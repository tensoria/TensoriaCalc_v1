(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   2809064,      59579]
NotebookOptionsPosition[   2772343,      58919]
NotebookOutlinePosition[   2772895,      58939]
CellTagsIndexPosition[   2772852,      58936]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["TensoriaCalc", "Title",
 CellChangeTimes->{{3.533882220173852*^9, 
  3.5338822591895204`*^9}},ExpressionUUID->"709c6e72-b6d5-4da7-834f-\
6a8e8ec43703"],

Cell[CellGroupData[{

Cell["Wei-Hao version introduction", "Section",
 CellChangeTimes->{{3.520627025921875*^9, 3.520627035578125*^9}, {
  3.521757617359375*^9, 3.52175762040625*^9}, {3.838183568545099*^9, 
  3.8381835822849464`*^9}},ExpressionUUID->"4c34ad68-c0ee-4c7e-b3bc-\
7e89d878397f"],

Cell["\<\
In this version, please search \[OpenCurlyDoubleQuote]NewCode\
\[CloseCurlyDoubleQuote] to jump to those code added by Wei-Hao.
Or, try to search the following keyword to find out specified section:

public declaration for Metric 
public declaration for MetricOperator
public declaration for CovariantBox
public declaration for JacobianComponents
public declaration for CoordinateTransformation
public declaration for RankNumber
public declaration for TooltipDisplayCheckwithComponents
public declaration for PartialD
public declaration for SymmetrizeIndices
public declaration for AntiSymmetrizeIndices
public declaration for SymmetrizeIndicesOperator
public declaration for AntiSymmetrizeIndicesOperator
public declaration for LieDerivativeOperator
public declaration for TooltipStyle
public declaration for ExteriorD
Attributes for ContractTensor
MetricOperator
Options for CoordinateTransformation
TestQuadraticInverse
Internal Function: RankNumber
Internal Function: TooltipDisplayCheckwithComponents
Redundant TagSetDelay
Derivative for Tensor
TooltipDisplay for Christoffel after acting PartialD
TestQuadratic
Inverse Metric with quadratic form (added code)
Delete the format of TooltipDisplay for Ricci Tensor
Delete the format of TooltipDisplay for Einstein Tensor
PartialD on a scalar with given coordinates list
PartialD for downstair on Tensor
PartialD for given Metric or Coordinates list on Tensor w/ downstair index
Short-hand for PartialD
Delete TensorType \[OpenCurlyDoubleQuote]PartialDerivative(s)\
\[CloseCurlyDoubleQuote]
Delete TensorType \[OpenCurlyDoubleQuote]Gradient\[CloseCurlyDoubleQuote]
Comment out TooltipDisplay in CovariantD
Bug Fixed for Tensor Check on stuff
CovariantBox on Tensor
JacobianComponents
CoordinateTransformation to one with the same symbols (Other than Metric and \
Christoffel)
CoordinateTransformation to one with different symbols (Other than Metric and \
Christoffel)
Change Name for Metric
Change Indices for Metric
Induced Tensor (Other than Metric and Christoffel)
CoordinateTransformation for Christoffel
ContractTensors now with order
CovariantHodgeDual Zero Tensor check
LieDerivative on General Tensor
LieDerivative on Metric with new indices
LieDerivative on General Tensor with new indices
SymmetrizeIndices
AntiSymmetrizeIndices
TensorIsZero for List
TensorComponents for Times[scalar, Plus[t1,t2]]
TensorSymmetry
New Property: TooltipStyle
New Property: TensorSymmetry
Protect
TooltipDisplay for metric
TooltipStyle for metric
Options for Tooltip
TooltipStyle
Tooltip for Christoffel
Tooltip for Riemann
Tooltip for Ricci
Tooltip for Weyl
Delete Redundent Union
ExteriorD
TensorEquations
TestIndices with OverHat
OrthonormalFrameField
ComponentRankNumber
New Property: OrthonormalFrameField
LieBracket
LieDerivative Check Vector
LieDerivative OptionValue
LieDerivative NewIndices
NonZeroTensorComponents
TooltipDisplay\[Rule]TensorComponents
PotentialForm
ZeroTensor
Tensor Linearity
LieDerivative Linearity
TensorForm
\[Del] transform
TestExpressionForm
ToExpressionForm
TensorsProduct ExpressionForm
LieDerivative for ExpressionForm
Indices for ExpressionForm
TensorIsZero for ExpressionForm
Delete TensorType: \[OpenCurlyDoubleQuote]CovariantDerivative(s)\
\[CloseCurlyDoubleQuote]
Do not allow CovariantD operator on a Christoffel
Operator Linearity
OperatorProductRule
\[Del]g=0
TensorWedge
TagSetDelay w/ t_Tensor
Scalar after CovariantHodgeDual: display ExpressionForm
SymmetrizedArray
CovariantHodgeDual: Automatically generate indices
Endow Metric as a property of a Tensor
Layer one
RicciScalar one layer
Determinant one layer
Coordinates one layer
TensorComponent one layer
Indices one layer
CovariantHodgeDual shortcut
Comment out VolumeForm
Comment out RicciCurvatureTensor
CovariantHodgeDual Check condition
ExtractFunctions
MoveIndices for scalar
CovariantHodgeDual for scalar
LeviCivita
CoordinatesDimension
CovariantHodgeDual
VectorSphericalHarmonic
TensorIsZero Pattern
SphericalHarmonicYTensor
TensorAssumption
TensorIsZeroOperator
TensorOperator
TensorDivision
TensorPlus
TensorComponentsManipulation
LieDerivative Inherit
TestDifferentialVector
TensorPlusOrderless
TensorPlusName
TimesScalarTensorName
TestOneVector
InteriorProduct
Message
ReplaceIndex
RemoveUnderBarredIndices for Tensor
RemoveRepeatedUnderBarredIndices for Tensor
TensorComponents and TensorsProduct
WedgeProductExpand
TestSymmetricTensorExpressionForm
Normal in MoveIndices
TensorProduct and TensorComponents
Operators\[CloseCurlyQuote] Rules
TestTensorTensor
TensorsProduct
New ContractTensors
TooltipStyle for derivative
Publish Operators\[CloseCurlyQuote] Rules
Second strategy of ONFF
BasisSgn
TestFormVectorIndices\
\>", "Text",
 CellChangeTimes->{{3.838183540394758*^9, 3.838183543254686*^9}, {
   3.8381835846752815`*^9, 3.8381836100650234`*^9}, {3.8381836417421074`*^9, 
   3.8381836436646852`*^9}, {3.8381836805670266`*^9, 3.838183761534753*^9}, {
   3.838184933979425*^9, 3.838184938757514*^9}, {3.838184994126876*^9, 
   3.8381850806870604`*^9}, {3.8381852508211985`*^9, 3.838185251119197*^9}, {
   3.8381866934354796`*^9, 3.838186727250552*^9}, {3.838188336832872*^9, 
   3.838188349135734*^9}, {3.838191541412948*^9, 3.8381915417119484`*^9}, {
   3.838191789878152*^9, 3.8381917900891523`*^9}, {3.838193304935484*^9, 
   3.8381933052714868`*^9}, {3.8381933557544036`*^9, 3.838193356000399*^9}, {
   3.8381934259392557`*^9, 3.838193448100277*^9}, {3.838194231743679*^9, 
   3.838194251771155*^9}, {3.8381943357064853`*^9, 3.8381943360474815`*^9}, {
   3.8381954143704343`*^9, 3.8381954146014347`*^9}, {3.838195587528199*^9, 
   3.8381955877462163`*^9}, {3.8381956461162577`*^9, 
   3.8381956463133345`*^9}, {3.8381956781507206`*^9, 
   3.8381956783662443`*^9}, {3.8381958534804516`*^9, 
   3.8381958538134527`*^9}, {3.8381959205272675`*^9, 
   3.8381959207892694`*^9}, {3.8381960015435495`*^9, 
   3.8381960017295523`*^9}, {3.838196201624762*^9, 3.838196201910922*^9}, {
   3.838196392882472*^9, 3.838196393099962*^9}, {3.838196497428034*^9, 
   3.8381965002424936`*^9}, {3.8381967607191563`*^9, 3.838196760858214*^9}, {
   3.838196835937931*^9, 3.838196836157698*^9}, {3.8392959677173567`*^9, 
   3.8392959680183086`*^9}, {3.839296025290244*^9, 3.8392960258230925`*^9}, {
   3.84308369671517*^9, 3.843083696910051*^9}, {3.8430867311459937`*^9, 
   3.8430867627815723`*^9}, {3.8436008380739775`*^9, 3.843600858266528*^9}, {
   3.8436018839614716`*^9, 3.8436018933569193`*^9}, {3.8436019778305826`*^9, 
   3.8436019808167105`*^9}, {3.8436038231369905`*^9, 3.843603832716693*^9}, {
   3.8439529985775375`*^9, 3.8439530009994125`*^9}, {3.84395817217196*^9, 
   3.843958219078933*^9}, {3.843958421941*^9, 3.843958423237872*^9}, {
   3.8455197040483627`*^9, 3.845519715495885*^9}, {3.8472438059621754`*^9, 
   3.8472438061496696`*^9}, {3.8472438981608315`*^9, 
   3.8472439023654337`*^9}, {3.847244431266676*^9, 3.847244462255109*^9}, {
   3.8472458456472225`*^9, 3.8472458500220885`*^9}, {3.847833425820345*^9, 
   3.8478334259763465`*^9}, {3.8478378438618464`*^9, 3.847837856241934*^9}, {
   3.847837995690747*^9, 3.8478379999882708`*^9}, {3.8478380929616284`*^9, 
   3.8478380967127852`*^9}, {3.847838356465848*^9, 3.8478383595512*^9}, {
   3.847839655490939*^9, 3.8478396969130116`*^9}, {3.8478397456412354`*^9, 
   3.847839759015979*^9}, {3.8478399809612226`*^9, 3.8478399836644635`*^9}, {
   3.847840045881219*^9, 3.8478400460532217`*^9}, {3.847840187434039*^9, 
   3.847840187597046*^9}, {3.847965602664712*^9, 3.847965602824849*^9}, {
   3.8484429730915613`*^9, 3.8484429761218395`*^9}, {3.8484431267374315`*^9, 
   3.848443185238154*^9}, {3.8484433245166388`*^9, 3.8484433253135114`*^9}, {
   3.8489978764940023`*^9, 3.8489979020301824`*^9}, {3.8501148460772343`*^9, 
   3.8501148578972692`*^9}, {3.8520227371790004`*^9, 
   3.8520227377386513`*^9}, {3.8525340830504694`*^9, 3.852534083366275*^9}, {
   3.85254504333886*^9, 3.852545044043426*^9}, {3.85315875272523*^9, 
   3.8531587529150424`*^9}, {3.853158789114741*^9, 3.8531587940144634`*^9}, {
   3.8541584518487835`*^9, 3.8541584932088346`*^9}, {3.854158559728834*^9, 
   3.854158559988388*^9}, 3.8552869726754093`*^9, {3.8564785246327133`*^9, 
   3.856478566175127*^9}, {3.858822872787442*^9, 3.8588228730222983`*^9}, {
   3.8595074926386466`*^9, 3.859507503503908*^9}, {3.859510431812354*^9, 
   3.859510432006238*^9}, {3.8613234214832845`*^9, 3.8613234219832697`*^9}, {
   3.8654811463160944`*^9, 3.8654811466754713`*^9}, {3.8667156075119047`*^9, 
   3.866715607891861*^9}, {3.8667570621771603`*^9, 3.866757062389318*^9}, {
   3.866757161033702*^9, 3.866757174784348*^9}, {3.8667718648033752`*^9, 
   3.866771865827972*^9}, {3.86731591863058*^9, 3.8673159249541874`*^9}, {
   3.8673280783247585`*^9, 3.867328078914853*^9}, {3.8673281483043437`*^9, 
   3.8673281485999174`*^9}, 3.868519645611379*^9, {3.8685696486472187`*^9, 
   3.8685696488700814`*^9}, {3.8685713926323566`*^9, 3.868571392800253*^9}, {
   3.8686120727838383`*^9, 3.8686120730666714`*^9}, {3.869100568596588*^9, 
   3.8691005687425003`*^9}, {3.869135969951573*^9, 3.8691359701536093`*^9}, {
   3.8691740205761356`*^9, 3.8691740207490273`*^9}, {3.8692866101301947`*^9, 
   3.8692866102701087`*^9}, 3.869287316295882*^9, {3.8692874536547966`*^9, 
   3.8692874537847147`*^9}, {3.8692875151421423`*^9, 
   3.8692875153360233`*^9}, {3.8697899738048363`*^9, 
   3.8697899941803665`*^9}, {3.8697900617648673`*^9, 3.869790071238541*^9}, {
   3.8697901581157503`*^9, 3.869790164687975*^9}, {3.871601285573132*^9, 
   3.8716012982123537`*^9}, {3.8716013734670973`*^9, 3.8716014048618*^9}, {
   3.8733296490269823`*^9, 3.873329650466101*^9}, {3.8733297302317142`*^9, 
   3.8733297398774796`*^9}, {3.8733424872205667`*^9, 3.873342487486187*^9}, {
   3.8733425919753513`*^9, 3.8733425923659763`*^9}, {3.873342629105654*^9, 
   3.873342632136904*^9}, {3.8733430582878294`*^9, 3.873343058506581*^9}, {
   3.8745372600209713`*^9, 3.874537260302797*^9}, {3.875090435535598*^9, 
   3.875090435694502*^9}, {3.875091652814492*^9, 3.8750916603028793`*^9}, {
   3.8750988730246654`*^9, 3.8750988815694013`*^9}, {3.8750998309459915`*^9, 
   3.875099846225582*^9}, {3.8751413477314396`*^9, 3.875141347917325*^9}, {
   3.8751414630825377`*^9, 3.875141463348374*^9}, {3.875242725157955*^9, 
   3.8752427253298273`*^9}, {3.875743992710063*^9, 3.875744009575689*^9}, {
   3.8757479130985107`*^9, 3.8757479478253937`*^9}, {3.875755335801253*^9, 
   3.8757553386932445`*^9}, {3.8763630386988945`*^9, 3.87636304007386*^9}, 
   3.8763633663570476`*^9, {3.876445721950384*^9, 3.8764457221066356`*^9}, {
   3.876538929314429*^9, 3.876538929501314*^9}, {3.8765423250973577`*^9, 
   3.8765423252550907`*^9}, {3.8770521715743914`*^9, 3.877052181784362*^9}, {
   3.877052230703272*^9, 3.877052245379991*^9}, {3.8842150359524565`*^9, 
   3.884215036130347*^9}, {3.884771474360896*^9, 3.8847714750952296`*^9}, {
   3.885422820250942*^9, 3.8854228208645678`*^9}, {3.886570714478826*^9, 
   3.8865707146397257`*^9}, {3.886734750665724*^9, 3.8867347601139317`*^9}, {
   3.8867380944100904`*^9, 3.8867380946189623`*^9}, {3.88711663353426*^9, 
   3.8871166515771303`*^9}, {3.8871598065528393`*^9, 3.887159807146472*^9}, {
   3.8893340330321445`*^9, 3.8893340332769947`*^9}, {3.889602107873559*^9, 
   3.8896021081655607`*^9}, {3.890189493061683*^9, 3.89018950120784*^9}, {
   3.8901899789597263`*^9, 3.8901899817899694`*^9}, {3.890192715066867*^9, 
   3.8901927158447356`*^9}, {3.890193361654958*^9, 3.8901933618328505`*^9}, {
   3.891515037339863*^9, 3.8915150422162147`*^9}, {3.8915156662284975`*^9, 
   3.891515674267579*^9}, {3.8915688374413786`*^9, 3.8915688401127453`*^9}, {
   3.891572141639448*^9, 3.8915721468702526`*^9}, {3.891572201115081*^9, 
   3.8915722014708633`*^9}, {3.892007061223699*^9, 3.8920070614085827`*^9}, {
   3.892211095551318*^9, 3.8922110963373537`*^9}, 3.894774787982849*^9, {
   3.8947749047467585`*^9, 3.894774904917658*^9}, {3.894889606577253*^9, 
   3.8948896072518473`*^9}, {3.895059035653338*^9, 3.8950590363200526`*^9}, {
   3.8950724392009845`*^9, 3.8950724548411903`*^9}, {3.895072729485428*^9, 
   3.8950727296416764`*^9}, 3.8950730126943693`*^9, {3.895074678971949*^9, 
   3.895074679237593*^9}, 3.8955429773942924`*^9, {3.8955490655079165`*^9, 
   3.8955490655648804`*^9}, {3.8955541071509275`*^9, 3.8955541074027753`*^9}, 
   3.895554784214306*^9, {3.895555034484186*^9, 3.895555035959872*^9}, 
   3.8955557206952553`*^9, 3.895555846126156*^9, 3.895556026004197*^9, {
   3.8966771856498065`*^9, 3.896677193105093*^9}, {3.89875463927464*^9, 
   3.898754639649605*^9}, {3.89917995212999*^9, 3.8991799525567265`*^9}, {
   3.953346115832272*^9, 3.953346115909462*^9}, 3.955682499431656*^9, {
   3.956193352196926*^9, 3.9561933529941483`*^9}, 
   3.95619785115727*^9},ExpressionUUID->"f0341033-fda0-4009-9a1f-\
fc82d2af96d4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"NewCode", ":"}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.871601374694344*^9, 3.8716013747063365`*^9}, 
   3.8733296731519117`*^9, 3.873329743255557*^9, 3.875242732332182*^9, 
   3.8915156789814606`*^9},ExpressionUUID->"ef005703-cd52-4222-a532-\
3659a531f1f5"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensoriaCalc: Introduction", "Section",
 CellChangeTimes->{{3.520627025921875*^9, 3.520627035578125*^9}, {
  3.521757617359375*^9, 
  3.52175762040625*^9}},ExpressionUUID->"72bd2be0-e491-4259-abdd-\
f5d0d6c720f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "            ", 
   RowBox[{
    RowBox[{"Copyright", " ", "Yi"}], "-", 
    RowBox[{"Zen", " ", 
     RowBox[{"Chu", "."}]}]}], "               ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "One", " ", "main", " ", "goal", " ", "of", " ", "this", " ", "software", 
    " ", "is", " ", "the"}], "          ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"computation", " ", "of", " ", "Christoffel", " ", "symbols"}], 
    ",", " ", "Riemann", ","}], "   ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Ricci", " ", "tensor", " ", "and", " ", "scalar"}], ",", " ", 
    RowBox[{
     RowBox[{"etc", ".", " ", "given"}], " ", "a", " ", "specific"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"metric", ".", " ", "We"}], " ", "are", " ", "working", " ", 
    "within", " ", "a", " ", "Riemannian"}], "     ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{"geometry", " ", 
    RowBox[{"frameowork", ".", " ", "Explicit"}], " ", "tensorial"}], 
   "        ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"calculations", " ", "will", " ", "increasingly", " ", "be", " ", 
    RowBox[{"supported", "."}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Please", " ", "feel", " ", "free", " ", "to", " ", "use", " ", 
    RowBox[{"and", "/", "or"}], " ", "modify", " ", "this"}], "     ", "*)"}],
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "code", " ", "for", " ", "the", " ", "purposes", " ", "of", " ", 
    "scientific", " ", 
    RowBox[{"research", "."}]}], "  ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Please", " ", "cite", " ", "the", " ", "URL", " ", "below", " ", "in", 
    " ", "your", " ", "publications"}], " ", "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
   "if", " ", "you", " ", "do", " ", "use", " ", "this", " ", "code", " ", 
    "for", " ", "your", " ", 
    RowBox[{"research", "."}]}], "     ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "If", " ", "you", " ", "want", " ", "to", " ", "make", " ", "money", " ", 
     "off", " ", "this"}], ",", " ", 
    RowBox[{"write", " ", "to"}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"me", " ", "first", " ", "at", " ", 
    RowBox[{"yizen", "[", "dot", "]"}], 
    RowBox[{"chu", "[", "at", "]"}], 
    RowBox[{"gmail", "[", "dot", "]"}], 
    RowBox[{"com", "."}]}], "    ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Feel", " ", "free", " ", "to", " ", "send", " ", "comments", " ", "to", 
     " ", "the", " ", "same", " ", "e"}], "-", 
    RowBox[{"mail", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"This", " ", "software"}], ",", " ", 
    RowBox[{"a", " ", 
     RowBox[{"user", "'"}], "s", " ", "guide"}], ",", " ", 
    RowBox[{"and", " ", "future"}]}], "      ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"updates", "/", "revisions"}], " ", "should", " ", "be", " ", 
    "available", " ", "at"}], "       ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"http", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{"www", ".", "stargazing", ".", "net"}], "/", "yizen"}], "/", 
     RowBox[{"Tensoria", ".", "html"}]}]}], "  ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"While", " ", "developing", " ", "this", " ", "code"}], ",", " ", 
    RowBox[{"I", " ", "have", " ", "taken"}]}], "       ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "inspiration", " ", "from", " ", "the", " ", "following", " ", "three", 
    " ", 
    RowBox[{"software", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"FeynCalc", " ", "@", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{"www", ".", "feyncalc", ".", "org"}], "/"}]}], "            ", 
   "*)"}], "\n", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"grt", " ", "@", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"www", ".", "vaudrevange", ".", "com"}], "/", "pascal"}], "/", 
      "grt"}], "/"}]}], "   ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"xAct", " ", "@", " ", 
     RowBox[{"http", ":"}]}], "//", 
    RowBox[{
     RowBox[{"www", ".", "xact", ".", "es"}], "/"}]}], 
   "                     ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "===", "===", "===", "===", "===", "===", "===", "===", "===", "===", "===",
      "===", "===", "===", "==="}], "="}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Please", " ", "refer", " ", "to", " ", "the", " ", 
    RowBox[{"TensoriaCalc", ".", "nb"}], " ", "file", " ", "for"}], "   ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "the", " ", "definitions", " ", "of", " ", "the", " ", "geometric", " ", 
    "objects"}], "       ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"computed", " ", "by", " ", "this", " ", 
    RowBox[{"package", ".", " ", 
     RowBox[{"(", 
      RowBox[{"It", " ", "is", " ", "difficult", " ", "to"}], "  "}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{" ", 
    RowBox[{"type", " ", "the", " ", "definitions", " ", "in", " ", 
     RowBox[{"text", "."}]}], ")"}], "                 ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.52062706340625*^9, {3.520627119109375*^9, 3.520627468984375*^9}, {
   3.5206275175625*^9, 3.520627645890625*^9}, {3.520627685671875*^9, 
   3.52062771053125*^9}, {3.520871722765625*^9, 3.5208718686875*^9}, {
   3.520871910671875*^9, 3.520872034078125*^9}, {3.5211465243125*^9, 
   3.521146592921875*^9}, {3.52169831134375*^9, 3.52169842040625*^9}, {
   3.521757643875*^9, 3.52175766646875*^9}, {3.533851610091141*^9, 
   3.5338517032134724`*^9}, {3.5338517361105185`*^9, 3.533851746077533*^9}, {
   3.5338517820915833`*^9, 3.5338517925207987`*^9}, {3.533851847610076*^9, 
   3.533851870463108*^9}, {3.5338519006333513`*^9, 3.533851943159811*^9}, {
   3.5338519863398733`*^9, 3.5338521403542914`*^9}, {3.5468009779741535`*^9, 
   3.5468011006215687`*^9}, {3.6065160615379653`*^9, 
   3.6065160654535723`*^9}, {3.6065161067468443`*^9, 
   3.6065161765413675`*^9}},ExpressionUUID->"4a86c268-2418-4e54-8890-\
ea254b3bdcf4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Geometric Objects: Definitions", "Section",
 CellChangeTimes->{{3.5350195756681585`*^9, 3.5350196069462137`*^9}, {
  3.5350196610003085`*^9, 
  3.535019662731911*^9}},ExpressionUUID->"11b59f65-da1a-4f8a-811c-\
2386e77bf6d4"],

Cell["\<\
Here, for the user\[CloseCurlyQuote]s reference, we define the geometric \
objects computed by TensoriaCalc. We employ Einstein\[CloseCurlyQuote]s \
summation convention, i.e., repeated indices are summed over.\
\>", "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, 3.669514452115941*^9, {
   3.66953130511903*^9, 3.669531309003252*^9}, {3.6696725129174223`*^9, 
   3.6696725200894337`*^9}, {3.669927613887076*^9, 
   3.6699276164378805`*^9}},ExpressionUUID->"b5e6e792-1bbe-4285-ac5a-\
39d229eddab4"],

Cell[TextData[{
 "Our Christoffel symbols are: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Mu]\[Nu]"], 
    "\[Congruent]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], 
     RowBox[{
      SuperscriptBox["g", "\[Alpha]\[Lambda]"], "(", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Mu]"], 
        SubscriptBox["g", "\[Nu]\[Lambda]"]}], "+", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Nu]"], 
        SubscriptBox["g", "\[Mu]\[Lambda]"]}], "-", 
       RowBox[{
        SubscriptBox["\[PartialD]", "\[Lambda]"], 
        SubscriptBox["g", "\[Mu]\[Nu]"]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"3a7cb0e4-d7b3-4646-aedf-ef1e1e84cd46"],
 ". Because \[CapitalGamma] is not a tensor, we do not allow for raising and \
lowering of indices."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144825510445`*^9}},ExpressionUUID->"52f9b741-3e82-4d6f-a1d4-\
e25e37d937a2"],

Cell[TextData[{
 "Our Riemann curvature tensor is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     SuperscriptBox["R", "\[Alpha]"], "\[Beta]\[Mu]\[Nu]"], "\[Congruent]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Nu]\[Beta]"]}], "-", 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Mu]\[Beta]"]}], "+", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Sigma]\[Mu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Sigma]"], "\[Nu]\[Beta]"]}], "-", 
     RowBox[{
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Sigma]\[Nu]"], 
      SubscriptBox[
       SuperscriptBox["\[CapitalGamma]", "\[Sigma]"], "\[Mu]\[Beta]"]}]}]}], 
   TraditionalForm]],ExpressionUUID->"c37d5b0a-a5ef-46e3-a5c7-2861dd12710e"],
 ". The Weyl tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    SuperscriptBox["C", "\[Alpha]"], "\[Beta]\[Mu]\[Nu]"], TraditionalForm]],
  ExpressionUUID->"77323ca7-7da4-4842-8483-fc4ac1843b06"],
 " is the traceless part of the Riemann tensor."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144873400545`*^9}},ExpressionUUID->"d40af7e2-9a26-4ca2-9ae2-\
e53c5384a21b"],

Cell[TextData[{
 "The Ricci tensor is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["R", "\[Beta]\[Nu]"], "\[Congruent]", 
    SubscriptBox[
     SuperscriptBox["R", "\[Alpha]"], "\[Beta]\[Alpha]\[Nu]"]}], 
   TraditionalForm]],ExpressionUUID->"2b04f9f8-56c4-495d-90fb-a70044476e1e"],
 "."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144890570574`*^9}},ExpressionUUID->"3845de80-1110-454b-9540-\
2e8519c9c9ac"],

Cell[TextData[{
 "The Ricci scalar is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{"R", "\[Congruent]", 
    RowBox[{
     SuperscriptBox["g", "\[Alpha]\[Beta]"], 
     SubscriptBox["R", "\[Alpha]\[Beta]"]}]}], TraditionalForm]],
  ExpressionUUID->"df250c09-a1fd-4af9-aad4-1ecdcd7a0922"],
 "."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.669514491868061*^9}},ExpressionUUID->"3c317f83-94d9-4d7a-886f-\
7a5d71c56178"],

Cell[TextData[{
 "The Einstein tensor is: ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["G", "\[Beta]\[Nu]"], "\[Congruent]", 
    RowBox[{
     SubscriptBox["R", "\[Beta]\[Nu]"], " ", "-", " ", 
     SubscriptBox["g", "\[Beta]\[Nu]"]}]}], TraditionalForm]],ExpressionUUID->
  "ed7ae0c4-5d9c-4939-9b1c-00c63c82c675"],
 StyleBox["R",
  FontSlant->"Italic"],
 "/2."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.6695144980730734`*^9}},ExpressionUUID->"aca41777-70a2-483b-a840-\
5989459e0b69"],

Cell[TextData[{
 "The generally covariant Levi-Civita tensor, in ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "0cd55a00-899a-49aa-b716-626fac56770b"],
 " space(time) dimensions, is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Epsilon]", "~"], 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Mu]", "1"], "..."}], 
      SubscriptBox["\[Mu]", "d"]}]], "=", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"|", 
        RowBox[{"det", " ", 
         SubscriptBox["g", "\[Alpha]\[Beta]"]}], "|"}], ")"}], 
      RowBox[{"1", "/", "2"}]], 
     SubscriptBox["\[Epsilon]", 
      RowBox[{
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "..."}], 
       SubscriptBox["\[Mu]", "d"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "8f639a88-6be8-4bc4-99b1-9ee1a98368e4"],
 ", where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Epsilon]", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "..."}], 
     SubscriptBox["\[Mu]", "d"]}]], TraditionalForm]],ExpressionUUID->
  "650310e7-d659-42da-964e-961805452ce3"],
 " is the Levi-Civita symbol, which in turn returns the sign of the \
permutation that brings {",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", 
     RowBox[{"1", ",", "...", ","}]], 
    SubscriptBox["\[Mu]", "d"]}], TraditionalForm]],ExpressionUUID->
  "d5d902f3-4482-40aa-b43b-fe84fdf41a3c"],
 "} into {0,1,2,3,..., d-1} (or into {",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "ae50e6a4-9716-4470-b107-b3b18220675c"],
 "+1,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "6eb0ed40-e294-4a5c-9419-8a3e2e1bbfab"],
 "+2,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "233cd570-137f-406f-9467-1fef04a23bb4"],
 "+3,...,",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "1daeca29-9fa2-4536-9346-d2aec61d7f15"],
 "+d}, for some integer ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["s", "i"], TraditionalForm]],ExpressionUUID->
  "18972dfd-4a18-4603-9440-3f60f11e42f5"],
 ") and is zero otherwise. In flat spacetime, this means we adhere to the \
covention that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["\[Epsilon]", "~"], 
     RowBox[{
      RowBox[{
       RowBox[{"0123", "..."}], "d"}], "-", "1"}]], " ", "=", "1"}], 
   TraditionalForm]],ExpressionUUID->"a20de96d-04e6-4b8d-b4be-d3e915352479"],
 " regardless of the signature of the metric. Note: ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " has a built-in LeviCivitaTensor that appears to implement what we would \
call the Levi-Civita tensor in ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "d35442b9-228f-4de6-9a8f-e9d46674ca91"],
 "-dimensional flat Euclidean space in Cartesian coordinates."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.66951449596507*^9}, {3.6695145618272038`*^9, 3.669514633497367*^9}, {
   3.6695146790024643`*^9, 3.6695146950585165`*^9}, {3.669517998168993*^9, 
   3.669518003503298*^9}, {3.671291620423515*^9, 3.6712916305055327`*^9}, {
   3.673104031705573*^9, 3.673104211485856*^9}, {3.6733339781765485`*^9, 
   3.673333978386552*^9}, {3.673334009914536*^9, 
   3.6733340542052164`*^9}},ExpressionUUID->"7946fbdc-2cbb-47bc-99b7-\
414d0ab90ab3"],

Cell[TextData[{
 "The Hodge dual (aka Hodge star operation), in ",
 Cell[BoxData[
  FormBox["d", TraditionalForm]],ExpressionUUID->
  "1c212502-a4a0-4fe3-b2ea-01e3003e8b38"],
 " space(time) dimensions, of a fully antisymmetric tensor ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "..."}], 
     SubscriptBox["\[Mu]", "n"]}]], TraditionalForm]],ExpressionUUID->
  "70a31a59-e0c3-475c-9cd9-b3df002e1c65"],
 " (where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"n", " ", "\[LessEqual]", " ", "d"}], TraditionalForm]],
  ExpressionUUID->"8c4cd4a0-8aa0-483f-ba11-7a1203f05b76"],
 "), is defined as, for e.g., \n\t\t\[FivePointedStar]",
 Cell[BoxData[
  FormBox[
   SubscriptBox["A", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "1"], "..."}], 
     SubscriptBox["\[Mu]", 
      RowBox[{"d", "-", "n"}]]}]], TraditionalForm]],ExpressionUUID->
  "3ff986f9-ec58-4f0a-b3c0-6ce56128acbd"],
 "\[Congruent]",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"1", "/", 
     RowBox[{"n", "!"}]}], ")"}], TraditionalForm]],ExpressionUUID->
  "e61a1b56-f562-4464-86d6-5f9518ce3449"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["\[Epsilon]", "~"], 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        SubscriptBox["\[Mu]", "1"], "..."}], 
       SubscriptBox["\[Mu]", 
        RowBox[{"d", "-", "n"}]], 
       SubscriptBox["\[Nu]", "1"]}], "..."}], 
     SubscriptBox["\[Nu]", "n"]}]], TraditionalForm]],ExpressionUUID->
  "eb7246f4-11be-4f58-b974-64dadb0a6fdf"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["A", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Nu]", "1"], "..."}], 
     SubscriptBox["\[Nu]", "n"]}]], TraditionalForm]],ExpressionUUID->
  "0a4549f2-6a03-4a58-8b25-98b4bceb64c9"],
 "."
}], "Text",
 CellChangeTimes->{{3.5350196118914223`*^9, 3.5350197821811123`*^9}, {
   3.5350198288407946`*^9, 3.5350199051561284`*^9}, {3.5350199458722*^9, 
   3.5350202136466703`*^9}, {3.535020275687979*^9, 3.5350202911788063`*^9}, {
   3.6294802198721633`*^9, 3.6294802599322195`*^9}, 3.6297452222417955`*^9, {
   3.6297637400879903`*^9, 3.629763773988669*^9}, {3.669510421728854*^9, 
   3.669510421966855*^9}, {3.669510461866974*^9, 3.669510592446375*^9}, {
   3.6695106395947247`*^9, 3.669510715058041*^9}, {3.6695109141611967`*^9, 
   3.6695109512433167`*^9}, {3.6695109977669773`*^9, 
   3.6695110209773045`*^9}, {3.669511147382535*^9, 3.6695112454851446`*^9}, {
   3.669511283536313*^9, 3.669511286083459*^9}, 3.6695114276765556`*^9, {
   3.6695115649214044`*^9, 3.6695115681235876`*^9}, {3.669514452115941*^9, 
   3.66951449596507*^9}, {3.6695145618272038`*^9, 3.669514633497367*^9}, {
   3.6695146790024643`*^9, 3.6695146950585165`*^9}, {3.669517998168993*^9, 
   3.669518003503298*^9}, {3.6695314283929696`*^9, 3.669531579967232*^9}, {
   3.6698311448221784`*^9, 3.6698311567028*^9}, {3.671291644345358*^9, 
   3.671291685577632*^9}, {3.671317143006171*^9, 3.6713171695815797`*^9}, {
   3.67333412672133*^9, 
   3.6733341280513506`*^9}},ExpressionUUID->"0031cf5e-9a66-49e2-9ae7-\
82aa2adb0af9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Public", "Section",
 CellChangeTimes->{{3.520303343484375*^9, 
  3.520303350734375*^9}},ExpressionUUID->"dbe7ad7a-92fe-41a0-9f5c-\
966a781ff5c3"],

Cell[CellGroupData[{

Cell["Begin", "Subsection",
 CellChangeTimes->{{3.6726814635444818`*^9, 
  3.6726814724714994`*^9}},ExpressionUUID->"7ed4bb07-bc17-40f3-a1d3-\
169195392a1b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BeginPackage", "[", "\"\<TensoriaCalc`\>\"", "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Upper", " ", "indices", " ", "are", " ", "denoted", " ", "by"}], 
    ",", " ", 
    RowBox[{
     RowBox[{"e", ".", "g", ".", " ", 
      SuperscriptBox["\[Mu]", "-"], ".", " ", "Lower"}], " ", "indices", " ", 
     "are", " ", "denoted", " ", "by"}], ",", " ", 
    RowBox[{"e", ".", "g", ".", " ", 
     SubscriptBox["\[Mu]", "-"]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "notation", " ", "is", " ", "the", " ", "same", " ", "as", 
    " ", 
    RowBox[{"Pascal", "'"}], "s", " ", "gtr"}], " ", "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, 
   3.671900525243921*^9, {3.6726814112425685`*^9, 3.672681415516377*^9}, {
   3.6731530927290735`*^9, 
   3.673153096775305*^9}},ExpressionUUID->"0dedec9e-166b-4c5a-b98a-\
9db1ff6a4b12"]
}, Closed]],

Cell[CellGroupData[{

Cell["?Usage", "Subsection",
 CellChangeTimes->{{3.6726814180283823`*^9, 
  3.6726814263264027`*^9}},ExpressionUUID->"92dff23d-d740-43fc-a3bc-\
d15106ea2098"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Usage", " ", "allows", " ", "us", " ", "to", " ", "say", " ", "which", 
    " ", "functions", " ", "will", " ", "be", " ", 
    RowBox[{"`public", "'"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "::", "usage"}], "=", 
     "\"\<Tensor is the generic Head of all tensorial objects.\>\""}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorType", "::", "usage"}], "=", 
     "\"\<TensorType specifies the type of Tensor.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorName", "::", "usage"}], "=", 
     "\"\<TensorName specifies the name of Tensor.\>\""}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Indices", "::", "usage"}], "=", 
     "\"\<(I) Indices \[Rule] {\[Mu],\[Nu],...} is one of the arguments of \
Tensor. It defines the indices of the Tensor. An upper index carries a \
superscript '-' and a lower index a subscript '-'. For example \
\!\(\*SuperscriptBox[\(\[Alpha]\), \(-\)]\) (also equivalent to SuperMinus[\
\[Alpha]]) is an upper index and \!\(\*SubscriptBox[\(\[Alpha]\), \(-\)]\) \
(also equivalent to SubMinus[\[Alpha]]) is a lower index. (II) \
Indices[M_Tensor] takes in a Tensor and returns a List of the indices used.\>\
\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"public", " ", "declaration", " ", "for", " ", "Metric"}]}], 
    "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{"The", " ", "message", " ", 
     RowBox[{"haven", "'"}], "t", " ", "be", " ", 
     RowBox[{"expanded", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Metric", "::", "usage"}], "=", 
     "\"\<(\!\(\*StyleBox[\"I\",FontColor->RGBColor[0, 0, 1]]\)) \
Metric[\[Mu],\[Nu],M,CoordinateSystem\[Rule]coords_List,TensorName\[Rule]name,\
StartIndex\[Rule]i,ChristoffelOperator\[Rule]op,RiemannOperator\[Rule]op,\
RicciOperator\[Rule]op,RicciScalarOperator\[Rule]op] returns a Tensor object \
representing a metric M with indices \[Mu] and \[Nu] (either both upper, \
i.e., \!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\) and \!\(\*SuperscriptBox[\(\
\[Nu]\), \(-\)]\), or both lower, i.e. \!\(\*SubscriptBox[\(\[Mu]\), \(-\)]\) \
and \!\(\*SubscriptBox[\(\[Nu]\), \(-\)]\); the coordinates are specified \
through the List coords. The name of the metric is name, and the metric M \
itself can either be given as a square matrix or an expression quadratic in \
differentials of the coordinates (e.g. \
(\[DifferentialD]x\!\(\*SuperscriptBox[\()\), \(2\)]\)+(\[DifferentialD]y\!\(\
\*SuperscriptBox[\()\), \(2\)]\)). StartIndex i tells TensoriaCalc when to \
begin counting indices; for example spacetime indices usually start at 0 \
while spatial indices usually start at 1. The ChristoffelOperator, \
RiemannOperator, etc. specify operators that will be applied to the \
components of the Christoffel symbols, Riemann tensor, etc. (Note: \
TensorName, StartIndex, ChristoffelOperator, RiemannOperator, RicciOperator, \
RicciScalarOperator are optional; the defaults are name = \
\!\(\*StyleBox[\"g\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\",\",FontSlant->\
\"Italic\"]\) i = 0 and op = FullSimplify.) \
(\!\(\*StyleBox[\"II\",FontColor->RGBColor[0, 0, 1]]\)) Metric[\[Mu], \[Nu], \
\[Tau]_Tensor] takes in \[Tau], an object with Head Tensor, of TensorType \
Metric, and returns the same Tensor object with TensorComponents representing \
the metric (if \[Mu],\[Nu] are both SuperMinus), the inverse metric (if \
\[Mu],\[Nu] are both SubMinus), or the identity matrix (if one index is \
SubMinus and one is SuperMinus).\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "::", "usage"}], "=", 
     "\"\<(\!\(\*StyleBox[\"I\",FontColor->RGBColor[0, 0, 1]]\)) \
NonMetricTensor[\[Mu]_List,stuff_List,exp_,CoordinateSystem\[Rule]coords_List,\
TensorType\[Rule]Null,TooltipDisplay\[Rule]Null,\n\tStartIndex\[Rule]0] \
returns a Tensor with indices \[Mu], components (entered as a Table) stuff, \
TensorName \[Rule] exp, coordinates coords, etc. TensorName, TensorType, \
TooltipDisplay, and StartIndex are Optional arguments, with default values as \
shown. (\!\(\*StyleBox[\"II\",FontColor->RGBColor[0, 0, 1]]\)) \
NonMetricTensor[{},stuff,exp_,CoordinateSystem\[Rule]coords_List,TensorType\
\[Rule]Null,TooltipDisplay\[Rule]Null,\n\tStartIndex\[Rule]0] returns a \
Tensor containing a scalar field with no indices {}. Its explicit expression \
is \!\(\*StyleBox[\"stuff\",FontSlant->\"Italic\"]\); its TensorName is \
\!\(\*StyleBox[\"exp\",FontSlant->\"Italic\"]\); and coordinates coords, etc. \
TensorName, TensorType, TooltipDisplay, and StartIndex are Optional \
arguments, with default values as shown.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Riemann", "::", "usage"}], "=", 
     "\"\<Riemann[\[Mu],\[Nu],\[Alpha],\[Beta],MetricT] takes in the metric \
MetricT and returns a Tensor containing the components of the Riemann \
curvature tensor, if indices are Symbols. If indices are Integers or if \
indices are the coordinates, the specified component will be returned.\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Ricci", "::", "usage"}], "=", 
     "\"\<Ricci[\[Nu],\[Beta],MetricT_Tensor] takes in the Tensor MetricT and \
returns a Tensor containing the components of the Ricci curvature tensor, if \
indices are Symbols. If indices are Integers or if indices are the \
coordinates, the specified component will be returned.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RicciScalar", "::", "usage"}], "=", 
     "\"\<RicciScalar[MetricT] takes in the Tensor MetricT and returns the \
Ricci scalar.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Einstein", "::", "usage"}], "=", 
     "\"\<Einstein[\[Nu],\[Beta],MetricT_Tensor,EinsteinOperator\[Rule]op] \
takes in the Tensor MetricT and returns a Tensor containing (the operation op \
applied to) the components of the Einstein tensor, where Einstein-Tensor = \
Ricci-Tensor - (Metric-Tensor/2) Ricci-Scalar \[LongDash] if indices are \
Symbols. If indices are Integers or if indices are the coordinates, the \
specified component will be returned. (EinsteinOperator is optional; if left \
unspecified, the default is op = FullSimplify.)\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LeviCivita", "::", "usage"}], "=", 
     "\"\<LeviCivita[\[Nu]1,\[Nu]2,...,\[Nu]d,MetricT_Tensor] takes in the \
Tensor MetricT (in \!\(\*StyleBox[\"d\",FontSlant->\"Italic\"]\) dimensions) \
and return a Tensor that yields the generally covariant Levi-Civita volume \
form, with indices \[Nu]1 through \[Nu]d. Note that Mathematica has an \
in-built LeviCivitaTensor, but it is really our LeviCivita here implemented \
for flat (Euclidean) space.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "::", "usage"}], "=", 
     "\"\<CovariantHodgeDual[\[Nu]I__,\[Tau]_Tensor,m_Tensor] returns the \
generally covariant Hodge dual of the Tensor \[Tau] using the Metric Tensor \
m. Note that Mathematica has an in-built HodgeDual, but it is really the \
Hodge dual (aka Hodge star operator) in flat (Euclidean) space. Now, the \
Hodge dual (aka Hodge star operation), in \!\(TraditionalForm\`d\) \
space(time) dimensions, of a fully antisymmetric tensor \!\(TraditionalForm\`\
\*SubscriptBox[\(A\), \(\(\*SubscriptBox[\(\[Mu]\), \(1\)] ... \) \
\*SubscriptBox[\(\[Mu]\), \(n\)]\)]\) (where \!\(TraditionalForm\`n\\\  \
\[LessEqual] \\\ d\)), is defined as, for e.g., \
\[FivePointedStar]\!\(TraditionalForm\`\*SubscriptBox[\(A\), \
\(\(\*SubscriptBox[\(\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(d - n\
\)]\)]\)\[Congruent]\!\(TraditionalForm\`\((1/\(n!\))\)\)\!\(TraditionalForm\`\
\*SubscriptBox[OverscriptBox[\(\[Epsilon]\), \(~\)], \(\(\(\*SubscriptBox[\(\
\[Mu]\), \(1\)] ... \) \*SubscriptBox[\(\[Mu]\), \(d - n\)] \*SubscriptBox[\(\
\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \
\(n\)]\)]\)\!\(TraditionalForm\`\*SuperscriptBox[\(A\), \(\(\*SubscriptBox[\(\
\[Nu]\), \(1\)] ... \) \*SubscriptBox[\(\[Nu]\), \(n\)]\)]\). Note: \
CovariantHodgeDual does check whether the Tensor \[Tau] is fully \
antisymmetric.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"EinsteinOperator", "::", "usage"}], "=", 
     "\"\<EinsteinOperator->op is an Option when using the TensoriaCalc \
function Einstein. It tells TensoriaCalc to apply op to the components of the \
Einstein tensor. The default op = FullSimplify.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Weyl", "::", "usage"}], "=", 
     "\"\<Weyl[\[Mu],\[Nu],\[Alpha],\[Beta],MetricT_Tensor] takes in the \
metric MetricT and returns a Tensor containing the components of the Weyl \
curvature tensor, if indices are Symbols. If indices are Integers or if \
indices are the coordinates, the specified component will be returned.\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WeylOperator", "::", "usage"}], "=", 
     "\"\<WeylOperator->op is an Option when using the TensoriaCalc function \
Weyl. It tells TensoriaCalc to apply op to the components of the Weyl \
curvature tensor. The default op = FullSimplify.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateSystem", "::", "usage"}], "=", 
     "\"\<CoordinateSystem defines the variables used in a given coordinate \
system. For example CoordinateSystem \[Rule] {t,x,y,z}.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Coordinates", "::", "usage"}], "=", 
     "\"\<Coordinates[M_Tensor] takes in a Tensor of type Metric and returns \
a List of the coordinates used.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorComponents", "::", "usage"}], "=", 
     "\"\<(I) TensorComponents \[Rule] tt is one of the arguments of Tensor. \
It defines the components for a given Tensor through tt. (II) \
TensorComponents[m_Tensor] takes in a Tensor object m and returns its \
TensorComponents\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricDeterminant", "::", "usage"}], "=", 
     "\"\<MetricDeterminant is an Option within a Tensor of type Metric whose \
OptionValue is the determinant of the metric in use.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Determinant", "::", "usage"}], "=", 
    "\"\<Determinant[MetricT] takes in a Tensor of type Metric and returns \
the determinant of the metric.\>\""}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannComponents", "::", "usage"}], "=", 
     "\"\<RiemannComponents refer to the components of the Riemann curvature \
tensor.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RicciComponents", "::", "usage"}], "=", 
     "\"\<RicciComponents refer to the components of the Ricci curvature \
tensor.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RicciScalarInvariant", "::", "usage"}], "=", 
     "\"\<RicciScalarCurvature is the Option occuring within a Tensor of \
Metric type, whose OptionValue gives the rule referring to the Ricci \
scalar.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ChristoffelComponents", "::", "usage"}], "=", 
     "\"\<ChristoffelComponents refer to the components of the Christoffel \
symbols.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"StartIndex", "::", "usage"}], "=", 
     "\"\<StartIndex is the Option occuring within Tensor that tells \
TensoriaCalc which Integer to start counting indices from. For example, \
spacetime indices usually have StartIndex \[Rule] 0 whereas purely spatial \
indices usually have StartIndex \[Rule] 1.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Christoffel", "::", "usage"}], "=", 
     "\"\<Christoffel[SuperMinus[\[Mu]_Integer],SubMinus[\[Alpha]_Integer],\
SubMinus[\[Beta]_Intger],M_Tensor] takes in the metric Tensor M (TensorType \
must be Metric) and returns a Tensor containing the components of the \
Christoffel symbol, if indices are Symbols. If indices are Integers or if \
indices are the coordinates, the specified component will be returned.\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TooltipDisplay", "::", "usage"}], "=", 
     "\"\<TooltipDisplay is an Option occuring within a non-Metric type \
Tensor which tells TensoriaCalc what to display when the user hovers her \
mouse over the Tensor.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", "TooltipStyle"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TooltipStyle", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", "MetricOperator"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricOperator", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ChristoffelOperator", "::", "usage"}], "=", 
     "\"\<ChristoffelOperator \[Rule] Op is an Option when using Metric. It \
tells TensoriaCalc to apply Op when calculating the components of the \
Christoffel symbols, for example FullSimplify the resulting \
expression.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RiemannOperator", "::", "usage"}], "=", 
     "\"\<RiemannOperator \[Rule] Op is an Option when using Metric. It tells \
TensoriaCalc to apply Op when calculating the components of the Riemann \
curvature tensor, for example FullSimplify the resulting expression.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RicciOperator", "::", "usage"}], "=", 
     "\"\<RicciOperator \[Rule] Op is an Option when using Metric. It tells \
TensoriaCalc to apply Op when calculating the components of the Ricci \
curvature tensor, for example FullSimplify the resulting expression.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RicciScalarOperator", "::", "usage"}], "=", 
     "\"\<RicciScalarOperator \[Rule] Op is an Option when using Metric. It \
tells TensoriaCalc to apply Op when calculating the components of the Ricci \
scalar, for example FullSimplify the resulting expression.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", 
      "SymmetrizeIndicesOperator"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymmetrizeIndicesOperator", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", 
      "AntiSymmetrizeIndicesOperator"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AntiSymmetrizeIndicesOperator", "::", "usage"}], "=", 
     "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", 
      "LieDerivativeOperator"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieDerivativeOperator", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", "CovariantBox"}]}], "*)"}]
    , "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"The", " ", "message", " ", 
     RowBox[{"haven", "'"}], "t", " ", "be", " ", 
     RowBox[{"expanded", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantBox", "::", "usage"}], "=", 
     "\"\<CovariantBox[X,MetricT] applies the operator \
\!\(\*SuperscriptBox[\(g\), \(\[Mu]\[Nu]\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SubscriptBox[\(\[Del]\), \(\[Nu]\)]\) on X using the metric \
Tensor MetricT. Currently, only the scalar operator is supported, i.e. X \
cannot contain Tensor objects and CovariantBox[X,MetricT] \[Congruent] (|det \
g|\!\(\*SuperscriptBox[\()\), \(\(-1\)/2\)]\)\!\(\*SubscriptBox[\(\[PartialD]\
\), \(\[Mu]\)]\)((|det g|\!\(\*SuperscriptBox[\()\), \(1/2\)]\) \
\!\(\*SuperscriptBox[\(g\), \(\[Mu]\[Nu]\)]\) \
\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Nu]\)]\)X).\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", "JacobianComponents"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "piece", " ", "is", " ", "supposed", " ", "to", " ", "not", 
     " ", "inside", " ", "the", " ", "official", " ", 
     RowBox[{"version", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianComponents", "::", "usage"}], "=", 
     "\"\<Please ignore it's, it's only public in Wei-Hao version.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", 
      "CoordinateTransformation"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"The", " ", "message", " ", 
     RowBox[{"haven", "'"}], "t", " ", "be", " ", 
     RowBox[{"expanded", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateTransformation", "::", "usage"}], "=", 
     "\"\<(\!\(\*StyleBox[\"I\",FontColor->RGBColor[0, 0, \
1]]\)\!\(\*StyleBox[\".1\",FontColor->RGBColor[0, 0, 1]]\)) \
CoordinateTransformation[{x\[Rule]f1[x,y,z,...], y\[Rule]f2[x,y,z,...], z\
\[Rule]f3[x,y,z,...], ...}] returns the coordinate transformation and the \
associated Jacobian for the infinitesimals, i.e. the output is \
Union[{x\[Rule]f1[x,y,z,...], y\[Rule]f2[x,y,z,...], z\[Rule]f3[x,y,z,...], \
...}, {dx\[Rule](\[PartialD]f1/\[PartialD]x)\[DifferentialD]x+(\[PartialD]f1/\
\[PartialD]y)\[DifferentialD]y+ ..., dy\[Rule](\[PartialD]f2/\[PartialD]x)\
\[DifferentialD]x+(\[PartialD]f2/\[PartialD]y)\[DifferentialD]y+...}]. \n\t\
(\!\(\*StyleBox[\"I\",FontColor->RGBColor[0, 0, \
1]]\)\!\(\*StyleBox[\".2\",FontColor->RGBColor[0, 0, 1]]\)) \
CoordinateTransformation[{x\[Rule]f1[p,q,r,...], y\[Rule]f2[p,q,r,...], z\
\[Rule]f3[p,q,r,...], ...}, {p,q,r, ...}] returns the coordinate \
transformation and the associated Jacobian for the infinitesimals, i.e. the \
output is Union[{x\[Rule]f1[p,q,r,...], y\[Rule]f2[p,q,r,...], \
z\[Rule]f3[p,q,r,...], ...}, {dx\[Rule](\[PartialD]f1/\[PartialD]p)\
\[DifferentialD]p+(\[PartialD]f1/\[PartialD]q)\[DifferentialD]q+ ..., dy\
\[Rule](\[PartialD]f2/\[PartialD]p)\[DifferentialD]p+(\[PartialD]f2/\
\[PartialD]q)\[DifferentialD]q+...}]. The main difference between (I.1) and \
(I.2) is that (I.2) allows for new coordinate names on the right hand side of \
the rules; of course, that means one has to specify what the new coordinates \
are for (I.2). (\!\(\*StyleBox[\"II\",FontColor->RGBColor[0, 0, 1]]\)) \
CoordinateTransformation[mt_Tensor,{x\[Rule]f1[x,y,z,...], \
y\[Rule]f2[x,y,z,...], z\[Rule]f3[x,y,z,...], ...}, \
CoordinateTransformationOperator\[Rule]op, StartIndex\[Rule]si] or \
CoordinateTransformation[mt_Tensor,{x\[Rule]f1[p,q,r,...], \
y\[Rule]f2[p,q,r,...], z\[Rule]f3[p,q,r,...], ...}, {p,q,r, ...}, \
CoordinateTransformationOperator\[Rule]op, StartIndex\[Rule]si], where mt is \
a Tensor of TensorType Metric, returns the same Tensor mt except \
coordinate-transformed according to the specified rules. Note that the index \
names and placement (i.e., down-down or up-up) are preserved. The \
CoordinateTransformationOperator\[Rule]op is an optional rule; with the \
default op = FullSimplify. StartIndex\[Rule]si is Optional; with default \
given by that in mt. Note: the new coordinates will be ordered according to \
the chronology specified in {p,q,r,...}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GradientSquared", "::", "usage"}], "=", 
     "\"\<GradientSquared[X,MetricT] computes \!\(\*SuperscriptBox[\(g\), \(\
\[Mu]\[Nu]\)]\) \!\(\*SubscriptBox[\(\[Del]\), \(\[Mu]\)]\)X \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Nu]\)]\)X using the metric Tensor MetricT. \
Currently, only the scalar operator is supported, i.e. X cannot contain \
Tensor objects.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"public", " ", "declaration", " ", "for", " ", "PartialD"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"The", " ", "message", " ", 
     RowBox[{"haven", "'"}], "t", " ", "be", " ", 
     RowBox[{"expanded", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartialD", "::", "usage"}], "=", 
     "\"\<PartialD[\!\(\*SubscriptBox[\(\[Mu]\), \(-\)]\),S_,MetricT_Tensor] \
or PartialD[\!\(\*SuperscriptBox[\(\[Mu]\), \(-\)]\),S_,MetricT_Tensor] \
returns a Tensor object with TensorComponents \
\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Mu]\)]\)TensorComponent[S] or \
\!\(\*SuperscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\
\), \(\[Nu]\)]\)TensorComponent[S] if S is a Tensor object, and \
\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Mu]\)]\)S or \!\(\*SuperscriptBox[\(g\
\), \(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(\[PartialD]\), \(\[Nu]\)]\)S if S \
is simply an expression, using the metric \!\(\*SuperscriptBox[\(g\), \(\[Mu]\
\[Nu]\)]\) of MetricT.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", "SymmetrizeIndices"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartialDWeiHao", "::", "usage"}], "=", 
     "\"\<WeiHao's version PartialD\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymmetrizeIndices", "::", "usage"}], "=", "\"\<public\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", 
      "AntiSymmetrizeIndices"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"AntiSymmetrizeIndices", "::", "usage"}], "=", 
     "\"\<public\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantD", "::", "usage"}], "=", 
     "\"\<CovariantD[\!\(\*SubscriptBox[\(\[Mu]\), \
\(-\)]\),S_Tensor,MetricT_Tensor] (or CovariantD[\!\(\*SuperscriptBox[\(\[Mu]\
\), \(-\)]\),S_,MetricT_Tensor]) returns a Tensor object with \
TensorComponents containing the metric-compatible covariant derivative \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Mu]\)]\) (or \!\(\*SuperscriptBox[\(\[Del]\
\), \(\[Mu]\)]\)) acting on S, using the metric MetricT.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"public", " ", "declaration", " ", "for", " ", "ExteriorD"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExteriorD", "::", "usage"}], "=", "\"\<public\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorsProduct", "::", "usage"}], "=", 
     "\"\<TensorsProduct[Times[tt__Tensor]] \[LongDash] not to be confused \
with Mathematica's own TensorContract \[LongDash] returns a Tensor whose \
TensorComponents is built from contracting the sequence of Tensors in tt, \
i.e., by forming a tensor product out of their TensorComponents, and summing \
over repeated indices. All other attributes of the output Tensor are \
inherited from the first Tensor of the sequence in tt.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SwapIndices", "::", "usage"}], "=", 
     "\"\<SwapIndices[tt_Tensor,idx_List] returns the Tensor object tt, with \
its un-UnderBarred indices (say, \!\(\*SubscriptBox[\(i\), \
\(1\)]\)...\!\(\*SubscriptBox[\(i\), \(n\)]\)) re-arranged into idx; the \
TensorComponents of tt are re-arranged accordingly. When specifying idx, \
remember not to include the UnderBarred Indices of tt.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorIsZero", "::", "usage"}], "=", 
     "\"\<TensorIsZero[tt_Tensor] returns True if every component of the \
Tensor object tt is zero and False otherwise.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveIndices", "::", "usage"}], "=", 
     "\"\<(I) MoveIndices[tt_Tensor,idx_List,m_Tensor] returns the Tensor tt \
with its indices raised/lowered by specifying idx, using the Metric Tensor m. \
Suppose tt has indices {\!\(TraditionalForm\`\*SubscriptBox[\(\[Alpha]\), \(-\
\)]\), \!\(TraditionalForm\`\*SuperscriptBox[\(\[Beta]\), \(-\)]\) \
,\!\(TraditionalForm\`\*SuperscriptBox[\(\[Mu]\), \(-\)]\), \
\!\(TraditionalForm\`\*SubscriptBox[\(\[Nu]\), \(-\)]\)} and \[Alpha] and \
\[Mu] need to be raised and lowered respectively, then do \
MoveIndices[tt_Tensor,{\!\(TraditionalForm\`\*SuperscriptBox[\(\[Alpha]\), \
\(-\)], \*SubscriptBox[\(\[Mu]\), \(-\)]\)},m]. (II) \
MoveIndices[tt_Tensor,m_Tensor] essentially returns the Tensor tt[\[Alpha],\
\[Beta],...] where the indices \[Alpha],\[Beta],... can be specified \
arbitrarily \[LongDash] either up or down. If the specified indices were not \
in the same up/down position as the input tt, the indices are automatically \
moved using the Metric Tensor m.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RaiseAllIndices", "::", "usage"}], "=", 
     "\"\<RaiseAllIndices[tt_Tensor,m_Tensor] returns the Tensor tt with all \
its indices raised using the Metric Tensor m.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LowerAllIndices", "::", "usage"}], "=", 
     "\"\<LowerAllIndices[tt_Tensor,m_Tensor] returns the Tensor tt with all \
its indices lowered using the Metric Tensor m.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UniqueIndices", "::", "usage"}], "=", 
     "\"\<UniqueIndices[tt_Tensor] returns the Tensor tt with its indices \
replaced with Unique ones.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GeodesicSystem", "::", "usage"}], "=", 
     "\"\<GeodesicSystem[MetricT_Tensor,AffineParameter\[Rule]\[Lambda],\
NonAffineParameter\[Rule]t] returns the affine parameter Lagrangian (1/2)\!\(\
\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\[Lambda]]](\!\(\*SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\
\[Lambda])(\!\(\*SuperscriptBox[\(dz\), \(\[Nu]\)]\)/d\[Lambda]) for geodesic \
motion, the non-affine parameter Lagrangian (\!\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[t]](\!\(\*SuperscriptBox[\(dz\), \
\(\[Mu]\)]\)/dt)(\!\(\*SuperscriptBox[\(dz\), \
\(\[Nu]\)]\)/dt)\!\(\*SuperscriptBox[\()\), \(1/2\)]\) for geodesic motion, \
and the geodesic equations in both affine and non-affine parameter \
forms.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GeodesicLagrangians", "::", "usage"}], "=", 
     "\"\<GeodesicLagrangians[MetricT_Tensor,AffineParameter\[Rule]\[Lambda],\
NonAffineParameter\[Rule]t] returns the affine parameter Lagrangian (1/2)\!\(\
\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\[Lambda]]](\!\(\*SuperscriptBox[\(dz\), \(\[Mu]\)]\)/d\
\[Lambda])(\!\(\*SuperscriptBox[\(dz\), \(\[Nu]\)]\)/d\[Lambda]) for geodesic \
motion, and the non-affine parameter Lagrangian (\!\(\*SubscriptBox[\(g\), \(\
\[Mu]\[Nu]\)]\)[z[t]](\!\(\*SuperscriptBox[\(dz\), \
\(\[Mu]\)]\)/dt)(\!\(\*SuperscriptBox[\(dz\), \
\(\[Nu]\)]\)/dt)\!\(\*SuperscriptBox[\()\), \(1/2\)]\) for geodesic motion. \
It does what GeodesicSystem does, but does not output the geodesic equations \
themselves.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"GeodesicHamiltonianDynamics", "::", "usage"}], "=", 
     "\"\<GeodesicHamiltonianDynamics[MetricT_Tensor,{z1->p1,z2->p2,...},\
\[Lambda]] returns the affine parameter Hamiltonian \
(1/2)\!\(\*SuperscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)[z[\[Lambda]]]\!\(\*SubscriptBox[\(p\), \(\[Mu]\)]\)[\
\[Lambda]]\!\(\*SubscriptBox[\(p\), \(\[Nu]\)]\)[\[Lambda]] \n\tand the \
geodesic equations {\!\(\*SuperscriptBox[\(dz\), \
\(\[Mu]\)]\)/d\[Lambda]==\!\(\*SuperscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)\!\(\*SubscriptBox[\(p\), \
\(\[Nu]\)]\),\!\(\*SubscriptBox[\(dp\), \
\(\[Mu]\)]\)=-\[PartialD]H/\[PartialD]\!\(\*SuperscriptBox[\(z\), \
\(\[Mu]\)]\)}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieDerivative", "::", "usage"}], "=", 
     "\"\<LieDerivative[\[Xi]_Tensor,m_Tensor] returns the Lie derivative of \
the Tensor m with respect to the rank-1 Tensor \[Xi]. Currently, \
LieDerivative only takes in Metric m; i.e., it only computes the Lie \
derivatives of metrics: \!\(\*SubscriptBox[\(\[Sterling]\), \
\(\[Xi]\)]\)\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\) = \
\!\(\*SuperscriptBox[\(\[Xi]\), \(\[Sigma]\)]\)\!\(\*SubscriptBox[\(\
\[PartialD]\), \(\[Sigma]\)]\)\!\(\*SubscriptBox[\(g\), \
\(\[Mu]\[Nu]\)]\)+\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(g\), \
\(\[Nu]\[Sigma]\)]\)+\!\(\*SubscriptBox[\(\[PartialD]\), \
\(\[Nu]\)]\)\!\(\*SuperscriptBox[\(\[Xi]\), \
\(\[Sigma]\)]\)\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Sigma]\)]\).\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorEquations"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorEquations", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalFrameField", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseOrthonormalFrameField", "::", "usage"}], "=", 
     "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalFrameFieldOperator", "::", "usage"}], "=", 
     "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FlatMetric", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOrthonormalFrameField", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalFrameFieldIndices", "::", "usage"}], "=", 
     "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalBasis", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateBasis", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "LieBracket"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracketOperator", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Derivative", " ", "for", " ", "Tensor"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PD", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "PotentialForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PotentialForm", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExpressionForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToExpressionForm", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\n", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Operator", " ", "Linearity"}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"OperatorLinearity", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Operator", " ", "ProductRule"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OperatorProductRule", "::", "usage"}], "=", "\"\<\>\""}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\[FivePointedStar]", "::", "usage"}], "=", "\"\<\>\""}], ";"}],
     "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "SphericalHarmonicYTensor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicYTensor", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "VectorSphericalHarmonic"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VectorSphericalHarmonic", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorAssumption", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorIsZeroOperator"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorIsZeroOperator", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorOperator", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorDivision"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorDivision", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorDivisionOperator", "::", "usage"}], "=", "\"\<\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorPlus"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorPlus", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorComponentsManipulation"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorComponentsManipulation", "::", "usage"}], "=", 
     "\"\<\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "InteriorProduct"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"InteriorProduct", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "WedgeProductExpand"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WedgeProductExpand", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ToTensorComponents"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToTensorComponents", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"New", " ", "ContractTensors"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ContractTensors", "::", "usage"}], "=", "\"\<\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Publish", " ", 
      RowBox[{"Operators", "'"}], " ", "Rules"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OperatorDistributeOverPlus", "::", "usage"}], "=", "\"\<\>\""}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"OperatorNullList", "::", "usage"}], "=", "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OperatorExpansion", "::", "usage"}], "=", "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OperatorFactorOutScalar", "::", "usage"}], "=", "\"\<\>\""}], 
     ";", 
     RowBox[{
      RowBox[{"OperatorRemoveSingleComponentList", "::", "usage"}], "=", 
      "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OperatorThreadThroughFunction", "::", "usage"}], "=", 
      "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OperatorTensorReturnItself", "::", "usage"}], "=", 
      "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OperatorExpressionFormReturnItself", "::", "usage"}], "=", 
      "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OperatorTensorsProduct", "::", "usage"}], "=", "\"\<\>\""}], 
     ";", 
     RowBox[{
      RowBox[{"OperatorContractThroughFunction", "::", "usage"}], "=", 
      "\"\<\>\""}], ";", 
     RowBox[{
      RowBox[{"OutputBecomesOneTensor", "::", "usage"}], "=", "\"\<\>\""}], 
     ";", 
     RowBox[{
      RowBox[{"OperatorThreadThroughTimes", "::", "usage"}], "=", 
      "\"\<\>\""}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, 
   3.671900525243921*^9, {3.6726814112425685`*^9, 3.672681415516377*^9}, {
   3.6726815539770775`*^9, 3.6726815849009447`*^9}, {3.67277883261517*^9, 
   3.672778833516272*^9}, {3.6729368512415514`*^9, 3.672936886484229*^9}, {
   3.7181175425194597`*^9, 3.7181175449841714`*^9}, {3.7181175804892473`*^9, 
   3.7181175826322465`*^9}, {3.718117813313806*^9, 3.718117820041767*^9}, {
   3.7181178661505527`*^9, 3.7181178743255715`*^9}, {3.7181179136960073`*^9, 
   3.7181179415368843`*^9}, {3.7181187729579525`*^9, 
   3.7181188881224637`*^9}, {3.718168060805704*^9, 3.7181680634625854`*^9}, {
   3.7181681106786623`*^9, 3.7181681133195763`*^9}, {3.71817011784788*^9, 
   3.7181702312591715`*^9}, {3.7188740448276434`*^9, 3.718874118266955*^9}, {
   3.7277837734101863`*^9, 3.7277838369796805`*^9}, {3.7277842477480726`*^9, 
   3.7277843047626133`*^9}, {3.7277843812194896`*^9, 
   3.7277845386305146`*^9}, {3.727791805526963*^9, 3.7277919228456736`*^9}, {
   3.727832767414161*^9, 3.727832769174889*^9}, {3.7278328043105087`*^9, 
   3.7278329288248887`*^9}, {3.781003012473667*^9, 3.7810030133054795`*^9}, {
   3.781005331163983*^9, 3.7810053674280224`*^9}, {3.7913771210831985`*^9, 
   3.7913771569079695`*^9}, {3.791377210905308*^9, 3.7913773291755714`*^9}, {
   3.791377359815612*^9, 3.7913775419381227`*^9}, {3.791378219198855*^9, 
   3.7913782633819675`*^9}, {3.791378615351301*^9, 3.791378668631422*^9}, {
   3.791378708031274*^9, 3.7913787328163815`*^9}, {3.7962445899421296`*^9, 
   3.796244804335622*^9}, {3.7991207168351173`*^9, 3.7991207174378333`*^9}, {
   3.8105274981203403`*^9, 3.8105275085677595`*^9}, {3.810527557450038*^9, 
   3.810527570574007*^9}, {3.8105276259252205`*^9, 3.810527733083951*^9}, 
   3.8123247414827676`*^9, {3.813532660660122*^9, 3.813532739857503*^9}, {
   3.815346979379566*^9, 3.8153471496655016`*^9}, {3.825219914608142*^9, 
   3.8252199159897146`*^9}, {3.8274030532332573`*^9, 3.827403092077257*^9}, 
   3.827403333075289*^9, {3.828410386120182*^9, 3.8284103866102*^9}, {
   3.83647600335748*^9, 3.836476032379975*^9}, {3.8374903218347116`*^9, 
   3.837490372975354*^9}, {3.8374974429987583`*^9, 3.8374974476862593`*^9}, 
   3.8376383781542296`*^9, {3.837638410960621*^9, 3.837638482168416*^9}, {
   3.838183840584766*^9, 3.8381838680948887`*^9}, {3.838183928485117*^9, 
   3.8381839435202985`*^9}, {3.8381840437849283`*^9, 
   3.8381842691835175`*^9}, {3.8381843136670265`*^9, 3.838184348592174*^9}, 
   3.838185064755763*^9, {3.8436009166427355`*^9, 3.8436009600931234`*^9}, {
   3.843600996259204*^9, 3.8436009980560236`*^9}, {3.843601909831271*^9, 
   3.843601920927291*^9}, {3.8436019669676285`*^9, 3.8436019682515917`*^9}, {
   3.8436038518804154`*^9, 3.843603867229436*^9}, {3.843958225375813*^9, 
   3.8439582258289323`*^9}, {3.843958406097253*^9, 3.843958412394126*^9}, {
   3.8472438873003244`*^9, 3.847243888911127*^9}, {3.8484429189667234`*^9, 
   3.848442958741664*^9}, {3.848442988956651*^9, 3.848442992628209*^9}, {
   3.8484431920075393`*^9, 3.8484432405856686`*^9}, {3.8484432856637945`*^9, 
   3.8484433104294105`*^9}, {3.849142957171355*^9, 3.8491429921369934`*^9}, {
   3.849498951614747*^9, 3.849498958346848*^9}, {3.8538478049660068`*^9, 
   3.8538478156761894`*^9}, {3.854158401219428*^9, 3.854158438878516*^9}, {
   3.854158482008668*^9, 3.85415851534895*^9}, {3.859455459568985*^9, 
   3.8594554640764174`*^9}, {3.859456030032592*^9, 3.859456035902937*^9}, {
   3.859462337266512*^9, 3.8594623446364126`*^9}, {3.8594631859223404`*^9, 
   3.859463188813361*^9}, {3.8595076079588003`*^9, 3.859507628902814*^9}, {
   3.859510452270667*^9, 3.8595104678580027`*^9}, {3.859511611397701*^9, 
   3.859511611649548*^9}, {3.859600787476267*^9, 3.8596007958214016`*^9}, {
   3.8599297665217047`*^9, 3.859929767460065*^9}, {3.8601114820472794`*^9, 
   3.8601114959424105`*^9}, {3.861332200728032*^9, 3.861332203328434*^9}, {
   3.8651200484298077`*^9, 3.865120054414178*^9}, {3.866716024064704*^9, 
   3.8667161051445646`*^9}, {3.8667179579401255`*^9, 
   3.8667179670039434`*^9}, {3.8673280513665485`*^9, 
   3.8673280654550543`*^9}, {3.8691360029115515`*^9, 3.869136008106018*^9}, {
   3.873340251699786*^9, 3.8733402818247795`*^9}, {3.875098040723068*^9, 
   3.8750980447451982`*^9}, {3.8842149950815887`*^9, 3.884215017371883*^9}, {
   3.8847705619704027`*^9, 3.8847705645000515`*^9}, {3.885422804571506*^9, 
   3.8854228086230364`*^9}, {3.885422846052211*^9, 3.8854228464679565`*^9}, {
   3.886734779411789*^9, 3.886734787067097*^9}, {3.886734955553728*^9, 
   3.886734962876237*^9}, {3.8867381690893097`*^9, 3.8867381762229385`*^9}, {
   3.887112472433793*^9, 3.887112508114831*^9}, {3.887116640949686*^9, 
   3.8871166603557186`*^9}, {3.887159785593274*^9, 3.8871598194841995`*^9}, {
   3.8901934035913267`*^9, 3.8901934139598784`*^9}, 3.8947747965421734`*^9, {
   3.8947763682734437`*^9, 3.8947763992077365`*^9}, {3.895074665342996*^9, 
   3.895074672112776*^9}, {3.895542980370104*^9, 3.895542982067542*^9}, {
   3.8955490655967493`*^9, 3.8955490656047425`*^9}, {3.895554071144112*^9, 
   3.8955540965294905`*^9}, {3.898754569630513*^9, 3.8987546281227446`*^9}, 
   3.8988329558635097`*^9, {3.8988330026898136`*^9, 3.898833014497012*^9}, {
   3.8993774229573507`*^9, 3.89937742633826*^9}, 
   3.956199042412479*^9},ExpressionUUID->"eb551ae7-49f0-46bf-a0d1-\
2e2fecbe6ae9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"4", "D", " ", "Ideal", " ", "MHD", " ", "Functions"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MHDSystem", "::", "usage"}], "=", 
     "\"\<MHDSystem[{\[CapitalPhi]1_,\[CapitalPhi]2_,\[CapitalPhi]3_}, \
\[Rho]0_Function, m_Tensor, MetricSignature \[Rule] s_String, MHDOperator \
\[Rule] op] returns an object, with Head MHDSystem, that stores all relevant \
information described by the 3 scalar fields {\[CapitalPhi]1,\[CapitalPhi]2,\
\[CapitalPhi]3} and the plasma energy density (pure function) \[Rho]0. Note \
that MetricSignature and MHDOperator are optional; s = `Mostly minus' tells \
TensoriaCalc the user employs \!\(\*SubscriptBox[\(\[Eta]\), \
\(\[Mu]\[Nu]\)]\) = diag[1,-1,...,-1] and s = `Mostly plus' tells \
TensoriaCalc the user employs \!\(\*SubscriptBox[\(\[Eta]\), \
\(\[Mu]\[Nu]\)]\) = diag[-1,+1,...,+1]; the default values are s = `Mostly \
minus' and op = Simplify.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "::", "usage"}], "=", 
     "\"\<(\!\(\*StyleBox[\"I\",FontColor->RGBColor[0, 0, 1]]\)) \
MHDScalar[1,mm_MHDSystem], MHDScalar[2,mm_MHDSystem], and \
MHDScalar[3,mm_MHDSystem] returns, respectively, the 1st, 2nd, and 3rd \
fundamental scalar fields of the MHDSystem mm. \
(\!\(\*StyleBox[\"II\",FontColor->RGBColor[0, 0, 1]]\)) \
MHDScalar[\[Mu]T_,1,mm_MHDSystem], MHDScalar[\[Mu]T_,2,mm_MHDSystem], and \
MHDScalar[\[Mu]T_,3,mm_MHDSystem] returns, respectively, the Tensor object \
describing \[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\), \[Del]\!\(\
\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\), and \[Del]\!\(\*SuperscriptBox[\
\(\[CapitalPhi]\), \(3\)]\), with index \[Mu]T.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD3Form", "::", "usage"}], "=", 
     "\"\<MHD3Form[\[Mu]T_,\[Nu]T_,\[Gamma]T_,mm_MHDSystem] returns the \
Tensor built from the 3 fundamental scalars \
\!\(\*StyleBox[OverscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \
\"~\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\" \",FontSlant->\"Italic\"]\)\
\[Congruent] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \
\[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\), of \
the MHDSystem mm, with indices {\[Mu]T,\[Nu]T,\[Gamma]T}.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaCurrent", "::", "usage"}], "=", 
     "\"\<MHDPlasmaCurrent[\[Mu]T_,mm_MHDSystem] returns the plasma current \
Tensor \!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\), of the MHDSystem mm, \
with indices {\[Mu]T}. Note that \
\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\) is the Hodge dual of the 3-form \
built from the 3 fundamental MHD scalars, namely \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \[Wedge] \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \[Wedge] \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\).\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwell", "::", "usage"}], "=", 
     "\"\<MHDMaxwell[\[Mu]T_,\[Nu]T_,mm_MHDSystem] returns the Maxwell Tensor \
\!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\), of the MHDSystem mm, with \
indices {\[Mu]T,\[Nu]T}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellCurrent", "::", "usage"}], "=", 
     "\"\<MHDMaxwellCurrent[\[Mu]T_,mm_MHDSystem] returns the electromagnetic \
(Maxwell) current \!\(\*StyleBox[\"J\",FontSlant->\"Italic\"]\) = div \
\!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\), of the MHDSystem mm, with \
index {\[Mu]T}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDRank2P", "::", "usage"}], "=", 
     "\"\<MHDRank2P[\[Mu]T_,\[Nu]T_,mm_MHDSystem] returns the rank-2 Tensor \
object \!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\), of the MHDSystem mm, \
with indices {\[Mu]T,\[Nu]T}. This \
\!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\) occurs on the right hand side \
of the 3 MHD PDEs.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMetric", "::", "usage"}], "=", 
     "\"\<MHDMetric[\[Mu]T_, \[Nu]T_, mm_MHDSystem] returns the Metric Tensor \
object describing the background spacetime geometry of the MHDSystem in mm, \
with indices {\[Mu]T, \[Nu]T}.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"...", " ", "MHDSystem", " ", "arguments"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalarFunction1", "::", "usage"}], "=", 
     "\"\<MHDScalarFunction1 \[Rule] \!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\) is one of the arguments of an MHDSystem object. It describes the 1st \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalarFunction2", "::", "usage"}], "=", 
     "\"\<MHDScalarFunction2 \[Rule] \!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(2\)]\) is one of the arguments of an MHDSystem object. It describes the 2nd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalarFunction3", "::", "usage"}], "=", 
     "\"\<MHDScalarFunction3 \[Rule] \!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(3\)]\) is one of the arguments of an MHDSystem object. It describes the 3rd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD1FormTensor1", "::", "usage"}], "=", 
     "\"\<MHD1FormTensor1 \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) is one of the \
arguements of an MHDSystem object. It describes the gradient of the 1st \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD1FormTensor2", "::", "usage"}], "=", 
     "\"\<MHD1FormTensor2 \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) is one of the \
arguements of an MHDSystem object. It describes the gradient of the 2nd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD1FormTensor3", "::", "usage"}], "=", 
     "\"\<MHD1FormTensor3 \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\) is one of the \
arguements of an MHDSystem object. It describes the gradient of the 3rd \
fundamental scalar of the MHDSstem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHD3FormTensor", "::", "usage"}], "=", 
     "\"\<MHD3FormTensor \[Rule] \
\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\)\[Wedge]\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(2\)]\)\[Wedge]\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\) is one \
of the arguments of an MHDSystem object. It describes the 3-form \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\)\[Wedge]\
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\)\[Wedge]\
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\), where \
\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(I = 1, 2, 3\)]\) are the 3 \
fundamental scalars of the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellTensor", "::", "usage"}], "=", 
     "\"\<MHDMaxwellTensor \[Rule] \[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\
\), \(1\)]\)\[Wedge]\[Del]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) is \
one of the arguments of an MHDSystem object. It describes the 2-form Maxwell \
Tensor \!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\) = \
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\)\[Wedge]\
\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\), where \
\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(I = 1, 2\)]\) are the first 2 \
fundamental scalars of the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaCurrentTensor", "::", "usage"}], "=", 
     "\"\<MHDPlasmaCurrentTensor \[Rule] \
\[FivePointedStar](\[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\) \[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\
\)]\) \[Wedge] \[DifferentialD]\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\
\)) is one of the arguments of an MHDSystem object. It describes the \
(identically conserved) plasma current Tensor, which in index notation reads \
\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \"\[Mu]\"]\) \
\[Congruent] \!\(\*SuperscriptBox[OverscriptBox[\(\[Epsilon]\), \(~\)], \(\
\[Mu]\\\ \[Alpha]\[Beta]\[Gamma]\)]\) \!\(\*SubscriptBox[\(\[Del]\), \(\
\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \
\(1\)]\)\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(2\)]\)\!\(\*SubscriptBox[\(\[Del]\), \
\(\[Gamma]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\), where \
\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(I = 1, 2, 3\)]\) are the 3 \
fundamental scalars of the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDRank2PTensor", "::", "usage"}], "=", 
     "\"\<MHDRank2PTensor \[Rule] \
\!\(TraditionalForm\`\*SuperscriptBox[\(P\), \(\[Alpha]\[Beta]\)]\) is one of \
the arguments of an MHDSystem object. It describes the Tensor object \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\) \[Congruent] \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)(\!\(\*SubscriptBox[\(\[Rho]\), \(0\)]\) \!\(\*SuperscriptBox[\
\(\[Del]\), \([\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(1\)]\) \!\
\(\*SuperscriptBox[\(\[Del]\), \(\[Alpha]\)]\)\!\(\*SubscriptBox[\(\
\[CapitalPhi]\), \(2\)]\) \!\(\*SuperscriptBox[\(\[Del]\), \(\(\[Beta]\)\(]\)\
\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(3\)]\)), which occurs on the \
right-hand-sides of the 3 PDEs governing the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellCurrentTensor", "::", "usage"}], "=", 
     "\"\<MHDMaxwellCurrentTensor \[Rule] \
\!\(TraditionalForm\`\*SuperscriptBox[\(J\), \(\[Alpha]\)]\) is one of the \
arguments of an MHDSystem object. It describes the Tensor object \
\!\(\*SuperscriptBox[StyleBox[\"J\",FontSlant->\"Italic\"], \"\[Alpha]\"]\) \
\[Congruent] \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Sigma]\[Alpha]\"]\), \
\!\(\*StyleBox[\"i\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\".\",FontSlant->\
\"Italic\"]\)\!\(\*StyleBox[\"e\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\".\"\
,FontSlant->\"Italic\"]\), the electromagnetic current.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDEquationsList", "::", "usage"}], "=", 
     "\"\<MHDEquationsList \[Rule] {{lhs1,rhs1},{lhs2,rhs2},{0,rhs3}} is one \
of the arguments of an MHDSystem object. The lhs1 == rhs1, lhs2 == rhs2, and \
0 == rhs3 form the 3 fundamental PDEs of the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDEquations", "::", "usage"}], "=", 
     "\"\<MHDEquations[mm_MHDSystem] returns a List of the 3 fundamental \
partial differential equations of the MHDSystem mm.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMaxwellStressTensor", "::", "usage"}], "=", 
     "\"\<MHDMaxwellStressTensor \[Rule] \
\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[EM\!\(\*SubscriptBox[\(]\), \(\
\[Mu]\[Nu]\)]\) is one of the arguments of an MHDSystem object. It contains \
the rank-2 Tensor object describing electromagnetic \
energy-momentum-shear-stress of the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaStressTensor", "::", "usage"}], "=", 
     "\"\<MHDPlasmaStressTensor \[Rule] \
\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Plasma\!\(\*SubscriptBox[\(]\), \
\(\[Mu]\[Nu]\)]\) is one of the arguments of an MHDSystem object. It contains \
the rank-2 Tensor object describing plasma energy-momentum-shear-stress of \
the MHDSystem.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDTotalStressTensor", "::", "usage"}], "=", 
     "\"\<MHDTotalStressTensor \[Rule] \
\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Total\!\(\*SubscriptBox[\(]\), \
\(\[Mu]\[Nu]\)]\) is one of the arguments of an MHDSystem object. It contains \
the rank-2 Tensor object describing the total plasma + Maxwell photon \
energy-momentum-shear-stress of the MHDSystem.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDLagrangianDensity", "::", "usage"}], "=", 
     "\"\<MHDLagrangianDensity \[Rule] L is one of the arguments of a \
MHDSystem object, where L is the Lagrangian density of the MHDSystem\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaEnergyDensityOperator", "::", "usage"}], "=", 
     "\"\<MHDPlasmaEnergyDensityOperator \[Rule] \
\!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) is one of the arguments of a \
MHDSystem object, where \!\(\*StyleBox[\"op\",FontSlant->\"Italic\"]\) \
provides the function describing the energy density of the plasma.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDPlasmaEnergyDensity", "::", "usage"}], "=", 
     "\"\<MHDPlasmaEnergyDensity[mm_MHDSystem] returns the plasma energy \
density function of the MHDSystem mm.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDLagrangian", "::", "usage"}], "=", 
     "\"\<MHDLagrangian[mm_MHDSystem] returns the (coordinate scalar) \
Lagrangian density of the MHDSystem mm.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDEnergyMomentumShearStress", "::", "usage"}], "=", 
     "\"\<MHDEnergyMomentumShearStress[\[Mu]T_,\[Nu]T_,ss_String,mm_MHDSystem]\
, for ss = Maxwell, returns the rank-2 Tensor object describing \
electromagnetic energy-momentum-shear-stress of the MHDSystem mm. \
MHDEnergyMomentumShearStress[\[Mu]T_,\[Nu]T_,ss_String,mm_MHDSystem], for ss \
= Plasma, returns the rank-2 Tensor object describing plasma \
energy-momentum-shear-stress of the MHDSystem mm. \
MHDEnergyMomentumShearStress[\[Mu]T_,\[Nu]T_,ss_String,mm_MHDSystem], for ss \
= Total, returns the rank-2 Tensor object describing the total plasma + \
Maxwell photon energy-momentum-shear-stress of the MHDSystem mm.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDMetricTensor", "::", "usage"}], "=", 
     "\"\<MHDMetricTensor \[Rule] \
\!\(\*SubscriptBox[StyleBox[\"g\",FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\) \
is one of the arguments of an MHDSystem object. It contains the rank-2 Tensor \
object describing background spacetime geometry of the MHDSystem.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDOperator", "::", "usage"}], "=", 
     "\"\<MHDOperator \[Rule] op is an optional argument when entering a \
MHDSystem. Default value for op is Simplify.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MetricSignature", "::", "usage"}], "=", 
     "\"\<MetricSignature \[Rule] op_String specifies whether the user is \
employing the `Mostly minus' or `Mostly plus' metric signature; in (1+1) \
spacetime dimensions `Mostly minus' means \!\(\*SubscriptBox[\(\[Eta]\), \(\
\[Mu]\[Nu]\)]\) \[Congruent] diag[1,-1] and `Mostly plus' means \
\!\(\*SubscriptBox[\(\[Eta]\), \(\[Mu]\[Nu]\)]\) \[Congruent] diag[-1,1]. \
MetricSignature occurs, for e.g., as an Optional argument in MHDSystem. \
Whenever relevant, the default is `Mostly minus'.\>\""}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, {
   3.671321209835158*^9, 3.6713212146263666`*^9}, {3.671321251505637*^9, 
   3.671321267605068*^9}, {3.6713213047075367`*^9, 3.6713215167665663`*^9}, {
   3.67132164255451*^9, 3.6713217972267942`*^9}, {3.671324219085931*^9, 
   3.6713242492063932`*^9}, {3.6713245181605263`*^9, 3.671324907624008*^9}, 
   3.671324939489498*^9, {3.671324991380295*^9, 3.6713253089556723`*^9}, {
   3.6713756135009017`*^9, 3.671375619057911*^9}, {3.6713785591619196`*^9, 
   3.6713785667319326`*^9}, {3.671378646154108*^9, 3.6713788076174326`*^9}, {
   3.671378838491488*^9, 3.6713788518695097`*^9}, {3.671379084930932*^9, 
   3.6713790858209333`*^9}, {3.671379127187009*^9, 3.6713792554652414`*^9}, {
   3.671379400923545*^9, 3.671379402155547*^9}, {3.671379932400988*^9, 
   3.6713800306761847`*^9}, {3.671380107286331*^9, 3.6713801909664917`*^9}, {
   3.6713802493786097`*^9, 3.671380250020611*^9}, {3.6713802836856785`*^9, 
   3.671380435580968*^9}, {3.671381462198265*^9, 3.671381596326538*^9}, {
   3.67138164114962*^9, 3.6713816915217047`*^9}, {3.6713817605058403`*^9, 
   3.6713817849498806`*^9}, {3.671381903904108*^9, 3.6713820498723845`*^9}, {
   3.671382330526928*^9, 3.671382455238199*^9}, {3.6713825475284204`*^9, 
   3.6713826901516657`*^9}, {3.6713827624247932`*^9, 3.671383287472781*^9}, {
   3.671383341952903*^9, 3.6713833426729035`*^9}, {3.671383465932156*^9, 
   3.6713834773151765`*^9}, {3.67138354438433*^9, 3.6713835486193385`*^9}, {
   3.6713835842934113`*^9, 3.6713838031758127`*^9}, {3.671383862480932*^9, 
   3.671384083316369*^9}, {3.6713841377440667`*^9, 3.6713842081652355`*^9}, {
   3.671384259494336*^9, 3.6713844022626233`*^9}, {3.671384453169711*^9, 
   3.6713844534697113`*^9}, {3.671685508951892*^9, 3.6716855171737137`*^9}, {
   3.6716855944723024`*^9, 3.6716856076637316`*^9}, {3.6716859391195593`*^9, 
   3.671686029694344*^9}, {3.671686382552693*^9, 3.671686383114294*^9}, {
   3.6717413407126837`*^9, 3.6717413443696995`*^9}, {3.6717414699141855`*^9, 
   3.6717414933582783`*^9}, {3.671758957994608*^9, 3.6717590364786587`*^9}, {
   3.671759288102297*^9, 3.671759350393615*^9}, {3.671759449814612*^9, 
   3.6717594847880793`*^9}, {3.6717597123332214`*^9, 
   3.6717597125747213`*^9}, {3.6717662550993176`*^9, 
   3.6717662561153193`*^9}, {3.671900578618348*^9, 3.6719006029244456`*^9}, {
   3.671911219158656*^9, 3.6719112271593733`*^9}, 3.6719732047373495`*^9, {
   3.6719859092022495`*^9, 3.671986059131355*^9}, {3.671986122724991*^9, 
   3.67198613678242*^9}, {3.671986226162913*^9, 3.671986300093571*^9}, {
   3.671994909516223*^9, 3.671994950447564*^9}, {3.671995257586131*^9, 
   3.6719952821565366`*^9}, {3.671995344374095*^9, 3.6719955035461993`*^9}, {
   3.6719972832379923`*^9, 3.671997339695221*^9}, {3.6719973848798056`*^9, 
   3.6719973912091675`*^9}, {3.6719974739639006`*^9, 
   3.6719975101499705`*^9}, {3.6720242671119475`*^9, 3.6720242730820394`*^9}, 
   3.672024456267353*^9, {3.6720580038770237`*^9, 3.672058075185619*^9}, {
   3.6720598884924736`*^9, 3.672059956831023*^9}, {3.6720794284600215`*^9, 
   3.6720794308881607`*^9}, {3.6720794711324625`*^9, 3.672079647027523*^9}, {
   3.6720796791583605`*^9, 3.6720797274791245`*^9}, {3.6720797713856363`*^9, 
   3.6720799372391224`*^9}, {3.672157549715098*^9, 3.6721576173486366`*^9}, {
   3.672258204506383*^9, 3.6722582329910126`*^9}, {3.672260823929206*^9, 
   3.67226082663136*^9}, {3.672260859656249*^9, 3.672260880600447*^9}, {
   3.859455408615982*^9, 3.8594554500962706`*^9}, {3.8596007670529175`*^9, 
   3.859600767396989*^9}},ExpressionUUID->"91b04c85-a1aa-4658-96dc-\
da31b43dd7ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"public", " ", "declaration", " ", "for", " ", "RankNumber"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "This", " ", "piece", " ", "is", " ", "supposed", " ", "to", " ", "not", 
    " ", "inside", " ", "the", " ", "official", " ", 
    RowBox[{"version", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it's, it's only public in Wei-Hao version.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ComponentRankNumber"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComponentRankNumber", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it's, it's only public in Wei-Hao version.\>\""}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "public", " ", "declaration", " ", "for", " ", 
      "TooltipDisplayCheckwithComponents"}]}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "This", " ", "piece", " ", "is", " ", "supposed", " ", "to", " ", "not", 
     " ", "inside", " ", "the", " ", "official", " ", 
     RowBox[{"version", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TooltipDisplayCheckwithComponents", "::", "usage"}], "=", 
      "\[IndentingNewLine]", 
      "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sgn", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestIndices", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveRepeatedUnderBarredIndices", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveUnderBarredIndices", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"OverHatSgn", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialVector", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialForm", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ZeroTensor", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestExpressionForm", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMetricTensor", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestTensorIsFullyAntiSymmetric", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"StartIndexNoPart", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorNameNoPart", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorTypeNoPart", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TooltipDisplayNoPart", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TooltipStyleNoPart", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinatesNoPart", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorComponentsNoPart", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"IndicesNoPart", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinatesDimension", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"ContainOnlyScalarTensor", "::", "usage"}], "=", 
      "\[IndentingNewLine]", 
      "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
     ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMoveOnlyOneType", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TimesScalarTensorName", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TensorPlusName", "::", "usage"}], "=", "\[IndentingNewLine]", 
      "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
     ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOneVector", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceIndex", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestSymmetricTensorExpressionForm", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestTensorTensor", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"NotAbstractIndex", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestRepeatedIndices", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"BasisSgn", "::", "usage"}], "=", "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"TestFormVectorIndices", "::", "usage"}], "=", 
     "\[IndentingNewLine]", 
     "\"\<Please ignore it. It's only public in Wei-Hao version.\>\""}], 
    ";"}]}]}]], "Code",
 CellChangeTimes->{{3.8599297826019287`*^9, 3.859929838271906*^9}, {
   3.859929910291888*^9, 3.859929913291938*^9}, {3.865119167679326*^9, 
   3.865119170960577*^9}, {3.8651193621881676`*^9, 3.8651193811256666`*^9}, {
   3.865560635155592*^9, 3.8655606364954605`*^9}, {3.8667160312343335`*^9, 
   3.866716031924839*^9}, {3.867328435687086*^9, 3.867328455501277*^9}, {
   3.868569668287101*^9, 3.8685696719278545`*^9}, {3.869100611204363*^9, 
   3.8691006148291335`*^9}, {3.875098338100155*^9, 3.875098340677569*^9}, {
   3.875241003821782*^9, 3.875241062502694*^9}, {3.8752410955595274`*^9, 
   3.8752411007155924`*^9}, {3.8757465740436635`*^9, 3.875746597772067*^9}, {
   3.8757466475144625`*^9, 3.8757466499409714`*^9}, {3.875747458733897*^9, 
   3.8757474694873877`*^9}, {3.875747786786392*^9, 3.8757477897863317`*^9}, {
   3.8757480104166756`*^9, 3.875748036735523*^9}, {3.876538947770138*^9, 
   3.8765389506753583`*^9}, {3.878180752627137*^9, 3.878180755949107*^9}, {
   3.8860352884445367`*^9, 3.886035292663186*^9}, {3.88657445589979*^9, 
   3.886574460485958*^9}, {3.8867381525124702`*^9, 3.886738153155079*^9}, {
   3.8896026082495604`*^9, 3.8896026125925593`*^9}, {3.890193448757524*^9, 
   3.890193512758066*^9}, {3.8901980999480505`*^9, 3.8901981080990396`*^9}, 
   3.8915138495944233`*^9, {3.8915689581375775`*^9, 3.891568976929081*^9}, {
   3.8920070474492564`*^9, 3.8920070477690573`*^9}, 3.893289123663864*^9, 
   3.894775943384306*^9, {3.8948895949770575`*^9, 3.8948895982421627`*^9}, {
   3.895072747828694*^9, 3.895072752141078*^9}, {3.895552883450466*^9, 
   3.8955528865485992`*^9}, {3.89555397151873*^9, 3.8955539745739346`*^9}, 
   3.895554786496966*^9, 3.895555179352072*^9, 3.8955553449512076`*^9, 
   3.8955555320463047`*^9, 3.8955556400102143`*^9, 3.895555722215759*^9, 
   3.8955557886552334`*^9, 3.8955558477264414`*^9, 3.8955559542282887`*^9, 
   3.895556027733861*^9, 3.895556095220892*^9, {3.953346125319738*^9, 
   3.9533461305604897`*^9}, {3.9561974468712463`*^9, 3.956197451799999*^9}, {
   3.956197620141621*^9, 
   3.9561976208927517`*^9}},ExpressionUUID->"49edcfe2-6c69-44ee-a9ac-\
b7327209cab8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Attributes/Options/Mathematica Packages", "Subsection",
 CellChangeTimes->{{3.672681438275632*^9, 3.672681448704054*^9}, {
  3.71811586794244*^9, 
  3.7181158764039145`*^9}},ExpressionUUID->"ad34d706-e6c9-4ec1-a4a2-\
11f9f325835b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Tensor", " ", 
    RowBox[{"properties", "/", "options"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"Tensor", ",", "Orderless"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetAttributes", "[", 
     RowBox[{"MHDSystem", ",", "Orderless"}], "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorPlusOrderless"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SetAttributes", "[", 
      RowBox[{"TensorPlus", ",", "Orderless"}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SetAttributes", "[", 
      RowBox[{"TensorPlusName", ",", "Orderless"}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Attributes", " ", "for", " ", "ContractTensor"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"SetAttributes", "[", 
      RowBox[{"TensorsProduct", ",", "HoldAll"}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Metric", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CoordinateSystem", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{
       "TensorName", "\[Rule]", 
        "\"\<\!\(\*StyleBox[\"g\",FontSlant->\"Italic\"]\)\>\""}], ",", 
       RowBox[{"StartIndex", "\[Rule]", "0"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "MetricOperator"}], "*)"}], 
       RowBox[{"MetricOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"ChristoffelOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RiemannOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RicciOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"RicciScalarOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
       RowBox[{"FlatMetric", "\[Rule]", "Null"}], ",", 
       RowBox[{"OrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TestOrthonormalFrameField", "\[Rule]", "False"}], ",", 
       RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "Null"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
       RowBox[{"TensorOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Christoffel", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", 
        RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "TensorComponents"}]}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Riemann", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", 
        RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Ricci", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", 
        RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Einstein", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"EinsteinOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "Weyl", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"WeylOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "OrthonormalFrameField", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TestOrthonormalFrameField", "\[Rule]", "False"}], ",", 
       RowBox[{"OrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "Null"}], ",", 
       RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "Null"}]}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "NonMetricTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"StartIndex", "\[Rule]", "0"}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"TensorType", "\[Rule]", "Null"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
       RowBox[{"TensorOperator", "\[Rule]", " ", "Simplify"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"{", "}"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "MHDSystem", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"MHDOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"MetricSignature", "\[Rule]", "\"\<Mostly minus\>\""}]}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "GeodesicSystem", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[CapitalTHacek]", "]"}]}], ",", 
       RowBox[{"NonAffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[CapitalLSlash]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "GeodesicLagrangians", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"AffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[CapitalTHacek]", "]"}]}], ",", 
       RowBox[{"NonAffineParameter", "\[Rule]", 
        RowBox[{"Unique", "[", "\[CapitalLSlash]", "]"}]}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Options", " ", "for", " ", "CoordinateTransformation"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Indices", " ", "and", " ", "TensorName", " ", "are", " ", "new", " ", 
     "parts", " ", 
     RowBox[{"w", "/", " ", "default"}], " ", "value"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "CoordinateTransformation", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"CoordinateTransformationOperator", "\[Rule]", "Simplify"}], 
       ",", 
       RowBox[{
       "StartIndex", "\[Rule]", "\[Alpha]\[Beta]\[Gamma]\[Theta]\[Phi]"}], 
       ",", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TensorName", "\[Rule]", "1234"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Options", " ", "for", " ", "Tooltip"}]}], "*)"}], 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "LieDerivative"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "LieDerivative", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LieDerivativeOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"Indices", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "LieBracket"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "LieBracket", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"LieDerivativeOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"LieBracketOperator", "\[Rule]", "Simplify"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}], ",", 
       RowBox[{"Indices", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "SphericalHarmonicYTensor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "SphericalHarmonicYTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "VectorSphericalHarmonic"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "VectorSphericalHarmonic", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Normalize", "\[Rule]", " ", "True"}], ",", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"TooltipDisplay", "\[Rule]", "Null"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "SymmetrizeIndices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "SymmetrizeIndices", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"SymmetrizeIndicesOperator", "\[Rule]", 
       RowBox[{"(*", "Simplify", "*)"}], 
       RowBox[{"(", 
        RowBox[{"#", "&"}], ")"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "AntiSymmetrizeIndices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "AntiSymmetrizeIndices", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"AntiSymmetrizeIndicesOperator", "\[Rule]", 
       RowBox[{"(*", "Simplify", "*)"}], 
       RowBox[{"(", 
        RowBox[{"#", "&"}], ")"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorIsZeroOperator"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "TensorIsZero", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"TensorIsZeroOperator", "\[Rule]", " ", "Simplify"}], "}"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorDivision"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "TensorDivision", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"TensorDivisionOperator", "\[Rule]", " ", "Simplify"}], "}"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "PotentialForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "PotentialForm", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{
      "TensorName", "\[Rule]", 
       "\"\<\!\(\*StyleBox[\"\[Beta]\",FontSlant->\"Italic\"]\)\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"MMA", " ", "Packages"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Needs", "[", "\"\<VariationalMethods`\>\"", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Notation`AutoLoadNotationPalette", "=", "False"}], "}"}], 
       ",", 
       RowBox[{"Needs", "[", "\"\<Notation`\>\"", "]"}]}], "]"}], ";"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ToTensorComponents"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ToTensorComponents", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"CoordinateSystem", "\[Rule]", " ", 
       RowBox[{"{", "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Options", "[", "ElectromagneticStressEnergyTensor", "]"}], "=", 
     RowBox[{"{", 
      RowBox[{"MetricSignature", "\[Rule]", "\"\<Mostly minus\>\""}], "}"}]}],
     ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, 3.520303299859375*^9, {
   3.520303549375*^9, 3.52030358071875*^9}, {3.5203507715625*^9, 
   3.520350858640625*^9}, {3.520350918515625*^9, 3.520350918796875*^9}, {
   3.5203511166875*^9, 3.520351136140625*^9}, {3.520356764953125*^9, 
   3.520356884515625*^9}, {3.520371762125*^9, 3.5203718918125*^9}, {
   3.520378815359375*^9, 3.520378856375*^9}, {3.52037895428125*^9, 
   3.520378970015625*^9}, {3.5204389959375*^9, 3.52043945671875*^9}, {
   3.520439536453125*^9, 3.52043953984375*^9}, 3.520439581921875*^9, {
   3.520439654296875*^9, 3.520439710359375*^9}, {3.520439880765625*^9, 
   3.520439884828125*^9}, {3.520439970515625*^9, 3.52044004490625*^9}, {
   3.52044311690625*^9, 3.520443213734375*^9}, {3.520465048609375*^9, 
   3.5204650511875*^9}, {3.520626553671875*^9, 3.52062658471875*^9}, {
   3.52062668471875*^9, 3.52062670090625*^9}, {3.520626757234375*^9, 
   3.520626799984375*^9}, {3.520626907484375*^9, 3.52062701828125*^9}, {
   3.52069946446875*^9, 3.5206994743125*^9}, {3.520699970546875*^9, 
   3.52069998275*^9}, {3.520815631453125*^9, 3.520815642671875*^9}, {
   3.52087815671875*^9, 3.5208781575625*^9}, {3.52087819059375*^9, 
   3.520878191671875*^9}, {3.520878244578125*^9, 3.520878249421875*^9}, {
   3.520899545265625*^9, 3.520899552515625*^9}, {3.520956048171875*^9, 
   3.520956049203125*^9}, 3.520957443984375*^9, {3.521140458546875*^9, 
   3.52114045903125*^9}, {3.521146843921875*^9, 3.5211468451875*^9}, {
   3.521226495468966*^9, 3.5212267343908415`*^9}, {3.5212272990470915`*^9, 
   3.521227301906466*^9}, {3.521234889484375*^9, 3.52123490115625*^9}, 
   3.5212349964375*^9, 3.521235089015625*^9, 3.521235880828125*^9, 
   3.521236001265625*^9, 3.52123740409375*^9, 3.521237684734375*^9, 
   3.52123825221875*^9, 3.521247508625*^9, 3.52124811696875*^9, 
   3.521248740078125*^9, {3.521251276515625*^9, 3.5212512769375*^9}, {
   3.521252125328125*^9, 3.521252129109375*^9}, {3.52125512903125*^9, 
   3.52125513334375*^9}, {3.52134227965625*^9, 3.521342302765625*^9}, {
   3.521350247328125*^9, 3.5213502586875*^9}, {3.521479285640625*^9, 
   3.521479481234375*^9}, {3.521510402328125*^9, 3.52151042*^9}, {
   3.52151067996875*^9, 3.521510685546875*^9}, {3.521510730328125*^9, 
   3.521510739578125*^9}, {3.521510958453125*^9, 3.521510961984375*^9}, {
   3.521571634296875*^9, 3.521571802671875*^9}, {3.521572707796875*^9, 
   3.521572848953125*^9}, {3.52166992121875*^9, 3.521670375828125*^9}, {
   3.521671400609375*^9, 3.521671468921875*^9}, {3.52167190478125*^9, 
   3.521671956046875*^9}, {3.521672654796875*^9, 3.521672663921875*^9}, {
   3.52167419490625*^9, 3.521674311921875*^9}, {3.521674723703125*^9, 
   3.52167473009375*^9}, {3.521698277296875*^9, 3.521698278296875*^9}, {
   3.52170295315625*^9, 3.521703048328125*^9}, {3.521734163609375*^9, 
   3.521734164296875*^9}, {3.5217404766875*^9, 3.521740477390625*^9}, {
   3.521757871828125*^9, 3.52175808225*^9}, {3.52175824334375*^9, 
   3.521758489984375*^9}, {3.5217585360625*^9, 3.52175861346875*^9}, {
   3.5217598483125*^9, 3.521759928390625*^9}, {3.52175996796875*^9, 
   3.52176025784375*^9}, {3.521760292078125*^9, 3.52176030628125*^9}, {
   3.5217651831875*^9, 3.521765221421875*^9}, {3.52176535990625*^9, 
   3.52176541146875*^9}, {3.52178529415625*^9, 3.521785357515625*^9}, {
   3.521787816203125*^9, 3.5217878181875*^9}, {3.521910257296875*^9, 
   3.521910279484375*^9}, {3.521910354734375*^9, 3.52191037071875*^9}, {
   3.521953189171875*^9, 3.5219535383125*^9}, {3.5219541266875*^9, 
   3.521954167859375*^9}, {3.522528068484375*^9, 3.52252807225*^9}, {
   3.533879884589926*^9, 3.5338799579256544`*^9}, {3.5391957298212233`*^9, 
   3.539195980472576*^9}, {3.5391960243210382`*^9, 3.5391960252110395`*^9}, {
   3.5394613785048385`*^9, 3.5394614644453897`*^9}, {3.539551377786018*^9, 
   3.5395513832616277`*^9}, {3.5395518179563913`*^9, 3.539551821497597*^9}, {
   3.5395518826029043`*^9, 3.539551883024105*^9}, {3.539552087680865*^9, 
   3.5395520916276717`*^9}, {3.5396160218156214`*^9, 
   3.5396160594740877`*^9}, {3.539616108785774*^9, 3.5396164138287096`*^9}, {
   3.5760901684770727`*^9, 3.576090494096444*^9}, {3.576090533470914*^9, 
   3.5760905336737137`*^9}, {3.576093700198476*^9, 3.5760938477747345`*^9}, {
   3.5766864493342285`*^9, 3.5766870372680607`*^9}, {3.5766870775317316`*^9, 
   3.576687119012204*^9}, {3.5837901145639615`*^9, 3.5837902223701277`*^9}, {
   3.606329333933484*^9, 3.606329375050616*^9}, {3.6064202232098227`*^9, 
   3.6064202685464163`*^9}, {3.6064204122876377`*^9, 3.606420456448163*^9}, {
   3.606491800762127*^9, 3.606491850775815*^9}, {3.606492069990939*^9, 
   3.606492143879165*^9}, {3.6064921763380213`*^9, 3.6064922572346487`*^9}, {
   3.6064923297627974`*^9, 3.6064923299818096`*^9}, {3.606492370603133*^9, 
   3.606492371219168*^9}, {3.6064961691193953`*^9, 3.6064961915836806`*^9}, {
   3.6064975285121484`*^9, 3.606497546217161*^9}, {3.6065035977871275`*^9, 
   3.606503646715926*^9}, {3.6065063001198483`*^9, 3.606506471837719*^9}, {
   3.606513240603368*^9, 3.6065132547171745`*^9}, {3.60651331827781*^9, 
   3.606513466271275*^9}, {3.6065743279396286`*^9, 3.6065743313716345`*^9}, {
   3.6065760454249916`*^9, 3.60657607740182*^9}, {3.6096134581867433`*^9, 
   3.6096134860795927`*^9}, {3.6096142872189994`*^9, 3.609614335438684*^9}, {
   3.6294774407514944`*^9, 3.6294774906015644`*^9}, {3.62947757779919*^9, 
   3.629477783009477*^9}, {3.629477825719537*^9, 3.6294778347395496`*^9}, {
   3.6294778894696264`*^9, 3.62947797075974*^9}, {3.6294780589298635`*^9, 
   3.6294780596998644`*^9}, {3.629478098129918*^9, 3.6294782395501165`*^9}, {
   3.6294782867201824`*^9, 3.6294783055702085`*^9}, {3.629478455970419*^9, 
   3.6294784946804733`*^9}, {3.6294785317405252`*^9, 
   3.6294785570705605`*^9}, {3.6294803157822976`*^9, 3.629480339682331*^9}, {
   3.6296556131724815`*^9, 3.629655647025541*^9}, {3.629655677321794*^9, 
   3.6296556859360094`*^9}, {3.629697278543481*^9, 3.6296973521750107`*^9}, {
   3.6296977113732457`*^9, 3.629697784256974*^9}, {3.6297631878993664`*^9, 
   3.629763353830789*^9}, {3.629763719443343*^9, 3.6297637226415515`*^9}, {
   3.6297637935867133`*^9, 3.6297638430924325`*^9}, {3.629908800590377*^9, 
   3.629908989442511*^9}, {3.6299090230303698`*^9, 3.6299090238727713`*^9}, {
   3.6299332867334347`*^9, 3.6299332984178553`*^9}, {3.629933337870325*^9, 
   3.6299333851852083`*^9}, {3.6299334939797993`*^9, 
   3.6299334981932344`*^9}, {3.6299337870972757`*^9, 3.629933817049328*^9}, {
   3.6299338759082317`*^9, 3.629933878092235*^9}, {3.629933931892765*^9, 
   3.6299339794572487`*^9}, {3.629934090482643*^9, 3.6299342367017*^9}, {
   3.629934623053544*^9, 3.6299346362843685`*^9}, {3.62993551990188*^9, 
   3.6299355229457855`*^9}, {3.629936340077901*^9, 3.629936349224618*^9}, {
   3.6299365172409315`*^9, 3.62993652603285*^9}, {3.630202947315394*^9, 
   3.630203367556756*^9}, {3.630203751880745*^9, 3.6302037621786633`*^9}, {
   3.6302037989592285`*^9, 3.6302038071511436`*^9}, {3.630203839939402*^9, 
   3.630203890589692*^9}, {3.6303300061366024`*^9, 3.6303300318160715`*^9}, {
   3.6313350528542*^9, 3.631335053316707*^9}, {3.6318275349354877`*^9, 
   3.631827553040766*^9}, {3.6318275856262665`*^9, 3.6318277499787908`*^9}, {
   3.6318277829867973`*^9, 3.6318277990995455`*^9}, {3.6336504306760654`*^9, 
   3.6336506572885036`*^9}, {3.6336506942095747`*^9, 3.633650742872664*^9}, {
   3.6695307810349817`*^9, 3.6695309718614273`*^9}, {3.669579900852109*^9, 
   3.669579987992093*^9}, {3.669593927721108*^9, 3.6695940267987747`*^9}, {
   3.669839259742984*^9, 3.6698393341535196`*^9}, {3.6698394017679768`*^9, 
   3.669839442740054*^9}, {3.6698395022010007`*^9, 3.669839584901169*^9}, {
   3.6698396272036543`*^9, 3.669839679443956*^9}, {3.6710431072367277`*^9, 
   3.671043118297151*^9}, {3.6710431498888187`*^9, 3.671043153553627*^9}, {
   3.671321209835158*^9, 3.6713212146263666`*^9}, {3.671321251505637*^9, 
   3.671321267605068*^9}, {3.6713213047075367`*^9, 3.6713215167665663`*^9}, {
   3.67132164255451*^9, 3.6713217972267942`*^9}, {3.671324219085931*^9, 
   3.6713242492063932`*^9}, {3.6713245181605263`*^9, 3.671324907624008*^9}, 
   3.671324939489498*^9, {3.671324991380295*^9, 3.6713253089556723`*^9}, {
   3.6713756135009017`*^9, 3.671375619057911*^9}, {3.6713785591619196`*^9, 
   3.6713785667319326`*^9}, {3.671378646154108*^9, 3.6713788076174326`*^9}, {
   3.671378838491488*^9, 3.6713788518695097`*^9}, {3.671379084930932*^9, 
   3.6713790858209333`*^9}, {3.671379127187009*^9, 3.6713792554652414`*^9}, {
   3.671379400923545*^9, 3.671379402155547*^9}, {3.671379932400988*^9, 
   3.6713800306761847`*^9}, {3.671380107286331*^9, 3.6713801909664917`*^9}, {
   3.6713802493786097`*^9, 3.671380250020611*^9}, {3.6713802836856785`*^9, 
   3.671380435580968*^9}, {3.671381462198265*^9, 3.671381596326538*^9}, {
   3.67138164114962*^9, 3.6713816915217047`*^9}, {3.6713817605058403`*^9, 
   3.6713817849498806`*^9}, {3.671381903904108*^9, 3.6713820498723845`*^9}, {
   3.671382330526928*^9, 3.671382455238199*^9}, {3.6713825475284204`*^9, 
   3.6713826901516657`*^9}, {3.6713827624247932`*^9, 3.671383287472781*^9}, {
   3.671383341952903*^9, 3.6713833426729035`*^9}, {3.671383465932156*^9, 
   3.6713834773151765`*^9}, {3.67138354438433*^9, 3.6713835486193385`*^9}, {
   3.6713835842934113`*^9, 3.6713838031758127`*^9}, {3.671383862480932*^9, 
   3.671384083316369*^9}, {3.6713841377440667`*^9, 3.6713842081652355`*^9}, {
   3.671384259494336*^9, 3.6713844022626233`*^9}, {3.671384453169711*^9, 
   3.6713844534697113`*^9}, {3.671685508951892*^9, 3.6716855171737137`*^9}, {
   3.6716855944723024`*^9, 3.6716856076637316`*^9}, {3.6716859391195593`*^9, 
   3.671686029694344*^9}, {3.671686382552693*^9, 3.671686383114294*^9}, {
   3.6717413407126837`*^9, 3.6717413443696995`*^9}, {3.6717414699141855`*^9, 
   3.6717414933582783`*^9}, {3.671758957994608*^9, 3.6717590364786587`*^9}, {
   3.671759288102297*^9, 3.671759350393615*^9}, {3.671759449814612*^9, 
   3.6717594847880793`*^9}, {3.6717597123332214`*^9, 
   3.6717597125747213`*^9}, {3.6717662550993176`*^9, 
   3.6717662561153193`*^9}, {3.671900578618348*^9, 3.6719006029244456`*^9}, {
   3.671911219158656*^9, 3.6719112271593733`*^9}, {3.6719732047373495`*^9, 
   3.6719732346119165`*^9}, {3.671995939819153*^9, 3.6719959692038336`*^9}, {
   3.6722324308385067`*^9, 3.672232432223528*^9}, {3.672232569303133*^9, 
   3.672232572420681*^9}, {3.7181157560094833`*^9, 3.71811575841288*^9}, {
   3.718115844428811*^9, 3.718115864426034*^9}, {3.7181167933141174`*^9, 
   3.7181168116070356`*^9}, {3.7181170257554364`*^9, 3.718117039062437*^9}, {
   3.7181170961555586`*^9, 3.7181171211734743`*^9}, {3.7181171936859355`*^9, 
   3.7181171958699427`*^9}, {3.7181172338467407`*^9, 
   3.7181172390306425`*^9}, {3.7181681299598155`*^9, 3.718168131758211*^9}, {
   3.7188730687248526`*^9, 3.7188730949039564`*^9}, {3.7188741572225513`*^9, 
   3.7188741657783065`*^9}, {3.7277847699803953`*^9, 3.7277848065097*^9}, {
   3.781003023198018*^9, 3.7810030235061936`*^9}, {3.7810053974795904`*^9, 
   3.7810053982555656`*^9}, {3.791378142378893*^9, 3.79137818122291*^9}, {
   3.8135320645573673`*^9, 3.8135320921455812`*^9}, {3.8135321504995637`*^9, 
   3.81353216517237*^9}, {3.827402803841505*^9, 3.827402830986506*^9}, {
   3.82740336161316*^9, 3.8274033709911184`*^9}, {3.8284102154268746`*^9, 
   3.828410237114087*^9}, {3.8284104093400855`*^9, 3.828410409445087*^9}, 
   3.829429371295764*^9, {3.829434082092366*^9, 3.8294341099600954`*^9}, {
   3.8303414108486323`*^9, 3.830341411843004*^9}, {3.8314399777494774`*^9, 
   3.831439978389352*^9}, {3.831677861439806*^9, 3.8316778674846497`*^9}, 
   3.8316779064507275`*^9, {3.8341795749993267`*^9, 3.834179603278328*^9}, {
   3.836476047095024*^9, 3.8364760475777674`*^9}, {3.838183480014862*^9, 
   3.838183480524811*^9}, {3.838185190645543*^9, 3.8381852474840517`*^9}, {
   3.8392944784803658`*^9, 3.839294491920397*^9}, {3.839295934562344*^9, 
   3.839295959324132*^9}, 3.8407642074910684`*^9, 3.8424027143268814`*^9, 
   3.842403126463729*^9, {3.843083629245039*^9, 3.8430836306061897`*^9}, {
   3.843083780668081*^9, 3.843083800594717*^9}, 3.8430838494114237`*^9, {
   3.8439529838744183`*^9, 3.8439529843587875`*^9}, {3.8477933711176815`*^9, 
   3.847793449080078*^9}, {3.8478361809076033`*^9, 3.847836205011715*^9}, {
   3.847838023514019*^9, 3.847838089737734*^9}, {3.847838423356592*^9, 
   3.8478384884747944`*^9}, {3.847846761343003*^9, 3.8478467871501265`*^9}, {
   3.847846822848173*^9, 3.847846845743091*^9}, {3.8478469372787867`*^9, 
   3.8478469662859483`*^9}, 3.8479656495691447`*^9, {3.8540779921374187`*^9, 
   3.854078023217332*^9}, 3.8540780536770935`*^9, {3.854079105572745*^9, 
   3.854079107168346*^9}, 3.8540797340128565`*^9, 3.8540819066255045`*^9, {
   3.8541585288325443`*^9, 3.8541585459082236`*^9}, 3.854158763837405*^9, {
   3.8594544786104035`*^9, 3.859454484034376*^9}, {3.8594548034330683`*^9, 
   3.8594548226893473`*^9}, {3.859455191721946*^9, 3.8594552192749624`*^9}, {
   3.8594559412494965`*^9, 3.859455944978319*^9}, {3.8594622985089865`*^9, 
   3.8594623070421057`*^9}, {3.8594643176741376`*^9, 
   3.8594643583559628`*^9}, {3.859464436819172*^9, 3.8594644371616907`*^9}, 
   3.8595025444506474`*^9, {3.859507514793906*^9, 3.8595075210340347`*^9}, {
   3.859507586694316*^9, 3.859507592414768*^9}, {3.8595123478607044`*^9, 
   3.859512358096125*^9}, 3.8596008312989244`*^9, 3.860671183954074*^9, {
   3.8611397658410015`*^9, 3.861139766161374*^9}, {3.861144358911488*^9, 
   3.8611443666816826`*^9}, {3.8611444657515326`*^9, 
   3.8611444661115932`*^9}, {3.8613321464734373`*^9, 3.8613321584010954`*^9}, 
   3.8625409920435157`*^9, 3.8657220040987463`*^9, {3.8667178694717054`*^9, 
   3.86671793412029*^9}, {3.867313669629397*^9, 3.867313678259658*^9}, {
   3.873420047206176*^9, 3.873420049187497*^9}, {3.8750943741005344`*^9, 
   3.8750944411844597`*^9}, {3.8847704900019555`*^9, 3.884770516344298*^9}, {
   3.884771523316414*^9, 3.8847715321154785`*^9}, {3.8847715732632475`*^9, 
   3.88477159990942*^9}, {3.8847727177085032`*^9, 3.8847727440036807`*^9}, {
   3.885375448199168*^9, 3.885375448794793*^9}, {3.885382694200553*^9, 
   3.8853827056085205`*^9}, {3.885422755083685*^9, 3.8854227917193413`*^9}, {
   3.8865697257520494`*^9, 3.88656973210915*^9}, {3.8865697631409874`*^9, 
   3.886569826515701*^9}, {3.88657070498269*^9, 3.886570725482691*^9}, {
   3.88673471013857*^9, 3.886734730930822*^9}, {3.886738228674123*^9, 
   3.886738406465705*^9}, 3.8867400912902613`*^9, {3.887112096796203*^9, 
   3.8871121140007734`*^9}, {3.889052409668887*^9, 3.8890524527003555`*^9}, {
   3.890181833690528*^9, 3.8901818673836265`*^9}, {3.8901899618764563`*^9, 
   3.8901899674696894`*^9}, {3.8915730985639453`*^9, 3.891573098973691*^9}, {
   3.8915734065666995`*^9, 3.891573408291646*^9}, {3.891574012321288*^9, 
   3.891574014824758*^9}, 3.8915740513632116`*^9, 3.891579741883506*^9, 
   3.8915801783582296`*^9, 3.8915871526433063`*^9, {3.893153485880587*^9, 
   3.893153506266393*^9}, 3.8947759518829365`*^9, {3.8947763291669407`*^9, 
   3.894776340033222*^9}, {3.8955450682755203`*^9, 3.8955450932365265`*^9}, 
   3.895549065613738*^9, {3.8987253764800773`*^9, 3.8987253776141005`*^9}, {
   3.955680711173623*^9, 3.955680711174163*^9}, {3.956199042418846*^9, 
   3.956199042421667*^9}},ExpressionUUID->"51d6a053-8ea8-4cc2-8ca7-\
ea9976cc4174"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Start Private here", "Section",
 CellChangeTimes->{{3.52030335396875*^9, 3.52030336065625*^9}, {
  3.520440577734375*^9, 
  3.52044059371875*^9}},ExpressionUUID->"72db2963-df8b-47c5-afb6-\
fc5119094b1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.52030330771875*^9}},ExpressionUUID->"918b4003-dc65-445a-bb4c-\
a29a22fcd1b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Internal Programming Tools", "Section",
 CellChangeTimes->{{3.520303364296875*^9, 
  3.52030337496875*^9}},ExpressionUUID->"a50d09e8-2ca3-4c82-8198-\
485591f2ec8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "check", " ", "if", " ", "\[Mu]", " ", "is", " ", "an", " ", "index"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TestIndices", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]", ",", 
        RowBox[{"SuperMinus", "[", "_Integer", "]"}]}], "]"}], "||", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]", ",", 
        RowBox[{"SuperMinus", "[", "_Symbol", "]"}]}], "]"}], "||", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]", ",", 
        RowBox[{"SubMinus", "[", "_Integer", "]"}]}], "]"}], "||", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]", ",", 
        RowBox[{"SubMinus", "[", "_Symbol", "]"}]}], "]"}]}]}], ";"}], "*)"}],
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"TestIndices", " ", "with", " ", "OverHat"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TestIndices", "::", "TestIndicesFalse"}], "=", 
     "\"\<The index `1` isn't in a proper form.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TestIndices", "[", "\[Mu]_", "]"}], ":=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"\[Mu]", ",", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_Integer", "]"}], "|", 
            RowBox[{"SuperMinus", "[", "_Symbol", "]"}], "|", 
            RowBox[{"SubMinus", "[", "_Integer", "]"}], "|", 
            RowBox[{"SubMinus", "[", "_Symbol", "]"}], "|", 
            RowBox[{"SuperMinus", "[", 
             RowBox[{"OverHat", "[", "_Integer", "]"}], "]"}], "|", 
            RowBox[{"SuperMinus", "[", 
             RowBox[{"OverHat", "[", "_Symbol", "]"}], "]"}], "|", 
            RowBox[{"SubMinus", "[", 
             RowBox[{"OverHat", "[", "_Integer", "]"}], "]"}], "|", 
            RowBox[{"SubMinus", "[", 
             RowBox[{"OverHat", "[", "_Symbol", "]"}], "]"}]}]}], "]"}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestIndices", "::", "TestIndicesFalse"}], ",", "\[Mu]"}], 
          "]"}], ";", "False"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestIndices", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{"\[Mu]", ",", 
       RowBox[{
        RowBox[{"SuperMinus", "[", "_Integer", "]"}], "|", 
        RowBox[{"SuperMinus", "[", "_Symbol", "]"}], "|", 
        RowBox[{"SubMinus", "[", "_Integer", "]"}], "|", 
        RowBox[{"SubMinus", "[", "_Symbol", "]"}], "|", 
        RowBox[{"SuperMinus", "[", 
         RowBox[{"OverHat", "[", "_Integer", "]"}], "]"}], "|", 
        RowBox[{"SuperMinus", "[", 
         RowBox[{"OverHat", "[", "_Symbol", "]"}], "]"}], "|", 
        RowBox[{"SubMinus", "[", 
         RowBox[{"OverHat", "[", "_Integer", "]"}], "]"}], "|", 
        RowBox[{"SubMinus", "[", 
         RowBox[{"OverHat", "[", "_Symbol", "]"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Mu]", "-"], " ", "gives"}], " ", "+", 
     RowBox[{"1", " ", "and", " ", 
      SubscriptBox["\[Mu]", "-"], " ", "gives"}], " ", "-", "1"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Sgn", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"upper", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], ",", "1", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"lower", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], ";"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     SuperscriptBox["\[Mu]", "-"], " ", "or", " ", 
     SubscriptBox["\[Mu]", "-"], " ", "returns", " ", "\[Mu]"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IndexNumber", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{
      RowBox[{"\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
       "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      SuperscriptBox["\[Mu]", "-"], " ", "returns", " ", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "Null"}], "}"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "upper"}], " ", "index"}]}], " ", 
    "*)"}], "\n", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Mu]", "-"], " ", "returns", " ", 
      RowBox[{"Column", "[", 
       RowBox[{"{", 
        RowBox[{"Null", ",", "\[Mu]"}], "}"}], "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"i", ".", "e", ".", " ", "lower"}], " ", "index"}]}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"UpOrDown", "[", "\[Mu]_", "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"lower", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{"Null", ",", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"upper", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Mu]", ",", 
         RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], ",", 
       RowBox[{"Column", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          ",", "Null"}], "}"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"ReplaceIndex", ":", " ", 
      RowBox[{"takes", " ", "in", " ", "\[Nu]", " ", "and", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["\[Mu]", "-"], " ", "or", " ", 
         SubscriptBox["\[Mu]", "-"]}], ")"}]}]}], ",", " ", 
     RowBox[{"and", " ", "returns", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["\[Nu]", "-"], " ", "or", " ", 
        SubscriptBox["\[Nu]", "-"]}], ")"}]}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"ReplaceIndex", "[", 
       RowBox[{
        RowBox[{"\[Nu]_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "\[Nu]", "]"}], "===", "Symbol"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "\[Nu]", "]"}], "===", "Integer"}], ")"}]}],
           ")"}]}], ",", 
        RowBox[{"\[Mu]_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], "]"}], ":=", 
      RowBox[{"Which", "[", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"upper", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], ",", 
        RowBox[{"SuperMinus", "[", "\[Nu]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"lower", " ", "index"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], ",", 
        RowBox[{"SubMinus", "[", "\[Nu]", "]"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ReplaceIndex"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{
       RowBox[{"\[Nu]_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "\[Nu]", "]"}], "===", "Symbol"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "\[Nu]", "]"}], "===", "Integer"}], ")"}]}], 
         ")"}]}], ",", 
       RowBox[{"\[Mu]_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], "]"}], ":=", 
     RowBox[{"\[Nu]", "//", 
      RowBox[{
      "\[Mu]", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ReplaceIndex"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplaceIndex", "[", 
      RowBox[{
       RowBox[{"\[Nu]_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]", "]"}]}], ",", 
       RowBox[{"\[Mu]_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "\[Nu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "//", 
       RowBox[{
       "\[Mu]", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
      ")"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"returns", " ", 
      SuperscriptBox["#", "-"], " ", "or", " ", 
      SubscriptBox["#", "-"], " ", "given", " ", "coordinates", " ", "cooo", 
      " ", "and", " ", "StartIndex", " ", "st"}], ",", " ", 
     RowBox[{
     "where", " ", "#", " ", "is", " ", "the", " ", "appropriate", " ", 
      "index", " ", "number"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "if", " ", "the", " ", "\[Mu]I", " ", "is", " ", "just", " ", "a", " ", 
      "Symbol", " ", 
      RowBox[{"w", "/", "o"}], " ", "any", " ", "other", " ", "meaning"}], 
     ",", " ", 
     RowBox[{"it", " ", "will", " ", "be", " ", "returned", " ", "as", " ", 
      RowBox[{"is", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NumericIndex", "[", 
      RowBox[{
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", "cooo_List", ",", 
       "st_"}], "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"if", " ", 
        RowBox[{"it", "'"}], "s", " ", "already", " ", "an", " ", "Integer", 
        " ", "then", " ", "just", " ", "return", " ", "itself"}], " ", "*)"}],
       "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{
         "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], "===", "Integer"}], ",", "\[Mu]I", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "if", " ", "it", " ", "is", " ", "one", " ", "of", " ", "the", " ", 
         "coordinates", " ", "return", " ", "the", " ", "Position"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "}"}], ",", "cooo"}], "]"}], "===", 
        RowBox[{"{", 
         RowBox[{
         "\[Mu]I", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "}"}]}], ",", "\[IndentingNewLine]", "\t", 
       RowBox[{"ReplaceIndex", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"cooo", ",", 
                RowBox[{
                "\[Mu]I", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], "]"}], "]"}], ")"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", "1", 
           "+", "st"}], ")"}], ",", "\[Mu]I"}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "if", " ", "neither", " ", "then", " ", "just", " ", "return", " ", 
         "original", " ", "stuff"}], " ", "*)"}], "\[IndentingNewLine]", 
       "True", ",", "\[Mu]I"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"RaiseLower", "[", 
      RowBox[{"\[Mu]", ",", "\[Nu]", ",", "\[Tau]"}], "]"}], " ", "gives", 
     " ", "KroneckerDelta", " ", "if", " ", "\[Mu]", " ", "and", " ", "\[Nu]",
      " ", "have", " ", "the", " ", "same", " ", "Sgn", " ", "and", " ", 
     "otherwise", " ", 
     RowBox[{"g", "^", 
      RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", "or", " ", "g_", 
     RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "right", " ", "index", " ", "is", " ", "the", " ", "index", " ", "on", 
     " ", "the", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "left", " ", "index", " ", "is", " ", "what", " ", "we", " ", "want"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "if", " ", "they", " ", "are", " ", "both", " ", "upper", " ", "or", " ",
       "lower"}], ",", " ", 
     RowBox[{
     "then", " ", "we", " ", "need", " ", "to", " ", "return", " ", 
      "\[Delta]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"if", " ", "ud"}], ",", " ", 
     RowBox[{"then", " ", "return", " ", 
      RowBox[{"g", "^", 
       RowBox[{"{", 
        RowBox[{"-", "1"}], "}"}]}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"if", " ", "du"}], ",", " ", 
     RowBox[{"then", " ", "return", " ", "g"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"RaiseLower", "[", 
       RowBox[{
        RowBox[{"\[Mu]_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]", "]"}]}], ",", 
        RowBox[{"\[Nu]_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]", "]"}]}], ",", "\[Tau]_Tensor"}],
        "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", "\[Tau]", "]"}], "===", 
          RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
              RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SubMinus", "[", "_", "]"}], ",", 
              RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
         ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"si", ",", "MetricM"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"read", " ", "in", " ", "the", " ", "metric"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"MetricM", "=", 
         RowBox[{"TensorComponents", "[", "\[Tau]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"same", " ", "sign"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "\[Mu]", "]"}], 
            RowBox[{"Sgn", "[", "\[Nu]", "]"}]}], "===", "1"}], ",", 
          "\[IndentingNewLine]", "\t", 
          RowBox[{"KroneckerDelta", "[", 
           RowBox[{
            RowBox[{"IndexNumber", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"IndexNumber", "[", "\[Nu]", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"\[Mu]", " ", "positive"}], ",", " ", 
            RowBox[{"\[Nu]", " ", "negative"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"g", "^", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", " ", "\[Nu]"}], "}"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"extract", " ", "inverse", " ", "metric"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Mu]", "]"}], "===", "1"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Nu]", "]"}], "===", 
             RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"inverse", " ", "metric"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", "\t\t", "MetricM", ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"(*", " ", "metric", " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SubMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Inverse", "[", "MetricM", "]"}]}], 
            "\[IndentingNewLine]", "\t", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Mu]", "]"}], "-", "si", "+", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Nu]", "]"}], "-", "si", "+", 
             "1"}]}], "\[RightDoubleBracket]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"\[Mu]", " ", "negative"}], ",", " ", 
            RowBox[{"\[Nu]", " ", "positive"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"g_", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", " ", "\[Nu]"}], "}"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"extract", " ", "metric"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Mu]", "]"}], "\[Equal]", 
             RowBox[{"-", "1"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Nu]", "]"}], "\[Equal]", "1"}], ")"}]}], 
          ",", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{"(*", " ", 
             RowBox[{"inverse", " ", "metric"}], " ", "*)"}], 
            "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",",
              "\[IndentingNewLine]", "\t\t", 
             RowBox[{"Inverse", "[", "MetricM", "]"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{"(*", " ", "metric", " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"IndicesNoPart", "[", "\[Tau]", "]"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"SubMinus", "[", "_", "]"}], ",", 
                 RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
             "\[IndentingNewLine]", "\t\t", "MetricM"}], 
            "\[IndentingNewLine]", "\t", "]"}], "\[LeftDoubleBracket]", 
           RowBox[{
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Mu]", "]"}], "-", "si", "+", 
             "1"}], ",", 
            RowBox[{
             RowBox[{"IndexNumber", "[", "\[Nu]", "]"}], "-", "si", "+", 
             "1"}]}], "\[RightDoubleBracket]"}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TestQuadratic", " ", "checks", " ", "that", " ", "the", " ", "metric", 
     " ", "expression"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "is", " ", "quadratic", " ", "in", " ", "the", " ", "differentials", " ", 
     "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestQuadratic"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestQuadratic", "::", "TestQuadraticFalse"}], "=", 
     "\"\<The expression form of metric `1` isn't quadratic or consistent \
with metric's indices.\>\""}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestQuadratic", "[", 
      RowBox[{"ss_", ",", "cc_List", ",", 
       RowBox[{"judge_Integer", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"judge", "===", "1"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"judge", "===", 
            RowBox[{"-", "1"}]}], ")"}]}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dx", ",", "delx", ",", "newss", ",", "\[Epsilon]", ",", 
         "\[Epsilon]2", ",", "out"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"introduce", " ", "power", " ", "counting", " ", "rule"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dx", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[DifferentialD]", "#"}], "\[Rule]", 
              RowBox[{"\[Epsilon]", " ", 
               RowBox[{"\[DifferentialD]", "#"}]}]}], ")"}], "&"}], " ", "/@",
            "cc"}], ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delx", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Del]", "#"}], "\[Rule]", 
              RowBox[{"\[Epsilon]2", " ", 
               RowBox[{"\[Del]", "#"}]}]}], ")"}], "&"}], " ", "/@", "cc"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newss", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ss", "/.", "dx"}], ")"}], "/.", "delx"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"judge", "===", 
            RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"newss", ",", "\[Epsilon]"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"ss", " ", "\[Epsilon]"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]", ">", "0"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"out", "===", "2"}], ")"}], ",", "True", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"TestQuadratic", "::", "TestQuadraticFalse"}], ",", 
                "ss"}], "]"}], ";", "False"}]}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{"judge", "===", 
            RowBox[{"+", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"out", "=", 
            RowBox[{"FullSimplify", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{"newss", ",", "\[Epsilon]2"}], "]"}], "/", 
               RowBox[{"(", 
                RowBox[{"ss", " ", "\[Epsilon]2"}], ")"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Epsilon]2", ">", "0"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"out", "===", "2"}], ")"}], ",", "True", ",", 
             RowBox[{
              RowBox[{"Message", "[", 
               RowBox[{
                RowBox[{"TestQuadratic", "::", "TestQuadraticFalse"}], ",", 
                "ss"}], "]"}], ";", "False"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestQuadraticInverse"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TestQuadraticInverse", "::", "TestQuadraticInverseFalse"}], 
      "=", 
      "\"\<The expression form of inverse metric `1` isn't quadratic.\>\""}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TestQuadraticInverse", "[", 
       RowBox[{"ss_", ",", "cc_List"}], "]"}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"delx", ",", "\[Epsilon]", ",", "out"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"introduce", " ", "power", " ", "counting", " ", "rule"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"delx", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[Del]", "#"}], "\[Rule]", 
               RowBox[{"\[Epsilon]", " ", 
                RowBox[{"\[Del]", "#"}]}]}], ")"}], "&"}], " ", "/@", "cc"}], 
           ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"out", "=", 
          RowBox[{"FullSimplify", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"ss", "/.", "delx"}], ")"}], ",", "\[Epsilon]"}], 
              "]"}], "/", 
             RowBox[{"(", 
              RowBox[{"ss", " ", "\[Epsilon]"}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Epsilon]", ">", "0"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"out", "===", "2"}], ")"}], ",", "True", ",", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{
              "TestQuadraticInverse", "::", "TestQuadraticInverseFalse"}], 
              ",", "ss"}], "]"}], ";", "False"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TestMetricTensor", " ", "checks", " ", "that", " ", "m", " ", "is", " ", 
     "a", " ", "Tensor", " ", "of", " ", "the", " ", "type", " ", "Metric"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMetricTensor", "::", "TestMetricTensorFalse"}], "=", 
     "\"\<The tensor `1` isn't a metric tensor.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestMetricTensor", "[", "m_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tt", "}"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TensorTypeNoPart", "[", "m", "]"}], "===", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], ",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestMetricTensor", "::", "TestMetricTensorFalse"}], ",", 
            "m"}], "]"}], ";", "False"}]}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "CollectRepeatedIndices", " ", "takes", " ", "in", " ", "two", " ", "or", 
     " ", "more", " ", "Lists", " ", "of", " ", "Indices", " ", "and", " ", 
     "returns", " ", "all", " ", "repeated", " ", "ones"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CollectRepeatedIndices", "[", "ll__List", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"TestIndices", "/@", 
          RowBox[{"Join", "[", "ll", "]"}]}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], ")"}]}], ":=", 
     RowBox[{"Cases", "[", 
      RowBox[{
       RowBox[{"Split", "[", 
        RowBox[{"Sort", "[", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", 
           RowBox[{"Join", "[", "ll", "]"}]}], ")"}], "]"}], "]"}], ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"ss_Symbol", ",", "ss_Symbol"}], "}"}], "\[Rule]", "ss"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "NotAbstractIndex", " ", "takes", " ", "in", " ", "an", " ", "index", 
      " ", "\[Mu]"}], ",", " ", 
     RowBox[{"a", " ", "List", " ", "of", " ", "coordinates", " ", "cooo"}], 
     ",", " ", 
     RowBox[{"and", " ", "start", " ", "index", " ", "si"}], ",", " ", 
     RowBox[{
     "and", " ", "returns", " ", "True", " ", "if", " ", "the", " ", "index", 
      " ", "is", " ", "not", " ", "abstract", " ", "and", " ", "False", " ", 
      "otherwise"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "start", " ", "index", " ", "is", " ", "needed", " ", "because", " ", 
      "sometimes", " ", "the", " ", "Index", " ", "is", " ", "given", " ", 
      "as", " ", "an", " ", 
      SuperscriptBox["Integer", "-"], " ", "or", " ", 
      SubscriptBox["Integer", "-"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "The", " ", "index", " ", "can", " ", "be", " ", "UnderBarred", " ", "or",
      " ", "not"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NotAbstractIndex", "[", 
      RowBox[{"\[Mu]_", ",", "cooo_List", ",", "si_Integer"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestIndices", "[", "\[Mu]", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"NumericIndex", "[", 
                 RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}],
               ",", 
              RowBox[{"Range", "[", 
               RowBox[{"si", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", 
                 "1"}]}], "]"}]}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"\[Mu]", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}]}],
            ")"}], "||", 
          RowBox[{"NumericQ", "[", 
           RowBox[{
           "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "]"}]}], ")"}]}], ")"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "TestScalarTensor", " ", "reads", " ", "in", " ", "a", " ", "Tensor", " ",
      "and", " ", "determines", " ", "whether", " ", "it", " ", "is", " ", 
     "a", " ", "scalar", " ", "by", " ", "checking"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"(", "1", ")"}], " ", "If", " ", "Indices", " ", "are", " ", 
     "empty", " ", 
     RowBox[{"{", "}"}], " ", 
     RowBox[{"(", "2", ")"}], " ", "if", " ", "all", " ", "Indices", " ", 
     "are", " ", "UnderBarred"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "returns", " ", "True", " ", "if", " ", "Tensor", " ", "is", " ", 
     "scalar", " ", "and", " ", "False", " ", "otherwise"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "[", "m_Tensor", "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Indices", "[", "m", "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], "||", 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"Indices", "[", "m", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
           RowBox[{"UnderBar", "[", "_", "]"}], "]"}], ".."}], "}"}]}], 
       "]"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "[", 
      RowBox[{"m_", "/;", 
       RowBox[{"TestExpressionForm", "[", "m", "]"}]}], "]"}], ":=", 
     "False"}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestScalarTensor", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"m_Times", "|", "m_Plus"}], ")"}], "/;", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", " ", "idx_"}], ")"}], "\[Rule]", 
            " ", "idx"}], ",", "Infinity"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"{", "}"}], "}"}]}], ")"}], ",", "True", ",", "True", ",", 
       "False"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestTensorTensor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestTensorTensor", "[", "t_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"(", "t", ")"}], "}"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"idx_", "/;", 
                   RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
               " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], "]"}], 
          "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "RemoveUnderBarredIndices", " ", "remove", " ", "all", " ", "UnderBarred",
      " ", "Indices"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"xx1", ",", "xx2"}], "}"}], ",", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"\[Mu]T", ",", 
         RowBox[{
          RowBox[{"SuperMinus", "[", 
           RowBox[{"UnderBar", "[", "xx1_", "]"}], "]"}], "|", 
          RowBox[{"SubMinus", "[", 
           RowBox[{"UnderBar", "[", "xx2_", "]"}], "]"}]}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"RemoveUnderBarredIndices", " ", "for", " ", "Tensor"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveUnderBarredIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Indices", "[", 
      RowBox[{"t", ",", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "RemoveRepeatedUnderBarredIndices", " ", "remove", " ", "all", " ", 
     "repeated", " ", "UnderBarred", " ", "Indices"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveRepeatedUnderBarredIndices", "[", "\[Mu]T_List", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "i1", ",", "i2", ",", "i3"}], "}"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Mu]T", "//.", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"i1___", ",", 
             RowBox[{"SuperMinus", "[", 
              RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i2___", 
             ",", 
             RowBox[{"SubMinus", "[", 
              RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i3___"}],
             "}"}], "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}]}]}], ")"}], "//.", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i1___", ",", 
           RowBox[{"SubMinus", "[", 
            RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i2___", 
           ",", 
           RowBox[{"SuperMinus", "[", 
            RowBox[{"UnderBar", "[", "\[Mu]_", "]"}], "]"}], ",", "i3___"}], 
          "}"}], "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"i1", ",", "i2", ",", "i3"}], "}"}]}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "RemoveRepeatedUnderBarredIndices", " ", "for", " ", "Tensor"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RemoveRepeatedUnderBarredIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Indices", "[", 
      RowBox[{"t", ",", 
       RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "NestedDel", " ", "takes", " ", "in", " ", "an", " ", "express", " ", 
     "of", " ", "the", " ", "form", " ", 
     RowBox[{"Del", "[", 
      RowBox[{"...", 
       RowBox[{"Del", "[", "stuff", "]"}]}], "]"}], " ", "and", " ", 
     "returns", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"#", " ", "of", " ", "Dels"}], ",", " ", "stuff"}], "}"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "By", " ", "stuff", " ", "we", " ", "simply", " ", "mean", " ", "the", 
      " ", "remainder", " ", "after", " ", "the", " ", "outer", " ", "most", 
      " ", 
      RowBox[{"Del", "'"}], "s", " ", "are", " ", "peeled", " ", "away"}], 
     ";", " ", 
     RowBox[{"there", " ", "could", " ", "still", " ", "be", " ", 
      RowBox[{"Del", "'"}], "s", " ", "hidden", " ", "in", " ", "output"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NestedDel", "[", "dd_Del", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"stuff", ",", "idx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stuff", "=", "dd"}], ";", 
        RowBox[{"idx", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "stuff", "]"}], "===", "Del"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"strip", " ", "off", " ", "outer", " ", "most", " ", 
            RowBox[{"Del", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"stuff", "=", 
            RowBox[{
            "stuff", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
            ";", 
           RowBox[{"idx", "=", 
            RowBox[{"idx", "+", "1"}]}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"idx", ",", "stuff"}], "}"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "FormatTensorName", " ", "formats", " ", "the", " ", "TensorName", " ", 
     "of", " ", "a", " ", "Tensor", " ", "object"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"FormatTensorName", "[", "name_", "]"}], ":=", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Head", "[", "name", "]"}], ",", 
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"If", " ", "it", " ", "is", " ", "a", " ", 
            RowBox[{
             RowBox[{"TensorProduct", "/", "CovariantD"}], "/", "Times"}], 
            " ", "we", " ", "put", " ", "a", " ", "parenthesis", " ", 
            "around", " ", "it"}], " ", "*)"}], 
          RowBox[{"TensorProduct", "|", "Del", "|", "Times", "|", "Row"}], 
          ")"}]}], "]"}], ",", 
       RowBox[{"MatrixForm", "[", 
        RowBox[{"{", "name", "}"}], "]"}], ",", "\[IndentingNewLine]", "True",
        ",", "name"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     StyleBox[
      RowBox[{"Internal", " ", "Function"}],
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[":",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["RankNumber",
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"You", " ", "can", " ", "input", " ", "as", " ", "a", " ", 
     StyleBox["Tensor",
      FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
     StyleBox["list",
      FontColor->RGBColor[1, 0, 1]], " ", 
     RowBox[{
      RowBox[{"(", "CoordinateSystem", ")"}], ".", " ", "The"}], " ", 
     "output", " ", "will", " ", "be", " ", "the", " ", "rank", " ", "of", 
     " ", 
     RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"RemoveUnderBarredIndices", "[", 
       RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "[", "\[Mu]_List", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]", "]"}], "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"RankNumber", "[", 
      RowBox[{"expr_", "/;", 
       RowBox[{"TestExpressionForm", "[", "expr", "]"}]}], "]"}], ":=", "0"}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "CoordinatesDimension"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinatesDimension", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"Coordinates", "[", "t", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ComponentRankNumber"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ComponentRankNumber", "[", "t_Tensor", "]"}], "/;", 
      RowBox[{"!", 
       RowBox[{"TestExpressionForm", "[", 
        RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}]}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", 
       RowBox[{"TensorComponents", "[", "t", "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ComponentRankNumber", "[", "t_Tensor", "]"}], "/;", 
      RowBox[{"TestExpressionForm", "[", 
       RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ":=", "0"}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComponentRankNumber", "[", "\[Mu]_List", "]"}], ":=", 
     RowBox[{"Length", "[", 
      RowBox[{"Dimensions", "[", "\[Mu]", "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ComponentRankNumber", "[", 
      RowBox[{"\[Mu]_", "/;", 
       RowBox[{"TestExpressionForm", "[", "\[Mu]", "]"}]}], "]"}], ":=", 
     "0"}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Internal", " ", "Function"}], ":", " ", 
     "TooltipDisplayCheckwithComponents"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "function", " ", "is", " ", "to", " ", "check", " ", "if", 
      " ", "the", " ", "TooltipDisplay", " ", "coincide", " ", 
      RowBox[{"w", "/", " ", 
       RowBox[{"TensorComponents", ".", " ", "We"}]}], " ", "can", " ", 
      "input", " ", "with", " ", "a", " ", "Tensor"}], ",", " ", 
     RowBox[{"or", " ", "two", " ", "lists", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
        "Tooltipdisplay", " ", "List", " ", "and", " ", "TensorComponents"}], 
        ")"}], "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Now", ",", " ", 
     RowBox[{"this", " ", "is", " ", "only", " ", "for", " ", 
      RowBox[{"Christoffel", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TooltipDisplayCheckwithComponents", "[", 
       RowBox[{"disp_List", ",", "cps_List"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lgth", ",", "toollist", ",", "complist"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toollist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "&"}], "/@", 
           RowBox[{"Flatten", "[", "disp", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"complist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", "cps", "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "=!=", "0"}], ")"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"toollist", "=", 
          RowBox[{"Sort", "[", "toollist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"complist", "=", 
          RowBox[{"Sort", "[", "complist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"complist", "===", "toollist"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"MoveIndicesDoNotInvolveOverHatQ", "[", 
       RowBox[{"tt_Tensor", ",", "idx_List"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Indices", "[", "tt", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"SubMinus", "[", 
              RowBox[{"OverHat", "[", "_", "]"}], "]"}], "|", 
             RowBox[{"SuperMinus", "[", 
              RowBox[{"OverHat", "[", "_", "]"}], "]"}]}], ")"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"idx", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"SubMinus", "[", 
              RowBox[{"OverHat", "[", "_", "]"}], "]"}], "|", 
             RowBox[{"SuperMinus", "[", 
              RowBox[{"OverHat", "[", "_", "]"}], "]"}]}], ")"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    RowBox[{
     RowBox[{"TestMoveOnlyOneType", "[", 
      RowBox[{"tt_Tensor", ",", "idx_List"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"{", "}"}]}], ",", "i", ",", "ttidx"}], "}"}], ",", 
       RowBox[{
        RowBox[{"ttidx", "=", 
         RowBox[{"Indices", "[", "tt", "]"}]}], ";", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", 
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "]"}], "=!=", 
             RowBox[{"Head", "[", 
              RowBox[{
              "ttidx", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
               "]"}]}], ",", 
            RowBox[{"list", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"list", ",", 
               RowBox[{"Head", "[", 
                RowBox[{"idx", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], 
              "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"Dimensions", "[", "idx", "]"}]}]}], "}"}]}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"Union", "[", "list", "]"}], "]"}], "===", 
          RowBox[{"{", "1", "}"}]}], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", "list", "]"}], "/.", 
             RowBox[{"{", 
              RowBox[{"Integer", "\[Rule]", " ", "Nothing"}], "}"}]}], ")"}], 
           "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"{", "0", "}"}], "|", 
            RowBox[{"{", "1", "}"}]}], ")"}]}], "]"}]}]}], "]"}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    RowBox[{"OverHatSgn", "[", "\[Mu]_", "]"}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ")"}], "===", "Symbol"}], ")"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ")"}], "===", "OverHat"}], ")"}], ",", "1", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Head", "[", 
          RowBox[{
          "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], ")"}], "===", "Integer"}], ")"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "Start"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TooltipDisplayCheckwithComponents", "[", "t_Tensor", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"lgth", ",", "toollist", ",", "complist"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", "the", " ", "TooltipDisplay"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"toollist", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]",
               "td"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"The", " ", "number", " ", "of", " ", "non"}], "-", 
           RowBox[{
           "zero", " ", "components", " ", "in", " ", "TooltipDisplay"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "toollist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Extract", " ", "every", " ", "rhs", " ", "of", " ", "the", " ", 
           RowBox[{"rules", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"toollist", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "toollist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Extract", " ", "the", " ", "non"}], "-", 
           RowBox[{
           "zero", " ", "components", " ", "in", " ", "TensorComponents"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"complist", "=", 
          RowBox[{"Select", "[", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"t", "//", "TensorComponents"}], "]"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "=!=", "0"}], ")"}], "&"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Sometimes", ",", " ", 
           RowBox[{"the", " ", "order", " ", "will", " ", "be", " ", 
            RowBox[{"different", ".", " ", "We"}], " ", "should", " ", "sort",
             " ", "them", " ", "before", " ", "match", " ", 
            RowBox[{"them", "."}]}]}], "*)"}], 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"For", " ", "example"}], ",", " ", 
           RowBox[{
           "the", " ", "order", " ", "will", " ", "be", " ", "different", " ",
             "for", " ", "a", " ", "Christoffel", " ", "Symbols", " ", 
            "after", " ", "coordinate", " ", 
            RowBox[{"transformation", "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"toollist", "=", 
          RowBox[{"Sort", "[", "toollist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"complist", "=", 
          RowBox[{"Sort", "[", "complist", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"complist", "===", "toollist"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "End"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "Start"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"AddCurlyBrackets", "[", "idx_List", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"break", ",", "lgth", ",", "output"}], "}"}], ",", 
        RowBox[{
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "idx", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
                  RowBox[{"UnderBar", "[", "_", "]"}], "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"output", "=", 
                RowBox[{"Insert", "[", 
                 RowBox[{"idx", ",", 
                  RowBox[{
                   RowBox[{"UnderBar", "[", "\"\<{\>\"", "]"}], "//", 
                   RowBox[{"idx", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "0"}], "\[RightDoubleBracket]"}]}], ",",
                   "i"}], "]"}]}], ";", 
               RowBox[{"break", "=", "True"}]}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"break", "===", "True"}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "lgth"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"break", "=", "False"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"MatchQ", "[", 
                RowBox[{
                 RowBox[{"output", "\[LeftDoubleBracket]", 
                  RowBox[{"lgth", "+", "2", "-", "i"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
                  RowBox[{"UnderBar", "[", "_", "]"}], "]"}]}], "]"}]}], ",", 
              RowBox[{
               RowBox[{"output", "=", 
                RowBox[{"Insert", "[", 
                 RowBox[{"output", ",", 
                  RowBox[{
                   RowBox[{"UnderBar", "[", "\"\<}\>\"", "]"}], "//", 
                   RowBox[{"output", "\[LeftDoubleBracket]", 
                    RowBox[{
                    RowBox[{"lgth", "+", "2", "-", "i"}], ",", "0"}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"lgth", "+", "3", "-", "i"}]}], "]"}]}], ";", 
               RowBox[{"break", "=", "True"}]}]}], "]"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"break", "===", "True"}], ",", 
              RowBox[{"Break", "[", "]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"lgth", "+", "1"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", "]"}]}], 
     ";"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "End"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "NonZeroTensorComponents"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    RowBox[{
     RowBox[{"NonZeroTensorComponents", "[", 
      RowBox[{
      "name_", ",", "\[IndentingNewLine]", "\[Mu]T_List", ",", 
       "\[IndentingNewLine]", 
       StyleBox["ttM_", "Code"], 
       StyleBox[",", "Code"], 
       StyleBox["\[IndentingNewLine]", "Code"], 
       StyleBox["coords_List", "Code"]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"collist", "=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"rank", "=", 
          RowBox[{"RankNumber", "[", "\[Mu]T", "]"}]}], ",", 
         RowBox[{"dim", "=", 
          RowBox[{"Length", "[", "coords", "]"}]}], ",", "symboltemp", ",", 
         RowBox[{"symbollist", "=", 
          RowBox[{"{", "}"}]}], ",", "range", ",", "replacementlist", ",", 
         "newdisp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Prepare", " ", "the", " ", "lhs", " ", 
         RowBox[{"(", 
          StyleBox[
           RowBox[{"column", " ", "list"}],
           FontColor->RGBColor[1, 0, 1]], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Do", "[", 
         StyleBox["\[IndentingNewLine]", "Code"], 
         StyleBox[
          RowBox[{
           RowBox[{"collist", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"collist", ",", 
              RowBox[{"UpOrDown", 
               RowBox[{"[", 
                RowBox[{
                "\[Mu]T", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "]"}]}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "Code"], 
         StyleBox["]", "Code"]}], 
        StyleBox[";", "Code"], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"(*", 
          RowBox[{"First", " ", 
           RowBox[{"step", ".", " ", 
            RowBox[{"Haven", "'"}]}], "t", " ", "specified", " ", "any", " ", 
           RowBox[{"index", "."}]}], "*)"}], "Code"], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"newdisp", "=", 
          RowBox[{"{", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
                RowBox[{"Sequence", "@@", "collist"}]}], "}"}], "]"}], 
             "\[Rule]", "ttM"}], ")"}], "}"}]}], "Code"], 
        StyleBox[";", "Code"], 
        StyleBox["\n", "Code"], 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{
           RowBox[{"2", "nd"}], ",", " ", 
           RowBox[{"3", "rd", " ", "steps"}], ",", " ", 
           RowBox[{"and", " ", "so", " ", 
            RowBox[{"on", ".", " ", "Start"}], " ", "to", " ", "specified", 
            " ", "from", " ", "first", " ", "index", " ", "until", " ", 
            "every", " ", "index", " ", "is", " ", 
            RowBox[{"specified", "."}]}]}], "Code"], "*)"}], 
        StyleBox["\n", "Code"], 
        StyleBox[
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"newdisp", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"newdisp", ",", 
                RowBox[{
                 RowBox[{"Rule", "[", 
                  RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", " ", 
                 RowBox[{"Rule", "[", 
                  RowBox[{
                   RowBox[{"a", "/.", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "\[Mu]T", "\[LeftDoubleBracket]", "idxnumber", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{
                    "coords", "\[LeftDoubleBracket]", "coordnumber", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
                   RowBox[{
                   "b", "\[LeftDoubleBracket]", "coordnumber", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ",", "Infinity"}], 
               "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"coordnumber", ",", "1", ",", "dim"}], "}"}]}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"idxnumber", ",", "1", ",", "rank"}], "}"}]}], "]"}], 
         "Code"], 
        StyleBox[";", "Code"], 
        StyleBox["\n", "Code"], 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{
           RowBox[{"Select", " ", "non"}], "-", 
           RowBox[{"zero", " ", 
            RowBox[{"comp", "."}]}]}], "Code"], "*)"}], 
        StyleBox["\n", "Code"], 
        RowBox[{
         StyleBox["Select", "Code"], 
         StyleBox["[", "Code"], 
         RowBox[{
          StyleBox[
           RowBox[{"newdisp", "//", "Flatten"}], "Code"], 
          StyleBox[",", "Code"], 
          RowBox[{
           RowBox[{
            StyleBox["(", "Code"], 
            RowBox[{
             RowBox[{
              RowBox[{
               StyleBox["Flatten", "Code"], 
               StyleBox["[", "Code"], 
               RowBox[{
                StyleBox["Cases", "Code"], 
                StyleBox["[", "Code"], 
                RowBox[{
                 StyleBox[
                  RowBox[{"{", "#", "}"}], "Code"], 
                 StyleBox[",", "Code"], 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Row", "[", "__", "]"}], "\[Rule]", "cc_"}], 
                   ")"}], "\[Rule]", "cc"}]}], "]"}], 
               StyleBox["]", "Code"]}], 
              StyleBox["\[LeftDoubleBracket]", "Code"], 
              StyleBox["1", "Code"], 
              StyleBox["\[RightDoubleBracket]", "Code"]}], 
             StyleBox["=!=", "Code"], 
             StyleBox["0", "Code"]}], 
            StyleBox[")", "Code"]}], 
           StyleBox["&", "Code"]}]}], 
         StyleBox["]", "Code"]}]}]}], 
      StyleBox["\n", "Code"], 
      StyleBox["]", "Code"]}]}], 
    StyleBox[";", "Code"]}], "\[IndentingNewLine]", 
   StyleBox["\n", "Code"], 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestDifferentialForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialForm", "::", "AntiSymmetricOrVectorOrScalar"}], 
     "=", "\"\<The argument `1` might not have anti-symmetric \
TensorComponent, or it is not a vector nor scalar.\>\""}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TestDifferentialForm", "::", "TestIndicesFalse"}], "=", 
      "\"\<The argument `1` does not have indices in correct format.\>\""}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialForm", "::", "AllLowerIndicesFalse"}], "=", 
     "\"\<The argument `1` does not have all lower indices.\>\""}], ";"}], 
   StyleBox["\n", "Code"], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{"TestDifferentialForm", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", "t", "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialForm", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestDifferentialForm", "::", "TestIndicesFalse"}], ",", 
            "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"All", " ", "of", " ", "them", " ", "should", " ", "be", " ", 
        StyleBox["lower",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        RowBox[{
         StyleBox["index",
          FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}], "|", 
           RowBox[{"{", "}"}]}]}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "::", "AllLowerIndicesFalse"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{"TestDifferentialForm", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", 
              RowBox[{"LowerAllIndices", "[", 
               RowBox[{"t", ",", "m"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialForm", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "::", "TestIndicesFalse"}], ",", 
           "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Shouldn", "'"}], "t", " ", "check", " ", "all", " ", "of", 
       " ", "them", " ", "be", " ", 
       StyleBox["lower",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
       StyleBox["no",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestDifferentialVector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
     "TestDifferentialVector", "::", "AntiSymmetricOrVectorOrScalar"}], "=", 
     "\"\<The argument `1` might not have anti-symmetric TensorComponent, or \
it is not a vector nor scalar.\>\""}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TestDifferentialVector", "::", "TestIndicesFalse"}], "=", 
      "\"\<The argument `1` does not have indices in correct format.\>\""}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestDifferentialVector", "::", "AllUpperIndicesFalse"}], "=", 
     "\"\<The argument `1` does not have all upper indices.\>\""}], ";"}], 
   StyleBox["\n", "Code"], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestDifferentialVector", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", "t", "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialVector", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestDifferentialVector", "::", "TestIndicesFalse"}], ",",
             "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"All", " ", "of", " ", "them", " ", "should", " ", "be", " ", 
        StyleBox["upper",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        RowBox[{
         StyleBox["index",
          FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
          RowBox[{
           RowBox[{"{", "1", "}"}], "|", 
           RowBox[{"{", "}"}]}]}], "]"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialVector", "::", "AllUpperIndicesFalse"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestDifferentialVector", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorSymmetry", "[", 
              RowBox[{"RaiseAllIndices", "[", 
               RowBox[{"t", ",", "m"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}], "===", 
            RowBox[{"Antisymmetric", "[", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
             "]"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["scalar",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "t", " ", "should", " ", "be", " ", "a", " ", 
            StyleBox["vector",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "===", "1"}], ")"}]}], 
         ")"}], ",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{
           "TestDifferentialVector", "::", "AntiSymmetricOrVectorOrScalar"}], 
           ",", "t"}], "]"}], ";", "False"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        "OK", " ", "or", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], " ", 
        RowBox[{
         RowBox[{"(", "scalar", ")"}], "."}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"If", "["}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "True", "}"}], "|", 
         RowBox[{"{", "}"}]}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{",", "True", ",", 
        RowBox[{
         RowBox[{"Message", "[", 
          RowBox[{
           RowBox[{"TestDifferentialVector", "::", "TestIndicesFalse"}], ",", 
           "t"}], "]"}], ";", "False"}]}], "]"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Shouldn", "'"}], "t", " ", "check", " ", "all", " ", "of", 
       " ", "them", " ", "be", " ", 
       StyleBox["upper",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], " ", "or", " ", 
       StyleBox["no",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["index",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestTensorIsFullyAntiSymmetric"}], "*)"}], 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"check", " ", "t", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
          StyleBox["fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["anti",
           FontColor->RGBColor[1, 0, 1]]}], 
         StyleBox["-",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{"symm", " ", "tensor"}],
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorSymmetry", "[", "t", "]"}], "\[LeftDoubleBracket]", 
           "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{"Antisymmetric", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
           "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], ">", "1"}], ")"}]}], ")"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        RowBox[{"OK", "."}]}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", "True", "}"}]}], "]"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"All", " ", "of", " ", "them", " ", "should", " ", "be", " ", 
        StyleBox["upper",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], "or", " ", 
        StyleBox["lower",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        RowBox[{
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{
         RowBox[{"{", "1", "}"}], "|", 
         RowBox[{"{", 
          RowBox[{"-", "1"}], "}"}]}]}], "]"}]}], ")"}]}], 
   "\[IndentingNewLine]", 
   StyleBox["\n", "Code"], 
   RowBox[{
    RowBox[{"TestTensorIsFullyAntiSymmetric", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"check", " ", "t", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
          StyleBox["fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["anti",
           FontColor->RGBColor[1, 0, 1]]}], 
         StyleBox["-",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{"symm", " ", "tensor"}],
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorSymmetry", "[", 
            RowBox[{"LowerAllIndices", "[", 
             RowBox[{"t", ",", "m"}], "]"}], "]"}], "\[LeftDoubleBracket]", 
           "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{"Antisymmetric", "[", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "t", "]"}], "]"}], "]"}], "]"}], 
           "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], ">", "1"}], ")"}]}], ")"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Check",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "t", " ", "are", " ", 
        RowBox[{"OK", "."}]}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
        RowBox[{"{", "True", "}"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Shouldn", "'"}], "t", " ", "check", " ", "all", " ", "of", 
       " ", "them", " ", "be", " ", 
       StyleBox["upper",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["indices",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], "or", " ", 
       StyleBox["lower",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ")"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ZeroTensor"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ZeroTensor", "[", 
     RowBox[{"indices_List", ",", "cs_List"}], "]"}], ":=", 
    RowBox[{"NonMetricTensor", "[", 
     RowBox[{"indices", ",", 
      RowBox[{"Normal", "[", 
       RowBox[{"SymmetrizedArray", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Length", "[", "cs", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"RankNumber", "[", "indices", "]"}]}], "}"}]}], "]"}], 
         ",", 
         RowBox[{"ZeroSymmetric", "[", "All", "]"}]}], "]"}], "]"}], ",", 
      "\"\<0\>\"", ",", 
      RowBox[{"CoordinateSystem", "\[Rule]", "cs"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TestExpressionForm", "[", "stuff_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "stuff", "}"}], ",", 
           RowBox[{"Tensor", "[", "xx___", "]"}], ",", "\[Infinity]"}], "]"}],
          "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", "stuff", "]"}], "=!=", "List"}], ")"}]}], 
     ")"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"ContainOnlyScalarTensor", "[", "stuff_", "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "stuff", "}"}], ",", "_Tensor", ",", "Infinity"}], 
           "]"}]}], "]"}], ")"}], "===", 
       RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorPlusName"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TensorPlusName", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LHSt_Tensor", "|", "LHSt_Times"}], 
          RowBox[{"(*", 
           RowBox[{"|", "LHSt_Plus"}], "*)"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus"}], 
          ")"}]}], "]"}], "/;", 
       RowBox[{"(*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"LHSt", ",", 
            RowBox[{"Tensor", "[", "___", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "LHSt", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"RHSt", ",", 
             RowBox[{"Tensor", "[", "___", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"LHSttemp", "=", 
           RowBox[{"TensorName", "[", "LHSt", "]"}]}], ",", 
          RowBox[{"RHSttemp", "=", 
           RowBox[{"TensorName", "[", "RHSt", "]"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHSt", "]"}], "===", "Times"}], ")"}], ",", 
           RowBox[{"LHSttemp", "=", 
            RowBox[{"TimesScalarTensorName", "[", "LHSt", "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHSt", "]"}], "===", "Times"}], ")"}], ",", 
           RowBox[{"RHSttemp", "=", 
            RowBox[{"TimesScalarTensorName", "[", "RHSt", "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHSt", "]"}], "===", "Plus"}], ")"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RHSttemp", "=", 
            RowBox[{"TensorPlusName", "[", "RHSt", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{"LHSttemp", ",", "\"\<+\>\"", ",", "RHSttemp"}], "}"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TimesScalarTensorName"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TimesScalarTensorName", "[", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"scalar_", "/;", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}], 
         ",", "t_Tensor"}], "]"}], "]"}], ":=", 
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"TensorName", "[", "scalar", "]"}], ",", 
        RowBox[{"TensorName", "[", "t", "]"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TimesScalarTensorName", "[", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"scalar___", "/;", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}], 
         ",", "t___Tensor"}], "]"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"{", "scalar", "}"}]}], ")"}]}], ")"}], 
       RowBox[{"TensorName", "[", "t", "]"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TimesScalarTensorName", "[", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"scalar___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "scalar", "]"}], "=!=", "Tensor"}], ")"}]}], 
         ",", "t___Tensor"}], "]"}], "]"}], ":=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"{", "scalar", "}"}]}], ")"}]}], ")"}], 
       RowBox[{"TensorName", "[", 
        RowBox[{"(", 
         RowBox[{"Times", "@@", 
          RowBox[{"{", "t", "}"}]}], ")"}], "]"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestOneVector"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "Message"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOneVector", "::", "TestOneVectorFalse"}], "=", 
     "\"\<The argument `1` isn't a 1-vector tensor.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestOneVector", "[", "\[Xi]_Tensor", "]"}], ":=", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "\[Xi]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}], ")"}], ",", 
       "True", ",", 
       RowBox[{
        RowBox[{"Message", "[", 
         RowBox[{
          RowBox[{"TestOneVector", "::", "TestOneVectorFalse"}], ",", 
          "\[Xi]"}], "]"}], ";", "False"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "WedgeProductExpand"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"WedgeProductExpand", "[", "tw_TensorWedge", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "dlist", ",", "Permutelist", ",", "sgnlist", ",", "lgth", ",", 
         "result", ",", "ii"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dlist", "=", 
         RowBox[{"tw", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"TensorWedge", "[", "xxx___", "]"}], "\[Rule]", " ", 
            RowBox[{"{", "xxx", "}"}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Permutelist", "=", 
         RowBox[{"Permutations", "[", "dlist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sgnlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Signature", "[", "#", "]"}], "&"}], "/@", 
          "Permutelist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "Permutelist", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"result", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Plus", ",", 
           RowBox[{
            RowBox[{
            "sgnlist", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "sgnlist", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{"TensorProduct", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{
                 "Permutelist", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestSymmetricTensorExpressionForm"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestSymmetricTensorExpressionForm", "[", "stuff_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tep", ",", "liststuff"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tep", "=", 
         RowBox[{"stuff", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tep", "]"}], "===", "Plus"}], ",", 
          RowBox[{"liststuff", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "tep"}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "tep", "]"}], "===", "Times"}], ",", 
          RowBox[{"liststuff", "=", 
           RowBox[{"{", "tep", "}"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"liststuff", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[Del]", "_"}], ")"}], "|", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "_"}], ")"}], "power_"], "|", 
                RowBox[{"Times", "[", 
                 RowBox[{
                  RowBox[{"x1___", "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x1", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                    RowBox[{"{", "}"}]}], ")"}]}], ",", 
                  RowBox[{"xxx___", "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[Del]", "_"}], ")"}], "|", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[Del]", "_"}], ")"}], "power_"]}], ")"}], 
                    ".."}], "}"}]}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "xxx", "}"}], "]"}], "===", "1"}], ")"}]}], 
                    ")"}]}], ",", 
                  RowBox[{"x2___", "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x2", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                    RowBox[{"{", "}"}]}], ")"}]}]}], "]"}]}], ")"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "||", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"liststuff", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "_"}], ")"}], "|", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"\[DifferentialD]", "_"}], ")"}], "power_"], "|", 
                RowBox[{"Times", "[", 
                 RowBox[{
                  RowBox[{"x1___", "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x1", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                    RowBox[{"{", "}"}]}], ")"}]}], ",", 
                  RowBox[{"xxx___", "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[DifferentialD]", "_"}], ")"}], "|", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[DifferentialD]", "_"}], ")"}], "power_"]}], 
                    ")"}], ".."}], "}"}]}], "]"}], "&&", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "xxx", "}"}], "]"}], "===", "1"}], ")"}]}], 
                    ")"}]}], ",", 
                  RowBox[{"x2___", "/;", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x2", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                    RowBox[{"{", "}"}]}], ")"}]}]}], "]"}]}], ")"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "||", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"liststuff", ",", 
              RowBox[{"Times", "[", 
               RowBox[{
                RowBox[{"x1___", "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x1", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                   RowBox[{"{", "}"}]}], ")"}]}], ",", 
                RowBox[{"xxx___", "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"\[DifferentialD]", "_"}], ")"}], "|", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[DifferentialD]", "_"}], ")"}], "power_"]}], 
                    ")"}], ".."}], "}"}]}], "]"}], "&&", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "xxx", "}"}], "]"}], "=!=", "1"}], ")"}]}], 
                  ")"}]}], ",", 
                RowBox[{"x2___", "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x2", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                   RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "||", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"liststuff", ",", 
              RowBox[{"Times", "[", 
               RowBox[{
                RowBox[{"x1___", "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x1", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                   RowBox[{"{", "}"}]}], ")"}]}], ",", 
                RowBox[{"xxx___", "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[Del]", "_"}], "|", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"\[Del]", "_"}], ")"}], "power_"]}], ")"}], 
                    ".."}], "}"}]}], "]"}], "&&", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"{", "xxx", "}"}], "]"}], "=!=", "1"}], ")"}]}], 
                  ")"}]}], ",", 
                RowBox[{"x2___", "/;", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "x2", "}"}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"\[DifferentialD]", "_"}], "|", 
                    RowBox[{"\[Del]", "_"}]}], ")"}], ",", "Infinity"}], 
                    "]"}], "===", 
                   RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"tep", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"\[DifferentialD]", "_"}], ")"}], "|", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "_"}], ")"}], "power_"], "|", 
              RowBox[{"\[Del]", "_"}], "|", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[Del]", "_"}], ")"}], "power_"]}], ")"}]}], "]"}]}],
          ")"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"New", " ", "ContractTensors"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestRepeatedIndices", "::", "TestRepeatedIndicesFalse"}], "=", 
     "\"\<Didn't detect any repeated indices.\>\""}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestRepeatedIndices", "[", "wholeBunchOfStuff_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "AllTensor", ",", "FirstTensor", ",", "cooo", ",", "si", ",", "idx"}],
         "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AllTensor", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "wholeBunchOfStuff", "}"}], ",", "_Tensor", ",", 
           "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"FirstTensor", "=", 
         RowBox[{
         "AllTensor", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cooo", "=", 
         RowBox[{"Coordinates", "[", "FirstTensor", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "FirstTensor", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "wholeBunchOfStuff", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", " ", "idx_"}], ")"}], "\[Rule]", 
              " ", "idx"}], ",", "Infinity"}], "]"}], "]"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
                 "i3___"}], "}"}], "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"(*", " ", 
                   RowBox[{"check", " ", "repeated", " ", "indices"}], " ", 
                   "*)"}], 
                  RowBox[{
                   RowBox[{
                   "\[Mu]1T", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "===", 
                   RowBox[{
                   "\[Mu]2T", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "check", " ", "one", " ", "index", " ", "up", " ", "and", 
                    " ", "one", " ", "down"}], " ", "*)"}], 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
                    RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
                   RowBox[{"-", "1"}]}], ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "check", " ", "that", " ", "both", " ", "indices", " ", 
                    "are", " ", "abstract"}], " ", "*)"}], 
                  RowBox[{"!", 
                   RowBox[{"NotAbstractIndex", "[", 
                    RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}]}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{"(*", " ", 
                   RowBox[{
                   "check", " ", "that", " ", "both", " ", "indices", " ", 
                    "are", " ", "abstract"}], " ", "*)"}], 
                  RowBox[{"!", 
                   RowBox[{"NotAbstractIndex", "[", 
                    RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}]}], 
                  ")"}], "&&", 
                 RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
                 RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}], ")"}]}], 
              ")"}], "|", 
             RowBox[{"{", 
              RowBox[{
              "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
               "i3___"}], "}"}]}], "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"(*", " ", 
                RowBox[{"check", " ", "repeated", " ", "indices"}], " ", 
                "*)"}], 
               RowBox[{
                RowBox[{
                "\[Mu]1T", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "===", 
                RowBox[{
                "\[Mu]2T", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"(*", " ", 
                RowBox[{
                "check", " ", "one", " ", "index", " ", "up", " ", "and", " ",
                  "one", " ", "down"}], " ", "*)"}], 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
                 RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
                RowBox[{"-", "1"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"(*", " ", 
                RowBox[{
                "check", " ", "that", " ", "both", " ", "indices", " ", "are",
                  " ", "abstract"}], " ", "*)"}], 
               RowBox[{"!", 
                RowBox[{"NotAbstractIndex", "[", 
                 RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], 
              "&&", 
              RowBox[{"(", 
               RowBox[{"(*", " ", 
                RowBox[{
                "check", " ", "that", " ", "both", " ", "indices", " ", "are",
                  " ", "abstract"}], " ", "*)"}], 
               RowBox[{"!", 
                RowBox[{"NotAbstractIndex", "[", 
                 RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], 
              "&&", 
              RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
              RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}], ")"}]}], 
           ")"}]}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "BasisSgn"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"BasisSgn", "[", "stuff_", "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"\[DifferentialD]", "_"}]}], "]"}], ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"stuff", ",", 
         RowBox[{"\[Del]", "_"}]}], "]"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestFormVectorIndices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestFormVectorIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}]}], "]"}], ")"}], ",", 
       RowBox[{
        RowBox[{"{", "1", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "|", 
        RowBox[{"{", "}"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TestFormVectorIndices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TestFormVectorIndices", "[", "indices_List", "]"}], ":=", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"RemoveUnderBarredIndices", "[", "indices", "]"}]}], "]"}], 
        ")"}], ",", 
       RowBox[{
        RowBox[{"{", "1", "}"}], "|", 
        RowBox[{"{", 
         RowBox[{"-", "1"}], "}"}], "|", 
        RowBox[{"{", "}"}]}]}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303312609375*^9}, {3.520303594359375*^9, 3.520303669640625*^9}, {
   3.5203528833125*^9, 3.520352917421875*^9}, {3.520353025234375*^9, 
   3.520353134734375*^9}, {3.520353222796875*^9, 3.5203532285*^9}, {
   3.52035363684375*^9, 3.520353648234375*^9}, {3.520371983265625*^9, 
   3.520372009390625*^9}, {3.520372040765625*^9, 3.52037204234375*^9}, {
   3.520373601546875*^9, 3.520373608875*^9}, {3.520373681375*^9, 
   3.5203737725*^9}, {3.520373843515625*^9, 3.520373915828125*^9}, {
   3.520373971703125*^9, 3.520373974734375*^9}, {3.520374036796875*^9, 
   3.5203740864375*^9}, {3.52037473459375*^9, 3.520374758609375*^9}, {
   3.520441968*^9, 3.52044199165625*^9}, {3.5206279314375*^9, 
   3.520627934484375*^9}, {3.52062800871875*^9, 3.52062819365625*^9}, {
   3.52062825025*^9, 3.520628296015625*^9}, {3.5206410005625*^9, 
   3.520641013765625*^9}, {3.5206411729375*^9, 3.52064128375*^9}, {
   3.52064131609375*^9, 3.52064148315625*^9}, {3.5206415455625*^9, 
   3.520641554234375*^9}, {3.52064166375*^9, 3.520641666484375*^9}, {
   3.520641888671875*^9, 3.520641901203125*^9}, {3.520643750953125*^9, 
   3.520643854203125*^9}, {3.52064414540625*^9, 3.5206441485625*^9}, {
   3.520650588828125*^9, 3.52065066803125*^9}, {3.520650699578125*^9, 
   3.52065070521875*^9}, {3.520657060390625*^9, 3.5206570636875*^9}, {
   3.52065709878125*^9, 3.52065723459375*^9}, {3.520657442828125*^9, 
   3.520657443921875*^9}, {3.520657605*^9, 3.5206576095*^9}, {
   3.5206577215625*^9, 3.5206578865625*^9}, {3.520657936875*^9, 
   3.520657960859375*^9}, {3.520658036734375*^9, 3.5206581076875*^9}, 
   3.520658205453125*^9, 3.520658245359375*^9, {3.52065828290625*^9, 
   3.52065836640625*^9}, {3.5206584366875*^9, 3.520658510921875*^9}, {
   3.5206585434375*^9, 3.520658677875*^9}, {3.5206849995625*^9, 
   3.52068500203125*^9}, {3.5206850610625*^9, 3.520685062015625*^9}, {
   3.52068513365625*^9, 3.520685276078125*^9}, {3.520685386484375*^9, 
   3.52068563803125*^9}, {3.520685701375*^9, 3.52068576859375*^9}, {
   3.520687484890625*^9, 3.520687580171875*^9}, {3.52068766728125*^9, 
   3.520687689109375*^9}, 3.52068774225*^9, {3.5206877878125*^9, 
   3.52068786134375*^9}, {3.52068790584375*^9, 3.520687915390625*^9}, {
   3.5206879975625*^9, 3.520688096875*^9}, {3.520702059078125*^9, 
   3.520702403609375*^9}, {3.520702713390625*^9, 3.520702747234375*^9}, {
   3.520702857859375*^9, 3.520702863328125*^9}, {3.5207029781875*^9, 
   3.520703030609375*^9}, {3.520703064421875*^9, 3.520703065890625*^9}, {
   3.520703096765625*^9, 3.5207033071875*^9}, {3.520703396*^9, 
   3.520703496265625*^9}, {3.520705289734375*^9, 3.52070539884375*^9}, {
   3.52070557734375*^9, 3.52070574284375*^9}, {3.520705938328125*^9, 
   3.520705978765625*^9}, {3.520811559984375*^9, 3.520811568390625*^9}, {
   3.520860663984375*^9, 3.520860664375*^9}, {3.520860738359375*^9, 
   3.520860773515625*^9}, {3.520860885328125*^9, 3.520860893125*^9}, {
   3.520872225390625*^9, 3.5208722583125*^9}, {3.52087290084375*^9, 
   3.5208729056875*^9}, {3.520956090890625*^9, 3.520956092171875*^9}, {
   3.520986249875*^9, 3.520986379078125*^9}, {3.520986447203125*^9, 
   3.520986511609375*^9}, {3.52098665503125*^9, 3.5209867026875*^9}, {
   3.520986747078125*^9, 3.520986794875*^9}, {3.52098682703125*^9, 
   3.520986831875*^9}, {3.520987106375*^9, 3.5209872254375*^9}, {
   3.52098728625*^9, 3.52098763690625*^9}, {3.5209876713125*^9, 
   3.520987794484375*^9}, {3.520987831546875*^9, 3.520987898*^9}, {
   3.520987945890625*^9, 3.520987964328125*^9}, {3.5209880521875*^9, 
   3.5209880994375*^9}, {3.52098813075*^9, 3.52098827196875*^9}, {
   3.52098851540625*^9, 3.52098855515625*^9}, {3.52098863653125*^9, 
   3.520988643375*^9}, {3.52098869140625*^9, 3.52098877403125*^9}, {
   3.520988813328125*^9, 3.52098886578125*^9}, {3.5210407265625*^9, 
   3.521040744171875*^9}, {3.521040775625*^9, 3.52104084321875*^9}, {
   3.5210411816875*^9, 3.5210412101875*^9}, {3.52114569015625*^9, 
   3.52114572809375*^9}, {3.521217707265625*^9, 3.521217715671875*^9}, {
   3.521217927546875*^9, 3.521217963875*^9}, {3.521218474890625*^9, 
   3.521218528921875*^9}, {3.5212393095625*^9, 3.521239364875*^9}, {
   3.52123995678125*^9, 3.5212399609375*^9}, {3.521240055671875*^9, 
   3.521240055765625*^9}, {3.521240374234375*^9, 3.521240394703125*^9}, {
   3.52124044365625*^9, 3.52124044465625*^9}, {3.5212405005625*^9, 
   3.521240612515625*^9}, {3.521240755859375*^9, 3.5212408193125*^9}, {
   3.52124087103125*^9, 3.521240905484375*^9}, {3.521241041015625*^9, 
   3.521241097203125*^9}, {3.521241211390625*^9, 3.5212412188125*^9}, 
   3.521241782671875*^9, {3.521242110109375*^9, 3.52124215696875*^9}, {
   3.52124224990625*^9, 3.521242265953125*^9}, {3.521242839421875*^9, 
   3.5212428400625*^9}, {3.521242967421875*^9, 3.521243059640625*^9}, {
   3.521249340421875*^9, 3.521249342140625*^9}, {3.521670656109375*^9, 
   3.52167066703125*^9}, {3.5216734070625*^9, 3.5216734075625*^9}, {
   3.521735025390625*^9, 3.5217351415625*^9}, {3.521736713984375*^9, 
   3.521736714734375*^9}, {3.5217368119375*^9, 3.52173681659375*^9}, {
   3.521736866890625*^9, 3.52173692971875*^9}, {3.521736968203125*^9, 
   3.521737056765625*^9}, {3.521737100265625*^9, 3.52173711903125*^9}, {
   3.52174049478125*^9, 3.521740497515625*^9}, {3.52174100984375*^9, 
   3.521741096328125*^9}, {3.52174246353125*^9, 3.521742495734375*^9}, {
   3.521742742734375*^9, 3.521742875125*^9}, {3.5217464444375*^9, 
   3.521746470625*^9}, {3.52174654271875*^9, 3.521746545015625*^9}, {
   3.52174664240625*^9, 3.52174671003125*^9}, {3.521759207234375*^9, 
   3.521759209796875*^9}, 3.52175925890625*^9, {3.521759304109375*^9, 
   3.521759373078125*^9}, {3.521759445015625*^9, 3.52175954609375*^9}, {
   3.5217604933125*^9, 3.521760600265625*^9}, {3.521760738890625*^9, 
   3.52176074121875*^9}, {3.521786067171875*^9, 3.5217860934375*^9}, {
   3.5219184780625*^9, 3.52191848340625*^9}, {3.521953055046875*^9, 
   3.521953164109375*^9}, {3.52195483903125*^9, 3.521954839609375*^9}, {
   3.5324517659523525`*^9, 3.5324517661551533`*^9}, {3.5395491603981233`*^9, 
   3.5395494300913973`*^9}, {3.539549480229885*^9, 3.5395496299277477`*^9}, {
   3.5395496774922314`*^9, 3.5395497327163286`*^9}, {3.5395513304243345`*^9, 
   3.5395513329359393`*^9}, {3.5395517069153957`*^9, 
   3.5395517093802004`*^9}, {3.5395522120130835`*^9, 
   3.5395522158350897`*^9}, {3.539657249160885*^9, 3.539657249379285*^9}, {
   3.539657530777224*^9, 3.539657683320675*^9}, {3.539657748474284*^9, 
   3.5396578519577208`*^9}, {3.5396578829327927`*^9, 3.539658064724435*^9}, {
   3.5396580988419847`*^9, 3.5396581265820236`*^9}, {3.5396582225813313`*^9, 
   3.5396582969720464`*^9}, {3.5396583348323174`*^9, 3.539658416714452*^9}, {
   3.5396585143905983`*^9, 3.5396585146155987`*^9}, {3.594235766551963*^9, 
   3.5942357667519665`*^9}, {3.5942359148992424`*^9, 
   3.5942359306479845`*^9}, {3.594235985232823*^9, 3.594236066719575*^9}, {
   3.606163049208482*^9, 3.6061630597229004`*^9}, {3.606334715022857*^9, 
   3.606334725084875*^9}, {3.6063347683281507`*^9, 3.606334771276556*^9}, {
   3.606334862817517*^9, 3.606334866265123*^9}, {3.606335898643736*^9, 
   3.606335944055416*^9}, {3.6063360059875245`*^9, 3.6063360129919367`*^9}, {
   3.6063362373926587`*^9, 3.606336362099575*^9}, {3.6063364379287395`*^9, 
   3.6063365192564893`*^9}, {3.606447642770243*^9, 3.6064476438033023`*^9}, {
   3.6064930994988236`*^9, 3.6064931030390263`*^9}, {3.6064948043393345`*^9, 
   3.6064948811087255`*^9}, {3.6064954274349737`*^9, 
   3.6064954335883255`*^9}, {3.6064983162402563`*^9, 3.606498320577064*^9}, 
   3.6064985034717855`*^9, {3.606498554031474*^9, 3.6064985726735067`*^9}, {
   3.6295676201967974`*^9, 3.629567620648599*^9}, {3.629680185017112*^9, 
   3.6296802769560914`*^9}, {3.629680633349614*^9, 3.6296806793637075`*^9}, {
   3.6296807111641808`*^9, 3.629680838737239*^9}, {3.629681034690623*^9, 
   3.6296810520196543`*^9}, {3.6296812822770367`*^9, 3.629681286586645*^9}, {
   3.6296828131213646`*^9, 3.62968282186638*^9}, {3.629683469356697*^9, 
   3.6296835401938224`*^9}, {3.6296838985768557`*^9, 
   3.6296839126178803`*^9}, {3.6296847597020826`*^9, 3.629684933130988*^9}, {
   3.629684969833253*^9, 3.629685071093432*^9}, {3.629692378579189*^9, 
   3.629692529049019*^9}, {3.6296945310987587`*^9, 3.6296945862344627`*^9}, {
   3.6296946321551456`*^9, 3.629694659963399*^9}, {3.629694698707673*^9, 
   3.6296947003310757`*^9}, {3.6297032996087093`*^9, 3.629703465099947*^9}, 
   3.6297035072604094`*^9, {3.629703582225516*^9, 3.629703615624566*^9}, {
   3.6297037732778482`*^9, 3.6297037993748865`*^9}, {3.6297038394719453`*^9, 
   3.6297038411119475`*^9}, {3.6297040065635414`*^9, 
   3.6297040144635525`*^9}, {3.6297040769726453`*^9, 
   3.6297042157658424`*^9}, {3.629704281039935*^9, 3.6297043809580774`*^9}, {
   3.6297048388965054`*^9, 3.6297049164104424`*^9}, {3.6297049658705297`*^9, 
   3.6297049721849413`*^9}, {3.6297280006762824`*^9, 
   3.6297280992754774`*^9}, {3.629728422368769*^9, 3.6297284608957133`*^9}, {
   3.62972858008243*^9, 3.6297286148020597`*^9}, {3.62972867285105*^9, 
   3.6297287468368196`*^9}, {3.6297287911061335`*^9, 
   3.6297287914805336`*^9}, {3.629728981739934*^9, 3.629729013080001*^9}, {
   3.629729062765713*^9, 3.629729082045554*^9}, {3.629826197355792*^9, 
   3.6298262211296344`*^9}, {3.6298263619470034`*^9, 
   3.6298263686862154`*^9}, {3.629826626602665*^9, 3.6298266268366656`*^9}, {
   3.629865613702647*^9, 3.6298656859936457`*^9}, {3.6299294843132706`*^9, 
   3.6299295426011763`*^9}, {3.6697705135537825`*^9, 
   3.6697705493158283`*^9}, {3.6697706062800865`*^9, 3.6697706435802193`*^9}, 
   3.6697706876937428`*^9, {3.6697707712615223`*^9, 3.669770771949562*^9}, {
   3.6697708834759407`*^9, 3.6697708847950163`*^9}, {3.6698270303643155`*^9, 
   3.669827047409546*^9}, {3.672074736338648*^9, 3.6720749366671057`*^9}, {
   3.672082677115674*^9, 3.672082755709381*^9}, {3.826233712688684*^9, 
   3.8262337129721055`*^9}, {3.826233746528405*^9, 3.826233808032279*^9}, {
   3.8273795911151886`*^9, 3.8273796265839396`*^9}, {3.8273798613853607`*^9, 
   3.827379864088481*^9}, {3.8273829817444267`*^9, 3.8273829846924286`*^9}, {
   3.8274024792484355`*^9, 3.827402479956436*^9}, {3.837489538162016*^9, 
   3.837489600662038*^9}, {3.837489707474516*^9, 3.837489737365162*^9}, {
   3.8374897799901657`*^9, 3.8374897842870164`*^9}, {3.837490114162035*^9, 
   3.8374901690057898`*^9}, {3.8374902465066023`*^9, 3.8374902565690827`*^9}, 
   3.837490402615963*^9, {3.8374943905756917`*^9, 3.837494391685067*^9}, {
   3.837497281293601*^9, 3.8374973132947206`*^9}, {3.837497344763449*^9, 
   3.8374973984050045`*^9}, {3.837497743764369*^9, 3.8374977737174788`*^9}, {
   3.8375004667848983`*^9, 3.8375004766286497`*^9}, {3.8375005434880466`*^9, 
   3.8375007012388*^9}, {3.837500766207569*^9, 3.837500774645044*^9}, {
   3.83750083130132*^9, 3.837500834004443*^9}, {3.8375016902478547`*^9, 
   3.8375017014998245`*^9}, {3.83764294835192*^9, 3.837642965670882*^9}, {
   3.8381866345054016`*^9, 3.8381866835929146`*^9}, {3.83818680619582*^9, 
   3.8381869018457375`*^9}, {3.838186988778064*^9, 3.8381872814159007`*^9}, {
   3.838187312675513*^9, 3.8381874712183313`*^9}, {3.838193326754201*^9, 
   3.8381933295624046`*^9}, {3.8447768897264223`*^9, 3.8447769065710335`*^9}, 
   3.844809821679516*^9, 3.844809857897566*^9, {3.844813331778761*^9, 
   3.8448133319857635`*^9}, 3.8448135057552977`*^9, {3.8448138208287325`*^9, 
   3.844813825523732*^9}, {3.8448138641547337`*^9, 3.844813873954732*^9}, {
   3.8448957042424493`*^9, 3.844895705049954*^9}, {3.844902795528102*^9, 
   3.8449027959738283`*^9}, {3.8449433269288645`*^9, 3.8449433272436647`*^9}, 
   3.8449442994474154`*^9, 3.85254528705027*^9, {3.853221145046345*^9, 
   3.853221147646541*^9}, 3.853221298925313*^9, {3.853221481284031*^9, 
   3.853221482393796*^9}, 3.853222456626564*^9, {3.853286346551244*^9, 
   3.85328637663585*^9}, {3.858822474648003*^9, 3.858822486520647*^9}, {
   3.8588228045541835`*^9, 3.858822807593304*^9}, {3.8588228423133273`*^9, 
   3.8588228657458057`*^9}, 3.858823734523964*^9, {3.859457669360976*^9, 
   3.8594577249839745`*^9}, {3.8594578772999773`*^9, 
   3.8594578878339753`*^9}, {3.859459195350464*^9, 3.859459196210469*^9}, {
   3.8595103647586727`*^9, 3.859510419729851*^9}, {3.860099854137153*^9, 
   3.8600998635227714`*^9}, {3.861278495401449*^9, 3.861278496759264*^9}, {
   3.861280690146099*^9, 3.8612806960760436`*^9}, {3.861323440707077*^9, 
   3.861323453629053*^9}, {3.861702799489361*^9, 3.8617028059274726`*^9}, {
   3.861702851573842*^9, 3.861702861402455*^9}, {3.861749447510594*^9, 
   3.8617494567605095`*^9}, {3.86174951548767*^9, 3.861749518210271*^9}, {
   3.867319078220358*^9, 3.867319108790619*^9}, {3.867319192349622*^9, 
   3.8673192504796686`*^9}, {3.867328137199361*^9, 3.867328141559555*^9}, {
   3.8673284801608205`*^9, 3.867328501371873*^9}, {3.867328761414651*^9, 
   3.8673287766082864`*^9}, {3.867374055491091*^9, 3.8673740633872795`*^9}, {
   3.867374101462019*^9, 3.86737410520658*^9}, {3.8685196358008175`*^9, 
   3.8685196480175605`*^9}, {3.8685694653559933`*^9, 
   3.8685696431546087`*^9}, {3.8691004197825994`*^9, 3.869100422711796*^9}, {
   3.869100480102472*^9, 3.8691005624953446`*^9}, 3.8691007784609137`*^9, {
   3.871609781993772*^9, 3.871609805137319*^9}, {3.8716099893833127`*^9, 
   3.8716099909814568`*^9}, {3.871610266571615*^9, 3.8716103126649632`*^9}, 
   3.87161035631427*^9, {3.8716103935139885`*^9, 3.871610404510747*^9}, {
   3.871610434647501*^9, 3.871610453634239*^9}, {3.8716105052126474`*^9, 
   3.871610578548798*^9}, {3.8720448402653103`*^9, 3.8720448765413046`*^9}, {
   3.8720449754073057`*^9, 3.8720449773573055`*^9}, {3.872050407231696*^9, 
   3.872050430252696*^9}, {3.875241872379497*^9, 3.875241884664296*^9}, {
   3.875242044992626*^9, 3.875242065477417*^9}, {3.8752421041757083`*^9, 
   3.8752421567105064`*^9}, {3.8752423545373926`*^9, 3.875242409116314*^9}, {
   3.875242485271899*^9, 3.8752424854281864`*^9}, {3.875747306621274*^9, 
   3.875747351218406*^9}, {3.875747412372419*^9, 3.875747421787624*^9}, {
   3.875747566373525*^9, 3.8757475679563236`*^9}, {3.875748188799568*^9, 
   3.8757482882576504`*^9}, {3.875748328593083*^9, 3.875748389163454*^9}, {
   3.8757525778296647`*^9, 3.8757525917738867`*^9}, {3.876537910017207*^9, 
   3.876537984246462*^9}, {3.876538841552869*^9, 3.876538924151589*^9}, {
   3.8765408310496645`*^9, 3.8765408531651335`*^9}, {3.877048604078147*^9, 
   3.8770486182139072`*^9}, {3.8781806024532485`*^9, 3.878180605990083*^9}, {
   3.878181460491768*^9, 3.878181466395237*^9}, {3.8860367378252277`*^9, 
   3.886036769373989*^9}, {3.8861110572850494`*^9, 3.8861110586152315`*^9}, {
   3.8861112237242017`*^9, 3.8861112397554617`*^9}, {3.886111462711011*^9, 
   3.886111462865919*^9}, {3.886911333879192*^9, 3.8869114164184275`*^9}, {
   3.8869115168304515`*^9, 3.886911517015341*^9}, {3.8869115771443834`*^9, 
   3.886911577339301*^9}, {3.887118464629903*^9, 3.8871185659520597`*^9}, {
   3.8893275028059998`*^9, 3.8893275076665907`*^9}, {3.8893275591362*^9, 
   3.8893275602538233`*^9}, {3.8896015792575617`*^9, 3.889601610572567*^9}, {
   3.889601651354558*^9, 3.889601658982568*^9}, {3.889601706660567*^9, 
   3.8896017213445635`*^9}, {3.889606008728564*^9, 3.8896060316615644`*^9}, {
   3.8896060641245637`*^9, 3.8896060741975594`*^9}, {3.889606105230564*^9, 
   3.8896061396975713`*^9}, {3.8901894676948986`*^9, 
   3.8901894774156446`*^9}, {3.8901926545882063`*^9, 3.890192701868833*^9}, {
   3.891403784075463*^9, 3.8914038092830195`*^9}, 3.8914039729237556`*^9, {
   3.8914057520704284`*^9, 3.8914057780991063`*^9}, {3.8914058110779476`*^9, 
   3.8914058710452957`*^9}, {3.891406699443428*^9, 3.8914068447766*^9}, {
   3.891513291611006*^9, 3.8915133186689367`*^9}, 3.891513825013546*^9, {
   3.8915141593504143`*^9, 3.891514175643307*^9}, {3.891514614036959*^9, 
   3.891514626895515*^9}, {3.8915146609406214`*^9, 3.891514663069034*^9}, {
   3.8915148682529144`*^9, 3.8915148736944265`*^9}, 3.8915150488210125`*^9, 
   3.891515100253293*^9, {3.891515626583662*^9, 3.8915156437915535`*^9}, {
   3.8915156894719*^9, 3.8915157343096676`*^9}, {3.891515956507392*^9, 
   3.891515966538716*^9}, {3.8915160041708794`*^9, 3.8915160043317776`*^9}, {
   3.8915185185007153`*^9, 3.891518524692953*^9}, {3.8915193401295013`*^9, 
   3.891519343456766*^9}, {3.8915685181095343`*^9, 3.8915685193677654`*^9}, {
   3.8915687173167152`*^9, 3.891568857677004*^9}, {3.8915688883292603`*^9, 
   3.8915688937849255`*^9}, {3.8915721228489428`*^9, 
   3.8915721266905937`*^9}, {3.8915721568001823`*^9, 3.891572192745199*^9}, {
   3.8915722460080476`*^9, 3.8915722832398434`*^9}, {3.891572314364813*^9, 
   3.891572326349484*^9}, 3.8920068655997515`*^9, 3.8920069575264406`*^9, {
   3.8920070336818047`*^9, 3.892007055580203*^9}, {3.892013714916459*^9, 
   3.8920137635255327`*^9}, {3.8920796360630183`*^9, 
   3.8920800398370066`*^9}, {3.8920800714965487`*^9, 
   3.8920800771990376`*^9}, {3.8920807568676786`*^9, 
   3.8920807604901605`*^9}, {3.8920809007300034`*^9, 3.892080900862454*^9}, 
   3.8920809384051456`*^9, 3.8920811631800413`*^9, 3.892859751781663*^9, {
   3.8932891237727985`*^9, 3.8932891238897653`*^9}, {3.8932891910286007`*^9, 
   3.8932892327958193`*^9}, {3.894072166536578*^9, 3.894072230726001*^9}, {
   3.8940723537610283`*^9, 3.89407236240666*^9}, 3.8940730272368402`*^9, {
   3.8943450662116814`*^9, 3.89434507853652*^9}, 3.894345312340747*^9, {
   3.8943461640687923`*^9, 3.8943461645990295`*^9}, 3.894346314147188*^9, {
   3.89434884130538*^9, 3.8943488517202196`*^9}, {3.8947748686205235`*^9, 
   3.894774893566926*^9}, {3.89477596172167*^9, 3.894775987397379*^9}, {
   3.894889539787701*^9, 3.8948895778049755`*^9}, {3.8948917327640095`*^9, 
   3.8948917437749877`*^9}, {3.894891956286368*^9, 3.894891958452483*^9}, 
   3.894936303660626*^9, {3.8949363743476477`*^9, 3.894936374531536*^9}, {
   3.8949366963337717`*^9, 3.894936698821799*^9}, 3.894937372559208*^9, {
   3.8950727118765*^9, 3.895072721204378*^9}, 3.895542983530056*^9, 
   3.89554314230307*^9, {3.895553903218855*^9, 3.8955539507071753`*^9}, {
   3.895554773115775*^9, 3.895554779843066*^9}, {3.895554859137924*^9, 
   3.895554859287339*^9}, {3.895555019130292*^9, 3.8955550275299015`*^9}, {
   3.8955551719798512`*^9, 3.8955551749979105`*^9}, {3.8955553393614388`*^9, 
   3.8955553418772044`*^9}, {3.895555421517836*^9, 3.8955555172916403`*^9}, {
   3.895555634958105*^9, 3.8955556368564315`*^9}, {3.8955557161585093`*^9, 
   3.8955557171561604`*^9}, {3.895555769963516*^9, 3.8955557933300533`*^9}, {
   3.895555837964419*^9, 3.8955558424818373`*^9}, 3.8955559714238663`*^9, {
   3.8955560193670197`*^9, 3.8955560194609623`*^9}, {3.8955560900689507`*^9, 
   3.895556090103936*^9}, {3.8985445159994154`*^9, 3.8985445295350947`*^9}, {
   3.898544768630147*^9, 3.898544770783824*^9}, {3.898544845876978*^9, 
   3.8985448459819126`*^9}, {3.951435687129704*^9, 3.951435687970985*^9}, {
   3.953346094544518*^9, 3.953346107061071*^9}, {3.9556824816774807`*^9, 
   3.9556824817023573`*^9}, {3.956193300260743*^9, 3.956193334263279*^9}, {
   3.9561978532916737`*^9, 3.9561978544264393`*^9}, {3.956198213415729*^9, 
   3.956198257150058*^9}},ExpressionUUID->"488ddccd-bdb8-411d-9891-\
a43103f14aba"]
}, Closed]],

Cell[CellGroupData[{

Cell["Library of Functions", "Section",
 CellChangeTimes->{{3.5203033786875*^9, 3.520303387109375*^9}, {
  3.7916001768949437`*^9, 
  3.7916001819092584`*^9}},ExpressionUUID->"0394dae6-59c8-4959-bedf-\
167b042a8955"],

Cell[CellGroupData[{

Cell["Tensor is the central object", "Subsection",
 CellChangeTimes->{{3.520303402640625*^9, 3.520303409640625*^9}, {
   3.520303686546875*^9, 3.52030371015625*^9}, 3.5213944835*^9, {
   3.5217854575625*^9, 3.521785460828125*^9}, {3.5338529240499988`*^9, 
   3.5338529272400036`*^9}, 
   3.5760884657172747`*^9},ExpressionUUID->"f58072ca-30c6-4a05-b9e6-\
4325729d624a"],

Cell[CellGroupData[{

Cell["Test2", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.957844063214994*^9, 
   3.957844064208447*^9}},ExpressionUUID->"4b413813-1f35-4aa5-8079-\
459098f6c260"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Test2", "[", "]"}], ":=", "\"\<Test2\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6698433615844946`*^9, 
   3.6698433880800104`*^9}, {3.669843474192936*^9, 3.6698434754330063`*^9}, {
   3.6698435353114314`*^9, 3.6698435357544565`*^9}, {3.875743971743964*^9, 
   3.8757439829660597`*^9}, {3.875747614296013*^9, 3.875747654883006*^9}, 
   3.8757477023229423`*^9, {3.8757479909925957`*^9, 3.875747991258222*^9}, {
   3.875752777800908*^9, 3.875752785114856*^9}, {3.8757602068070116`*^9, 
   3.8757602189517016`*^9}, {3.8861130176660748`*^9, 3.886113041948106*^9}, {
   3.8901990429958506`*^9, 3.8901990690527115`*^9}, 3.8950713769890904`*^9, {
   3.895555838066365*^9, 3.895555838071362*^9}, {3.9578440678621283`*^9, 
   3.9578440751832323`*^9}},ExpressionUUID->"6dcd0d12-64f0-4d29-bc8d-\
3c3181c5f049"]
}, Closed]],

Cell[CellGroupData[{

Cell["Tensor arguments (Reference only, no code)", "Subsubsection",
 CellChangeTimes->{{3.6063967822099867`*^9, 3.6063968013307805`*^9}, {
  3.6063968396278687`*^9, 3.606396846808979*^9}, {3.6063975362315702`*^9, 
  3.6063975388376102`*^9}, {3.6698379480379486`*^9, 3.6698379651247807`*^9}, {
  3.6719079737919607`*^9, 
  3.671907974041561*^9}},ExpressionUUID->"347f41c0-125f-4615-8eab-\
91074a82f150"],

Cell["\<\
The most general Tensor object contains the following arguments

Tensor[
\t TensorType \[Rule] _,
\tTensorName \[Rule] _,
\tIndices \[Rule]{___},
\t(*NewCode: New Property: TooltipStyle*)
\tTooltipDisplay \[Rule]_,
\tTooltipStyle \[Rule]_,
\tStartIndex\[Rule]si_Integer,
\tCoordinateSystem\[Rule]{coords__},
\tTensorComponents\[Rule]matrix_,
\tChristoffelComponents\[Rule]ChrisRules_,
\tMetricDeterminant\[Rule]Detg_,
\tRiemannComponents\[Rule]RiemRules_,
\tRicciComponents\[Rule]RicRules_,
\tRicciScalarInvariant\[Rule]RRules_,
\t(*NewCode: New Property: TensorSymmetry*)
\tTensorSymmetry\[Rule]tsdisplay_,
\t(*NewCode: New Property: OrthonormalFrameField*)
\tFlatMetric\[Rule]fm_,
\tOrthonormalFrameField\[Rule]onffuser_,
\tInverseOrthonormalFrameField\[Rule]invonffuser_,
\tOrthonormalFrameFieldOperator\[Rule]onffop_,
\tTestOrthonormalFrameField\[Rule]checkonff_,
\tTensorOperator\[Rule]#&,
\tTensorAssumption\[Rule]{TA_}
]\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.52062706340625*^9, {3.520627119109375*^9, 3.520627468984375*^9}, {
   3.5206275175625*^9, 3.520627645890625*^9}, {3.520627685671875*^9, 
   3.52062771053125*^9}, {3.520871722765625*^9, 3.5208718686875*^9}, {
   3.520871910671875*^9, 3.520872034078125*^9}, {3.5211465243125*^9, 
   3.521146592921875*^9}, {3.52169831134375*^9, 3.52169842040625*^9}, {
   3.521757643875*^9, 3.52175766646875*^9}, {3.533851610091141*^9, 
   3.5338517032134724`*^9}, {3.5338517361105185`*^9, 3.533851746077533*^9}, {
   3.5338517820915833`*^9, 3.5338517925207987`*^9}, {3.533851847610076*^9, 
   3.533851870463108*^9}, {3.5338519006333513`*^9, 3.533851943159811*^9}, {
   3.5338519863398733`*^9, 3.5338521403542914`*^9}, {3.5468009779741535`*^9, 
   3.5468011006215687`*^9}, {3.606085122492715*^9, 3.6060853016949644`*^9}, {
   3.6060859133179474`*^9, 3.606085916498129*^9}, {3.6061492735689363`*^9, 
   3.606149296602254*^9}, 3.606397519540814*^9, 3.629916429023525*^9, {
   3.847244257730279*^9, 3.8472442954109335`*^9}, {3.847244335067897*^9, 
   3.8472444168119583`*^9}, {3.8478536294293175`*^9, 
   3.8478536455474596`*^9}, {3.847965569065133*^9, 3.8479655838672867`*^9}, {
   3.8613232982289467`*^9, 3.8613233362820063`*^9}, {3.861323369629843*^9, 
   3.861323405496088*^9}, {3.8872470886921525`*^9, 3.887247129167467*^9}, 
   3.899114208633295*^9, 
   3.956199042431635*^9},ExpressionUUID->"716b76f7-1c47-4ae9-82fd-\
d41c62af3adf"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorType (Reference only, no code)", "Subsubsection",
 CellChangeTimes->{{3.6063967822099867`*^9, 3.6063968013307805`*^9}, {
  3.6063968396278687`*^9, 3.606396846808979*^9}, {3.6063975362315702`*^9, 
  3.6063975388376102`*^9}, {3.6698379480379486`*^9, 3.6698379651247807`*^9}, {
  3.6719079737919607`*^9, 3.671907974041561*^9}, {3.837838959782662*^9, 
  3.8378389663491554`*^9}},ExpressionUUID->"aae06da9-a5bf-477a-96de-\
902d8c8b5643"],

Cell["\<\
(*NewCode: Text for TensorType*)
Null (Default value for NonMetricTensor)
\[OpenCurlyDoubleQuote]Metric\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]ChristoffelSymbols\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]RiemannCurvatureTensor\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]RicciCurvatureTensor\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]WeylCurvatureTensor\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]EinsteinTensor\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]VolumeForm\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]LieDerivative\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]Faraday\[CloseCurlyDoubleQuote]
MHDSystem:
\[OpenCurlyDoubleQuote]Gradient\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]Maxwell\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MHDMaxwell\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]3-Form\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]2-Form\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MHDPlasma\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MHDMaxwellPlasma\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]MaxwellCurrent\[CloseCurlyDoubleQuote]
\[OpenCurlyDoubleQuote]Faraday\[CloseCurlyDoubleQuote]\
\>", "Text",
 InitializationCell->True,
 CellChangeTimes->{
  3.52062706340625*^9, {3.520627119109375*^9, 3.520627468984375*^9}, {
   3.5206275175625*^9, 3.520627645890625*^9}, {3.520627685671875*^9, 
   3.52062771053125*^9}, {3.520871722765625*^9, 3.5208718686875*^9}, {
   3.520871910671875*^9, 3.520872034078125*^9}, {3.5211465243125*^9, 
   3.521146592921875*^9}, {3.52169831134375*^9, 3.52169842040625*^9}, {
   3.521757643875*^9, 3.52175766646875*^9}, {3.533851610091141*^9, 
   3.5338517032134724`*^9}, {3.5338517361105185`*^9, 3.533851746077533*^9}, {
   3.5338517820915833`*^9, 3.5338517925207987`*^9}, {3.533851847610076*^9, 
   3.533851870463108*^9}, {3.5338519006333513`*^9, 3.533851943159811*^9}, {
   3.5338519863398733`*^9, 3.5338521403542914`*^9}, {3.5468009779741535`*^9, 
   3.5468011006215687`*^9}, {3.606085122492715*^9, 3.6060853016949644`*^9}, {
   3.6060859133179474`*^9, 3.606085916498129*^9}, {3.6061492735689363`*^9, 
   3.606149296602254*^9}, 3.606397519540814*^9, 3.629916429023525*^9, {
   3.8378389721195645`*^9, 3.8378390546689687`*^9}, {3.837839088777255*^9, 
   3.837839102753378*^9}, {3.8378394513540354`*^9, 3.837839452419655*^9}, {
   3.8378395321632004`*^9, 3.837839532379404*^9}, {3.8378406005332117`*^9, 
   3.8378406007494135`*^9}, {3.8378406777798877`*^9, 
   3.8378407402101974`*^9}, {3.837840824670477*^9, 3.8378408493262377`*^9}, {
   3.8378408901534643`*^9, 3.8378410023324246`*^9}, {3.8478331489380193`*^9, 
   3.8478331493371954`*^9}, {3.8478333480185733`*^9, 
   3.8478333484615726`*^9}, {3.895546122608015*^9, 3.8955461274002714`*^9}, {
   3.8991146823111343`*^9, 
   3.8991147034312716`*^9}},ExpressionUUID->"fc9f0a89-a684-46e6-a8c0-\
f326a0c35007"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric", "Subsubsection",
 CellChangeTimes->{{3.861141688680252*^9, 
  3.861141691869981*^9}},ExpressionUUID->"40e9b7b5-f29e-4b42-a7e9-\
fa207ff66c33"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox["Metric",
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->GrayLevel[0.5]]}], 
  StyleBox["\[IndentingNewLine]",
   FontColor->GrayLevel[0.5]], 
  RowBox[{
   StyleBox["(*",
    FontColor->GrayLevel[0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox[
    RowBox[{
    "this", " ", "is", " ", "how", " ", "we", " ", "are", " ", "going", " ", 
     "to", " ", "input", " ", "a", " ", "metric", " ", "and", " ", "compute", 
     " ", "geometric", " ", "objects"}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "There", " ", "are", " ", "more", " ", "TagSetDelay", " ", "can", " ", 
    "be", " ", "cancelled", " ", 
    RowBox[{"out", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StartIndex", "\[Rule]", 
         RowBox[{"si_Integer", "/;", 
          RowBox[{"si", "\[GreaterEqual]", "0"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Mu]T_", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                 "\[Mu]T", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "Symbol"}], 
               ")"}]}], ")"}]}], ",", 
           RowBox[{"\[Nu]T_", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TestIndices", "[", "\[Nu]T", "]"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", 
                 RowBox[{
                 "\[Nu]T", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "Symbol"}], 
               ")"}]}], ")"}]}]}], "}"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"CoordinateSystem", "\[Rule]", 
         RowBox[{"coords_List", "/;", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "coords", "]"}], ",", 
            RowBox[{"{", "_Integer", "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"matrix_", "/;", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "matrix", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"nn_", ",", "nn_"}], "}"}]}], "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelOperator", "\[Rule]", "ChrisOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannOperator", "\[Rule]", "RiemannOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciOperator", "\[Rule]", "RicciOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarOperator", "\[Rule]", "RicciSOp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"TooltipDisplay", " ", "for", " ", "metric"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", "ttdisplay_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"TooltipStyle", " ", "for", " ", "metric"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipStyle", "\[Rule]", "ttstyle_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameField", "\[Rule]", "onffuser_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonffuser_"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onffop_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TestOrthonormalFrameField", "\[Rule]", "checkonff_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "onffidx_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TensorAssumption", "\[Rule]", "TA_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TensorOperator", "\[Rule]", " ", "Top_"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SubMinus", "[", "_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
            RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
       ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "Detg", ",", "MetricT", ",", "MetricM", ",", "Ch", ",", "RiemannP", 
         ",", "Riemann", ",", "RicciT", ",", "RicciS", ",", "Metric", ",", 
         "MetricInv", ",", "\[IndentingNewLine]", "\t", "\[Alpha]", ",", 
         "\[Beta]", ",", "\[Mu]", ",", "\[Nu]", ",", "d", ",", "\[Lambda]", 
         ",", "\[Sigma]", ",", "coord", ",", "gInv", ",", 
         "\[IndentingNewLine]", "\t", "RiemannRules", ",", "RicciTensorRules",
          ",", "RicciScalarRule", ",", "ChristoffelRules"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<T\>\"", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"\"\<load\>\"", " ", "the", " ", "metric"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MetricM", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"lower", " ", "indices"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "matrix", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"upper", " ", "indices"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Inverse", "[", "matrix", "]"}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"for", " ", "internal", " ", "computation", " ", "here"}], 
          ",", " ", 
          RowBox[{
           RowBox[{"we", " ", "set", " ", "StartIndex"}], " ", "\[Rule]", " ",
            "0"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coord", "[", "\[Alpha]_", "]"}], ":=", 
         RowBox[{"coords", "\[LeftDoubleBracket]", 
          RowBox[{"\[Alpha]", "+", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "tools", " ", "to", " ", "compute", " ", "tensor", " ", 
          "components"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Detg", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{"Det", "[", "MetricM", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Metric", "[", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"MetricM", "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"\[Mu]", "+", "1"}], ",", 
           RowBox[{"\[Nu]", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MetricInv", "[", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Inverse", "[", "MetricM", "]"}], "\[LeftDoubleBracket]", 
          RowBox[{
           RowBox[{"\[Mu]", "+", "1"}], ",", 
           RowBox[{"\[Nu]", "+", "1"}]}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Ch", "[", 
          RowBox[{"\[Mu]_", ",", "\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "/", "2"}], ")"}], 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"MetricInv", "[", 
              RowBox[{"\[Mu]", ",", "\[Lambda]"}], "]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Metric", "[", 
                  RowBox[{"\[Beta]", ",", "\[Lambda]"}], "]"}], ",", 
                 RowBox[{"coord", "[", "\[Alpha]", "]"}]}], "]"}], "+", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Metric", "[", 
                  RowBox[{"\[Alpha]", ",", "\[Lambda]"}], "]"}], ",", 
                 RowBox[{"coord", "[", "\[Beta]", "]"}]}], "]"}], "-", 
               RowBox[{"D", "[", 
                RowBox[{
                 RowBox[{"Metric", "[", 
                  RowBox[{"\[Alpha]", ",", "\[Beta]"}], "]"}], ",", 
                 RowBox[{"coord", "[", "\[Lambda]", "]"}]}], "]"}]}], ")"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"\[Lambda]", ",", "0", ",", 
              RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RiemannP", "[", 
          RowBox[{
          "\[Alpha]_", ",", "\[Beta]_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{
            RowBox[{"Ch", "[", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Nu]"}], "]"}], ",", 
            RowBox[{"coord", "[", "\[Mu]", "]"}]}], "]"}], "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Ch", "[", 
              RowBox[{"\[Alpha]", ",", "\[Mu]", ",", "\[Sigma]"}], "]"}], 
             RowBox[{"Ch", "[", 
              RowBox[{"\[Sigma]", ",", "\[Beta]", ",", "\[Nu]"}], "]"}]}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]", ",", "0", ",", 
              RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Riemann", "[", 
          RowBox[{
          "\[Alpha]_", ",", "\[Beta]_", ",", "\[Mu]_", ",", "\[Nu]_"}], "]"}],
          ":=", 
         RowBox[{
          RowBox[{"RiemannP", "[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], 
           "]"}], "-", 
          RowBox[{"RiemannP", "[", 
           RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Nu]", ",", "\[Mu]"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"RicciT", "[", 
          RowBox[{"\[Beta]_", ",", "\[Nu]_"}], "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Riemann", "[", 
            RowBox[{"\[Mu]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], 
            "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        RowBox[{"RicciS", ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MetricInv", "[", 
             RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}], 
            RowBox[{"RicciT", "[", 
             RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Beta]", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "0", ",", 
             RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "start", " ", "from", " ", "the", " ", "empty", " ", "List"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"RiemannRules", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"RicciTensorRules", "=", 
         RowBox[{"{", "}"}]}], ";", 
        RowBox[{"ChristoffelRules", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "\"\<Do\>\"", " ", "the", " ", "computation", " ", "and", " ", 
          "save", " ", "as", " ", "rules"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Metric", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "=", 
           RowBox[{"Metric", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"MetricInv", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "=", 
           RowBox[{"MetricInv", "[", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Ch", "[", 
             RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], "=", 
            RowBox[{"ChrisOp", "[", 
             RowBox[{"Ch", "[", 
              RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}], 
             "]"}]}], ";", 
           RowBox[{"ChristoffelRules", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"ChristoffelRules", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"ChristoffelComponents", "[", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Mu]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Alpha]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Beta]"}], ")"}], "-"]}], "]"}], 
                "\[Rule]", 
                RowBox[{"Ch", "[", 
                 RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "\[Beta]"}], "]"}]}], 
               "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Riemann", "[", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}],
              "]"}], "=", 
            RowBox[{"RiemannOp", "[", 
             RowBox[{"Riemann", "[", 
              RowBox[{
              "\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], "]"}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"RiemannRules", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"RiemannRules", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RiemannComponents", "[", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Alpha]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Beta]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Mu]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Nu]"}], ")"}], "-"]}], "]"}], 
                "\[Rule]", 
                RowBox[{"Riemann", "[", 
                 RowBox[{
                 "\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]"}], 
                 "]"}]}], "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"RicciT", "[", 
             RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}], "=", 
            RowBox[{"RicciOp", "[", 
             RowBox[{"RicciT", "[", 
              RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciTensorRules", "=", 
            RowBox[{"Append", "[", 
             RowBox[{"RicciTensorRules", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"RicciComponents", "[", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Beta]"}], ")"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"(", 
                    RowBox[{"si", "+", "\[Nu]"}], ")"}], "-"]}], "]"}], 
                "\[Rule]", 
                RowBox[{"RicciT", "[", 
                 RowBox[{"\[Beta]", ",", "\[Nu]"}], "]"}]}], "}"}]}], 
             "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "0", ",", 
            RowBox[{"d", "-", "1"}]}], "}"}]}], "]"}], ";", "\n", "\t", 
        RowBox[{"RicciS", "=", 
         RowBox[{"RicciSOp", "[", "RicciS", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarRule", "=", 
         RowBox[{"{", 
          RowBox[{"RicciScalar", "\[Rule]", "RicciS"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "name"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"MetricDeterminant", "\[Rule]", "Detg"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"ChristoffelComponents", "\[Rule]", 
           RowBox[{"Flatten", "[", "ChristoffelRules", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RiemannComponents", "\[Rule]", 
           RowBox[{"Flatten", "[", "RiemannRules", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RicciComponents", "\[Rule]", 
           RowBox[{"Flatten", "[", "RicciTensorRules", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"RicciScalarInvariant", "\[Rule]", 
           RowBox[{"Flatten", "[", "RicciScalarRule", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{"TooltipDisplay", " ", "for", " ", "metric"}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", "ttdisplay"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", "ttstyle"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"FlatMetric", "\[Rule]", "fm"}], ",", "\[IndentingNewLine]", 
          RowBox[{"OrthonormalFrameField", "\[Rule]", "onffuser"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonffuser"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onffop"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"TestOrthonormalFrameField", "\[Rule]", "checkonff"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "onffidx"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TensorAssumption", "\[Rule]", "TA"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TensorOperator", "\[Rule]", " ", "Top"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"Metric", ":", " ", 
      RowBox[{
      "If", " ", "one", " ", "up", " ", "and", " ", "one", " ", "down", " ", 
       "index", " ", "TensorName", " ", "is", " ", "changed", " ", "to", " ", 
       "\[Delta]"}]}],
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "this", " ", "is", " ", "also", " ", "good", " ", "reminder", " ", "that",
      " ", "going", " ", "to", " ", "one", " ", "up", " ", "one", " ", "down",
      " ", "indices", " ", "throws", " ", "away", " ", "info", " ", "on", " ",
      "the", " ", "metric", " ", "itself"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xx___", ",", "\[IndentingNewLine]", 
       RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"i1_", ",", "i2_"}], "}"}], "/;", 
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"one", " ", "up", " ", "and", " ", "one", " ", "down"}], 
           " ", "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "i1", "]"}], 
            RowBox[{"Sgn", "[", "i2", "]"}]}], "===", 
           RowBox[{"-", "1"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", 
        RowBox[{"name_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
            "name", "=!=", 
             "\"\<\!\(\*StyleBox[\"\[Delta]\",FontSlant->\"Italic\"]\)\>\""}],
             ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"name", "=!=", "\"\<\[Delta]\>\""}], ")"}]}], ")"}]}]}]}],
       "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{"Tensor", "[", 
      RowBox[{"xx", ",", 
       RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"i1", ",", "i2"}], "}"}]}], ",", 
       RowBox[{"TensorName", "\[Rule]", "\"\<\[Delta]\>\""}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.671909243404647*^9}, {3.8314389647190886`*^9, 3.8314389695190797`*^9}, {
   3.8381876185176935`*^9, 3.8381876483954706`*^9}, {3.838188300545725*^9, 
   3.83818832283567*^9}, {3.8381883598456235`*^9, 3.83818836003572*^9}, {
   3.8478338190759087`*^9, 3.8478338615757675`*^9}, {3.847837673865692*^9, 
   3.847837710807616*^9}, {3.84783786346992*^9, 3.8478378789087687`*^9}, {
   3.8478379621019382`*^9, 3.84783796230793*^9}, {3.8594556010909963`*^9, 
   3.8594556270319986`*^9}, {3.8594556912480097`*^9, 
   3.8594557104970093`*^9}, {3.8594561480244203`*^9, 
   3.8594562822380867`*^9}, {3.8594588522664633`*^9, 
   3.8594589674004693`*^9}, {3.859459212905465*^9, 3.8594592274004707`*^9}, {
   3.85945927091247*^9, 3.8594593400334635`*^9}, {3.8594593798404655`*^9, 
   3.8594594355004625`*^9}, {3.8594604392974176`*^9, 3.859460459866928*^9}, {
   3.8594605543879423`*^9, 3.8594606948087983`*^9}, {3.859461213092307*^9, 
   3.859461312972269*^9}, {3.859461456083396*^9, 3.8594615505012484`*^9}, {
   3.859462220633724*^9, 3.8594622279563*^9}, {3.859462474337384*^9, 
   3.859462479394371*^9}, {3.859462877545724*^9, 3.8594629057664413`*^9}, 
   3.859462996333089*^9, 3.8594635922714834`*^9, 3.8594636340681467`*^9, {
   3.8594637438873477`*^9, 3.859463791885425*^9}, {3.8594639699825983`*^9, 
   3.859463993630597*^9}, {3.8594640780306993`*^9, 3.859464080788702*^9}, {
   3.859464160341225*^9, 3.8594641705877085`*^9}, {3.859507550099011*^9, 
   3.859507582307036*^9}, {3.859508906543721*^9, 3.859508907902869*^9}, {
   3.8595090210468235`*^9, 3.8595090622782507`*^9}, {3.8595093108548994`*^9, 
   3.859509325919695*^9}, 3.8595094056896963`*^9, 3.8595094801925726`*^9, {
   3.859509553449321*^9, 3.85950956355905*^9}, {3.8595096368638353`*^9, 
   3.85950964812885*^9}, {3.8595099036070156`*^9, 3.8595099071768007`*^9}, {
   3.859510171019932*^9, 3.8595101711688385`*^9}, {3.859510568356614*^9, 
   3.85951056850852*^9}, {3.859510610515703*^9, 3.859510640261258*^9}, {
   3.859510712571088*^9, 3.8595107385160027`*^9}, 3.8595142673511114`*^9, {
   3.8595149548109922`*^9, 3.8595149817355723`*^9}, {3.8595150236977634`*^9, 
   3.8595150302927055`*^9}, 3.8595150839917297`*^9, {3.8595151326769953`*^9, 
   3.859515159452526*^9}, {3.859600557376666*^9, 3.859600592054014*^9}, {
   3.8596006562025523`*^9, 3.859600672454644*^9}, {3.8596008393259487`*^9, 
   3.8596008479064274`*^9}, {3.8596008806649933`*^9, 
   3.8596009087814913`*^9}, {3.859601104999363*^9, 3.85960112035612*^9}, {
   3.859601258427606*^9, 3.8596012586579933`*^9}, 3.85960143303165*^9, {
   3.859601531071765*^9, 3.8596015701271353`*^9}, {3.859601625403966*^9, 
   3.859601658867322*^9}, {3.8596019123143167`*^9, 3.859601920014387*^9}, 
   3.859602009077052*^9, {3.8596020465958467`*^9, 3.85960212841488*^9}, {
   3.8596077214275875`*^9, 3.8596077576714063`*^9}, {3.859607805462963*^9, 
   3.8596078264650097`*^9}, {3.859607858844967*^9, 3.8596078748131227`*^9}, 
   3.8596079059100637`*^9, {3.859608163862884*^9, 3.859608176478674*^9}, {
   3.8596082185277414`*^9, 3.8596082476387873`*^9}, {3.860063972092306*^9, 
   3.8600639884144163`*^9}, {3.860064082136467*^9, 3.8600640835361605`*^9}, 
   3.860064367934267*^9, {3.8600644779513025`*^9, 3.860064482708833*^9}, {
   3.860064825521562*^9, 3.8600648282413807`*^9}, 3.8600650189116974`*^9, {
   3.8600651437893195`*^9, 3.8600651469514074`*^9}, {3.860065200041277*^9, 
   3.8600652141611476`*^9}, {3.860065257544154*^9, 3.8600652593173056`*^9}, {
   3.8600653105208073`*^9, 3.8600653114114046`*^9}, 3.860065360031438*^9, {
   3.8600654144515057`*^9, 3.8600654234212255`*^9}, {3.860065481256881*^9, 
   3.8600655021013365`*^9}, {3.8600655707474833`*^9, 
   3.8600655709512434`*^9}, {3.860065621258689*^9, 3.860065626021537*^9}, 
   3.860065827771549*^9, {3.860065888701377*^9, 3.8600658949912596`*^9}, 
   3.8600659707712946`*^9, {3.860066226471365*^9, 3.860066230563578*^9}, 
   3.860066561855797*^9, {3.860066633315779*^9, 3.8600666334833145`*^9}, {
   3.860066831205914*^9, 3.860066837362755*^9}, 3.860066904575856*^9, {
   3.860067011375463*^9, 3.8600670459227915`*^9}, {3.8600671050154624`*^9, 
   3.860067143915722*^9}, {3.860108033143886*^9, 3.860108038521595*^9}, {
   3.8601080784992657`*^9, 3.8601080806086054`*^9}, {3.860111427849783*^9, 
   3.860111430193488*^9}, {3.8601115741591253`*^9, 3.8601115996513686`*^9}, {
   3.8605777818345966`*^9, 3.8605778138716097`*^9}, {3.8605779482572412`*^9, 
   3.860577949080242*^9}, {3.86057883081254*^9, 3.8605788610685387`*^9}, {
   3.861332239829957*^9, 3.861332266331642*^9}, {3.8617699152950683`*^9, 
   3.861769920729446*^9}, 3.8619263315662594`*^9, {3.8870173985236807`*^9, 
   3.8870174363630733`*^9}, {3.8955547737024174`*^9, 
   3.8955547737104106`*^9}, {3.956199042446658*^9, 
   3.956199042455611*^9}},ExpressionUUID->"55cfa897-81b7-4dd3-958b-\
b5eff504d035"]
}, Closed]],

Cell[CellGroupData[{

Cell["Eigensystem", "Subsubsection",
 CellChangeTimes->{{3.8991744790285034`*^9, 
  3.899174483778578*^9}},ExpressionUUID->"fd508f6f-e15c-4d3c-8ca6-\
88cad961051f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Second", " ", "strategy", " ", "of", " ", "ONFF"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tensor", "/:", 
    RowBox[{"Eigensystem", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Eigensystem", "[", 
     RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8991744805625577`*^9, 3.8991744805835476`*^9}, {
  3.8991799365535846`*^9, 
  3.8991799438111134`*^9}},ExpressionUUID->"ed628348-f31e-4a9b-ba50-\
421e43ee81c2"]
}, Closed]],

Cell[CellGroupData[{

Cell["OrthonormalFrameField", "Subsubsection",
 CellChangeTimes->{{3.8611417830099425`*^9, 
  3.8611417898900027`*^9}},ExpressionUUID->"ee3581fd-c267-4aa2-b53e-\
618eedbcc19a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["OrthonormalFrameField",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   StyleBox[
    RowBox[{"OrthonormalFrameField", " ", "Tensor", " ", "part"}],
    FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"The", " ", 
        StyleBox["pattern",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["check",
         FontColor->RGBColor[1, 0, 1]], " ", "here", " ", "take", " ", "care",
         " ", "of", " ", "pattern", " ", "checking", " ", 
        RowBox[{
         StyleBox["efficiency",
          FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"xx__", "/;", 
       RowBox[{"(", 
        RowBox[{"(*", 
         RowBox[{"Check", " ", 
          StyleBox["ChristoffelComponents",
           FontColor->RGBColor[1, 0, 1]], " ", "is", " ", "to", " ", "ensure",
           " ", "we", " ", "finished", " ", "all", " ", 
          StyleBox["basic",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["calculation",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "xx", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ChristoffelComponents", "\[Rule]", "cc_"}], ")"}], 
              "\[Rule]", "cc"}], ",", "1"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IndicesNoPart", "[", 
            RowBox[{"{", "xx", "}"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "xx", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
              "\[Rule]", "tc"}], ",", "1"}], "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TensorTypeNoPart", "[", 
            RowBox[{"{", "xx", "}"}], "]"}], "===", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            StyleBox["FlatMetric",
             FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
            StyleBox["not",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["Null",
             FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "a", " ", 
            StyleBox["Rank",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["1",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "will", 
            " ", "diagnalize", " ", "it", " ", "and", " ", "make", " ", "it", 
            " ", "become", " ", "a", " ", "Rank"}], "-", 
           RowBox[{"2", " ", "matrix", " ", "so", " ", "that", " ", "it", " ", 
            RowBox[{"won", "'"}], "t", " ", "macth", " ", "the", " ", 
            "pattern", " ", 
            RowBox[{"again", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "xx", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
              "fm"}], ",", "1"}], "]"}], "=!=", 
           RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ComponentRankNumber", "[", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xx", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
                "fm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["OrthonormalFrameFieldOperator",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"shouldn", "'"}], "t", " ", "be", " ", 
           RowBox[{
            StyleBox["Null",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "Its"}], " ", "defualt",
            " ", "value", " ", "is", " ", 
           RowBox[{
            StyleBox["Simplify",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "will", 
           " ", "make", " ", "it", " ", "becomes", " ", "Null", " ", "at", 
           " ", "the", " ", 
           RowBox[{"end", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "xx", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "OrthonormalFrameFieldOperator", "\[Rule]", "onffop_"}], ")"}],
               "\[Rule]", "onffop"}], ",", "1"}], "]"}], "=!=", 
           RowBox[{"{", "Null", "}"}]}], ")"}], "&&", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TestOrthonormalFrameField",
            FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "only", " ", 
           "be", " ", 
           StyleBox["True",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["or",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["False",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "Its"}], " ", "defualt",
            " ", "value", " ", "is", " ", 
           RowBox[{
            StyleBox["False",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "will", 
           " ", "make", " ", "it", " ", "becomes", " ", "Null", " ", "at", 
           " ", "the", " ", 
           RowBox[{"end", "."}]}], "*)"}], 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xx", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TestOrthonormalFrameField", "\[Rule]", "conff_"}], 
                 ")"}], "\[Rule]", "conff"}], ",", "1"}], "]"}], "]"}], ")"}],
            ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", "True", "}"}], "|", 
             RowBox[{"{", "False", "}"}]}], ")"}]}], "]"}]}], ")"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "eigens", ",", "Flatmetric", ",", "g", ",", "ginv", ",", "d", ",", 
         "rotm", ",", "valuesqrt", ",", "ONFFm", ",", "ONFFinvm", ",", 
         "output", ",", "onff", ",", "invonff", ",", "idx", ",", "matrix", 
         ",", "onffop", ",", "fm", ",", "cc", ",", "checkonff", ",", "tempm", 
         ",", "ONFFt", ",", "ONFFinvt", ",", "\[Alpha]", ",", "\[Mu]", ",", 
         "coord", ",", "onffidx", ",", "ONFFtidx", ",", "ONFFinvtidx", ",", 
         "i"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{"Extract", " ", "arguments"}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{"Indices", "[", 
          RowBox[{"{", "xx", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"matrix", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"{", "xx", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"fm", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
             "cc"}], ",", "\[Infinity]"}], "]"}], "\[LeftDoubleBracket]", "1",
           "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "fm", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"onff", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "cc_"}], ")"}], 
             "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"invonff", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "cc_"}], 
              ")"}], "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"onffop", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "cc_"}], 
              ")"}], "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"checkonff", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TestOrthonormalFrameField", "\[Rule]", "cc_"}], ")"}], 
             "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"coord", "=", 
         RowBox[{"Coordinates", "[", 
          RowBox[{"{", "xx", "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"onffidx", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xx", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "cc_"}], 
              ")"}], "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", " ", "we", " ", "have", " ", 
           StyleBox[
            SubscriptBox["g", "ab"],
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"we", " ", "should", " ", "calculate", " ", 
           RowBox[{
            StyleBox[
             SuperscriptBox["g", "ab"],
             FontColor->RGBColor[1, 0, 1]], ".", " ", "vice"}], " ", 
           "versa"}], ",", " ", 
          RowBox[{"if", " ", "we", " ", "have", " ", 
           StyleBox[
            SuperscriptBox["g", "ab"],
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"we", " ", "should", " ", "calculate", " ", 
           RowBox[{
            StyleBox[
             SubscriptBox["g", "ab"],
             FontColor->RGBColor[1, 0, 1]], ".", " ", "it"}], " ", "shares", 
           " ", "same", " ", 
           StyleBox["operator",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"w", "/", " ", 
            RowBox[{"OrthonormalFrameField", "."}]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{"idx", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SubMinus", "[", "_", "]"}], ",", 
              RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"g", "=", "matrix"}], ";", 
           RowBox[{"ginv", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
             ")"}]}]}], ",", 
          RowBox[{"MatchQ", "[", 
           RowBox[{"idx", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
              RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
          RowBox[{
           RowBox[{"ginv", "=", "matrix"}], ";", 
           RowBox[{"g", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
             ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["DiagonalMatrix",
           FontColor->RGBColor[1, 0, 1]], " ", "on", " ", 
          StyleBox["FlatMetric",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Flatmetric", "=", 
         RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"DiagonalMatrixQ", "[", "g", "]"}], ",", 
          RowBox[{
           RowBox[{"ONFFm", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                  "fm", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"g", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], 
                RowBox[{"(*", 
                 RowBox[{"//", "onffop"}], "*)"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"ONFFinvm", "=", 
            RowBox[{"DiagonalMatrix", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Sqrt", "[", 
                 RowBox[{
                  RowBox[{
                  "fm", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], " ", 
                  RowBox[{"ginv", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "i"}], "\[RightDoubleBracket]"}]}], 
                 "]"}], 
                RowBox[{"(*", 
                 RowBox[{"//", "onffop"}], "*)"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "]"}]}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{"!", 
            RowBox[{"DiagonalMatrixQ", "[", "g", "]"}]}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"onff", "===", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"invonff", "===", "Null"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", "user", " ", 
                RowBox[{"don", "'"}], "t", " ", "offer", " ", 
                StyleBox["OrthonormalFrameField",
                 FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
                StyleBox["InverseOrthonormalFrameField",
                 FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
               RowBox[{"we", " ", "should", " ", "use", " ", 
                StyleBox["Eigensystem",
                 FontColor->RGBColor[1, 0, 1]], " ", "to", " ", "calculate", 
                " ", "both", " ", "of", " ", 
                RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             "\t", 
             RowBox[{
              RowBox[{"eigens", "=", 
               RowBox[{"Eigensystem", "[", "g", "]"}]}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"rotm", "=", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Normalize", "[", 
                    RowBox[{"eigens", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], "]"}],
                    "//", "onffop"}], ")"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"valuesqrt", "=", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sqrt", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"(", 
                   RowBox[{"Flatmetric", ".", 
                    RowBox[{
                    "eigens", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "//", 
                "onffop"}]}], ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"ONFFm", "=", 
               RowBox[{"(", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "valuesqrt", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], " ", 
                   RowBox[{
                   "rotm", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], ")"}]}],
               ";", "\[IndentingNewLine]", "\t", 
              RowBox[{"ONFFinvm", "=", 
               RowBox[{"Flatmetric", ".", "ONFFm", ".", "ginv"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "user", " ", "offer", " ", "at", " ", "least", " ", 
                "one"}], ",", " ", 
               RowBox[{
               "we", " ", "utilize", " ", "it", " ", "to", " ", "get", " ", 
                "the", " ", 
                RowBox[{"other", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"onff", "=!=", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"invonff", "===", "Null"}], ")"}]}], ",", 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"ONFFm", "=", "onff"}], ";", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               StyleBox[
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox[
                   StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                   OverscriptBox["a", "^"]], "b"], "=", 
                 RowBox[{
                  SubscriptBox["\[Eta]", "ad"], 
                  SubscriptBox[
                   SuperscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["d", "^"]], "c"], 
                  SuperscriptBox["g", "cb"]}]}],
                FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"ONFFinvm", "=", 
               RowBox[{"Flatmetric", ".", "onff", ".", "ginv"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"onff", "===", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"invonff", "=!=", "Null"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"ONFFinvm", "=", "invonff"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               StyleBox[
                RowBox[{
                 SubscriptBox[
                  SuperscriptBox[
                   StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                   OverscriptBox["d", "^"]], "c"], "=", 
                 RowBox[{
                  SuperscriptBox["\[Eta]", "da"], 
                  SuperscriptBox[
                   SubscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["a", "^"]], "b"], 
                  SubscriptBox["g", "bc"]}]}],
                FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
              "\t", 
              RowBox[{"ONFFm", "=", 
               RowBox[{"Flatmetric", ".", "invonff", ".", "g"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{
               "If", " ", "user", " ", "offer", " ", "both", " ", "of", " ", 
                "them"}], ",", " ", 
               RowBox[{"we", " ", "use", " ", 
                RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"onff", "=!=", "Null"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"invonff", "=!=", "Null"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"ONFFm", "=", "onff"}], ";", 
              RowBox[{"ONFFinvm", "=", "invonff"}]}]}], "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"ONFFm", "=", 
         RowBox[{"(", 
          RowBox[{"ONFFm", "//", "onffop"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ONFFinvm", "=", 
         RowBox[{"(", 
          RowBox[{"ONFFinvm", "//", "onffop"}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Declare", " ", 
          StyleBox["OrthonormalFrameField",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], "as", " ", "a", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["Tensor",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{"object", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ONFFtidx", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
               ")"}], "===", 
              RowBox[{"{", 
               RowBox[{"Symbol", ",", "Symbol"}], "}"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox[
              OverscriptBox[
               RowBox[{
               "onffidx", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "^"], "-"], ",", 
             SubscriptBox[
              RowBox[{
              "onffidx", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox[
              OverscriptBox["\[Alpha]", "^"], "-"], ",", 
             SubscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ONFFinvtidx", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
               ")"}], "===", 
              RowBox[{"{", 
               RowBox[{"Symbol", ",", "Symbol"}], "}"}]}], ")"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              RowBox[{"(", 
               OverscriptBox[
                RowBox[{
                "onffidx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "^"], ")"}], "-"], ",", 
             SuperscriptBox[
              RowBox[{
              "onffidx", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox[
              OverscriptBox["\[Alpha]", "^"], "-"], ",", 
             SuperscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ONFFt", "=", 
           RowBox[{
            RowBox[{
            "{", "\[IndentingNewLine]", "xx", "\[IndentingNewLine]", "}"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}],
                  "\[Rule]", "Nothing"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], ")"}],
                  "\[Rule]", "Nothing"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "OrthonormalFrameFieldOperator", "\[Rule]", "oop_"}], ")"}],
                  "\[Rule]", "Nothing"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TestOrthonormalFrameField", "\[Rule]", "conf_"}], 
                  ")"}], "\[Rule]", "Nothing"}], ","}], "*)"}], 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
               " ", "Nothing"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TensorName", "\[Rule]", "\"\<\[CurlyEpsilon]\>\""}], 
                ")"}]}], " ", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", 
               " ", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "ONFFtidx"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
               "\[Rule]", " ", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "ONFFm"}], ")"}]}]}], 
             RowBox[{"(*", 
              RowBox[{",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"MetricDeterminant", "\[Rule]", "md_"}], ")"}], 
                "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"ChristoffelComponents", "\[Rule]", "ccc_"}], ")"}], 
                "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RiemannComponents", "\[Rule]", "rc_"}], ")"}], 
                "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RicciComponents", "\[Rule]", "ric_"}], ")"}], 
                "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"RicciScalarInvariant", "\[Rule]", "rsi_"}], ")"}], 
                "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                 "OrthonormalFrameFieldIndices", "\[Rule]", "onffidxxx_"}], 
                 ")"}], "\[Rule]", "Nothing"}]}], " ", "*)"}], "}"}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ONFFt", "=", 
         RowBox[{
          RowBox[{
          "{", "\[IndentingNewLine]", "xx", "\[IndentingNewLine]", "}"}], "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
             "Nothing"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
             "\[Rule]", "Nothing"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
              ")"}], "\[Rule]", "Nothing"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "oop_"}], 
              ")"}], "\[Rule]", "Nothing"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TestOrthonormalFrameField", "\[Rule]", "conf_"}], 
              ")"}], "\[Rule]", "Nothing"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", " ",
              "Nothing"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "\"\<\[CurlyEpsilon]\>\""}], 
              ")"}]}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ONFFtidx"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
             "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "ONFFm"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MetricDeterminant", "\[Rule]", "md_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ChristoffelComponents", "\[Rule]", "ccc_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RiemannComponents", "\[Rule]", "rc_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RicciComponents", "\[Rule]", "ric_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RicciScalarInvariant", "\[Rule]", "rsi_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "OrthonormalFrameFieldIndices", "\[Rule]", "onffidxxx_"}], 
              ")"}], "\[Rule]", "Nothing"}]}], " ", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ONFFinvt", "=", 
         RowBox[{"ONFFt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ONFFinvtidx"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], 
             "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "ONFFinvm"}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ONFFt", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Tensor", ",", "ONFFt"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ONFFinvt", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"Tensor", ",", "ONFFinvt"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"ONFFt", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
            "ONFFtidx", ",", "\[IndentingNewLine]", "ONFFm", ",", 
             "\"\<\[CurlyEpsilon]\>\"", ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", "coord"}]}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"ONFFinvt", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
            "ONFFinvtidx", ",", "\[IndentingNewLine]", "ONFFinvm", ",", 
             "\"\<\[CurlyEpsilon]\>\"", ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", "coord"}]}], "]"}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Replace", " ", 
          RowBox[{"w", "/", " ", "calculation"}], " ", 
          RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tempm", "=", 
         RowBox[{"ReleaseHold", "[", 
          RowBox[{"(*", 
           RowBox[{
            StyleBox["Hold",
             FontColor->RGBColor[1, 0, 1]], " ", "first", " ", "and", " ", 
            RowBox[{"replace", ".", " ", "To"}], " ", "avoid", " ", "trigger",
             " ", "initial", " ", "pattern", " ", "and", " ", "create", " ", 
            "infinte", " ", 
            RowBox[{"loop", "."}]}], "*)"}], 
          RowBox[{
           RowBox[{"Hold", "[", 
            RowBox[{
            "Tensor", "[", "\[IndentingNewLine]", "xx", "\[IndentingNewLine]",
              "]"}], "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFt"}], ")"}]}],
              ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
               ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
               "InverseOrthonormalFrameField", "\[Rule]", "ONFFinvt"}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "oop_"}], 
               ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Null"}], 
               ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TestOrthonormalFrameField", "\[Rule]", "conf_"}], 
               ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TestOrthonormalFrameField", "\[Rule]", "Null"}], 
               ")"}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"{", 
          RowBox[{"ONFFt", ",", "ONFFinvt", ",", "tempm"}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"checkonff", "===", "True"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"Append", "[", 
            RowBox[{
             RowBox[{"Append", "[", 
              RowBox[{"output", ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                StyleBox[
                 RowBox[{
                  SubscriptBox["g", "cd"], "=", 
                  RowBox[{
                   SubscriptBox[
                    SuperscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["a", "^"]], "c"], 
                   FormBox[
                    SubscriptBox["\[Eta]", "ab"],
                    TraditionalForm], 
                   SubscriptBox[
                    SuperscriptBox["\[CurlyEpsilon]", 
                    OverscriptBox["b", "^"]], "d"]}]}],
                 FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Transpose", "[", "ONFFm", "]"}], ".", 
                   "Flatmetric", ".", "ONFFm"}], "\[Equal]", "g"}], ")"}], "//",
                 "onffop"}]}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              StyleBox[
               RowBox[{
                SubscriptBox["\[Eta]", "cd"], "=", 
                RowBox[{
                 SuperscriptBox[
                  SubscriptBox[
                   StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                   OverscriptBox["c", "^"]], "a"], 
                 FormBox[
                  SubscriptBox["g", "ab"],
                  TraditionalForm], 
                 SuperscriptBox[
                  SubscriptBox["\[CurlyEpsilon]", 
                   OverscriptBox["d", "^"]], "b"]}]}],
               FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ONFFinvm", ".", "g", ".", 
                  RowBox[{"Transpose", "[", "ONFFinvm", "]"}]}], "==", 
                 "Flatmetric"}], ")"}], "//", "onffop"}], ")"}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "Start"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Bad", " ", "pattern", " ", "matching", " ", "slow", " ", "down", " ", 
     RowBox[{"dramatically", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xx___", ",", "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "idx_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelComponents", "\[Rule]", "cc_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FlatMetric", "\[Rule]", 
         RowBox[{"fm_", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fm", "=!=", "Null"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ComponentRankNumber", "[", "fm", "]"}], "===", "1"}], 
             ")"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameField", "\[Rule]", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "Null"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"OrthonormalFrameField", "\[Rule]", 
           RowBox[{"onff_", "/;", 
            RowBox[{"(", 
             RowBox[{"onff", "===", "Null"}], ")"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
           RowBox[{"invonff_", "/;", 
            RowBox[{"(", 
             RowBox[{"invonff", "===", "Null"}], ")"}]}]}], ","}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
         RowBox[{"onffop_", "/;", 
          RowBox[{"(", 
           RowBox[{"onffop", "=!=", "Null"}], ")"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
         RowBox[{"checkonff_", "/;", 
          RowBox[{"(", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"checkonff", ",", 
             RowBox[{"(", 
              RowBox[{"True", "|", "False"}], ")"}]}], "]"}], ")"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "eigens", ",", "Flatmetric", ",", "g", ",", "ginv", ",", "d", ",", 
          "rotm", ",", "valuesqrt", ",", "ONFFm", ",", "ONFFinvm", ",", 
          "output"}], "}"}], ",", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"g", "=", "matrix"}], ";", 
            RowBox[{"ginv", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
              ")"}]}]}], ",", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"ginv", "=", "matrix"}], ";", 
            RowBox[{"g", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Flatmetric", "=", 
          RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigens", "=", 
          RowBox[{"Eigensystem", "[", "g", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Length", "[", "fm", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rotm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"eigens", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], "]"}], "//",
               "onffop"}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"valuesqrt", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Flatmetric", ".", 
               RowBox[{
               "eigens", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "//", 
           "onffop"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFm", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "valuesqrt", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{
               "rotm", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "//", 
            "onffop"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFinvm", "=", 
          RowBox[{"Flatmetric", ".", "ONFFm", ".", "ginv"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"output", "=", 
          RowBox[{"{", 
           RowBox[{"ONFFm", ",", "ONFFinvm", ",", 
            RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
             RowBox[{"xx", ",", "\[IndentingNewLine]", 
              RowBox[{"Indices", "\[Rule]", "idx"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TensorComponents", "\[Rule]", "matrix"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"ChristoffelComponents", "\[Rule]", "cc"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"FlatMetric", "\[Rule]", "fm"}], ","}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFm"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ONFFinvm"}],
               ",", "\[IndentingNewLine]", 
              RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Null"}], 
              ",", "\[IndentingNewLine]", 
              RowBox[{"TestOrthonormalFrameField", "\[Rule]", "Null"}]}], 
             "\[IndentingNewLine]", "]"}]}], "}"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"checkonff", "===", "True"}], ",", 
           RowBox[{"output", "=", 
            RowBox[{"Append", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"output", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Transpose", "[", "ONFFm", "]"}], ".", 
                    "Flatmetric", ".", "ONFFm"}], "\[Equal]", "g"}], ")"}], "//",
                  "onffop"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ONFFm", ".", "ginv", ".", 
                  RowBox[{"Transpose", "[", "ONFFm", "]"}]}], "\[Equal]", 
                 "Flatmetric"}], ")"}], "//", "onffop"}]}], "]"}]}]}], "]"}], 
         ";", "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xx___", ",", "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "idx_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelComponents", "\[Rule]", "cc_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FlatMetric", "\[Rule]", 
         RowBox[{"fm_", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"fm", "=!=", "Null"}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"ComponentRankNumber", "[", "fm", "]"}], "===", "1"}], 
             ")"}]}], ")"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onffop_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
         RowBox[{"checkonff_", "/;", 
          RowBox[{"(", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"checkonff", ",", 
             RowBox[{"(", 
              RowBox[{"True", "|", "False"}], ")"}]}], "]"}], ")"}]}]}]}], 
       "\[IndentingNewLine]", "]"}], ":=", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "Flatmetric", ",", "g", ",", "ginv", ",", "rotm", ",", "valuesqrt", 
           ",", "ONFFm", ",", "ONFFinvm", ",", "output"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{"idx", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SubMinus", "[", "_", "]"}], ",", 
                RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"g", "=", "matrix"}], ";", 
             RowBox[{"ginv", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
               ")"}]}]}], ",", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"idx", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
                RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"ginv", "=", "matrix"}], ";", 
             RowBox[{"g", "=", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
               ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Flatmetric", "=", 
           RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"onff", "=!=", "Null"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"invonff", "===", "Null"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"ONFFm", "=", "onff"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ONFFinvm", "=", 
              RowBox[{"Flatmetric", ".", "onff", ".", "ginv"}]}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"onff", "===", "Null"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"invonff", "=!=", "Null"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"ONFFinvm", "=", "invonff"}], ";", "\[IndentingNewLine]", 
             RowBox[{"ONFFm", "=", 
              RowBox[{"Flatmetric", ".", "invonff", ".", "g"}]}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"onff", "=!=", "Null"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"invonff", "=!=", "Null"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"ONFFm", "=", "onff"}], ";", 
             RowBox[{"ONFFinvm", "=", "invonff"}]}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"output", "=", 
           RowBox[{"{", 
            RowBox[{"ONFFm", ",", "ONFFinvm", ",", 
             RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
              RowBox[{"xx", ",", "\[IndentingNewLine]", 
               RowBox[{"Indices", "\[Rule]", "idx"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TensorComponents", "\[Rule]", "matrix"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ChristoffelComponents", "\[Rule]", "cc"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFm"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
               "InverseOrthonormalFrameField", "\[Rule]", "ONFFinvm"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Null"}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{"TestOrthonormalFrameField", "\[Rule]", "Null"}]}], 
              "\[IndentingNewLine]", "]"}]}], "}"}]}], ";", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"checkonff", "===", "True"}], ",", 
            RowBox[{"output", "=", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"output", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Transpose", "[", "ONFFm", "]"}], ".", 
                    "Flatmetric", ".", "ONFFm"}], "\[Equal]", "g"}], ")"}], "//",
                   "onffop"}]}], "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ONFFm", ".", "ginv", ".", 
                   RowBox[{"Transpose", "[", "ONFFm", "]"}]}], "\[Equal]", 
                  "Flatmetric"}], ")"}], "//", "onffop"}]}], "]"}]}]}], "]"}],
           ";", "\[IndentingNewLine]", "output"}]}], "\[IndentingNewLine]", 
        "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"onffop", "===", "Null"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"invonff", "===", "Null"}], ")"}]}], ")"}]}], ")"}]}]}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "End"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8601080522590923`*^9, 3.8601081081782317`*^9}, {
   3.860108811512925*^9, 3.8601088371643662`*^9}, {3.8601095812633944`*^9, 
   3.860109581732105*^9}, {3.8601101383349247`*^9, 3.8601101387255373`*^9}, 
   3.8601101930271015`*^9, {3.86011035996247*^9, 3.860110371228373*^9}, {
   3.8601104262791476`*^9, 3.8601104782863235`*^9}, {3.8601105112798724`*^9, 
   3.860110546463823*^9}, {3.860110590503169*^9, 3.8601108217131147`*^9}, {
   3.8601109130146365`*^9, 3.8601109130615134`*^9}, {3.8601109455241995`*^9, 
   3.86011096347215*^9}, 3.860111054501237*^9, {3.8601116091614213`*^9, 
   3.860111646034217*^9}, {3.860111755837822*^9, 3.8601117804486065`*^9}, {
   3.860112181427363*^9, 3.8601123158824863`*^9}, {3.860112482889504*^9, 
   3.8601124983706427`*^9}, {3.86011312294491*^9, 3.8601131953905745`*^9}, 
   3.8601136846374483`*^9, {3.86011380527277*^9, 3.8601138056321363`*^9}, 
   3.860113838140704*^9, {3.8601138896641283`*^9, 3.860113889976621*^9}, {
   3.860114189114008*^9, 3.8601142126037383`*^9}, {3.860114322604232*^9, 
   3.8601143252135296`*^9}, 3.8601149892654653`*^9, {3.860115025869733*^9, 
   3.860115028604026*^9}, {3.860115118839145*^9, 3.860115124198991*^9}, 
   3.8601180296784124`*^9, {3.8601181066120033`*^9, 3.860118110301178*^9}, 
   3.8604722115502033`*^9, {3.8605778278176594`*^9, 3.8605778509044867`*^9}, {
   3.8605779281712427`*^9, 3.8605779364162397`*^9}, {3.8605779755922413`*^9, 
   3.860577979136243*^9}, {3.860663753607079*^9, 3.8606637632430806`*^9}, {
   3.8606641863329043`*^9, 3.860664260996916*^9}, 3.8606646229786787`*^9, 
   3.8606647042290688`*^9, {3.860664835251212*^9, 3.860664996450909*^9}, {
   3.8606652653092923`*^9, 3.8606652661862936`*^9}, {3.8606654497703395`*^9, 
   3.860665450723338*^9}, {3.8606657115904317`*^9, 3.8606657139964275`*^9}, {
   3.860665766731951*^9, 3.8606657748269486`*^9}, {3.8606660277208195`*^9, 
   3.860666049186817*^9}, {3.8606669449796877`*^9, 3.86066696337269*^9}, {
   3.8606671253952312`*^9, 3.8606671385900197`*^9}, {3.8606676493271637`*^9, 
   3.86066767901116*^9}, {3.8607198490544224`*^9, 3.8607198614807205`*^9}, 
   3.860720062704801*^9, {3.8607203324562683`*^9, 3.860720403837408*^9}, {
   3.861139623586132*^9, 3.8611396412312202`*^9}, {3.8611401948165274`*^9, 
   3.861140393349902*^9}, {3.8611404311198716`*^9, 3.861140640869858*^9}, {
   3.8611408367197275`*^9, 3.861140887128128*^9}, {3.8611409409898925`*^9, 
   3.861141009699751*^9}, {3.8611410603676467`*^9, 3.86114120335999*^9}, {
   3.861141248939698*^9, 3.861141290329917*^9}, {3.8611413464874115`*^9, 
   3.861141476179534*^9}, {3.86114171073994*^9, 3.861141772289896*^9}, {
   3.8611421239499493`*^9, 3.8611422365900736`*^9}, {3.861142266949956*^9, 
   3.8611424022398853`*^9}, {3.8611428492863407`*^9, 3.861142850696164*^9}, {
   3.861142937178194*^9, 3.861142961765764*^9}, {3.861143322765983*^9, 
   3.8611433242240114`*^9}, {3.8612292602860684`*^9, 3.86122926115753*^9}, {
   3.861236554709715*^9, 3.861236739783842*^9}, {3.8612374710153465`*^9, 
   3.861237549945371*^9}, 3.861237813310624*^9, {3.8612785357984533`*^9, 
   3.861278549488081*^9}, {3.8613224431771493`*^9, 3.861322509927991*^9}, {
   3.861322662281725*^9, 3.8613226730645533`*^9}, {3.861326351092517*^9, 
   3.8613263541936083`*^9}, {3.8613326825228963`*^9, 3.861332687431579*^9}, {
   3.8613327213047214`*^9, 3.861332803607329*^9}, {3.8613330619187245`*^9, 
   3.8613331732761126`*^9}, {3.861333208717292*^9, 3.861333280608028*^9}, {
   3.8655880592341213`*^9, 3.8655880615349355`*^9}, 3.865721377649269*^9, {
   3.8757455905406084`*^9, 3.87574560410826*^9}, {3.875752823311498*^9, 
   3.875752882433886*^9}, {3.875752928897497*^9, 3.875752940482314*^9}, {
   3.8861136166742306`*^9, 3.886113647311449*^9}, {3.8922078275038404`*^9, 
   3.8922078323769617`*^9}, {3.892207904753392*^9, 3.8922079351642046`*^9}, {
   3.892208035144802*^9, 3.8922080770152235`*^9}, {3.89220812284818*^9, 
   3.8922083076686697`*^9}, {3.8922083865564146`*^9, 3.892208462742731*^9}, 
   3.89220881354918*^9, {3.892208863450921*^9, 3.892208890987011*^9}, {
   3.8928660462310443`*^9, 3.8928661016849337`*^9}, {3.895071831213197*^9, 
   3.8950718471912403`*^9}, {3.899189493127262*^9, 3.899189601264044*^9}, {
   3.8991897843029346`*^9, 3.8991897982993107`*^9}, {3.8991898952026377`*^9, 
   3.8991898968905945`*^9}, {3.899189987148969*^9, 3.899189994265585*^9}, 
   3.8993769789349537`*^9, {3.899378287275901*^9, 3.8993782898882885`*^9}, {
   3.9028232275413523`*^9, 3.902823232122712*^9}, {3.9028247896595116`*^9, 
   3.902824832629794*^9}, {3.95299375036834*^9, 3.952993767972468*^9}, {
   3.956199042478525*^9, 
   3.9561990425554132`*^9}},ExpressionUUID->"f1b9dee0-dab0-4772-9362-\
1e686da3addd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Series", "Subsubsection",
 CellChangeTimes->{
  3.8611418015499945`*^9},ExpressionUUID->"f5ba511d-dc39-4266-9a5d-\
b47036fe4c37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     StyleBox["Series",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["expansion",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", "geometric", " ", 
     "quantities"}], ";", " ", 
    RowBox[{
    "Normal", " ", "is", " ", "applied", " ", "to", " ", "get", " ", "rid", 
     " ", "of", " ", "the", " ", "O", " ", "sign"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Need", " ", "to", " ", "remember", " ", "to", " ", "apply", " ", "Series",
     " ", "on", " ", "Tooltipdisplay", " ", "stuff", " ", 
    RowBox[{"too", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Metric", " ", "related"}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{"xx___", ",", "\[IndentingNewLine]", 
         RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricDeterminant", "\[Rule]", "Detg_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"ChristoffelComponents", "\[Rule]", "ChrisRules_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RiemannComponents", "\[Rule]", "RiemRules_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RicciComponents", "\[Rule]", "RicRules_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"RicciScalarInvariant", "\[Rule]", "RRule_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"OrthonormalFrameField", "\[Rule]", "onffuser_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "InverseOrthonormalFrameField", "\[Rule]", "invonffuser_"}]}], 
        "\[IndentingNewLine]", "]"}], ",", "\[Epsilon]__List"}], "]"}], ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xx", ",", "\[IndentingNewLine]", 
       RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"matrix", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MetricDeterminant", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"Detg", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ChristoffelComponents", "\[Rule]", "ChrisRules"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ChristoffelComponents", "[", "chx__", "]"}], "\[Rule]", 
           "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ChristoffelComponents", "[", "chx", "]"}], "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RiemannComponents", "\[Rule]", "RiemRules"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RiemannComponents", "[", "riex__", "]"}], "\[Rule]", 
           "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RiemannComponents", "[", "riex", "]"}], "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RicciComponents", "\[Rule]", "RicRules"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RicciComponents", "[", "ricx__", "]"}], "\[Rule]", 
           "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RicciComponents", "[", "ricx", "]"}], "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"RicciScalarInvariant", "\[Rule]", "RRule"}], "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"RicciScalar", "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"RicciScalar", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}]}], 
       ",", 
       RowBox[{"OrthonormalFrameField", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"onffuser", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{"invonffuser", ",", "\[Epsilon]"}], "]"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     StyleBox[
      RowBox[{"Non", "-", "Metric"}],
      FontColor->RGBColor[0, 0, 1]], ",", " ", 
     RowBox[{"Does", " ", "not", " ", "contain", " ", "TooltipDisplay"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xx___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xx", "}"}], ",", "TooltipDisplay", ",", 
               "\[Infinity]"}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorType", "\[Rule]", 
           RowBox[{"type_", "/;", 
            RowBox[{"type", "=!=", "\"\<Metric\>\""}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[Epsilon]__List"}], "]"}], ":=", 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xx", ",", "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", "type"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{"matrix", ",", "\[Epsilon]"}], "]"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       StyleBox[
        RowBox[{"Non", "-", "Metric"}],
        FontColor->RGBColor[0, 0, 1]], ",", " ", 
       RowBox[{"Contains", " ", "TooltipDisplay"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Tensor", "/:", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xx___", ",", "\[IndentingNewLine]", 
          RowBox[{"TensorType", "\[Rule]", 
           RowBox[{"type_", "/;", 
            RowBox[{"type", "=!=", "\"\<Metric\>\""}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", "disp_"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[Epsilon]__List"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xx", ",", "\[IndentingNewLine]", 
          RowBox[{"TensorType", "\[Rule]", "type"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"matrix", ",", "\[Epsilon]"}], "]"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"disp", "/.", 
             RowBox[{
              RowBox[{"Rule", "[", 
               RowBox[{"lhs_", ",", "rhs_"}], "]"}], "\[RuleDelayed]", 
              RowBox[{"Rule", "[", 
               RowBox[{"lhs", ",", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Series", "[", 
                  RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
               "]"}]}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
      StyleBox["Series",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["expansion",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", "geometric", " ", 
      "quantities"}], ";", " ", 
     RowBox[{
     "Normal", " ", "is", " ", "applied", " ", "to", " ", "get", " ", "rid", 
      " ", "of", " ", "the", " ", "O", " ", "sign"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Need", " ", "to", " ", "remember", " ", "to", " ", "apply", " ", 
     "Series", " ", "on", " ", "Tooltipdisplay", " ", "stuff", " ", 
     RowBox[{"too", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"Metric", " ", "related"}],
     FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", "TensorType", ",", "\[Infinity]"}], "]"}], "===", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}]}], ",", 
        "\[Epsilon]__List"}], "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{"t", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"Normal", "[", 
               RowBox[{"Series", "[", 
                RowBox[{"matrix", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
             ")"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MetricDeterminant", "\[Rule]", "Detg_"}], ")"}], 
           "\[RuleDelayed]", 
           RowBox[{"(", 
            RowBox[{"MetricDeterminant", "\[Rule]", 
             RowBox[{"Normal", "[", 
              RowBox[{"Series", "[", 
               RowBox[{"Detg", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ChristoffelComponents", "\[Rule]", "ChrisRules_"}], 
             ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"ChristoffelComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"ChrisRules", "/.", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "chx__", "]"}], 
                    "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "chx", "]"}], 
                    "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                   ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RiemannComponents", "\[Rule]", "RiemRules_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"RiemannComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"RiemRules", "/.", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"RiemannComponents", "[", "riex__", "]"}], 
                    "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "riex", "]"}], 
                    "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                   ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RicciComponents", "\[Rule]", "RicRules_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"RicciComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"RicRules", "/.", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"RicciComponents", "[", "ricx__", "]"}], 
                    "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"RicciComponents", "[", "ricx", "]"}], "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                   ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RicciScalarInvariant", "\[Rule]", "RRule_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"RicciScalarInvariant", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"RRule", "/.", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"RicciScalar", "\[Rule]", "rhs_"}], ")"}], 
                  "\[RuleDelayed]", 
                  RowBox[{"(", 
                   RowBox[{"RicciScalar", "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                   ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}]}], 
         "\[IndentingNewLine]", "}"}]}], ")"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", "TensorType", ",", "\[Infinity]"}], "]"}], "===", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}]}], ",", 
        "\[Epsilon]__List"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"matrix", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "TensorComponents", ",", "\[Infinity]"}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"Detg", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "MetricDeterminant", ",", "\[Infinity]"}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"ChrisRules", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "ChristoffelComponents", ",", "\[Infinity]"}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"RiemRules", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "RiemannComponents", ",", "\[Infinity]"}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{"RicRules", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "RicciComponents", ",", "\[Infinity]"}], "]"}],
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"RRule", "=", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", "RicciScalarInvariant", ",", "\[Infinity]"}], 
             "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], "}"}], ",", 
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "a_"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", 
                RowBox[{"Normal", "[", 
                 RowBox[{"Series", "[", 
                  RowBox[{"matrix", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
               ")"}]}], ")"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MetricDeterminant", "\[Rule]", "b_"}], ")"}], 
             "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"MetricDeterminant", "\[Rule]", 
               RowBox[{"Normal", "[", 
                RowBox[{"Series", "[", 
                 RowBox[{"Detg", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}],
             ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ChristoffelComponents", "\[Rule]", "c_"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"ChristoffelComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"ChrisRules", "/.", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "chx__", "]"}], 
                    "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "chx", "]"}], 
                    "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                    ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"RiemannComponents", "\[Rule]", "d_"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"RiemannComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"RiemRules", "/.", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"RiemannComponents", "[", "riex__", "]"}], 
                    "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "riex", "]"}], 
                    "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                    ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"RicciComponents", "\[Rule]", "e_"}], ")"}], "\[Rule]",
               " ", 
              RowBox[{"(", 
               RowBox[{"RicciComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"RicRules", "/.", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"RicciComponents", "[", "ricx__", "]"}], 
                    "\[Rule]", "rhs_"}], ")"}], "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"RicciComponents", "[", "ricx", "]"}], "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                    ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"RicciScalarInvariant", "\[Rule]", "f_"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"(", 
               RowBox[{"RicciScalarInvariant", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"RRule", "/.", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"RicciScalar", "\[Rule]", "rhs_"}], ")"}], 
                    "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"RicciScalar", "\[Rule]", 
                    RowBox[{"Normal", "[", 
                    RowBox[{"Series", "[", 
                    RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                    ")"}]}], ")"}]}], ")"}]}], ")"}]}], ")"}]}], 
           "\[IndentingNewLine]", "}"}]}], ")"}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     StyleBox[
      RowBox[{"Non", "-", "Metric"}],
      FontColor->RGBColor[0, 0, 1]], ",", " ", 
     RowBox[{"Does", " ", "not", " ", "contain", " ", "TooltipDisplay"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     StyleBox[
      RowBox[{"TagSetDelay", " ", 
       RowBox[{"w", "/", "t_Tensor"}]}],
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TooltipDisplayNoPart", "[", "t", "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], "=!=", 
            RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}]}], ")"}]}], ",", 
       "\[Epsilon]__List"}], "]"}], ":=", 
     RowBox[{"t", "/.", 
      RowBox[{"{", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
         "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"mx", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}], 
        ")"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     StyleBox[
      RowBox[{"Non", "-", "Metric"}],
      FontColor->RGBColor[0, 0, 1]], ",", " ", 
     RowBox[{"Contains", " ", "TooltipDisplay"}]}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TooltipDisplayNoPart", "[", "t", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], "=!=", 
            RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}]}], ")"}]}], ",", 
       "\[Epsilon]__List"}], "]"}], ":=", 
     RowBox[{"t", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
         "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"Series", "[", 
             RowBox[{"mx", ",", "\[Epsilon]"}], "]"}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TooltipDisplay", "\[Rule]", "disp_"}], ")"}], 
         "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"TooltipDisplay", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"disp", "/.", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Rule", "[", 
                RowBox[{"lhs_", ",", "rhs_"}], "]"}], "\[RuleDelayed]", 
               RowBox[{"Rule", "[", 
                RowBox[{"lhs", ",", 
                 RowBox[{"Normal", "[", 
                  RowBox[{"Series", "[", 
                   RowBox[{"rhs", ",", "\[Epsilon]"}], "]"}], "]"}]}], 
                "]"}]}], ")"}]}], ")"}]}], ")"}]}]}], "}"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.8358601334159107`*^9, 3.835860134977911*^9}, {
   3.872730352918479*^9, 3.8727303559106407`*^9}, {3.872730441325736*^9, 
   3.8727306353403215`*^9}, {3.8727321029186935`*^9, 
   3.8727321153410535`*^9}, {3.872732234281945*^9, 3.8727324192912235`*^9}, {
   3.8727324961060076`*^9, 3.872732510602254*^9}, {3.872732562842143*^9, 
   3.872732837241123*^9}, 3.872732870207861*^9, {3.872732911695358*^9, 
   3.8727330531424704`*^9}, 3.8727435514542027`*^9, 3.8727436034754596`*^9, {
   3.8732447099846177`*^9, 3.873244719176941*^9}, {3.8732449340058103`*^9, 
   3.8732449457468014`*^9}, {3.873247874567914*^9, 3.873247887447654*^9}, {
   3.873248068717987*^9, 3.873248074307585*^9}, {3.873248291320121*^9, 
   3.8732482962880373`*^9}, {3.873248374358128*^9, 3.873248382467146*^9}, {
   3.8732484489576817`*^9, 3.8732485508179083`*^9}, {3.8732487303304234`*^9, 
   3.873248772308071*^9}, {3.8732489313437614`*^9, 3.87324893586771*^9}, {
   3.873249085168085*^9, 3.8732491010700884`*^9}, {3.8732495020780067`*^9, 
   3.8732495084056253`*^9}, {3.873249576056493*^9, 3.873249582757741*^9}, {
   3.873249657367875*^9, 3.873249685967734*^9}, {3.8732498875379305`*^9, 
   3.8732499012460546`*^9}, 3.8732499749981422`*^9, {3.8732500374880967`*^9, 
   3.8732501047881336`*^9}, {3.8732501459354644`*^9, 
   3.8732503004081473`*^9}, {3.873250365348068*^9, 3.873250371343517*^9}, {
   3.8732507312001114`*^9, 3.873250748805163*^9}, {3.873252414133135*^9, 
   3.8732524237231483`*^9}, {3.8733297644200706`*^9, 
   3.8733297656700373`*^9}, {3.873329946826194*^9, 3.8733300147290106`*^9}, {
   3.8757529754787717`*^9, 3.8757530554782963`*^9}, 
   3.875753532855688*^9},ExpressionUUID->"52b440c1-9bbf-457b-af8b-\
55cb007f9e1c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Dimensions", "Subsubsection",
 CellChangeTimes->{
  3.8611419236597853`*^9},ExpressionUUID->"5199a88c-d4cf-4f1e-92d6-\
70c2399599c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Dimensions", " ", "of", " ", "Tensors"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox[
     RowBox[{"TagSetDelay", " ", 
      RowBox[{"w", "/", "t_Tensor"}]}],
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tensor", "/:", 
    RowBox[{"Dimensions", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Dimensions", "[", 
     RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.672964252873741*^9, 3.6729643833032446`*^9}, {
  3.7669422126612077`*^9, 3.7669422444372387`*^9}, {3.8727216231185036`*^9, 
  3.8727216299701567`*^9}, {3.873329800511198*^9, 
  3.873329800948694*^9}},ExpressionUUID->"f39524e6-1023-42d5-91d4-\
26667a17a23e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Normal", "Subsubsection",
 CellChangeTimes->{{3.884219844687734*^9, 3.8842198478557863`*^9}, 
   3.8853787123059735`*^9},ExpressionUUID->"2eb70b72-66c1-4cca-92a3-\
faebd7ac4aa9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"Normal", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"t", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
      "\[RuleDelayed]", " ", 
      RowBox[{"(", 
       RowBox[{"TensorComponents", "\[Rule]", " ", 
        RowBox[{"Normal", "[", "comp", "]"}]}], ")"}]}], "}"}]}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842199221650925`*^9, 3.884220015159384*^9}, {
  3.8842200466150427`*^9, 3.884220061318999*^9}, {3.884220506412386*^9, 
  3.8842205113085737`*^9}, {3.8847798554973927`*^9, 3.884779888464262*^9}, {
  3.8853783112753534`*^9, 3.8853783139706917`*^9}, {3.8853787176826577`*^9, 
  3.885378721984007*^9}},ExpressionUUID->"2e9cd62b-3af6-44da-a73d-\
4f398e9fd199"]
}, Closed]],

Cell[CellGroupData[{

Cell["Conjugate", "Subsubsection",
 CellChangeTimes->{{3.884219844687734*^9, 
  3.8842198478557863`*^9}},ExpressionUUID->"f7e3c5b7-2c51-41cc-b797-\
cdaf49449972"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"Conjugate", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"t", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
       "\[RuleDelayed]", " ", 
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", " ", 
         RowBox[{"Conjugate", "[", "comp", "]"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", " ", "name_"}], ")"}], 
       "\[RuleDelayed]", " ", 
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "name", "]"}], "===", "OverBar"}], ")"}], 
           ",", 
           RowBox[{
           "name", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           ",", "True", ",", " ", 
           RowBox[{"OverBar", "[", "name", "]"}]}], "]"}]}], ")"}]}]}], 
     "}"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842199221650925`*^9, 3.884220015159384*^9}, {
   3.8842200466150427`*^9, 3.884220061318999*^9}, {3.884220506412386*^9, 
   3.8842205113085737`*^9}, {3.8847798554973927`*^9, 3.884779888464262*^9}, 
   3.8854273448100014`*^9},ExpressionUUID->"944f0416-dd94-4d25-b197-\
86aa93bad688"]
}, Closed]],

Cell[CellGroupData[{

Cell["Derivative for Tensor", "Subsubsection",
 CellChangeTimes->{{3.8611418192322197`*^9, 
  3.8611418232219305`*^9}},ExpressionUUID->"453dc659-8cc9-4a14-b820-\
7a84bc7c10c1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox["D",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   StyleBox[
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Derivative", " ", "for", " ", "Tensor"}]}],
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"PD", "[", "\[IndentingNewLine]", 
      RowBox[{"t_Tensor", 
       RowBox[{"(*", 
        RowBox[{"/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TensorComponentsNoPart", "[", "t", "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TensorNameNoPart", "[", "t", "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", ",", "stuff_"}], 
      RowBox[{"(*", 
       RowBox[{"/;", 
        RowBox[{
         RowBox[{
         "This", " ", "check", " ", "is", " ", "for", " ", "not", " ", "to", 
          " ", "conflict", " ", 
          RowBox[{"w", "/", " ", 
           StyleBox["short",
            FontColor->RGBColor[1, 0, 1]]}]}], 
         StyleBox["-",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{"hand", " ", "of", " ", 
           RowBox[{"PartialD", "."}]}],
          FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", "stuff", "]"}], "===", "SubMinus"}], ")"}]}], 
       "*)"}], "]"}], ":=", 
     RowBox[{"(*", 
      RowBox[{"re", "-", 
       RowBox[{"declare", " ", "a", " ", "new", " ", "Tensor", " ", 
        RowBox[{"w", "/", " ", "add"}], " ", 
        StyleBox["\"\<\[PartialD]\>\"",
         FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "front", " ", "if", 
        " ", 
        StyleBox["TensorName",
         FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "take", " ", "a", 
        " ", 
        StyleBox["derivative",
         FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "all", " ", "the", 
        " ", 
        RowBox[{
         StyleBox["TensorComponents",
          FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
     RowBox[{"t", "/.", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorName", "\[Rule]", "tc_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], "[", 
            RowBox[{"TensorName", "[", "t", "]"}], "]"}]}], ")"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", "t", "]"}], ",", "stuff"}], 
            "]"}]}], ")"}]}]}], "}"}]}]}], ";"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "Start"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"PD", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xx___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "xx", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "cc_"}], ")"}], 
                 "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "xx", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorName", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
                 "cc"}], ",", "\[Infinity]"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], "\[IndentingNewLine]", 
         "]"}], ",", 
        RowBox[{"stuff_", "/;", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "This", " ", "check", " ", "is", " ", "for", " ", "not", " ", "to",
             " ", "conflict", " ", 
            RowBox[{"w", "/", " ", 
             StyleBox["short",
              FontColor->RGBColor[1, 0, 1]]}]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"hand", " ", "of", " ", "PartialD"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "stuff", "]"}], "===", "SubMinus"}], 
           ")"}]}]}]}], "]"}], ":=", 
      RowBox[{"(*", 
       RowBox[{"re", "-", 
        RowBox[{"declare", " ", "a", " ", "new", " ", "Tensor", " ", 
         RowBox[{"w", "/", " ", "add"}], " ", 
         StyleBox["\"\<\[PartialD]\>\"",
          FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "front", " ", "if", 
         " ", 
         StyleBox["TensorName",
          FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "take", " ", "a", 
         " ", 
         StyleBox["derivative",
          FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "all", " ", "the", 
         " ", 
         RowBox[{
          StyleBox["TensorComponents",
           FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
      RowBox[{
       RowBox[{
       "Tensor", "[", "\[IndentingNewLine]", "xx", "\[IndentingNewLine]", 
        "]"}], "/.", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorName", "\[Rule]", "tc_"}], ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], "[", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "xx", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorName", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
                 "cc"}], ",", "\[Infinity]"}], "]"}], "\[LeftDoubleBracket]", 
              "1", "\[RightDoubleBracket]"}], "]"}]}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "xx", "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"TensorComponents", "\[Rule]", "cc_"}], ")"}], 
                  "\[Rule]", "cc"}], ",", "\[Infinity]"}], "]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
              "stuff"}], "]"}]}], ")"}]}]}], "}"}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"See", " ", 
     RowBox[{"also", ":", " ", 
      RowBox[{
       StyleBox["Short",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["-",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["hand",
         FontColor->RGBColor[1, 0, 1]], " ", "for", " ", "PartialD"}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xx___", ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "nnn_"}]}], "\[IndentingNewLine]", 
         "]"}], ",", 
        RowBox[{"stuff_", "/;", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "This", " ", "check", " ", "is", " ", "for", " ", "not", " ", "to",
             " ", "conflict", " ", 
            RowBox[{"w", "/", " ", 
             StyleBox["short",
              FontColor->RGBColor[1, 0, 1]]}]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"hand", " ", "of", " ", "PartialD"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "stuff", "]"}], "===", "SubMinus"}], 
           ")"}]}]}]}], "]"}], ":=", 
      RowBox[{"(*", 
       RowBox[{"re", "-", 
        RowBox[{"declare", " ", "a", " ", "new", " ", "Tensor", " ", 
         RowBox[{"w", "/", " ", "add"}], " ", 
         StyleBox["\"\<\[PartialD]\>\"",
          FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "front", " ", "if", 
         " ", 
         StyleBox["TensorName",
          FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "take", " ", "a", 
         " ", 
         StyleBox["derivative",
          FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "all", " ", "the", 
         " ", 
         RowBox[{
          StyleBox["TensorComponents",
           FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xx", ",", "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], "[", "nnn", 
          "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"D", "[", 
          RowBox[{"matrix", ",", "stuff"}], "]"}]}]}], "\[IndentingNewLine]", 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xx___", ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "nnn_"}]}], "\[IndentingNewLine]", 
         "]"}], ",", 
        RowBox[{"stuff_", "/;", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "This", " ", "check", " ", "is", " ", "for", " ", "not", " ", "to",
             " ", "conflict", " ", 
            RowBox[{"w", "/", " ", 
             StyleBox["short",
              FontColor->RGBColor[1, 0, 1]]}]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"hand", " ", "of", " ", "PartialD"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "stuff", "]"}], "===", "SubMinus"}], 
           ")"}]}]}]}], "]"}], ":=", 
      RowBox[{"(*", 
       RowBox[{"re", "-", 
        RowBox[{"declare", " ", "a", " ", "new", " ", "Tensor", " ", 
         RowBox[{"w", "/", " ", "add"}], " ", 
         StyleBox["\"\<\[PartialD]\>\"",
          FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "front", " ", "if", 
         " ", 
         StyleBox["TensorName",
          FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "take", " ", "a", 
         " ", 
         StyleBox["derivative",
          FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "all", " ", "the", 
         " ", 
         RowBox[{
          StyleBox["TensorComponents",
           FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Print", "[", "\"\<D\>\"", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{"xx", ",", "\[IndentingNewLine]", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], "[", 
             "nnn", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"D", "[", 
             RowBox[{"matrix", ",", "stuff"}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xx___", ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "nnn_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", 
           RowBox[{"disp_", "/;", 
            RowBox[{"(", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"disp", ",", 
               RowBox[{"{", 
                RowBox[{"Repeated", "[", 
                 RowBox[{"Rule", "[", 
                  RowBox[{"_", ",", "_"}], "]"}], "]"}], "}"}]}], "]"}], 
             ")"}]}]}]}], "\[IndentingNewLine]", "]"}], ",", "stuff_Symbol"}],
        "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "newdisp", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"newdisp", "=", 
          RowBox[{"(", 
           RowBox[{"disp", "/.", 
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{"lhs_", 
               RowBox[{"(*", 
                RowBox[{"Row", "[", "__", "]"}], "*)"}], ",", "rhs_"}], "]"}],
              "\[RuleDelayed]", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Subscript", "[", 
                   RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], ",", 
                  "lhs"}], "}"}], "]"}], ",", 
               RowBox[{"D", "[", 
                RowBox[{"rhs", ",", "stuff"}], "]"}]}], "]"}]}]}], ")"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"newdisp", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"newdisp", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "#", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Row", "[", "__", "]"}], "\[Rule]", "cc_"}], 
                    ")"}], "\[Rule]", "cc"}]}], "]"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
                "0"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{"xx", ",", "\[IndentingNewLine]", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{
             RowBox[{"Subscript", "[", 
              RowBox[{"\"\<\[PartialD]\>\"", ",", "stuff"}], "]"}], "[", 
             "nnn", "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"D", "[", 
             RowBox[{"matrix", ",", "stuff"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", "newdisp"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "End"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tensor", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "stuff___", "]"}], ",", "\[Mu]T_Symbol"}], 
      "]"}], ":=", 
     RowBox[{"PD", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "stuff", "]"}], ",", "\[Mu]T"}], "]"}]}], 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.835859602926553*^9, 3.835859728311108*^9}, {
   3.835859791250119*^9, 3.835859804322502*^9}, {3.8358598345356293`*^9, 
   3.835859838531027*^9}, 3.8358598721245165`*^9, {3.8358599532439394`*^9, 
   3.835859957561669*^9}, {3.835860143619153*^9, 3.835860145369688*^9}, {
   3.835860221002843*^9, 3.8358602625621796`*^9}, 3.8358605805204043`*^9, {
   3.8358606388794003`*^9, 3.8358606467324133`*^9}, {3.8358606937574034`*^9, 
   3.835860703303405*^9}, {3.8358617594312496`*^9, 3.83586187699807*^9}, {
   3.8358619621210504`*^9, 3.835861968212232*^9}, 3.8358627392517357`*^9, {
   3.8358627770034075`*^9, 3.8358627773683376`*^9}, {3.8358628243884783`*^9, 
   3.8358628415763392`*^9}, {3.8358629083773623`*^9, 
   3.8358629727894125`*^9}, {3.835863089365315*^9, 3.8358631243379207`*^9}, {
   3.835863169281988*^9, 3.835863187539895*^9}, 3.8358632412599115`*^9, {
   3.835863433945222*^9, 3.835863439453006*^9}, 3.835863689797821*^9, {
   3.835864063766061*^9, 3.835864120354599*^9}, {3.8358642464275*^9, 
   3.835864253261094*^9}, {3.835864422411518*^9, 3.8358644229484215`*^9}, {
   3.8358645134704227`*^9, 3.8358645669434233`*^9}, {3.835864653310423*^9, 
   3.835864656034425*^9}, {3.835864748415412*^9, 3.835864757289424*^9}, {
   3.8358708947183275`*^9, 3.835870900186552*^9}, {3.8358711248677454`*^9, 
   3.835871148471379*^9}, {3.8358712149838257`*^9, 3.8358712251802435`*^9}, {
   3.835921099472575*^9, 3.835921154919902*^9}, {3.835921201194438*^9, 
   3.8359212355804343`*^9}, {3.835921631831324*^9, 3.8359216380753202`*^9}, {
   3.8359220216857185`*^9, 3.83592204296344*^9}, {3.836440224612873*^9, 
   3.836440250386945*^9}, 3.836441933581911*^9, {3.8364425314510565`*^9, 
   3.836442545730586*^9}, {3.8375015279338017`*^9, 3.8375015289337807`*^9}, {
   3.8375015734025517`*^9, 3.8375015740900292`*^9}, 3.837639265724143*^9, 
   3.8376393651142817`*^9, {3.8376395448328195`*^9, 3.8376395474562893`*^9}, {
   3.8376396686697636`*^9, 3.837639672396969*^9}, {3.837641332851806*^9, 
   3.8376413965861115`*^9}, {3.837641460418699*^9, 3.8376415349119864`*^9}, {
   3.8376419006223016`*^9, 3.8376419028935113`*^9}, {3.837645325106383*^9, 
   3.837645329162382*^9}, {3.837645524246386*^9, 3.837645526840377*^9}, {
   3.8376457577595215`*^9, 3.8376457609835234`*^9}, 3.837646893891533*^9, {
   3.8376469333207164`*^9, 3.837646935675719*^9}, {3.837652726116737*^9, 
   3.837652735935737*^9}, {3.837654742250891*^9, 3.837654800787981*^9}, {
   3.837655243904982*^9, 3.8376552646809855`*^9}, {3.837655324350054*^9, 
   3.837655354432051*^9}, {3.8378363518154*^9, 3.8378363624912643`*^9}, {
   3.8378364540157194`*^9, 3.8378364810095468`*^9}, {3.838191010180602*^9, 
   3.83819103728315*^9}, {3.838191274355959*^9, 3.8381912791602645`*^9}, 
   3.849143402827999*^9, {3.852007855718226*^9, 3.8520078600576468`*^9}, {
   3.852020979370977*^9, 3.8520210175010433`*^9}, 3.8520217914252577`*^9, 
   3.8520222878838015`*^9, {3.8520223576512814`*^9, 3.852022359171401*^9}, {
   3.8520225524699516`*^9, 3.852022554804723*^9}, {3.853279225604104*^9, 
   3.8532792716969824`*^9}, {3.853279361008794*^9, 3.853279401192734*^9}, {
   3.8532794373436747`*^9, 3.8532795093988323`*^9}, {3.853279548519978*^9, 
   3.8532795486648865`*^9}, {3.853289082452416*^9, 3.85328914138163*^9}, 
   3.8586872691029367`*^9, {3.858818182340184*^9, 3.858818212078759*^9}, 
   3.858818317387984*^9, 3.8588183822218094`*^9, 3.858818441731039*^9, 
   3.858818488877357*^9, 3.8588977831100874`*^9, 3.8590025027744246`*^9, 
   3.859445502512094*^9, 3.8594635460141306`*^9, 3.8594635771926537`*^9, {
   3.8596019690701036`*^9, 3.85960199275854*^9}, 3.85985509097552*^9, 
   3.861767540665697*^9, 3.8617681482387257`*^9, {3.861768273538753*^9, 
   3.8617684109950356`*^9}, {3.8617684886583176`*^9, 3.861768565629671*^9}, {
   3.8617686135658855`*^9, 3.8617686422310066`*^9}, {3.861769083815488*^9, 
   3.861769084939062*^9}, {3.8617691369898*^9, 3.861769214680065*^9}, {
   3.861769274055255*^9, 3.8617692764770536`*^9}, {3.861769326113449*^9, 
   3.8617693321132317`*^9}, {3.8617697830553784`*^9, 
   3.8617698325519686`*^9}, {3.8619263463902254`*^9, 
   3.8619263567499113`*^9}, {3.86193188893808*^9, 3.861931898015473*^9}, 
   3.862532921559805*^9, {3.862536912993188*^9, 3.862536916215206*^9}, {
   3.862540519532971*^9, 3.8625405235714893`*^9}, {3.8625406675381207`*^9, 
   3.862540677495*^9}, {3.8625407080801916`*^9, 3.8625407135418344`*^9}, {
   3.8627087151699495`*^9, 3.86270872294034*^9}, 3.862967194294706*^9, {
   3.865560131108966*^9, 3.865560146517609*^9}, 3.8655605984057074`*^9, {
   3.865561281771064*^9, 3.8655613432955055`*^9}, 3.8655614475486803`*^9, {
   3.8727224444911375`*^9, 3.872722473579224*^9}, {3.872722560224428*^9, 
   3.872722588419077*^9}, 3.872722634211478*^9, {3.872722700741763*^9, 
   3.8727227032260704`*^9}, {3.872722777813127*^9, 3.8727227934793034`*^9}, {
   3.8757530700320196`*^9, 3.875753117862438*^9}, 3.890265548583604*^9, 
   3.8902846703066487`*^9, 3.890284701199937*^9, {3.8902849853181124`*^9, 
   3.8902850007286386`*^9}},ExpressionUUID->"136d1ccd-7984-4b1f-9f4e-\
8346551e4ac6"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test2a", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.957844063214994*^9, 
   3.95784408519026*^9}},ExpressionUUID->"4a651096-6fe7-480f-acb6-\
5fcf91995886"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Test2a", "[", "]"}], ":=", "\"\<Test2a\>\""}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6698433615844946`*^9, 
   3.6698433880800104`*^9}, {3.669843474192936*^9, 3.6698434754330063`*^9}, {
   3.6698435353114314`*^9, 3.6698435357544565`*^9}, {3.875743971743964*^9, 
   3.8757439829660597`*^9}, {3.875747614296013*^9, 3.875747654883006*^9}, 
   3.8757477023229423`*^9, {3.8757479909925957`*^9, 3.875747991258222*^9}, {
   3.875752777800908*^9, 3.875752785114856*^9}, {3.8757602068070116`*^9, 
   3.8757602189517016`*^9}, {3.8861130176660748`*^9, 3.886113041948106*^9}, {
   3.8901990429958506`*^9, 3.8901990690527115`*^9}, 3.8950713769890904`*^9, {
   3.895555838066365*^9, 3.895555838071362*^9}, {3.9578440678621283`*^9, 
   3.957844087558261*^9}},ExpressionUUID->"bd97d00f-a58d-48c7-92f8-\
341bc4133248"]
}, Closed]],

Cell[CellGroupData[{

Cell["Simplify", "Subsubsection",
 CellChangeTimes->{{3.886907985980402*^9, 
  3.886908014692019*^9}},ExpressionUUID->"4c2e7990-bf65-48b1-8ec8-\
74cf66a257b3"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"Simplify", "[", "t_Tensor", 
    RowBox[{"(*", 
     RowBox[{"(", 
      RowBox[{"t_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "t", "]"}], "===", "Tensor"}], ")"}], "||", 
         RowBox[{"TestTensorTensor", "[", "t", "]"}], "||", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "t", "]"}]}]}], ")"}]}], ")"}], 
     "*)"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TA", "=", 
       RowBox[{"TensorAssumption", "[", "t", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TA", "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", 
             RowBox[{"Simplify", "[", "comp", "]"}]}], ")"}]}], "}"}]}], ",", 
        RowBox[{"(", 
         RowBox[{"TA", "=!=", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", 
             RowBox[{"Simplify", "[", 
              RowBox[{"comp", ",", "TA"}], "]"}]}], ")"}]}], "}"}]}]}], "]"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Simplify", "[", 
      RowBox[{"t", ",", "TA"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.886908031314934*^9, 3.8869080833470964`*^9}, {
   3.8869084260193853`*^9, 3.8869084398507643`*^9}, {3.8869086719244003`*^9, 
   3.8869086878112245`*^9}, {3.886908781476242*^9, 3.886908785955391*^9}, {
   3.8869088702507854`*^9, 3.886908911531067*^9}, {3.8872458622983956`*^9, 
   3.8872459138629313`*^9}, {3.8920149737009*^9, 3.892014983784693*^9}, {
   3.8988528576028547`*^9, 3.898852928949194*^9}, 3.898852972958228*^9, {
   3.898853066967451*^9, 3.8988531071916084`*^9}, {3.898853230648549*^9, 
   3.898853235679679*^9}},ExpressionUUID->"6e842148-ea8f-4433-b072-\
9e6630dcb93a"]
}, Closed]],

Cell[CellGroupData[{

Cell["FullSimplify", "Subsubsection",
 CellChangeTimes->{{3.886907985980402*^9, 
  3.886907993284156*^9}},ExpressionUUID->"cba288e5-988d-40bd-ae0e-\
5e166730c5fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Tensor", "/:", 
   RowBox[{"FullSimplify", "[", "t_Tensor", "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"TA", "=", 
       RowBox[{"TensorAssumption", "[", "t", "]"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TA", "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", 
             RowBox[{"FullSimplify", "[", "comp", "]"}]}], ")"}]}], "}"}]}], 
        ",", 
        RowBox[{"(", 
         RowBox[{"TA", "=!=", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
           "\[RuleDelayed]", " ", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", " ", 
             RowBox[{"FullSimplify", "[", 
              RowBox[{"comp", ",", "TA"}], "]"}]}], ")"}]}], "}"}]}]}], "]"}],
       "*)"}], "\[IndentingNewLine]", 
     RowBox[{"FullSimplify", "[", 
      RowBox[{"t", ",", "TA"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.886908054112037*^9, 3.8869080553637457`*^9}, {
   3.8869080889770255`*^9, 3.886908091971876*^9}, {3.8869089179254923`*^9, 
   3.8869089239234304`*^9}, {3.89201499261026*^9, 3.8920149997684736`*^9}, {
   3.8988529899623566`*^9, 3.8988529935404077`*^9}, 3.8988531181134205`*^9, {
   3.8988532441547756`*^9, 
   3.8988532474515343`*^9}},ExpressionUUID->"5f34a97a-072a-4f9a-a613-\
82479f4825e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorSymmetry", "Subsubsection",
 CellChangeTimes->{
  3.861141905720069*^9},ExpressionUUID->"14afb864-641f-466b-b691-\
a1771dfe6365"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["TensorSymmetry",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"TensorSymmetry", " ", "of", " ", "Tensors"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Tensor", "/:", 
    RowBox[{"TensorSymmetry", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "ts", "}"}], ",", 
      RowBox[{
       RowBox[{"ts", "=", 
        RowBox[{"TensorSymmetry", "[", 
         RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorSymmetry", "\[Rule]", "tss_"}], ")"}], 
              "\[Rule]", "tss"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"ts", ",", 
           RowBox[{"Append", "[", 
            RowBox[{"t", ",", 
             RowBox[{"TensorSymmetry", "\[Rule]", "ts"}]}], "]"}]}], "}"}], 
         ",", "True", ",", 
         RowBox[{"{", 
          RowBox[{"ts", ",", 
           RowBox[{"t", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorSymmetry", "\[Rule]", "oldts_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorSymmetry", "\[Rule]", "ts"}], ")"}]}]}]}], 
          "}"}]}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"(*", 
     RowBox[{"NewCode", ":", " ", 
      StyleBox["TensorSymmetry",
       FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{"TensorSymmetry", " ", "of", " ", "Tensors"}],
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{"TensorSymmetry", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ts", ",", "indices", ",", "newts", ",", "lgth"}], "}"}], ",", 
       RowBox[{
        RowBox[{"ts", "=", 
         RowBox[{"TensorSymmetry", "[", 
          RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"We", " ", "should", " ", 
          StyleBox["remove",
           FontColor->RGBColor[1, 0, 1]], " ", "those", " ", 
          StyleBox["under",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["bar",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"square", "/", "curly"}],
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["bracket",
           FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "the", " ", 
          "indices", " ", "list", " ", 
          RowBox[{"first", "."}]}], "*)"}], 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Convert", " ", "MMA", " ", "output", " ", "in", " ", "our", " ", 
          "prefer", " ", 
          RowBox[{"way", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"To", " ", "understand", " ", "this", " ", "block"}], ",", 
          " ", 
          RowBox[{
           RowBox[{"you", " ", "can", " ", "refer", " ", "to", " ", "Wei"}], 
           "-", 
           RowBox[{
            RowBox[{"Hao", "'"}], "s", " ", 
            RowBox[{"notebook", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", "ts", "]"}], "===", "ZeroSymmetric"}], ",", 
          RowBox[{"newts", "=", "\"\<Zero Tensor\>\""}], ",", 
          RowBox[{"ts", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{"newts", "=", "\"\<No Symmetry\>\""}], ",", 
          RowBox[{
           RowBox[{"Head", "[", "ts", "]"}], "===", "Antisymmetric"}], ",", 
          RowBox[{"newts", "=", 
           RowBox[{"Antisymmetric", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "indices", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{
             "ts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{"Head", "[", "ts", "]"}], "===", "Symmetric"}], ",", 
          RowBox[{"newts", "=", 
           RowBox[{"Symmetric", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "indices", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}], "&"}], "/@", 
             RowBox[{
             "ts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
            "]"}]}], ",", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"ts", ",", 
             RowBox[{"Cycles", "[", "_List", "]"}], ",", "Infinity"}], "]"}], 
           "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"lgth", "=", 
            RowBox[{"Length", "[", "ts", "]"}]}], ";", 
           RowBox[{"newts", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], "===", "1"}], "&&", 
                 RowBox[{
                  RowBox[{"ts", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "===", 
                  RowBox[{"-", "1"}]}]}], ",", 
                RowBox[{"Antisymmetric", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], "===", "1"}], "&&", 
                 RowBox[{
                  RowBox[{"ts", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "===",
                   "1"}]}], ",", 
                RowBox[{"Symmetric", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], "\[NotEqual]", "1"}], "&&", 
                 RowBox[{
                  RowBox[{"ts", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "===", 
                  RowBox[{"-", "1"}]}]}], ",", 
                RowBox[{"Antisymmetric", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                  RowBox[{"ts", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "1", ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], "]"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], "\[NotEqual]", "1"}], "&&", 
                 RowBox[{
                  RowBox[{"ts", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "===",
                   "1"}]}], ",", 
                RowBox[{"Symmetric", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                  RowBox[{"ts", "\[LeftDoubleBracket]", 
                   RowBox[{"ii", ",", "1", ",", "1"}], 
                   "\[RightDoubleBracket]"}]}], "]"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
                    RowBox[{"+", "1"}]}], "||", 
                    RowBox[{
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
                    RowBox[{"-", "1"}]}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Conjugate", "[", 
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                    "]"}]}], ")"}], "===", "1"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}]}], 
                 ")"}], ",", 
                RowBox[{"newts", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cycles", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], ",", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "}"}]}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
                    RowBox[{"+", "1"}]}], "||", 
                    RowBox[{
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], "=!=", 
                    RowBox[{"-", "1"}]}]}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                    RowBox[{"Conjugate", "[", 
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], " ", 
                    "]"}]}], ")"}], "===", "1"}], ")"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Length", "[", 
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}], "]"}], "!=", "1"}], ")"}]}], 
                 ")"}], ",", 
                RowBox[{"newts", "=", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Cycles", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                    RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "1", ",", "1"}], 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                   RowBox[{"ts", "\[LeftDoubleBracket]", 
                    RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "}"}]}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"ii", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", " ", "there", " ", "is", " ", 
           StyleBox["no",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["TensorSymmetry",
            FontColor->RGBColor[1, 0, 1]], " ", "in", " ", "original", " ", 
           "Tensor"}], ",", " ", 
          RowBox[{
           StyleBox["Append",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"one", ".", " ", "If"}], " ", "there", " ", "is"}], ",", 
          " ", 
          RowBox[{
           StyleBox["replace",
            FontColor->RGBColor[1, 0, 1]], " ", "to", " ", "be", " ", "the", 
           " ", "new", " ", 
           RowBox[{"one", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "The", " ", "output", " ", "will", " ", "be", " ", "a", " ", 
          "\"\<Timing\>\"", " ", "function", " ", "like", " ", 
          RowBox[{"List", ".", " ", "User"}], " ", "can", " ", "directly", 
          " ", "see", " ", "the", " ", "symmetry", " ", "property", " ", "in",
           " ", "part", " ", "one", " ", "of", " ", "the", " ", 
          RowBox[{"List", ".", " ", "They"}], " ", "can", " ", "also", " ", 
          "extract", " ", "the", " ", "tensor", " ", 
          RowBox[{"w", "/", "TensorSymmetry"}], " ", "by", " ", "using", " ", 
          "part", " ", "2."}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"t", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ")"}], 
               "\[Rule]", "ts"}]}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"newts", ",", 
            RowBox[{"Append", "[", 
             RowBox[{"t", ",", 
              RowBox[{"TensorSymmetry", "\[Rule]", "newts"}]}], "]"}]}], 
           "}"}], ",", "True", ",", 
          RowBox[{"{", 
           RowBox[{"newts", ",", 
            RowBox[{"t", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorSymmetry", "\[Rule]", "oldts_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorSymmetry", "\[Rule]", "newts"}], ")"}]}]}]}], 
           "}"}]}], "]"}]}]}], "]"}]}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.672964252873741*^9, 3.6729643833032446`*^9}, {
   3.8454341927154727`*^9, 3.845434212486429*^9}, {3.8460310209181595`*^9, 
   3.8460311147301235`*^9}, {3.8460311538159637`*^9, 
   3.8460311760786333`*^9}, {3.846031368802162*^9, 3.8460313956112995`*^9}, 
   3.847244168918722*^9, {3.847244654910158*^9, 3.847244663677137*^9}, {
   3.8472458282849016`*^9, 3.847245838552026*^9}, {3.847772557700958*^9, 
   3.8477725755809636`*^9}, 3.8477831348011355`*^9, {3.84779136804475*^9, 
   3.847791373011225*^9}, {3.853218368177205*^9, 3.853218378517086*^9}, {
   3.855269307064885*^9, 3.855269564911346*^9}, {3.8552696403502526`*^9, 
   3.8552696940623903`*^9}, {3.8751423143590374`*^9, 3.87514233667031*^9}, {
   3.8751423764048605`*^9, 
   3.875142400268011*^9}},ExpressionUUID->"37147205-5cb8-4f7a-b766-\
decc14db435c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Evaluating abstract indices at specific coordinates/values", \
"Subsubsection",
 CellChangeTimes->{
  3.8611418680599484`*^9, {3.8673187698376665`*^9, 
   3.8673187743332243`*^9}},ExpressionUUID->"21452b93-eb66-46fe-8421-\
ce6f17afd95c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Evaluating", " ", "abstract", " ", "indices", " ", "at", " ", "specific",
      " ", 
     RowBox[{"coordinates", "/", "values"}]}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"IofII", ":", " ", 
     RowBox[{
     "If", " ", "all", " ", "Indices", " ", "are", " ", "either", " ", 
      "Integers", " ", "or", " ", "Coordinates", " ", "we", " ", "return", 
      " ", "the", " ", "component"}]}],
    FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "need", " ", "to", " ", "include", " ", "the", " ", 
    "possibility", " ", "that", " ", "there", " ", "may", " ", "be", " ", 
    "an", " ", "UnderBar", " ", "applied", " ", "to", " ", "some", " ", "of", 
    " ", "the", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"No", " ", "UnderBarred", " ", "Indices"}],
    FontColor->RGBColor[0.6, 0.4, 0.2]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{
      RowBox[{"matrix", "\[LeftDoubleBracket]", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"#", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
             "si", "+", "1"}], ")"}], "&"}], "/@", "\[Mu]T"}], ")"}]}], 
       "\[RightDoubleBracket]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"NotAbstractIndex", "[", 
            RowBox[{"#", ",", "cooo", ",", "si"}], "]"}], "&"}], "/@", 
          "\[Mu]T"}], "]"}], "===", 
        RowBox[{"{", "True", "}"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{
     "If", " ", "there", " ", "are", " ", "more", " ", "than", " ", "1", " ", 
      "UnderBarred", " ", "Indices", " ", "and", " ", "all", " ", "Indices", 
      " ", "are", " ", "not", " ", "abstract", " ", "then", " ", "all", " ", 
      "those", " ", "indices", " ", "not", " ", "UnderBarred", " ", "are", 
      " ", "subject", " ", "to", " ", "the", " ", "operations", " ", "in", 
      " ", "IIofII", " ", "below"}], ",", " ", 
     RowBox[{
     "until", " ", "all", " ", "indices", " ", "are", " ", "UnderBarred"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "So", " ", "what", " ", "remains", " ", "is", " ", "to", " ", "deal", " ",
      "with", " ", "a", " ", "Tensor", " ", "with", " ", "all", " ", 
     "UnderBarred", " ", "Indices"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"All", " ", "UnderBarred", " ", "Indices"}],
     FontColor->RGBColor[0.6, 0.4, 0.2]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"\[Mu]T_List", "/;", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
              RowBox[{"UnderBar", "[", "_", "]"}], "]"}], ".."}], "}"}]}], 
          "]"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{"(*", " ", 
      RowBox[{
      "if", " ", "all", " ", "Indices", " ", "are", " ", "UnderBarred", " ", 
       "there", " ", "should", " ", "be", " ", "only", " ", "one", " ", 
       "component"}], " ", "*)"}], 
     RowBox[{
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "matrix", "]"}], "===", "List"}], ",", 
        RowBox[{
        "matrix", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",",
         "True", ",", "matrix"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "first", " ", "remove", " ", "repeated", " ", "indices", " ", 
           "then", " ", "remove", " ", "all", " ", 
           RowBox[{"UnderBar", "'"}], "s", " ", "to", " ", "first", " ", 
           "check", " ", "no", " ", "indices", " ", "are", " ", "abstract", 
           " ", "ones"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"NotAbstractIndex", "[", 
              RowBox[{
               RowBox[{"#", "/.", 
                RowBox[{
                 RowBox[{"UnderBar", "[", "aa_", "]"}], "\[Rule]", "aa"}]}], 
               ",", "cooo", ",", "si"}], "]"}], "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}]}], "]"}],
           "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"IIofII", ":", " ", 
      RowBox[{"If", " ", "one", " ", "or", " ", "more", " ", 
       RowBox[{"Indices", " ", "--"}], " ", "but", " ", "not", " ", "all", 
       " ", "of", " ", 
       RowBox[{"them", " ", "--"}], " ", "are", " ", "Integer", " ", "or", 
       " ", "coordinates", " ", "we", " ", "reduce", " ", "the", " ", "rank", 
       " ", "of", " ", "the", " ", "Tensor", " ", "accordingly"}]}],
     FontColor->RGBColor[0, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"i1___", ",", "\[Mu]T_", ",", "i2___"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mtx", ",", "ni", ",", "VectorJ", ",", "ix", ",", "leftidx"}], "}"}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"contract", " ", "with", " ", 
          SubscriptBox[
           SuperscriptBox["\[Delta]", "\[Mu]"], "ni"], " ", "or", " ", 
          SubscriptBox["\[Delta]", 
           RowBox[{"\[Mu]", " ", "ni"}]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"ni", "=", 
          RowBox[{
           RowBox[{"NumericIndex", "[", 
            RowBox[{"\[Mu]T", ",", "cooo", ",", "si"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           SubscriptBox[
            SuperscriptBox["\[Delta]", "\[Mu]"], "ni"], " ", "or", " ", 
           SubscriptBox["\[Delta]", 
            RowBox[{"\[Mu]", " ", "ni"}]]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"VectorJ", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"ni", "===", "ix"}], ",", "1", ",", "True", ",", "0"}], 
             "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ix", ",", "si", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", "1"}]}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "to", " ", "contract", " ", 
           "Tensor", " ", "with", " ", 
           SubscriptBox[
            SuperscriptBox["\[Delta]", "\[Mu]"], "ni"], " ", "or", " ", 
           SubscriptBox["\[Delta]", 
            RowBox[{"\[Mu]", " ", "ni"}]]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"mtx", "=", 
          RowBox[{"TensorProduct", "[", 
           RowBox[{"VectorJ", ",", "matrix"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{
           "...", " ", "do", " ", "not", " ", "include", " ", "indices", " ", 
            "that", " ", "do", " ", "not", " ", "pass", " ", "TestIndices", 
            " ", "ensuring", " ", "that", " ", "sequential", " ", "Tensor", 
            " ", "reduction", " ", "is", " ", 
            RowBox[{"OK", " ", "--"}], " ", 
            RowBox[{"i", ".", "e", "."}]}], ",", " ", 
           RowBox[{"no", " ", "infinite", " ", "recursion", " ", 
            RowBox[{"occurs", " ", "--"}], " ", "as", " ", "long", " ", "as", 
            " ", "the", " ", "UnderBar", " ", "is", " ", "applied", " ", "to",
             " ", "the", " ", "said", " ", "index", " ", "after", " ", 
            "TensorContract", " ", "is", " ", "applied"}]}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"leftidx", "=", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"{", "i1", "}"}], ",", 
            RowBox[{"xx_", "/;", 
             RowBox[{
              RowBox[{"TestIndices", "[", "xx", "]"}], "===", "False"}]}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mtx", "=", 
          RowBox[{"TensorContract", "[", 
           RowBox[{"mtx", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "leftidx", "]"}], "+", "2"}]}], "}"}], 
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"return", " ", "the", " ", "Tensor", " ", 
           RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", 
           " ", "except", " ", "the", " ", "TensorComponents", " ", "and", 
           " ", "the", " ", "index", " ", "\[Mu]T"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{"xxx", ",", "\[IndentingNewLine]", 
           RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"UnderBar", "/@", "\[Mu]T"}], ",", "i2"}], "}"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", "mtx"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{
         "check", " ", "the", " ", "index", " ", "is", " ", "not", " ", 
          "abstract"}], " ", "*)"}], 
        RowBox[{"NotAbstractIndex", "[", 
         RowBox[{"\[Mu]T", ",", "cooo", ",", "si"}], "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.831438981749403*^9, 3.8314389863695817`*^9}, {
   3.838192702526781*^9, 3.838192713373404*^9}, {3.8484516378413415`*^9, 
   3.8484516417909007`*^9}, {3.848451690072141*^9, 3.84845169096559*^9}, {
   3.8955547737883625`*^9, 
   3.8955547737953587`*^9}},ExpressionUUID->"338b0823-3ca3-4ff0-ae40-\
9910b605f2d3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Einstein summation", "Subsubsection",
 CellChangeTimes->{
  3.8611418822063417`*^9},ExpressionUUID->"8fd9aec0-45a5-4318-82ee-\
88053c8585f4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Einstein", " ", 
     RowBox[{"summation", ":", " ", 
      RowBox[{
      "Repeated", " ", "indices", " ", "are", " ", "summed", " ", "over"}]}]}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"w", "/", " ", "Tooltipdisplay"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", "ttdd_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
          "i3___"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mtx", ",", "MJ", ",", "ix1", ",", "ix2", ",", "leftidx1", ",", 
          "leftidx2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Remember", " ", "to", " ", "remove", " ", "underbarred", " ", 
          "indices", " ", "because", " ", "they", " ", "are", " ", "no", " ", 
          "longer", " ", "part", " ", "of", " ", "the", " ", "active", " ", 
          "index", " ", "structue"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mtx", "=", 
          RowBox[{"TensorContract", "[", 
           RowBox[{"matrix", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"{", "i1", "}"}], "]"}], "]"}], "+", "1"}], ",", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"{", "i1", "}"}], "]"}], "]"}], "+", "1", "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"{", "i2", "}"}], "]"}], "]"}], "+", "1"}]}], "}"}],
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"return", " ", "the", " ", "Tensor", " ", 
           RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", 
           " ", "except", " ", "the", " ", "TensorComponents", " ", "and", 
           " ", "the", " ", "indics", " ", "\[Mu]1T", " ", "and", " ", 
           "\[Mu]2T"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{"xxx", ",", "\[IndentingNewLine]", 
           RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"UnderBar", "/@", "\[Mu]1T"}], ",", "i2", ",", 
              RowBox[{"UnderBar", "/@", "\[Mu]2T"}], ",", "i3"}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", "mtx"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"ttdd", ",", "matrix", ",", "\[Infinity]"}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ",", "ttdd", ",", "True", ",", 
              RowBox[{"ttdd", "/.", 
               RowBox[{"matrix", "\[Rule]", "mtx"}]}]}], "]"}]}]}], "]"}]}]}],
        "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "repeated", " ", "indices"}], " ", "*)"}], 
         RowBox[{
          RowBox[{
          "\[Mu]1T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{
          "\[Mu]2T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
          ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "one", " ", "index", " ", "up", " ", "and", " ", 
           "one", " ", "down"}], " ", "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
           RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
          RowBox[{"-", "1"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{"!", 
          RowBox[{"NotAbstractIndex", "[", 
           RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{"!", 
          RowBox[{"NotAbstractIndex", "[", 
           RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], "&&", 
        RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
        RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"w", "/", "o"}], " ", "Tooltipdisplay"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"xxx___", "/;", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{"TooltipDisplayNoPart", "[", 
            RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "]"}], "===", 
         RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
          "i3___"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
      "\[IndentingNewLine]", "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mtx", ",", "MJ", ",", "ix1", ",", "ix2", ",", "leftidx1", ",", 
          "leftidx2"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Remember", " ", "to", " ", "remove", " ", "underbarred", " ", 
          "indices", " ", "because", " ", "they", " ", "are", " ", "no", " ", 
          "longer", " ", "part", " ", "of", " ", "the", " ", "active", " ", 
          "index", " ", "structue"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"mtx", "=", 
          RowBox[{"TensorContract", "[", 
           RowBox[{"matrix", ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"{", "i1", "}"}], "]"}], "]"}], "+", "1"}], ",", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"{", "i1", "}"}], "]"}], "]"}], "+", "1", "+", 
                RowBox[{"Length", "[", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"{", "i2", "}"}], "]"}], "]"}], "+", "1"}]}], "}"}],
              "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"return", " ", "the", " ", "Tensor", " ", 
           RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", 
           " ", "except", " ", "the", " ", "TensorComponents", " ", "and", 
           " ", "the", " ", "indics", " ", "\[Mu]1T", " ", "and", " ", 
           "\[Mu]2T"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{"xxx", ",", "\[IndentingNewLine]", 
           RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"i1", ",", 
              RowBox[{"UnderBar", "/@", "\[Mu]1T"}], ",", "i2", ",", 
              RowBox[{"UnderBar", "/@", "\[Mu]2T"}], ",", "i3"}], "}"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", "mtx"}]}], "]"}]}]}], "]"}],
       "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "repeated", " ", "indices"}], " ", "*)"}], 
         RowBox[{
          RowBox[{
          "\[Mu]1T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
          RowBox[{
          "\[Mu]2T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
          ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "one", " ", "index", " ", "up", " ", "and", " ", 
           "one", " ", "down"}], " ", "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
           RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
          RowBox[{"-", "1"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{"!", 
          RowBox[{"NotAbstractIndex", "[", 
           RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{"!", 
          RowBox[{"NotAbstractIndex", "[", 
           RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}]}], ")"}], "&&", 
        RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
        RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671403822997702*^9, 
   3.6714038860202975`*^9}, {3.671404769666751*^9, 3.671404932124491*^9}, {
   3.671404999032096*^9, 3.671404999152096*^9}, {3.6714050894249077`*^9, 
   3.671405092122412*^9}, {3.67140523671815*^9, 3.6714053192882805`*^9}, {
   3.6714054173459363`*^9, 3.671405533768616*^9}, {3.671409211990823*^9, 
   3.671409256770013*^9}, {3.671409296689161*^9, 3.671409307821204*^9}, 
   3.6714105541618795`*^9, {3.671410809268471*^9, 3.671410822660237*^9}, {
   3.6714124277246027`*^9, 3.67141242885212*^9}, {3.671648361386112*^9, 
   3.6716483651301193`*^9}, {3.671648574498087*^9, 3.671648600425332*^9}, {
   3.6716488824270277`*^9, 3.671649000831236*^9}, {3.671740416301479*^9, 
   3.6717404423390565`*^9}, 3.671747751830694*^9, {3.671762336815095*^9, 
   3.6717623586929307`*^9}, 3.671762401491088*^9, {3.825631538697545*^9, 
   3.8256315947610993`*^9}, {3.8256316516018195`*^9, 
   3.8256317001842775`*^9}, {3.8314389891691003`*^9, 
   3.8314389931051197`*^9}, {3.837500976504446*^9, 3.837500993879443*^9}, {
   3.837501078254426*^9, 3.83750112008255*^9}, {3.837501159988804*^9, 
   3.8375012158820705`*^9}, {3.8375012480695696`*^9, 
   3.8375012502102175`*^9}, {3.8375013464337997`*^9, 
   3.8375013604962997`*^9}, {3.837501475652548*^9, 3.8375014880275517`*^9}, {
   3.8757532108817077`*^9, 3.8757532167029066`*^9}, {3.8955547738173447`*^9, 
   3.8955547738273396`*^9}},ExpressionUUID->"36cf09fb-177d-4db5-95d5-\
946628070b0d"],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Old", " ", "code", " ", "\[IndentingNewLine]", 
     StyleBox[
      RowBox[{"(*", " ", 
       RowBox[{"Einstein", " ", 
        RowBox[{"summation", ":", " ", 
         RowBox[{
         "Repeated", " ", "indices", " ", "are", " ", "summed", " ", 
          "over"}]}]}], " ", "*)"}],
      FontColor->GrayLevel[0.5]], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"w", "/", " ", "Tooltipdisplay"}], "*)"}], 
     "\[IndentingNewLine]", "Tensor"}], "/:", 
    RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
     RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
      RowBox[{"TooltipDisplay", "\[Rule]", "ttdd_"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Indices", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
         "i3___"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mtx", ",", "MJ", ",", "ix1", ",", "ix2", ",", "leftidx1", ",", 
         "leftidx2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MJ", "=", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "cooo", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "are", " ", "going", " ", "to", " ", "contract", " ", 
          "Tensor", " ", "with", " ", 
          SubscriptBox[
           SuperscriptBox["\[Delta]", "\[Mu]1"], "\[Mu]2"], " ", "or", " ", 
          SubscriptBox[
           SuperscriptBox["\[Delta]", "\[Mu]2"], "\[Mu]1"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mtx", "=", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"MJ", ",", "matrix"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "...", " ", "do", " ", "not", " ", "include", " ", "indices", " ", 
          "that", " ", "do", " ", "not", " ", "pass", " ", "TestIndices", " ",
           "ensuring", " ", "that", " ", "sequential", " ", "Tensor", " ", 
          "reduction", " ", "is", " ", "OK", " ", "as", " ", "long", " ", 
          "as", " ", "the", " ", "UnderBar", " ", "is", " ", "applied", " ", 
          "to", " ", "the", " ", "said", " ", "index", " ", "after", " ", 
          "TensorContract", " ", "is", " ", "applied"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"leftidx1", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"{", "i1", "}"}], ",", 
           RowBox[{"xx_", "/;", 
            RowBox[{
             RowBox[{"TestIndices", "[", "xx", "]"}], "===", "False"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"leftidx2", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"{", "i2", "}"}], ",", 
           RowBox[{"xx_", "/;", 
            RowBox[{
             RowBox[{"TestIndices", "[", "xx", "]"}], "===", "False"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mtx", "=", 
         RowBox[{"TensorContract", "[", 
          RowBox[{"mtx", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "leftidx1", "]"}], "+", "3"}]}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{
                RowBox[{"Length", "[", "leftidx1", "]"}], "+", 
                RowBox[{"Length", "[", "leftidx2", "]"}], "+", "4"}]}], 
              "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "the", " ", "Tensor", " ", 
          RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", " ",
           "except", " ", "the", " ", "TensorComponents", " ", "and", " ", 
          "the", " ", "indics", " ", "\[Mu]1T", " ", "and", " ", "\[Mu]2T"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xxx", ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"UnderBar", "/@", "\[Mu]1T"}], ",", "i2", ",", 
             RowBox[{"UnderBar", "/@", "\[Mu]2T"}], ",", "i3"}], "}"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "mtx"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", "mtx"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "repeated", " ", "indices"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
        "\[Mu]1T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
        RowBox[{
        "\[Mu]2T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "one", " ", "index", " ", "up", " ", "and", " ", "one", 
         " ", "down"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
         RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
        RowBox[{"-", "1"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}], 
            ",", 
            RowBox[{"Range", "[", 
             RowBox[{"si", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", "1"}]}], 
             "]"}]}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NumericIndex", "[", 
             RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}]}], 
         ")"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}], 
            ",", 
            RowBox[{"Range", "[", 
             RowBox[{"si", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", "1"}]}], 
             "]"}]}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NumericIndex", "[", 
             RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}]}], 
         ")"}]}], ")"}], "&&", 
      RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
      RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"w", "/", "o"}], " ", "Tooltipdisplay"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Tensor", "/:", 
    RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"xxx___", "/;", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "xxx", "}"}], ",", 
            RowBox[{"TooltipDisplay", "\[Rule]", "nnn_"}], ",", 
            "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
        RowBox[{"{", "}"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"CoordinateSystem", "\[Rule]", "cooo_List"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Indices", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
        "i1___", ",", "\[Mu]1T_", ",", "i2___", ",", "\[Mu]2T_", ",", 
         "i3___"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"TensorComponents", "\[Rule]", "matrix_"}]}], 
     "\[IndentingNewLine]", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mtx", ",", "MJ", ",", "ix1", ",", "ix2", ",", "leftidx1", ",", 
         "leftidx2"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MJ", "=", 
         RowBox[{"IdentityMatrix", "[", 
          RowBox[{"Length", "[", "cooo", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "are", " ", "going", " ", "to", " ", "contract", " ", 
          "Tensor", " ", "with", " ", 
          SubscriptBox[
           SuperscriptBox["\[Delta]", "\[Mu]1"], "\[Mu]2"], " ", "or", " ", 
          SubscriptBox[
           SuperscriptBox["\[Delta]", "\[Mu]2"], "\[Mu]1"]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"mtx", "=", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"MJ", ",", "matrix"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "...", " ", "do", " ", "not", " ", "include", " ", "indices", " ", 
          "that", " ", "do", " ", "not", " ", "pass", " ", "TestIndices", " ",
           "ensuring", " ", "that", " ", "sequential", " ", "Tensor", " ", 
          "reduction", " ", "is", " ", "OK", " ", "as", " ", "long", " ", 
          "as", " ", "the", " ", "UnderBar", " ", "is", " ", "applied", " ", 
          "to", " ", "the", " ", "said", " ", "index", " ", "after", " ", 
          "TensorContract", " ", "is", " ", "applied"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"leftidx1", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"{", "i1", "}"}], ",", 
           RowBox[{"xx_", "/;", 
            RowBox[{
             RowBox[{"TestIndices", "[", "xx", "]"}], "===", "False"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"leftidx2", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"{", "i2", "}"}], ",", 
           RowBox[{"xx_", "/;", 
            RowBox[{
             RowBox[{"TestIndices", "[", "xx", "]"}], "===", "False"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mtx", "=", 
         RowBox[{"TensorContract", "[", 
          RowBox[{"mtx", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", 
               RowBox[{
                RowBox[{"Length", "[", "leftidx1", "]"}], "+", "3"}]}], "}"}],
              ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", 
               RowBox[{
                RowBox[{"Length", "[", "leftidx1", "]"}], "+", 
                RowBox[{"Length", "[", "leftidx2", "]"}], "+", "4"}]}], 
              "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "the", " ", "Tensor", " ", 
          RowBox[{"w", "/", " ", "everything"}], " ", "the", " ", "same", " ",
           "except", " ", "the", " ", "TensorComponents", " ", "and", " ", 
          "the", " ", "indics", " ", "\[Mu]1T", " ", "and", " ", "\[Mu]2T"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"xxx", ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"i1", ",", 
             RowBox[{"UnderBar", "/@", "\[Mu]1T"}], ",", "i2", ",", 
             RowBox[{"UnderBar", "/@", "\[Mu]2T"}], ",", "i3"}], "}"}]}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "mtx"}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "repeated", " ", "indices"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
        "\[Mu]1T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
        RowBox[{
        "\[Mu]2T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "one", " ", "index", " ", "up", " ", "and", " ", "one", 
         " ", "down"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Sgn", "[", "\[Mu]1T", "]"}], 
         RowBox[{"Sgn", "[", "\[Mu]2T", "]"}]}], "===", 
        RowBox[{"-", "1"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}], 
            ",", 
            RowBox[{"Range", "[", 
             RowBox[{"si", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", "1"}]}], 
             "]"}]}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NumericIndex", "[", 
             RowBox[{"\[Mu]1T", ",", "cooo", ",", "si"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}]}], 
         ")"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "that", " ", "both", " ", "indices", " ", "are", " ", 
           "abstract"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"NumericIndex", "[", 
               RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}], 
            ",", 
            RowBox[{"Range", "[", 
             RowBox[{"si", ",", 
              RowBox[{
               RowBox[{"Length", "[", "cooo", "]"}], "+", "si", "-", "1"}]}], 
             "]"}]}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"NumericIndex", "[", 
             RowBox[{"\[Mu]2T", ",", "cooo", ",", "si"}], "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "}"}]}], 
         ")"}]}], ")"}], "&&", 
      RowBox[{"TestIndices", "[", "\[Mu]1T", "]"}], "&&", 
      RowBox[{"TestIndices", "[", "\[Mu]2T", "]"}]}]}]}], ";"}], 
  "\[IndentingNewLine]", "*)"}]], "Input",
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.671909232684424*^9}, {3.671909455107115*^9, 3.6719094688767424`*^9}, {
   3.8955547738493257`*^9, 
   3.895554773875312*^9}},ExpressionUUID->"02652a5e-7479-46bb-822e-\
2576caf2530d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Appearance", " ", "of", " ", "Metric", " ", "Tensor"}],
    FontColor->GrayLevel[0.5]], " ", "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontColor->GrayLevel[0.5]], 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Jan", " ", "2014"}], ":", " ", 
    RowBox[{
    "we", " ", "have", " ", "decided", " ", "to", " ", "display", " ", "the", 
     " ", "metric", " ", "as", " ", "any", " ", "other", " ", "rank", " ", 
     "2", " ", "tensor", " ", 
     RowBox[{"i", ".", "e", ".", " ", 
      SubscriptBox["g", "\[Mu]\[Nu]"]}], " ", "or", " ", 
     SuperscriptBox["g", "\[Mu]\[Nu]"], " ", "or", " ", 
     SubscriptBox[
      SuperscriptBox["\[Delta]", "\[Mu]"], "\[Nu]"], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"if", " ", "TensorName", " ", "is", " ", "g"}], ")"}], ".", 
      " ", "TensorComponents"}], " ", "are", " ", "displayed", " ", "by", " ",
      "hovering", " ", "mouse", " ", "cursor", " ", "over", " ", 
     RowBox[{
      SubscriptBox["g", "\[Mu]\[Nu]"], "."}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Format", "[", 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StartIndex", "\[Rule]", "si_Integer"}], 
        RowBox[{"(*", 
         RowBox[{"/;", 
          RowBox[{"si", "\[GreaterEqual]", "0"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Mu]T_", "/;", 
            RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
           RowBox[{"\[Nu]T_", "/;", 
            RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CoordinateSystem", "\[Rule]", "coords_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "matrix_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelComponents", "\[Rule]", "ChrisRules_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannComponents", "\[Rule]", "RiemRules_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciComponents", "\[Rule]", "RicRules_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarInvariant", "\[Rule]", "RRules_"}], ",", 
        "\[IndentingNewLine]", "xx___"}], "\[IndentingNewLine]", "]"}], "]"}],
      ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xx", ",", "\[IndentingNewLine]", 
       RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "coords"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{"name", ",", 
           RowBox[{"UpOrDown", "[", "\[Mu]T", "]"}], ",", 
           RowBox[{"UpOrDown", "[", "\[Nu]T", "]"}]}], "}"}], "]"}], 
        "\[Rule]", "matrix"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"ChrisRules", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"ChristoffelComponents", "[", 
            RowBox[{
             RowBox[{"SuperMinus", "[", "\[Mu]s_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "\[Alpha]s_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "\[Beta]s_", "]"}]}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Mu]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "Null"}], "}"}], "]"}], ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{"Null", ",", 
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Alpha]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{"Null", ",", 
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Beta]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], "]"}]}],
           "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"RiemRules", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"RiemannComponents", "[", 
            RowBox[{
             RowBox[{"SuperMinus", "[", "\[Mu]s_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "\[Nu]s_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "\[Alpha]s_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "\[Beta]s_", "]"}]}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<R\>\"", ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Mu]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}], ",", "Null"}], "}"}], "]"}], ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{"Null", ",", 
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Nu]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{"Null", ",", 
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Alpha]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{"Null", ",", 
                 RowBox[{"coords", "\[LeftDoubleBracket]", 
                  RowBox[{"\[Beta]s", "-", "si", "+", "1"}], 
                  "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], "]"}]}],
           "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"RicRules", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"RicciComponents", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Nu]s_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Beta]s_", "]"}]}], "]"}], 
          "\[RuleDelayed]", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<R\>\"", ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"Null", ",", 
                RowBox[{"coords", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Nu]s", "-", "si", "+", "1"}], 
                 "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
             RowBox[{"Column", "[", 
              RowBox[{"{", 
               RowBox[{"Null", ",", 
                RowBox[{"coords", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Beta]s", "-", "si", "+", "1"}], 
                 "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], "]"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"RRules", "/.", 
        RowBox[{"{", 
         RowBox[{
         "RicciScalar", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"R\",FontSlant->\"Italic\"]\)\>\""}], 
         "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], " ", 
   "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092245198083`*^9}, {3.8955547738903027`*^9, 
   3.895554773893301*^9}},ExpressionUUID->"5b8c30c6-bd5c-4b4a-9308-\
8005b11d9c0c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Format", "Subsubsection",
 CellChangeTimes->{
  3.861141894360052*^9},ExpressionUUID->"e40595af-8b16-4e8a-bd7d-\
29d3504b2037"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Format", ":"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->GrayLevel[0.5]]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "display", " ", "the", " ", "TensorName", " ", "and", " ", 
    "associated", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"w", "/", " ", "TooltipDisplay"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"TensorType", "\[Rule]", 
         RowBox[{"type_", "/;", 
          RowBox[{"(", 
           RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", "name_"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
       RowBox[{"(*", 
        RowBox[{"/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "_Symbol"}], "]"}]}], ")"}], "&"}], "/@", "\[Mu]T"}], 
            "]"}], "===", 
           RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", 
        RowBox[{"display_", "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"display", "=!=", "Null"}], ")"}], 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
            "TensorComponents"}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{"display", "=!=", "TensorComponents"}], ")"}]}]}]}]}], 
      "\[IndentingNewLine]", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"NewCode", ":", " ", "TooltipStyle"}], "*)"}], 
    RowBox[{"Tooltip", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
           ")"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Head", "[", "display", "]"}], "===", "List"}], ",", 
        RowBox[{"Flatten", "[", "display", "]"}], ",", "True", ",", 
        "display"}], "]"}], ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyleNoPart", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyleNoPart", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", 
          RowBox[{"TooltipStyle", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "name", "}"}], ",", 
         RowBox[{"Del", "[", "_", "]"}], ",", "\[Infinity]"}], "]"}], "===", 
       RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "I", " ", "of", " ",
      "II"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Scalars", ",", " ", 
     RowBox[{
      RowBox[{"vectors", " ", "and", " ", "rank"}], "-", 
      RowBox[{"2", " ", "tensors"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Format", "[", 
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xxx___", "/;", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Delete", " ", "Redundent", " ", "Union"}]}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"TooltipDisplayNoPart", "[", 
                 RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"TooltipDisplayNoPart", "[", 
                 RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
               RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}], 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
             "TensorComponents"}], "*)"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TooltipDisplayNoPart", "[", 
              RowBox[{"{", "xxx", "}"}], "]"}], "=!=", 
             RowBox[{"{", "TensorComponents", "}"}]}], ")"}]}], ")"}]}], 
        RowBox[{"(*", 
         RowBox[{"&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"{", "xxx", "}"}], ",", 
                  RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ",", 
                  "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"{", "xxx", "}"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ")"}], 
                   "\[Rule]", "ts"}], ",", "\[Infinity]"}], "]"}], "]"}], 
               "]"}], "===", 
              RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"TensorType", "\[Rule]", 
          RowBox[{"type_", "/;", 
           RowBox[{"(", 
            RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
        RowBox[{"(*", 
         RowBox[{"/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
            RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"scalar", ",", " ", 
         RowBox[{
         "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], " ", 
        "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Length", "[", "coords", "]"}], ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}], 
       ")"}]}], "]"}], ":=", 
    RowBox[{"(*", 
     RowBox[{"NewCode", ":", " ", "TooltipStyle"}], "*)"}], 
    RowBox[{"Tooltip", "[", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
           ")"}]}]}], "}"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"MatrixForm", "[", "ttM", "]"}], ",", 
        RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "coords"}]}], "}"}], ",", 
      RowBox[{"Sequence", "@@", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyleNoPart", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "===", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"{", "}"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TooltipStyleNoPart", "[", 
            RowBox[{"{", "xxx", "}"}], "]"}], ")"}], "=!=", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"TooltipStyle", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"{", "xxx", "}"}], "]"}], ")"}]}], "}"}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "II", " ", "of", 
     " ", "II"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"everything", " ", "else"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"xxx___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"TooltipDisplayNoPart", "[", 
                RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"TooltipDisplayNoPart", "[", 
                 RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
               RowBox[{"{", "Null", "}"}]}], ")"}], 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
               "TensorComponents"}], "*)"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", 
                RowBox[{"{", "xxx", "}"}], "]"}], "=!=", 
               RowBox[{"{", "TensorComponents", "}"}]}], ")"}]}]}], ")"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
         RowBox[{"(*", 
          RowBox[{"/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                 ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
             RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}]}], 
        "\[IndentingNewLine]", "]"}], "/;", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"scalar", ",", " ", 
           RowBox[{
           "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], " ",
           "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "coords", "]"}], ",", 
               RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}], 
         ")"}]}]}], "]"}], ":=", 
     RowBox[{"Row", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
          ")"}]}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
     "TensorComponents"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Format", "[", "\[IndentingNewLine]", 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx___", 
        RowBox[{"(*", 
         RowBox[{"/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Flatten", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xxx", "}"}], ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ",", 
               "\[Infinity]"}], "]"}], "]"}], "===", 
            RowBox[{"{", "TensorComponents", "}"}]}], ")"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", "TensorComponents"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], ":=", 
     StyleBox["\n", "Code"], 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"TooltipStyleNoPart", "[", 
           RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Tooltip", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
              ")"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"NonZeroTensorComponents", "[", 
          RowBox[{
          "name", ",", "\[IndentingNewLine]", "\[Mu]T", ",", 
           "\[IndentingNewLine]", "ttM", ",", "\[IndentingNewLine]", 
           "coords"}], "]"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"TooltipStyleNoPart", "[", 
           RowBox[{"{", "xxx", "}"}], "]"}], "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Tooltip", "[", 
        RowBox[{
         RowBox[{"Row", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
              ")"}]}]}], "}"}], "]"}], ",", 
         RowBox[{"NonZeroTensorComponents", "[", 
          RowBox[{
          "name", ",", "\[IndentingNewLine]", "\[Mu]T", ",", 
           "\[IndentingNewLine]", "ttM", ",", "\[IndentingNewLine]", 
           "coords"}], "]"}], ",", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"{", "xxx", "}"}], "]"}]}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "Start"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"(*", " ", 
     StyleBox[
      RowBox[{"Format", ":"}],
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->GrayLevel[0.5]], 
     StyleBox["*)",
      FontColor->GrayLevel[0.5]]}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "we", " ", "display", " ", "the", " ", "TensorName", " ", "and", " ", 
      "associated", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"w", "/", " ", "TooltipDisplay"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"NewCode", ":", " ", 
      RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Format", "[", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"TensorType", "\[Rule]", 
           RowBox[{"type_", "/;", 
            RowBox[{"(", 
             RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
         RowBox[{"(*", 
          RowBox[{"/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                 ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
             RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"display_", "/;", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"display", "=!=", "Null"}], ")"}], 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
              "TensorComponents"}], "*)"}], "&&", 
            RowBox[{"(", 
             RowBox[{"display", "=!=", "TensorComponents"}], ")"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}], "]"}], ":=", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "TooltipStyle"}], "*)"}], 
      RowBox[{
       RowBox[{
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", "ttstyle", "}"}], ",", 
          RowBox[{
           RowBox[{"ttstyle", "=", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xxx", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tt_"}], ")"}], "\[Rule]",
                 "tt"}], ",", "\[Infinity]"}], "]"}], "]"}]}], ";", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ttstyle", "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", 
                    "\[Mu]T"}], ")"}]}]}], "}"}], "]"}], ",", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "display", "]"}], "===", "List"}], ",", 
                 RowBox[{"Flatten", "[", "display", "]"}], ",", "True", ",", 
                 "display"}], "]"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{"ttstyle", "=!=", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Tooltip", "[", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", 
                    "\[Mu]T"}], ")"}]}]}], "}"}], "]"}], ",", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Head", "[", "display", "]"}], "===", "List"}], ",", 
                 RowBox[{"Flatten", "[", "display", "]"}], ",", "True", ",", 
                 "display"}], "]"}], ",", 
               RowBox[{"TooltipStyle", "\[Rule]", "ttstyle"}]}], "]"}]}], 
            "]"}]}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "name", "}"}], ",", 
              RowBox[{"Del", "[", "_", "]"}], ",", "\[Infinity]"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "I", " ", "of",
           " ", "II"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Scalars", ",", " ", 
          RowBox[{
           RowBox[{"vectors", " ", "and", " ", "rank"}], "-", 
           RowBox[{"2", " ", "tensors"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Format", "[", 
         RowBox[{
          RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"xxx___", "/;", 
             RowBox[{"(*", 
              RowBox[{"NewCode", ":", " ", 
               RowBox[{"Delete", " ", "Redundent", " ", "Union"}]}], "*)"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}], "===", 
                   RowBox[{"{", "}"}]}], ")"}], "||", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], 
                    "\[Rule]", "mmm"}], ",", "\[Infinity]"}], "]"}], "]"}], "===", 
                   RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}], 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
                 "TensorComponents"}], "*)"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Flatten", "[", 
                  RowBox[{"Cases", "[", 
                   RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], 
                    "\[Rule]", "mmm"}], ",", "\[Infinity]"}], "]"}], "]"}], "=!=",
                  "TensorComponents"}], ")"}]}], ")"}]}], 
            RowBox[{"(*", 
             RowBox[{"&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
                  RowBox[{"{", "}"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Union", "[", 
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ")"}], 
                    "\[Rule]", "ts"}], ",", "\[Infinity]"}], "]"}], "]"}], 
                   "]"}], "===", 
                  RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}]}], "*)"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{"TensorType", "\[Rule]", 
              RowBox[{"type_", "/;", 
               RowBox[{"(", 
                RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
            RowBox[{"(*", 
             RowBox[{"/;", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Union", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                    ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
                RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}]}], 
           "\[IndentingNewLine]", "]"}], "/;", 
          RowBox[{"(", 
           RowBox[{"(*", " ", 
            RowBox[{"scalar", ",", " ", 
             RowBox[{
             "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], 
            " ", "*)"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "||", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Length", "[", "coords", "]"}], ",", 
                 RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}],
            ")"}]}], "]"}]}], ":=", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TooltipStyle"}], "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Module", "[", 
          RowBox[{
           RowBox[{"{", "ttstyle", "}"}], ",", 
           RowBox[{
            RowBox[{"ttstyle", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "xxx", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TooltipStyle", "\[Rule]", "tt_"}], ")"}], 
                 "\[Rule]", "tt"}], ",", "\[Infinity]"}], "]"}], "]"}]}], ";", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"ttstyle", "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", 
                    "\[Mu]T"}], ")"}]}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MatrixForm", "[", "ttM", "]"}], ",", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "coords"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"(", 
               RowBox[{"ttstyle", "=!=", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Tooltip", "[", 
               RowBox[{
                RowBox[{"Row", "[", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", 
                    "\[Mu]T"}], ")"}]}]}], "}"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"MatrixForm", "[", "ttM", "]"}], ",", 
                  RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "coords"}]}], 
                 "}"}], ",", 
                RowBox[{"TooltipStyle", "\[Rule]", "ttstyle"}]}], "]"}]}], 
             "]"}]}]}], "]"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "II", " ", 
           "of", " ", "II"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"everything", " ", "else"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Format", "[", 
          RowBox[{
           RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"xxx___", "/;", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}], "===", 
                    RowBox[{"{", "}"}]}], ")"}], "||", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], 
                    "\[Rule]", "mmm"}], ",", "\[Infinity]"}], "]"}], "]"}], "===", 
                    RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}], 
                RowBox[{"(*", 
                 RowBox[{
                  RowBox[{"NewCode", ":", " ", "TooltipDisplay"}], "\[Rule]", 
                  "TensorComponents"}], "*)"}], "&&", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Flatten", "[", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], 
                    "\[Rule]", "mmm"}], ",", "\[Infinity]"}], "]"}], "]"}], "=!=",
                   "TensorComponents"}], ")"}]}], ")"}]}], 
             RowBox[{"(*", 
              RowBox[{"&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ",", 
                    "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
                   RowBox[{"{", "}"}]}], ")"}], "||", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "xxx", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ")"}], 
                    "\[Rule]", "ts"}], ",", "\[Infinity]"}], "]"}], "]"}], 
                    "]"}], "===", 
                   RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}]}], "*)"}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{"(*", " ", 
              RowBox[{"TensorType", "\[Rule]", 
               RowBox[{"type_", "/;", 
                RowBox[{"(", 
                 RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}],
              "\[IndentingNewLine]", 
             RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
             RowBox[{"(*", 
              RowBox[{"/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                    ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
                 RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}]}], 
            "\[IndentingNewLine]", "]"}], "/;", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"(*", " ", 
              RowBox[{"scalar", ",", " ", 
               RowBox[{
               "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], 
              " ", "*)"}], 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], "||", 
              RowBox[{"MatchQ", "[", 
               RowBox[{
                RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Length", "[", "coords", "]"}], ",", 
                   RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], 
               "]"}]}], ")"}]}]}], "]"}]}], ":=", 
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
             ")"}]}]}], "}"}], "]"}]}]}]}], ";"}], "*)"}], 
   StyleBox["\[IndentingNewLine]",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "End"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "Start"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"(*", 
     RowBox[{"With", " ", "Tensor", " ", "Symmetry"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Tensor", "/:", 
      RowBox[{"Format", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xxx___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "xxx", "}"}], ",", 
                   RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ",", 
                   "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "xxx", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], 
                    "\[Rule]", "mmm"}], ",", "\[Infinity]"}], "]"}], "]"}], 
                "]"}], "===", 
               RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"TensorType", "\[Rule]", 
            RowBox[{"type_", "/;", 
             RowBox[{"(", 
              RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
          RowBox[{"(*", 
           RowBox[{"/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                  ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
              RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}]}], 
         "\[IndentingNewLine]", "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"scalar", ",", " ", 
           RowBox[{
           "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], " ",
           "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Length", "[", "coords", "]"}], ",", 
               RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}], 
         ")"}]}], "]"}], ":=", 
      RowBox[{"Tooltip", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
             ")"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"MatrixForm", "[", "ttM", "]"}], ",", 
          RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "coords"}], ",", 
          RowBox[{"\"\<TensorSymmetry\>\"", "\[Rule]", "ts"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"w", "/", "o"}], " ", "TooltipDisplay", " ", "II", " ", "of", 
       " ", "II"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"everything", " ", "else"}], " ", "*)"}], "\[IndentingNewLine]",
      " ", 
     RowBox[{"Tensor", "/:", 
      RowBox[{"Format", "[", 
       RowBox[{
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"xxx___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "xxx", "}"}], ",", 
                   RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ",", 
                   "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], "||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "xxx", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], 
                    "\[Rule]", "mmm"}], ",", "\[Infinity]"}], "]"}], "]"}], 
                "]"}], "===", 
               RowBox[{"{", "Null", "}"}]}], ")"}]}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"TensorType", "\[Rule]", 
            RowBox[{"type_", "/;", 
             RowBox[{"(", 
              RowBox[{"type", "=!=", "\"\<Metric\>\""}], ")"}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
          RowBox[{"(*", 
           RowBox[{"/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                   RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                  ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
              RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}]}], 
         "\[IndentingNewLine]", "]"}], "/;", 
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"scalar", ",", " ", 
            RowBox[{
            "vector", " ", "or", " ", "rank", " ", "2", " ", "tensor"}]}], 
           " ", "*)"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"RemoveUnderBarredIndices", "[", "\[Mu]T", "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}], "||", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "ttM", "]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Length", "[", "coords", "]"}], "}"}], "|", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Length", "[", "coords", "]"}], ",", 
                RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}]}], "]"}]}], 
          ")"}]}]}], "]"}], ":=", 
      RowBox[{"Tooltip", "[", 
       RowBox[{
        RowBox[{"Row", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"FormatTensorName", "[", "name", "]"}], ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
             ")"}]}]}], "}"}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"\"\<TensorSymmetry\>\"", "\[Rule]", "ts"}], "}"}]}], 
       "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    StyleBox["(*",
     FontColor->RGBColor[0.6, 0.4, 0.2]], 
    StyleBox[
     RowBox[{"Abondoned", " ", 
      RowBox[{"code", ":", " ", "End"}]}],
     FontColor->GrayLevel[0.5]], 
    StyleBox["*)",
     FontColor->RGBColor[0.6, 0.4, 0.2]]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092176573935`*^9}, {3.6720740087360315`*^9, 3.672074075534852*^9}, {
   3.672074987021986*^9, 3.672074999122678*^9}, {3.6720750949751606`*^9, 
   3.672075105894785*^9}, {3.672075159332842*^9, 3.672075169396417*^9}, {
   3.6720752377493267`*^9, 3.6720752607176404`*^9}, {3.6720828553884125`*^9, 
   3.6720828660860767`*^9}, {3.6720828971890545`*^9, 
   3.6720829003941035`*^9}, {3.8262358604865246`*^9, 
   3.8262358608389063`*^9}, {3.8262359183019056`*^9, 
   3.8262359185427027`*^9}, {3.8365150275588408`*^9, 
   3.8365150507492037`*^9}, {3.836515245108944*^9, 3.8365153930392113`*^9}, 
   3.8365154381289167`*^9, {3.8365155720588017`*^9, 3.8365156095288286`*^9}, {
   3.8365156823688655`*^9, 3.8365157001690054`*^9}, {3.8365159170689583`*^9, 
   3.836515921233824*^9}, 3.8365165030823064`*^9, {3.836516795034235*^9, 
   3.836516817415293*^9}, {3.8365168529003077`*^9, 3.83651688141634*^9}, {
   3.8365169617025023`*^9, 3.836516984785651*^9}, {3.8365170845064473`*^9, 
   3.8365173153855686`*^9}, {3.83651761500602*^9, 3.8365176366267977`*^9}, {
   3.836517826859807*^9, 3.836517963886343*^9}, {3.8365179991860795`*^9, 
   3.8365180311134453`*^9}, {3.836518063708222*^9, 3.836518186174382*^9}, {
   3.8365182972198324`*^9, 3.836518325075186*^9}, 3.8365183923036757`*^9, {
   3.8365186140992365`*^9, 3.836518636830546*^9}, {3.83651913895794*^9, 
   3.836519174503744*^9}, {3.836519340162985*^9, 3.8365193437554083`*^9}, {
   3.836519733430002*^9, 3.836519737357012*^9}, 3.8365198639242077`*^9, 
   3.836519914313467*^9, 3.836527600174177*^9, 3.8365285238024883`*^9, {
   3.8365287836708336`*^9, 3.8365287950993757`*^9}, {3.836528984248169*^9, 
   3.8365289861581697`*^9}, 3.837499534541447*^9, {3.837499601697709*^9, 
   3.837499616525835*^9}, {3.837499646775832*^9, 3.8374996782149844`*^9}, {
   3.837499727308753*^9, 3.83749972941812*^9}, {3.837499764386859*^9, 
   3.837499780543131*^9}, 3.8375003058890777`*^9, {3.8375009668794236`*^9, 
   3.837500968113796*^9}, {3.846031687562609*^9, 3.8460317040663166`*^9}, {
   3.8460318655619345`*^9, 3.846031870389908*^9}, {3.8460319555754375`*^9, 
   3.8460320563093023`*^9}, {3.84603212927774*^9, 3.84603215947159*^9}, {
   3.846032253115411*^9, 3.8460322559550915`*^9}, 3.8472451727531757`*^9, 
   3.847245237997714*^9, {3.8472454968177752`*^9, 3.84724550650664*^9}, {
   3.847245619876923*^9, 3.8472456229236784`*^9}, 3.8472456829236927`*^9, 
   3.847772314831476*^9, {3.8477723561016693`*^9, 3.847772361073612*^9}, 
   3.847772403511515*^9, {3.8477937114574594`*^9, 3.8477937186663227`*^9}, {
   3.84779460846754*^9, 3.8477946190063505`*^9}, 3.8478339500281925`*^9, {
   3.847834029899483*^9, 3.8478341250176616`*^9}, 3.8478345704838595`*^9, {
   3.8478346049132657`*^9, 3.847834638506363*^9}, 3.8478357123347893`*^9, {
   3.847838149780706*^9, 3.847838165232731*^9}, {3.847838328175954*^9, 
   3.8478383489427657`*^9}, {3.8489975869366035`*^9, 3.848997632780204*^9}, {
   3.8489978434514723`*^9, 3.848997859618456*^9}, {3.8532180985290766`*^9, 
   3.8532181013589973`*^9}, {3.8532181564283133`*^9, 3.853218158538715*^9}, 
   3.853218308947239*^9, {3.853218507786126*^9, 3.8532185251855364`*^9}, 
   3.853218588555437*^9, {3.860066278727498*^9, 3.8600662980715694`*^9}, 
   3.860066371251645*^9, {3.860578071860258*^9, 3.8605781001533947`*^9}, {
   3.8611442712014313`*^9, 3.8611443110513754`*^9}, {3.861144389161501*^9, 
   3.861144394624101*^9}, 3.8611444803815823`*^9, {3.8611445180216103`*^9, 
   3.861144518991531*^9}, {3.866763147694089*^9, 3.8667631628319864`*^9}, {
   3.8667632455889463`*^9, 3.866763247008811*^9}, 3.8667632928254957`*^9, {
   3.8667633284878473`*^9, 3.8667633716236153`*^9}, {3.8667634181521397`*^9, 
   3.866763426645866*^9}, {3.866763460366863*^9, 3.866763518803314*^9}, {
   3.8667637080895348`*^9, 3.8667637569204636`*^9}, {3.8667637983436203`*^9, 
   3.8667638015055237`*^9}, {3.8667638577445316`*^9, 
   3.8667639111104307`*^9}, {3.866764016828268*^9, 3.866764018251977*^9}, {
   3.866764068531627*^9, 3.866764071630863*^9}, {3.8667642452254415`*^9, 
   3.866764286304215*^9}, {3.8667643260909863`*^9, 3.8667643379754086`*^9}, 
   3.866764390921748*^9, 3.8667644752599688`*^9, {3.866764513520646*^9, 
   3.866764555527948*^9}, {3.8667646306058965`*^9, 3.866764654087795*^9}, {
   3.8667646888963704`*^9, 3.8667647021122246`*^9}, {3.866764738165637*^9, 
   3.8667648053976803`*^9}, {3.8667718408811545`*^9, 3.866771858091778*^9}, {
   3.866771959716087*^9, 3.8667719627644544`*^9}, {3.866772047576489*^9, 
   3.8667720762554307`*^9}, {3.867319482387926*^9, 3.8673195357927704`*^9}, {
   3.868519640828643*^9, 3.868519642469198*^9}, {3.868581794490655*^9, 
   3.8685817958768296`*^9}, 3.8732519294832687`*^9, {3.874537141432888*^9, 
   3.874537239662412*^9}, {3.874537350333072*^9, 3.8745373802238073`*^9}, {
   3.874537428144106*^9, 3.87453746357551*^9}, 3.8750931644036765`*^9, 
   3.875093257698656*^9, 3.8750933143877463`*^9, {3.875093475216889*^9, 
   3.875093482586351*^9}, {3.875093858313075*^9, 3.8750938768686485`*^9}, {
   3.8750939389064503`*^9, 3.875093973253297*^9}, 3.875096911489003*^9, 
   3.8751015560178933`*^9, {3.8752335248915634`*^9, 3.8752335259383793`*^9}, {
   3.8752335577468696`*^9, 3.875233623046691*^9}, {3.8752492429347095`*^9, 
   3.8752492715238247`*^9}, {3.875249316128373*^9, 3.875249329647545*^9}, {
   3.875249683252559*^9, 3.87524973904854*^9}, {3.875753225474447*^9, 
   3.8757533225213256`*^9}, {3.875753380940504*^9, 3.875753460726071*^9}, {
   3.875753611330094*^9, 3.8757536689287367`*^9}, {3.875759022047869*^9, 
   3.875759031222004*^9}, 3.88538386145723*^9, {3.885384182232299*^9, 
   3.8853841890960684`*^9}, {3.8853844287802553`*^9, 3.8853844324999638`*^9}, 
   3.8853845082291555`*^9, {3.8853849948706803`*^9, 3.8853850081526856`*^9}, 
   3.885385064737802*^9, 3.8853851073375416`*^9, {3.885387437069361*^9, 
   3.885387491034937*^9}, {3.885389350602725*^9, 3.885389362418072*^9}, {
   3.885436947160122*^9, 3.8854369494537473`*^9}, {3.885437023440462*^9, 
   3.8854370288536463`*^9}, {3.885958919011883*^9, 3.885958931597186*^9}, {
   3.885963916821184*^9, 3.88596395156194*^9}, {3.8859641005379796`*^9, 
   3.8859641263227773`*^9}, {3.8860390119411955`*^9, 
   3.8860390158598003`*^9}, {3.886039058346332*^9, 3.8860390585182285`*^9}, {
   3.8860390900679684`*^9, 3.8860391123380294`*^9}, {3.8860391462779865`*^9, 
   3.8860391840370646`*^9}, {3.8955547739442673`*^9, 
   3.8955547739932375`*^9}, {3.955682391465823*^9, 3.955682391466449*^9}, {
   3.955682445842976*^9, 
   3.9556824481801767`*^9}},ExpressionUUID->"a2d8608e-d483-43a5-abfa-\
b2ddb2badaa8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Format", ":", " ", 
     RowBox[{
      RowBox[{"Appearance", " ", "of", " ", "non"}], "-", 
      RowBox[{"Metric", " ", "Tensor", " ", 
       RowBox[{"w", "/", " ", 
        RowBox[{"Del", "[", 
         RowBox[{"...", 
          RowBox[{"Del", "[", 
           RowBox[{"stuff", " ", 
            RowBox[{"w", "/", "o"}], " ", 
            RowBox[{"Del", "'"}], "s"}], "]"}]}], "]"}]}]}]}], ":", " ", 
     RowBox[{"to", " ", 
      RowBox[{"do", "!"}]}]}],
    FontColor->GrayLevel[0.5]], 
   StyleBox[" ",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "display", " ", "the", " ", "TensorName", " ", "and", " ", 
    "associated", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"w", "/", " ", "TooltipDisplay"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Format", "[", 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", 
         RowBox[{"type_", "/;", 
          RowBox[{"type", "=!=", "\"\<Metric\>\""}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], 
        RowBox[{"(*", 
         RowBox[{"/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{
                   "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "_Symbol"}], "]"}]}], 
                ")"}], "&"}], "/@", "\[Mu]T"}], "]"}], "===", 
            RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", "display_"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"stuff", ",", "output", ",", "idx"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Tooltip", "[", 
         RowBox[{
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"name", ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}],
                ")"}]}]}], "}"}], "]"}], ",", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "display", "]"}], "===", "List"}], ",", 
            RowBox[{"Flatten", "[", "display", "]"}], ",", "True", ",", 
            "display"}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{
            StyleBox["LabelStyle",
             FontColor->GrayLevel[0]], "\[Rule]", 
            RowBox[{"{", "Large", "}"}]}]}], "*)"}], "]"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "name", "]"}], "===", "Del"}], ")"}], ")"}]}]}],
     ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
      RowBox[{"w", "/", "o"}], " ", "TooltipDisplay"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"Tensor", "/:", 
     RowBox[{"Format", "[", 
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"xxx___", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "xxx", "}"}], ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ",", 
               "\[Infinity]"}], "]"}], "]"}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", 
         RowBox[{"type_", "/;", 
          RowBox[{"type", "=!=", "\"\<Metric\>\""}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}]}], 
       RowBox[{"(*", 
        RowBox[{"/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TestIndices", "[", "#", "]"}], "&&", 
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   ",", "_Symbol"}], "]"}]}], ")"}], "&"}], "/@", "\[Mu]T"}], 
            "]"}], "===", 
           RowBox[{"{", "True", "}"}]}], ")"}]}], "*)"}], 
       "\[IndentingNewLine]", "]"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Row", "[", 
       RowBox[{"{", 
        RowBox[{"name", ",", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"UpOrDown", "[", "#", "]"}], "&"}], "/@", "\[Mu]T"}], 
           ")"}]}]}], "}"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "name", "]"}], "===", "Del"}], ")"}], ")"}]}]}],
     ";"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"TensorProduct", " ", "of", " ", "Tensors"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "It", " ", "is", " ", "not", " ", "possible", " ", "to", " ", "do", " ", 
     "something", " ", "like", " ", "Tensor"}], "/:", 
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"Times", "[", 
       RowBox[{"t1___", ",", "mm_", ",", "t2___"}], "]"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"Head", "[", "mm", "]"}], "=!=", "Tensor"}]}], ":=", "..."}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "So", " ", "we", " ", "create", " ", "TensorsProduct", " ", "below"}], " ",
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Format", ":"}],
    FontColor->RGBColor[0.5, 0, 0.5]], 
   StyleBox[" ",
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->GrayLevel[0.5]]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "display", " ", "the", " ", "TensorName", " ", "and", " ", 
    "associated", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"w", "/", " ", "TooltipDisplay"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.671909210051178*^9}, {3.875093170130147*^9, 3.875093170808731*^9}, 
   3.87509324265392*^9, {3.8750933204580092`*^9, 3.8750933218351603`*^9}, {
   3.8750934008826623`*^9, 3.8750934370653806`*^9}, {3.875093489531073*^9, 
   3.8750934906673737`*^9}, {3.8750935899041133`*^9, 3.87509368934088*^9}, 
   3.8750937692429223`*^9, {3.875093991462085*^9, 3.8750939978091774`*^9}, 
   3.875094093508246*^9, {3.8750941438372555`*^9, 3.8750941703979015`*^9}, {
   3.875094471358876*^9, 3.875094509032677*^9}, {3.8750946331906695`*^9, 
   3.875094649608558*^9}, {3.8750946805475073`*^9, 3.8750947515548906`*^9}, {
   3.8750948198035297`*^9, 3.8750948456676044`*^9}, {3.8750949481400795`*^9, 
   3.8750949496001797`*^9}, {3.8750950585772266`*^9, 3.8750951358404784`*^9}, 
   3.8750951805839863`*^9, 3.8750952161337185`*^9, {3.875095552546296*^9, 
   3.8750957058615594`*^9}, {3.8750958501723375`*^9, 
   3.8750958622668886`*^9}, {3.8750959511084023`*^9, 3.875095951329266*^9}, {
   3.8750960594772468`*^9, 3.8750960616798887`*^9}, {3.8750960949683065`*^9, 
   3.875096107436201*^9}, {3.875096193027187*^9, 3.87509620969692*^9}, {
   3.8750962533800187`*^9, 3.875096260134861*^9}, 3.8750964692343993`*^9, {
   3.8750965003577557`*^9, 3.8750965040015125`*^9}, {3.8750965979886456`*^9, 
   3.8750966137689304`*^9}, {3.8750967306594224`*^9, 
   3.8750967450445642`*^9}, {3.875096786458214*^9, 3.8750967962207613`*^9}, 
   3.875097068556165*^9, {3.875097273138611*^9, 3.875097296968935*^9}, {
   3.8750973406975403`*^9, 3.8750973629178658`*^9}, {3.8750975043329353`*^9, 
   3.8750975444212484`*^9}, 3.8750975869371777`*^9, 3.875164402860781*^9, {
   3.8751645629321375`*^9, 3.8751645665409117`*^9}, {3.8752335003995132`*^9, 
   3.875233507917548*^9}, 3.8955490656217337`*^9, {3.895554774010227*^9, 
   3.8955547740132256`*^9}},ExpressionUUID->"2f19460f-6d3c-47f3-9581-\
2425bf3be082"]
}, Closed]],

Cell[CellGroupData[{

Cell["TooltipDisplay for Christoffel (Abandoned)", "Subsubsection",
 CellChangeTimes->{
  3.8611418325299997`*^9, {3.8757540697227306`*^9, 
   3.8757540769273744`*^9}},ExpressionUUID->"95179f01-a721-49ed-ae8c-\
46fd0a7ef5a4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"NewCode", ":", " ", 
     StyleBox[
      RowBox[{
      "TooltipDisplay", " ", "for", " ", "Christoffel", " ", "after", " ", 
       "acting", " ", "PartialD"}],
      FontColor->RGBColor[0.5, 0, 0.5]]}], 
    StyleBox[",",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox["CovariantD",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[",",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox["Derivative",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[",",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[
     RowBox[{"etc", "."}],
     FontColor->RGBColor[0.5, 0, 0.5]]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", "\"\<ChristoffelSymbols\>\""}], 
        RowBox[{"(*", 
         RowBox[{
         "Only", " ", "works", " ", "for", " ", 
          "\"\<\!\(\*StyleBox[\"Christoffel\",FontColor->RGBColor[1, 0, 1]]\)\
\>\""}], "*)"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", "disp_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{"name_", "/;", 
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{"name", "===", "\"\<\[CapitalGamma]\>\""}], ")"}]}]}]}], 
        RowBox[{"(*", 
         RowBox[{"Not", " ", "always", " ", "be", " ", 
          RowBox[{"triggered", ".", " ", "Only"}], " ", "trigger", " ", 
          StyleBox["when",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["the",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["name",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["Christoffel",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["is",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["changed",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T_List"}], ",", 
        "\[IndentingNewLine]", 
        StyleBox[
         RowBox[{"TensorComponents", "\[Rule]", "ttM_"}], "Code"], 
        StyleBox[",", "Code"], 
        StyleBox["\[IndentingNewLine]", "Code"], 
        StyleBox[
         RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], "Code"]}], 
       StyleBox["\[IndentingNewLine]", "Code"], 
       StyleBox["]", "Code"]}], 
      StyleBox["/;", "Code"], 
      StyleBox[
       RowBox[{"!", 
        RowBox[{"TooltipDisplayCheckwithComponents", "[", 
         RowBox[{"disp", ",", "ttM"}], "]"}]}], "Code"]}], 
     StyleBox[
      RowBox[{"(*", 
       RowBox[{"Check", " ", "if", " ", "the", " ", 
        StyleBox["TooltipDisplay",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["does",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["not",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["match",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[
         RowBox[{"w", "/", " ", "TensorComponents"}],
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "Code"], 
     StyleBox[
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "the", " ", "display", " ", "and", " ", "components", " ", 
         "consist", " ", 
         RowBox[{"w", "/", " ", "each"}], " ", "other"}], ",", " ", 
        RowBox[{"we", " ", 
         RowBox[{"don", "'"}], "t", " ", "need", " ", "to", " ", "trigger", 
         " ", "this", " ", 
         RowBox[{"code", "."}]}]}], "*)"}], "Code"], ":=", 
     StyleBox["\n", "Code"], 
     StyleBox[
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx", ",", "\[IndentingNewLine]", 
        RowBox[{"TensorType", "\[Rule]", "\"\<ChristoffelSymbols\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", " ", 
         RowBox[{"NonZeroTensorComponents", "[", 
          RowBox[{
          "name", ",", "\[IndentingNewLine]", "\[Mu]T", ",", 
           "\[IndentingNewLine]", "ttM", ",", "\[IndentingNewLine]", 
           "coords"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", "name"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", "\[Mu]T"}], ",", "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", "ttM"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], 
       "\[IndentingNewLine]", "]"}], "Code"]}], 
    StyleBox[";", "Code"]}], "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, 3.5203034191875*^9, {3.5203509418125*^9, 
   3.520350955265625*^9}, {3.520374181640625*^9, 3.52037419353125*^9}, {
   3.52037428890625*^9, 3.52037429225*^9}, {3.520374390359375*^9, 
   3.520374391046875*^9}, {3.52037449153125*^9, 3.520374508859375*^9}, {
   3.520374542359375*^9, 3.520374562515625*^9}, {3.520374665328125*^9, 
   3.520374666125*^9}, {3.520374798734375*^9, 3.5203748170625*^9}, {
   3.520442091734375*^9, 3.520442103078125*^9}, {3.520442156859375*^9, 
   3.520442237609375*^9}, {3.520442932203125*^9, 3.520442946328125*^9}, 
   3.5204430529375*^9, {3.520449654171875*^9, 3.520449741703125*^9}, {
   3.520461701390625*^9, 3.52046171115625*^9}, {3.520461829296875*^9, 
   3.5204618643125*^9}, {3.52046189925*^9, 3.5204619086875*^9}, {
   3.520462190671875*^9, 3.520462199265625*^9}, {3.520462248390625*^9, 
   3.520462255953125*^9}, {3.52046263196875*^9, 3.520462676203125*^9}, {
   3.520462781609375*^9, 3.520462783296875*^9}, {3.52046295721875*^9, 
   3.52046300696875*^9}, {3.520463069578125*^9, 3.520463097359375*^9}, {
   3.52046330721875*^9, 3.520463328234375*^9}, {3.520463500234375*^9, 
   3.520463506578125*^9}, {3.5204635759375*^9, 3.52046357878125*^9}, {
   3.520463627625*^9, 3.520463634921875*^9}, {3.52046371734375*^9, 
   3.520463719828125*^9}, {3.520463799875*^9, 3.52046387153125*^9}, {
   3.5204646916875*^9, 3.520464736625*^9}, {3.52069951259375*^9, 
   3.520699699609375*^9}, {3.520699992109375*^9, 3.52069999440625*^9}, {
   3.520811957234375*^9, 3.520812132578125*^9}, {3.52081218434375*^9, 
   3.520812365828125*^9}, {3.520812564921875*^9, 3.520812569625*^9}, {
   3.5208126603125*^9, 3.520812664359375*^9}, {3.5208127515*^9, 
   3.52081275875*^9}, {3.520812849*^9, 3.520812859109375*^9}, {
   3.520812903453125*^9, 3.5208130645*^9}, {3.520813114734375*^9, 
   3.520813119109375*^9}, {3.52081316215625*^9, 3.52081316665625*^9}, {
   3.5208133298125*^9, 3.520813333390625*^9}, {3.5208135518125*^9, 
   3.520813616953125*^9}, {3.520814478625*^9, 3.520814517421875*^9}, {
   3.520814555859375*^9, 3.520814613671875*^9}, {3.5208146563125*^9, 
   3.520814722828125*^9}, {3.52081482359375*^9, 3.520814830421875*^9}, {
   3.52087296378125*^9, 3.520873035734375*^9}, {3.52087306871875*^9, 
   3.520873075875*^9}, {3.520873179546875*^9, 3.5208732265625*^9}, {
   3.52087327746875*^9, 3.520873296546875*^9}, {3.52087335853125*^9, 
   3.520873361484375*^9}, {3.520873428328125*^9, 3.520873439921875*^9}, {
   3.520873528796875*^9, 3.520873596453125*^9}, {3.520874029125*^9, 
   3.520874058125*^9}, {3.52087876996875*^9, 3.520878774265625*^9}, {
   3.520879095359375*^9, 3.520879096078125*^9}, {3.520881848546875*^9, 
   3.520882124296875*^9}, {3.5208821583125*^9, 3.5208822268125*^9}, {
   3.520882285359375*^9, 3.520882299640625*^9}, {3.52088233096875*^9, 
   3.520882332296875*^9}, {3.52088237009375*^9, 3.5208825624375*^9}, {
   3.520882741546875*^9, 3.5208828856875*^9}, {3.520884240671875*^9, 
   3.520884241375*^9}, {3.520885397109375*^9, 3.520885515015625*^9}, {
   3.52088556446875*^9, 3.5208858435625*^9}, {3.520885898484375*^9, 
   3.520885974234375*^9}, {3.520898025796875*^9, 3.520898078625*^9}, {
   3.520898132015625*^9, 3.520898159171875*^9}, {3.520898268171875*^9, 
   3.520898439453125*^9}, {3.520898471875*^9, 3.52089847509375*^9}, {
   3.5208987905625*^9, 3.520898791046875*^9}, 3.520957046015625*^9, {
   3.5209570961875*^9, 3.520957131078125*^9}, {3.52107807721875*^9, 
   3.521078188765625*^9}, {3.5210782819375*^9, 3.521078383796875*^9}, {
   3.521137026140625*^9, 3.521137068953125*^9}, {3.521142246921875*^9, 
   3.52114265653125*^9}, {3.52114442525*^9, 3.521144472171875*^9}, {
   3.521144505640625*^9, 3.52114451575*^9}, {3.52114454646875*^9, 
   3.5211445929375*^9}, {3.52121984296875*^9, 3.5212198994375*^9}, {
   3.521220739*^9, 3.52122090625*^9}, {3.521221086375*^9, 
   3.5212210973125*^9}, {3.521221169703125*^9, 3.521221170109375*^9}, {
   3.521241296640625*^9, 3.52124132271875*^9}, {3.521241364609375*^9, 
   3.521241377921875*^9}, {3.521241761265625*^9, 3.521241789875*^9}, {
   3.52125020228125*^9, 3.5212503195*^9}, {3.521250367578125*^9, 
   3.52125043315625*^9}, {3.521348381171875*^9, 3.521348591296875*^9}, {
   3.5213486974375*^9, 3.52134881896875*^9}, {3.52134888690625*^9, 
   3.521348973890625*^9}, 3.5213493814375*^9, 3.521349424265625*^9, {
   3.521349591765625*^9, 3.52134976540625*^9}, {3.521349909984375*^9, 
   3.52134995234375*^9}, {3.5213501821875*^9, 3.521350185953125*^9}, {
   3.5213504943125*^9, 3.521350511640625*^9}, {3.5213506120625*^9, 
   3.521350633390625*^9}, {3.52135068425*^9, 3.521350712765625*^9}, {
   3.521351003671875*^9, 3.521351010375*^9}, {3.52135113328125*^9, 
   3.52135113853125*^9}, {3.521351225125*^9, 3.521351264515625*^9}, {
   3.521353769546875*^9, 3.52135380609375*^9}, {3.52135391003125*^9, 
   3.5213539324375*^9}, {3.52138689021875*^9, 3.521386896859375*^9}, {
   3.5213915893125*^9, 3.52139181034375*^9}, {3.52139186425*^9, 
   3.521391942109375*^9}, {3.521391976125*^9, 3.521391991109375*^9}, {
   3.521392049890625*^9, 3.52139216490625*^9}, {3.52139221046875*^9, 
   3.521392215734375*^9}, {3.52139226215625*^9, 3.5213922816875*^9}, {
   3.5213923241875*^9, 3.52139238159375*^9}, {3.521392606671875*^9, 
   3.5213926106875*^9}, {3.521392646546875*^9, 3.521392830515625*^9}, {
   3.521392927671875*^9, 3.521392945734375*^9}, {3.521393239734375*^9, 
   3.521393253125*^9}, {3.52139330940625*^9, 3.52139332665625*^9}, {
   3.52139486253125*^9, 3.52139486378125*^9}, {3.521395281328125*^9, 
   3.521395287609375*^9}, {3.52139612678125*^9, 3.521396148546875*^9}, {
   3.521396433484375*^9, 3.52139647615625*^9}, {3.521396513796875*^9, 
   3.521396530703125*^9}, {3.521396718125*^9, 3.521396718453125*^9}, {
   3.521398676140625*^9, 3.52139875478125*^9}, {3.52139878946875*^9, 
   3.52139882240625*^9}, {3.521399017640625*^9, 3.521399148484375*^9}, {
   3.521399182484375*^9, 3.521399183546875*^9}, {3.521399244109375*^9, 
   3.5213993385*^9}, {3.5213995170625*^9, 3.521399783703125*^9}, {
   3.52139984184375*^9, 3.521399940109375*^9}, {3.521400227171875*^9, 
   3.521400233828125*^9}, {3.521400279890625*^9, 3.5214002875625*^9}, {
   3.521400370515625*^9, 3.521400373984375*^9}, {3.521400410140625*^9, 
   3.521400412890625*^9}, {3.521401423609375*^9, 3.52140142775*^9}, {
   3.5214015165625*^9, 3.52140151815625*^9}, {3.521401780921875*^9, 
   3.521401883765625*^9}, {3.52140193640625*^9, 3.521401969265625*^9}, {
   3.52140201503125*^9, 3.52140202003125*^9}, {3.521402455625*^9, 
   3.5214025640625*^9}, {3.52140260134375*^9, 3.52140261928125*^9}, {
   3.521402734453125*^9, 3.521402863140625*^9}, {3.52141532615625*^9, 
   3.5214153873125*^9}, {3.5214156420625*^9, 3.52141570696875*^9}, {
   3.521442583140625*^9, 3.521442620640625*^9}, {3.521442651796875*^9, 
   3.521442666296875*^9}, {3.5214427025*^9, 3.521442792484375*^9}, {
   3.52144286128125*^9, 3.52144296165625*^9}, {3.521443004765625*^9, 
   3.5214430215625*^9}, {3.52144312996875*^9, 3.521443237265625*^9}, {
   3.521443272421875*^9, 3.52144328728125*^9}, {3.521471452890625*^9, 
   3.521471462828125*^9}, {3.521472116640625*^9, 3.52147218709375*^9}, {
   3.521472280796875*^9, 3.52147230184375*^9}, {3.521472418421875*^9, 
   3.521472429140625*^9}, {3.521472511109375*^9, 3.521472519234375*^9}, {
   3.521472551109375*^9, 3.521472579375*^9}, {3.52164943446875*^9, 
   3.521649441140625*^9}, {3.52164978603125*^9, 3.521649794796875*^9}, {
   3.521653219375*^9, 3.521653224921875*^9}, {3.52165329765625*^9, 
   3.5216533165625*^9}, {3.52165483128125*^9, 3.521654835875*^9}, {
   3.5216555458125*^9, 3.5216555685*^9}, {3.52166988665625*^9, 
   3.52166989046875*^9}, {3.521670768421875*^9, 3.52167081534375*^9}, {
   3.521670849203125*^9, 3.521670860421875*^9}, {3.521670891625*^9, 
   3.5216709856875*^9}, {3.521671147125*^9, 3.52167118725*^9}, {
   3.5216712428125*^9, 3.521671386015625*^9}, {3.52167158846875*^9, 
   3.5216716393125*^9}, {3.52167168784375*^9, 3.52167170453125*^9}, {
   3.521671767953125*^9, 3.521671800890625*^9}, {3.52167184703125*^9, 
   3.52167188040625*^9}, {3.5216719656875*^9, 3.5216720203125*^9}, {
   3.521672086421875*^9, 3.521672149015625*^9}, {3.521672195671875*^9, 
   3.5216722440625*^9}, {3.521672320125*^9, 3.52167243040625*^9}, {
   3.521672468421875*^9, 3.521672645609375*^9}, 3.521672796265625*^9, {
   3.5216729164375*^9, 3.52167311040625*^9}, {3.521673143375*^9, 
   3.52167317259375*^9}, {3.521673209484375*^9, 3.521673232453125*^9}, {
   3.521673284078125*^9, 3.52167331528125*^9}, {3.52167336734375*^9, 
   3.521673388625*^9}, {3.5216751101875*^9, 3.52167523325*^9}, {
   3.5216758554375*^9, 3.52167588446875*^9}, {3.521676011109375*^9, 
   3.521676031296875*^9}, {3.521676083265625*^9, 3.52167608490625*^9}, {
   3.52167614078125*^9, 3.521676144140625*^9}, {3.521676218859375*^9, 
   3.521676219984375*^9}, {3.521676257140625*^9, 3.521676342625*^9}, {
   3.521676404546875*^9, 3.52167643903125*^9}, {3.52167657284375*^9, 
   3.521676714046875*^9}, {3.521676750734375*^9, 3.521676871203125*^9}, {
   3.521677046671875*^9, 3.521677063546875*^9}, {3.5216771815625*^9, 
   3.52167723953125*^9}, {3.52167732425*^9, 3.52167734403125*^9}, {
   3.521677383*^9, 3.521677383875*^9}, {3.521677432109375*^9, 
   3.521677540125*^9}, {3.52167758334375*^9, 3.521677617234375*^9}, {
   3.521677668*^9, 3.521677671203125*^9}, {3.52167772715625*^9, 
   3.521677757234375*^9}, {3.521677788*^9, 3.52167782253125*^9}, {
   3.521677906875*^9, 3.521677914546875*^9}, {3.521677984171875*^9, 
   3.5216780049375*^9}, {3.521678053546875*^9, 3.521678053734375*^9}, {
   3.5216998578125*^9, 3.52169988396875*^9}, {3.521699914484375*^9, 
   3.521699973359375*^9}, {3.521700012703125*^9, 3.52170021290625*^9}, {
   3.521700272359375*^9, 3.521700381625*^9}, {3.52170041990625*^9, 
   3.52170087975*^9}, {3.52170095365625*^9, 3.5217009635*^9}, {
   3.52170103315625*^9, 3.52170115653125*^9}, {3.521701254953125*^9, 
   3.521701351890625*^9}, {3.5217013993125*^9, 3.521701438234375*^9}, {
   3.521701516515625*^9, 3.52170153925*^9}, {3.521701892234375*^9, 
   3.52170189378125*^9}, {3.521702314984375*^9, 3.521702329390625*^9}, {
   3.52173341071875*^9, 3.521733630953125*^9}, {3.52173367478125*^9, 
   3.52173375459375*^9}, {3.521733804375*^9, 3.521733833953125*^9}, {
   3.521741591*^9, 3.52174163671875*^9}, {3.521741705890625*^9, 
   3.521741768546875*^9}, {3.52174187984375*^9, 3.52174188003125*^9}, {
   3.521742036875*^9, 3.52174203709375*^9}, {3.521745152640625*^9, 
   3.521745164734375*^9}, {3.521745200890625*^9, 3.521745255765625*^9}, {
   3.521745324890625*^9, 3.52174536284375*^9}, {3.521745446203125*^9, 
   3.52174547321875*^9}, {3.521745506265625*^9, 3.521745513234375*^9}, {
   3.52174554921875*^9, 3.52174556996875*^9}, {3.5217456041875*^9, 
   3.521745606546875*^9}, {3.521745796859375*^9, 3.521745798109375*^9}, {
   3.521746119421875*^9, 3.521746202171875*^9}, {3.521746247578125*^9, 
   3.5217462608125*^9}, {3.521746322625*^9, 3.521746349625*^9}, {
   3.52175678640625*^9, 3.521756816921875*^9}, {3.521757001703125*^9, 
   3.521757017046875*^9}, {3.5217610119375*^9, 3.52176102221875*^9}, {
   3.5217647861875*^9, 3.521764807984375*^9}, {3.521764873484375*^9, 
   3.521764892078125*^9}, {3.52176496665625*^9, 3.521764992953125*^9}, {
   3.521765145359375*^9, 3.52176515403125*^9}, {3.52176547803125*^9, 
   3.521765486640625*^9}, {3.521784419484375*^9, 3.52178441959375*^9}, {
   3.521784735171875*^9, 3.521784739125*^9}, {3.521784803*^9, 
   3.521784832328125*^9}, {3.5217852330625*^9, 3.521785233265625*^9}, {
   3.521788073828125*^9, 3.521788104875*^9}, {3.52179265278125*^9, 
   3.521792721640625*^9}, {3.521792757875*^9, 3.521792783609375*^9}, {
   3.52179304334375*^9, 3.521793217125*^9}, {3.521793247703125*^9, 
   3.52179326671875*^9}, {3.521867759015625*^9, 3.521867794828125*^9}, {
   3.521903765703125*^9, 3.52190378259375*^9}, {3.521910287625*^9, 
   3.5219103075625*^9}, {3.52191037603125*^9, 3.521910410796875*^9}, {
   3.52191902275*^9, 3.521919058921875*^9}, {3.52191974478125*^9, 
   3.5219197580625*^9}, {3.5219389993125*^9, 3.521939153*^9}, {
   3.52194930271875*^9, 3.52194932571875*^9}, {3.52194942278125*^9, 
   3.5219494263125*^9}, {3.521950287453125*^9, 3.52195029703125*^9}, {
   3.521953722984375*^9, 3.52195380025*^9}, {3.52195433934375*^9, 
   3.521954407375*^9}, {3.5219544496875*^9, 3.52195451690625*^9}, {
   3.5219546679375*^9, 3.52195468209375*^9}, {3.5219548593125*^9, 
   3.521954863546875*^9}, {3.52195602975*^9, 3.521956063796875*^9}, {
   3.52195629140625*^9, 3.521956357828125*^9}, {3.521956396453125*^9, 
   3.5219564374375*^9}, {3.5338712661975746`*^9, 3.533871361323346*^9}, {
   3.5338813382784786`*^9, 3.5338813663273277`*^9}, {3.5338815867333527`*^9, 
   3.53388159891597*^9}, {3.5338816780572996`*^9, 3.533881853354808*^9}, {
   3.533881894133279*^9, 3.5338820548759613`*^9}, {3.53388210515485*^9, 
   3.5338821573837414`*^9}, {3.5338824795243073`*^9, 3.533882480304309*^9}, {
   3.5338826190353527`*^9, 3.5338826220773573`*^9}, {3.533882797000465*^9, 
   3.5338828884946256`*^9}, 3.533882972625573*^9, {3.5338830165708504`*^9, 
   3.533883031609277*^9}, {3.533883077816558*^9, 3.5338830803125625`*^9}, {
   3.5338831964547663`*^9, 3.533883212085994*^9}, {3.5338832641276855`*^9, 
   3.533883270461296*^9}, {3.5338833237977905`*^9, 3.5338833905035076`*^9}, {
   3.5338834292071753`*^9, 3.5338834566632233`*^9}, {3.5338835023089037`*^9, 
   3.5338835056785097`*^9}, {3.5338835727118273`*^9, 
   3.5338835994502745`*^9}, {3.5338836545651712`*^9, 
   3.5338836686519957`*^9}, {3.533883732097307*^9, 3.533883735388913*^9}, {
   3.5338838282402763`*^9, 3.533883831469482*^9}, {3.5338838790807657`*^9, 
   3.5338839318556585`*^9}, {3.5338841950601697`*^9, 
   3.5338842006611776`*^9}, {3.533884289183502*^9, 3.533884385586038*^9}, {
   3.5338844540299344`*^9, 3.5338846658554325`*^9}, {3.533896646054044*^9, 
   3.5338967398621426`*^9}, {3.533896822025326*^9, 3.5338968359964437`*^9}, {
   3.53389691032167*^9, 3.5338969105856824`*^9}, {3.5338971233903627`*^9, 
   3.5338971363541813`*^9}, {3.533897219401898*^9, 3.5338972354505205`*^9}, {
   3.5338972707361703`*^9, 3.5338972749661765`*^9}, {3.5338978585023127`*^9, 
   3.533897865536066*^9}, {3.5338979217961693`*^9, 3.533898000278984*^9}, {
   3.5338980623234015`*^9, 3.533898066186492*^9}, {3.533898144347541*^9, 
   3.5338981535560675`*^9}, {3.533898233983821*^9, 3.5338982373649206`*^9}, {
   3.5339312966250153`*^9, 3.533931296985016*^9}, {3.5339314506542325`*^9, 
   3.5339314570856414`*^9}, {3.533931664934333*^9, 3.5339316768215537`*^9}, {
   3.5857213419283295`*^9, 3.58572134252113*^9}, {3.5857215487846923`*^9, 
   3.585721549174693*^9}, {3.585721605319192*^9, 3.5857216509180717`*^9}, {
   3.5857216896061397`*^9, 3.585721690448541*^9}, {3.58572175242745*^9, 
   3.5857217649074717`*^9}, {3.5857221603837667`*^9, 3.585722165188575*^9}, {
   3.5857222535315304`*^9, 3.5857222644515495`*^9}, {3.5857227752120466`*^9, 
   3.5857228235877314`*^9}, {3.585722986264817*^9, 3.5857230354673033`*^9}, {
   3.585723093686606*^9, 3.585723122203456*^9}, {3.585723169643139*^9, 
   3.585723171733543*^9}, {3.5857232526664853`*^9, 3.58572327258772*^9}, {
   3.606335159966839*^9, 3.606335198046506*^9}, {3.6063352330685673`*^9, 
   3.606335262131418*^9}, {3.6063353403967557`*^9, 3.6063353699744077`*^9}, {
   3.6063355019506392`*^9, 3.6063355100002537`*^9}, {3.6063358322344193`*^9, 
   3.6063358372576284`*^9}, {3.6066738883426533`*^9, 3.606673983512097*^9}, {
   3.6066740559482403`*^9, 3.6066740635486746`*^9}, {3.6066743363332767`*^9, 
   3.606674360126638*^9}, {3.6066746414127264`*^9, 3.6066746456029663`*^9}, {
   3.6066746864413023`*^9, 3.6066746935107064`*^9}, {3.606764163770528*^9, 
   3.6067641878257694`*^9}, {3.6067646447193723`*^9, 
   3.6067646954194613`*^9}, {3.6067650160780244`*^9, 
   3.6067650464980783`*^9}, {3.629562191862056*^9, 3.6295622179565096`*^9}, {
   3.6295624903759656`*^9, 3.6295625052137947`*^9}, {3.629562566755515*^9, 
   3.6295625671621156`*^9}, {3.629563111218094*^9, 3.6295631194739094`*^9}, {
   3.6295678441846895`*^9, 3.6295678567385135`*^9}, {3.6295769150568147`*^9, 
   3.629576939323668*^9}, 3.6295791738516903`*^9, 3.6295792209418187`*^9, {
   3.629581267714156*^9, 3.6295812912406006`*^9}, {3.629581325784066*^9, 
   3.629581340671893*^9}, {3.6295814029374175`*^9, 3.629581429304266*^9}, {
   3.6295818560362825`*^9, 3.629581856332683*^9}, {3.6295819110649934`*^9, 
   3.6295819150988007`*^9}, 3.62958195994705*^9, {3.6295827367218447`*^9, 
   3.6295827372990456`*^9}, {3.629582811380183*^9, 3.6295830005573826`*^9}, {
   3.6295922773693624`*^9, 3.6295923269242268`*^9}, {3.629592361069789*^9, 
   3.629592363895294*^9}, {3.6295923947624507`*^9, 3.6295924368449287`*^9}, {
   3.629592556257448*^9, 3.6295925866629047`*^9}, {3.6295926742687674`*^9, 
   3.6295926896873956`*^9}, {3.629592857642812*^9, 3.6295928635884237`*^9}, {
   3.6296008298157945`*^9, 3.629600857037795*^9}, {3.6296010760041723`*^9, 
   3.6296011709187737`*^9}, {3.6296012604938602`*^9, 
   3.6296013158603663`*^9}, {3.629601566485784*^9, 3.6296017289910207`*^9}, {
   3.629601965126772*^9, 3.629602009106655*^9}, {3.629602234491691*^9, 
   3.62960233417128*^9}, {3.6296025406568675`*^9, 3.629602545034876*^9}, {
   3.629602605592389*^9, 3.6296026720725155`*^9}, {3.629602819991993*^9, 
   3.629602824448001*^9}, {3.629605598839726*^9, 3.629605607327141*^9}, {
   3.6296058220871186`*^9, 3.62960582882633*^9}, {3.6296063832065477`*^9, 
   3.629606402387883*^9}, {3.629606538604329*^9, 3.6296066163905716`*^9}, {
   3.629606677993684*^9, 3.629606687579601*^9}, {3.6296068047490234`*^9, 
   3.629606830226368*^9}, 3.6296068624429245`*^9, {3.6296068979092875`*^9, 
   3.6296069681300106`*^9}, {3.629609076756136*^9, 3.6296091040088844`*^9}, {
   3.6296099141079187`*^9, 3.6296099316810493`*^9}, {3.6296100423732443`*^9, 
   3.629610095608038*^9}, {3.6296101382529125`*^9, 3.6296102324377785`*^9}, {
   3.629610465776189*^9, 3.6296105719830756`*^9}, {3.6296106080628395`*^9, 
   3.6296106195756593`*^9}, {3.629610656929625*^9, 3.629610732269657*^9}, {
   3.629610770130324*^9, 3.629610865268092*^9}, {3.629610900164753*^9, 
   3.6296109467227354`*^9}, {3.62961103488599*^9, 3.629611035478791*^9}, {
   3.62961131996777*^9, 3.629611351764426*^9}, {3.6296113965317063`*^9, 
   3.629611407320126*^9}, {3.629611650866873*^9, 3.629611658370486*^9}, {
   3.629611693028248*^9, 3.629611725211104*^9}, {3.629660344681587*^9, 
   3.629660396816783*^9}, {3.629662054116185*^9, 3.629662109498183*^9}, {
   3.629662485797946*^9, 3.629662506233982*^9}, {3.6296627377648115`*^9, 
   3.629662875565055*^9}, {3.629663059835583*^9, 3.6296630605400844`*^9}, {
   3.629663213456155*^9, 3.6296632447274103`*^9}, {3.62966339066107*^9, 
   3.629663505423672*^9}, {3.629663629963293*^9, 3.62966374139069*^9}, 
   3.6296637790073557`*^9, {3.6296639427647448`*^9, 3.62966405344954*^9}, {
   3.629664258753003*^9, 3.6296642835833473`*^9}, {3.629664357640478*^9, 
   3.629664406652266*^9}, {3.6296644497627425`*^9, 3.6296644754010878`*^9}, {
   3.6296645845515814`*^9, 3.629664754351282*^9}, {3.6296648207714*^9, 
   3.6296648719226904`*^9}, {3.6296649072767525`*^9, 3.629665007539429*^9}, {
   3.629665128176044*^9, 3.629665131155649*^9}, {3.629665198002467*^9, 
   3.629665208579286*^9}, {3.629665989873558*^9, 3.6296660606365824`*^9}, {
   3.629666240755704*^9, 3.629666248087716*^9}, {3.629680463417473*^9, 
   3.629680463611674*^9}, {3.6296839559917583`*^9, 3.629684004376444*^9}, {
   3.629684359598235*^9, 3.6296844225402164`*^9}, {3.629697473161625*^9, 
   3.6296975310175266`*^9}, {3.6296984575100627`*^9, 
   3.6296984799167023`*^9}, {3.629698536527603*^9, 3.6296985539120336`*^9}, {
   3.6297029070413284`*^9, 3.629702918063344*^9}, {3.629702984562439*^9, 
   3.629702988605445*^9}, {3.6297038644319816`*^9, 3.629703884097009*^9}, 
   3.6297039422184496`*^9, {3.629704987754769*^9, 3.6297050664593077`*^9}, {
   3.6297051249286375`*^9, 3.6297051564516935`*^9}, {3.6297051944125605`*^9, 
   3.6297052523000636`*^9}, {3.6297052825731173`*^9, 
   3.6297053031671534`*^9}, {3.629705388300189*^9, 3.62970538895539*^9}, {
   3.62972916921355*^9, 3.6297291763503666`*^9}, {3.6297292561692886`*^9, 
   3.629729263599902*^9}, {3.629761051728472*^9, 3.629761065720507*^9}, {
   3.629829049363864*^9, 3.629829080818822*^9}, {3.629832420822437*^9, 
   3.629832422351239*^9}, {3.629833134540451*^9, 3.629833156760482*^9}, {
   3.629841550046672*^9, 3.62984155467428*^9}, {3.6298419857146883`*^9, 
   3.6298419986509113`*^9}, {3.629842327687729*^9, 3.6298423483446655`*^9}, {
   3.6298424340556164`*^9, 3.6298424347651176`*^9}, {3.629857562453469*^9, 
   3.6298575752992034`*^9}, {3.6298617363544903`*^9, 3.629861743498315*^9}, {
   3.629861792832088*^9, 3.629861797965208*^9}, {3.6298621478116827`*^9, 
   3.6298621703399477`*^9}, {3.629862224692195*^9, 3.6298622386228337`*^9}, {
   3.629934024806528*^9, 3.6299340705926085`*^9}, {3.629935785029563*^9, 
   3.6299358234439325`*^9}, {3.630093833832834*^9, 3.630093925755106*^9}, {
   3.6303312112935457`*^9, 3.6303312550516224`*^9}, {3.6303358993921537`*^9, 
   3.6303359226755953`*^9}, {3.6306356399709835`*^9, 
   3.6306356458927946`*^9}, {3.630636068179586*^9, 3.6306361110125637`*^9}, {
   3.6306361560057445`*^9, 3.630636184065894*^9}, {3.630636235447586*^9, 
   3.630636267952746*^9}, {3.63063630275181*^9, 3.6306363664175234`*^9}, {
   3.6306364437215614`*^9, 3.6306365062241726`*^9}, {3.630636538221331*^9, 
   3.630636557862567*^9}, {3.630636607219159*^9, 3.6306366182246785`*^9}, {
   3.6306367049124327`*^9, 3.6306367069872365`*^9}, {3.6306367739863553`*^9, 
   3.6306368265585485`*^9}, {3.6306368669329214`*^9, 
   3.6306368850077534`*^9}, {3.6306369704707117`*^9, 
   3.6306369715340137`*^9}, {3.6306370050048733`*^9, 3.6306370121403866`*^9}, 
   3.6306370476386495`*^9, {3.6306371345330048`*^9, 3.6306371389166126`*^9}, {
   3.6306372376894894`*^9, 3.6306372761020594`*^9}, {3.6306374107348022`*^9, 
   3.6306374177860146`*^9}, {3.6306374703665094`*^9, 
   3.6306376025850487`*^9}, {3.6306376480269303`*^9, 
   3.6306376569389467`*^9}, {3.630637688572405*^9, 3.6306377047228336`*^9}, {
   3.630638005103675*^9, 3.63063803012432*^9}, {3.630638132477803*^9, 
   3.6306381742124786`*^9}, {3.630638443344762*^9, 3.6306384548725824`*^9}, {
   3.630693969338559*^9, 3.6306940821519747`*^9}, {3.630694494199352*^9, 
   3.6306945206800165`*^9}, {3.63069542859525*^9, 3.6306954292512627`*^9}, {
   3.630695677045081*^9, 3.6306957023971386`*^9}, {3.63069573859525*^9, 
   3.6306958461515474`*^9}, {3.6306960563359995`*^9, 3.630696315629788*^9}, {
   3.630696895134617*^9, 3.6306969769772644`*^9}, {3.6306970092793493`*^9, 
   3.630697023245936*^9}, {3.6306970610093985`*^9, 3.6306971134507113`*^9}, {
   3.63069721480139*^9, 3.6306972323263006`*^9}, {3.671909193986844*^9, 
   3.6719092506401615`*^9}, {3.835859602926553*^9, 3.835859728311108*^9}, {
   3.835859791250119*^9, 3.835859804322502*^9}, {3.8358598345356293`*^9, 
   3.835859838531027*^9}, 3.8358598721245165`*^9, {3.8358599532439394`*^9, 
   3.835859957561669*^9}, {3.835860143619153*^9, 3.835860145369688*^9}, {
   3.835860221002843*^9, 3.8358602625621796`*^9}, 3.8358605805204043`*^9, {
   3.8358606388794003`*^9, 3.8358606467324133`*^9}, {3.8358606937574034`*^9, 
   3.835860703303405*^9}, {3.8358617594312496`*^9, 3.83586187699807*^9}, {
   3.8358619621210504`*^9, 3.835861968212232*^9}, 3.8358627392517357`*^9, {
   3.8358627770034075`*^9, 3.8358627773683376`*^9}, {3.8358628243884783`*^9, 
   3.8358628415763392`*^9}, {3.8358629083773623`*^9, 
   3.8358629727894125`*^9}, {3.835863089365315*^9, 3.8358631243379207`*^9}, {
   3.835863169281988*^9, 3.835863187539895*^9}, 3.8358632412599115`*^9, {
   3.835863433945222*^9, 3.835863439453006*^9}, 3.835863689797821*^9, {
   3.835864063766061*^9, 3.835864120354599*^9}, {3.8358642464275*^9, 
   3.835864253261094*^9}, {3.835864422411518*^9, 3.8358644229484215`*^9}, {
   3.8358645134704227`*^9, 3.8358645669434233`*^9}, {3.835864653310423*^9, 
   3.835864656034425*^9}, {3.835864748415412*^9, 3.835864757289424*^9}, {
   3.8358708947183275`*^9, 3.835870900186552*^9}, {3.8358711248677454`*^9, 
   3.835871148471379*^9}, {3.8358712149838257`*^9, 3.8358712251802435`*^9}, {
   3.835921099472575*^9, 3.835921154919902*^9}, {3.835921201194438*^9, 
   3.8359212355804343`*^9}, {3.835921631831324*^9, 3.8359216380753202`*^9}, {
   3.8359220216857185`*^9, 3.83592204296344*^9}, {3.836440224612873*^9, 
   3.836440250386945*^9}, 3.836441933581911*^9, {3.8364425314510565`*^9, 
   3.836442545730586*^9}, {3.8375015279338017`*^9, 3.8375015289337807`*^9}, {
   3.8375015649806533`*^9, 3.8375015654962983`*^9}, {3.8375017537654305`*^9, 
   3.837501790452952*^9}, {3.837502073032799*^9, 3.837502100157813*^9}, 
   3.8375030486816425`*^9, {3.837503087353506*^9, 3.8375031216191187`*^9}, {
   3.8375036281532245`*^9, 3.8375036336532393`*^9}, 3.837503693887623*^9, {
   3.837503748887605*^9, 3.83750378849699*^9}, {3.837503833153248*^9, 
   3.837503934121977*^9}, 3.8375043674353514`*^9, {3.8375044584669523`*^9, 
   3.8375044626231823`*^9}, {3.8375044957013063`*^9, 3.837504506404435*^9}, {
   3.837504994578554*^9, 3.83750510240959*^9}, {3.8375051478002243`*^9, 
   3.8375051592064548`*^9}, {3.8375052463158283`*^9, 3.837505338831473*^9}, {
   3.8375055263330636`*^9, 3.837505528583088*^9}, 3.83750559547433*^9, {
   3.837505678759041*^9, 3.8375056813684387`*^9}, {3.8375058703109803`*^9, 
   3.837505873139101*^9}, {3.8375059531889725`*^9, 3.8375059738139715`*^9}, {
   3.8375062123803363`*^9, 3.8375062161928415`*^9}, {3.837506308481487*^9, 
   3.8375063099189854`*^9}, {3.837506395575853*^9, 3.8375064027477226`*^9}, {
   3.8376028574316063`*^9, 3.837602902889894*^9}, {3.8376031013018866`*^9, 
   3.837603120778749*^9}, {3.8376031559054193`*^9, 3.837603184379328*^9}, {
   3.8376032321987915`*^9, 3.83760343694972*^9}, {3.83760356253207*^9, 
   3.837603578234928*^9}, {3.8376036425534534`*^9, 3.8376036604561563`*^9}, {
   3.837603698999505*^9, 3.8376037265853424`*^9}, 3.8376038603455276`*^9, {
   3.8376040706645565`*^9, 3.837604072369849*^9}, {3.837607138494339*^9, 
   3.8376071632011805`*^9}, {3.8376072254274015`*^9, 
   3.8376072565572147`*^9}, {3.837607362229513*^9, 3.8376073839920797`*^9}, {
   3.837607465974249*^9, 3.837607506016636*^9}, {3.8376075513507867`*^9, 
   3.837607569855713*^9}, {3.837607991954672*^9, 3.8376079948571887`*^9}, {
   3.837608403918603*^9, 3.8376084386897917`*^9}, {3.837608566554458*^9, 
   3.837608583707883*^9}, {3.837608618002578*^9, 3.8376086238048515`*^9}, {
   3.8376086642324777`*^9, 3.837608689727016*^9}, {3.8376087259289455`*^9, 
   3.837608761755112*^9}, {3.837608837464309*^9, 3.837608843667581*^9}, {
   3.8376088811255264`*^9, 3.8376089182784657`*^9}, {3.837608954977806*^9, 
   3.8376089670617423`*^9}, {3.8376089979179344`*^9, 
   3.8376090010278254`*^9}, {3.83760904192185*^9, 3.837609050115362*^9}, {
   3.8376091865085726`*^9, 3.8376091961163425`*^9}, {3.8376093835647464`*^9, 
   3.8376093922238545`*^9}, 3.8376098111957583`*^9, {3.8376389236573467`*^9, 
   3.8376389243278904`*^9}, {3.837638999214301*^9, 3.8376390264875283`*^9}, {
   3.8376391310041485`*^9, 3.837639134023379*^9}, 3.8376407917969294`*^9, 
   3.837640906216976*^9, 3.837641662871751*^9, 3.837641984664361*^9, {
   3.8376421207712455`*^9, 3.837642237859331*^9}, {3.8376423338188696`*^9, 
   3.837642407968956*^9}, 3.8376424553306637`*^9, {3.837642491665759*^9, 
   3.837642492877802*^9}, 3.8376425329172354`*^9, 3.8376426478618793`*^9, 
   3.8376429835848703`*^9, {3.837645071050145*^9, 3.837645108201154*^9}, {
   3.83764520159704*^9, 3.8376452262357173`*^9}, {3.8376452596147213`*^9, 
   3.837645284672716*^9}, 3.8376454294813757`*^9, {3.837645768293536*^9, 
   3.8376457714605207`*^9}, {3.837645917551523*^9, 3.8376459182375207`*^9}, {
   3.837646740869529*^9, 3.83764674104253*^9}, {3.837646781830533*^9, 
   3.837646783404533*^9}, 3.83765283531306*^9, 3.837653140004111*^9, {
   3.8376536700741262`*^9, 3.8376537743348293`*^9}, {3.8376550395944757`*^9, 
   3.8376550473348675`*^9}, {3.8376550890666246`*^9, 3.837655107948265*^9}, 
   3.8378362501020966`*^9, {3.8381855551450567`*^9, 3.838185609638281*^9}, {
   3.8381916245889606`*^9, 3.8381916248859754`*^9}, 3.8381917592792535`*^9, {
   3.838192133065313*^9, 3.83819224101149*^9}, {3.838192303491232*^9, 
   3.8381924112970295`*^9}, {3.8381924456807184`*^9, 
   3.8381925204693117`*^9}, {3.8387849749609146`*^9, 3.838785048753461*^9}, {
   3.8447769786149673`*^9, 3.844777001371827*^9}, {3.852544998346586*^9, 
   3.8525450155979557`*^9}, 3.853219354039359*^9, 3.853219403589053*^9, {
   3.8532196430575695`*^9, 3.853219685757208*^9}, {3.8532197270171833`*^9, 
   3.8532197458772345`*^9}, {3.853220106374138*^9, 3.853220108134001*^9}, {
   3.853220138443843*^9, 3.853220139043708*^9}, {3.8532203163948717`*^9, 
   3.8532203188225765`*^9}, {3.8532231676162195`*^9, 
   3.8532231678767085`*^9}, {3.8532823241121225`*^9, 
   3.8532823843567915`*^9}, {3.853284613112215*^9, 3.8532846883295193`*^9}, {
   3.853289283911167*^9, 3.8532892910203314`*^9}, {3.858297377618552*^9, 
   3.8582973837897587`*^9}, 3.858686951708252*^9, 3.858687274213078*^9, {
   3.8588180525526047`*^9, 3.858818094764451*^9}, {3.858818126621711*^9, 
   3.8588181560714655`*^9}, {3.8605779928732386`*^9, 
   3.8605779952002397`*^9}, {3.8673193055992785`*^9, 3.867319367558631*^9}, 
   3.8685196374882913`*^9, 3.8739514836842976`*^9, 
   3.955682445851995*^9},ExpressionUUID->"0b387dd1-36ff-4323-8fb5-\
ce6799433dc8"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorWedge", "Subsubsection",
 CellChangeTimes->{{3.8715535411617823`*^9, 
  3.87155355517332*^9}},ExpressionUUID->"4f587374-e443-482e-8a24-\
a68a8ad56bd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["TensorWedge",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Tensor", "/:", 
   RowBox[{
    RowBox[{"TensorWedge", "[", 
     RowBox[{
      RowBox[{"t1_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RankNumber", "[", "t1", "]"}], ">", "0"}], ")"}]}], 
      RowBox[{"(*", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "t1", "]"}], "||", 
          RowBox[{
           RowBox[{"RankNumber", "[", "t1", "]"}], "===", "1"}]}], ")"}], 
        ")"}], "*)"}], ",", 
      RowBox[{"t2_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"RankNumber", "[", "t2", "]"}], ">", "0"}], ")"}]}]}], 
     RowBox[{"(*", 
      RowBox[{"(", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "t2", "]"}], "||", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t2", "]"}], "===", "1"}]}], ")"}], 
       ")"}], "*)"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestFormVectorIndices", "[", 
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "t1", "]"}], ",", 
          RowBox[{"Indices", "[", "t2", "]"}]}], "]"}], "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Coordinates", "[", "t1", "]"}], "===", 
        RowBox[{"Coordinates", "[", "t2", "]"}]}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"t1", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"Indices", "\[Rule]", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"Indices", "[", "t1", "]"}], ",", 
           RowBox[{"Indices", "[", "t2", "]"}]}], "]"}]}], ")"}]}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"Normal", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", "t1", "]"}], "\[TensorWedge]", 
           RowBox[{"TensorComponents", "[", "t2", "]"}]}], "]"}]}], ")"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{"TensorWedge", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"{", 
              RowBox[{"t1", ",", "t2"}], "}"}]}], ")"}]}], "]"}]}], ")"}]}]}],
      "}"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.871554255499343*^9, 3.87155434521754*^9}, {
   3.87155439323206*^9, 3.871554423173257*^9}, {3.87155455760633*^9, 
   3.8715545616406183`*^9}, {3.8715546222186184`*^9, 3.871554680876766*^9}, {
   3.871555070965699*^9, 3.8715550724859266`*^9}, {3.871555233183864*^9, 
   3.8715552497168264`*^9}, {3.871601386597025*^9, 3.8716013971485424`*^9}, {
   3.8716090250540304`*^9, 3.871609050684745*^9}, {3.871609095947385*^9, 
   3.8716091439954653`*^9}, {3.8716092242515306`*^9, 3.8716092337083917`*^9}, 
   3.871609355947235*^9, {3.871610634645377*^9, 3.871610689161745*^9}, {
   3.8720450772033043`*^9, 3.8720451788353043`*^9}, 3.872045304828312*^9, {
   3.872045376036312*^9, 3.8720454277393103`*^9}, {3.872045464396305*^9, 
   3.8720454783063097`*^9}, {3.8720455960442867`*^9, 3.872045603900278*^9}, {
   3.8720459290272813`*^9, 3.8720460046272864`*^9}, {3.8721252515702796`*^9, 
   3.872125252249511*^9}, {3.872127484715887*^9, 3.872127518936771*^9}, {
   3.8721365645446777`*^9, 3.8721365738400064`*^9}, 3.872136752066078*^9, 
   3.872137200094269*^9, {3.8733298535294833`*^9, 3.8733298541248274`*^9}, {
   3.8757537416715617`*^9, 3.8757537794605656`*^9}, {3.875753820015767*^9, 
   3.8757538209532356`*^9}, {3.8901942269571238`*^9, 3.89019424962121*^9}, {
   3.8901945245761485`*^9, 3.8901945279280853`*^9}, {3.8901946174161882`*^9, 
   3.8901946253668795`*^9}, {3.895555772607154*^9, 3.8955557741745043`*^9}, {
   3.9561933844428062`*^9, 3.9561934087437067`*^9}, 3.9561978569224873`*^9, 
   3.956794321521593*^9},ExpressionUUID->"79feeefb-52be-427f-9713-\
1a81e1d0c3a2"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetrizedArray", "Subsubsection",
 CellChangeTimes->{{3.8745352300428543`*^9, 
  3.874535234670026*^9}},ExpressionUUID->"144b4830-8fee-44b7-8263-\
a050478e3b14"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "SymmetrizedArray"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Tensor", "/:", 
   RowBox[{"SymmetrizedArray", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"output", ",", "newts", ",", "tc", ",", "sa"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tc", "=", 
       RowBox[{"TensorComponents", "[", "t", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"sa", "=", 
       RowBox[{"SymmetrizedArray", "[", "tc", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"output", "=", 
       RowBox[{"t", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", "xxx___"}], ")"}], 
          "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", "sa"}], ")"}]}], "}"}]}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"newts", "=", 
       RowBox[{"TensorSymmetry", "[", "sa", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorSymmetry", "\[Rule]", "ts_"}], ")"}], "\[Rule]", 
             "ts"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"Append", "[", 
         RowBox[{"output", ",", 
          RowBox[{"TensorSymmetry", "\[Rule]", "newts"}]}], "]"}], ",", 
        "True", ",", 
        RowBox[{"output", "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorSymmetry", "\[Rule]", "oldts_"}], ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorSymmetry", "\[Rule]", "newts"}], ")"}]}]}]}], 
       "]"}]}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8745352453825326`*^9, 3.874535301851828*^9}, {
   3.8745354706253147`*^9, 3.8745354966414146`*^9}, {3.874535765600994*^9, 
   3.8745357947049265`*^9}, {3.8745358487609825`*^9, 
   3.8745359323289165`*^9}, {3.874536007008989*^9, 3.874536055464908*^9}, 
   3.8745361353941855`*^9, {3.874536371000757*^9, 3.874536393112314*^9}, {
   3.874537245540819*^9, 
   3.874537245854628*^9}},ExpressionUUID->"adf3d5e7-382b-45db-8489-\
dc31b7bb2318"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorComponents", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.6064499663461447`*^9, 3.606449970874403*^9}, {3.6719161950603175`*^9, 
   3.6719162069379997`*^9}, {3.6720177824038334`*^9, 
   3.672017782669034*^9}},ExpressionUUID->"703c590b-c2fa-432e-9327-\
0051b74354d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"TensorProduct", " ", "and", " ", "TensorComponents"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TensorComponents", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"m_Tensor", "|", "m_List"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], 
         "\[RuleDelayed]", "mmm"}], ",", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"TensorComponent", " ", "one", " ", "layer"}]}], "*)"}], 
        RowBox[{"(*", "\[Infinity]", "*)"}], "1"}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorComponentsNoPart", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], 
        "\[RuleDelayed]", "mmm"}], ",", "1"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"If", " ", "there", " ", "are", " ", "no", " ", 
     RowBox[{"Tensor", "'"}], "s", " ", "then", " ", "just", " ", "return", 
     " ", "the", " ", "same", " ", "object"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TensorComponent", "[", 
       RowBox[{"m_", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], "/;", 
        RowBox[{"(", 
         RowBox[{"TestExpressionForm", "[", "m", "]"}], ")"}]}], "]"}], ":=", 
      "m"}], ";"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorComponentsNoPart", "[", 
      RowBox[{"m_", "/;", 
       RowBox[{"TestExpressionForm", "[", "m", "]"}]}], "]"}], ":=", 
     RowBox[{"{", "m", "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"TensorComponents", "[", 
      RowBox[{"t_Tensor", ",", "tc_List"}], "]"}], ":=", 
     RowBox[{"t", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", "tc"}], ")"}]}]}]}], 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89507240671309*^9, 3.8950724291978345`*^9}, {
   3.8950749272174034`*^9, 3.895074930732938*^9}, {3.895075257902565*^9, 
   3.8950752581369114`*^9}, 3.895547707077297*^9, {3.895555838030388*^9, 
   3.8955558380343843`*^9}},ExpressionUUID->"f0463e5c-46ae-45fb-9c45-\
47b88f73699a"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"One", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorComponents", "[", 
     RowBox[{"(", 
      RowBox[{"m_Tensor", "|", "m_List"}], ")"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"m", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], 
        "\[RuleDelayed]", "mmm"}], ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"TensorComponent", " ", "one", " ", "layer"}]}], "*)"}], 
       RowBox[{"(*", "\[Infinity]", "*)"}], "1"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorComponentsNoPart", "[", 
     RowBox[{"(", 
      RowBox[{"t_Tensor", "|", "t_List"}], ")"}], "]"}], ":=", 
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], 
       "\[RuleDelayed]", "mmm"}], ",", "1"}], "]"}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"If", " ", "there", " ", "are", " ", "no", " ", 
     RowBox[{"Tensor", "'"}], "s", " ", "then", " ", "just", " ", "return", 
     " ", "the", " ", "same", " ", "object"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorComponents", "[", 
     RowBox[{"m_", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], "/;", 
      RowBox[{"TestExpressionForm", "[", "m", "]"}]}], "]"}], ":=", "m"}], 
   ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorComponentsNoPart", "[", 
     RowBox[{"m_", "/;", 
      RowBox[{"TestExpressionForm", "[", "m", "]"}]}], "]"}], ":=", 
    RowBox[{"{", "m", "}"}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorComponents", "[", 
     RowBox[{"t_Tensor", ",", "tc_List"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"t", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "tc"}], ")"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Thread", " ", "over", " ", "Plus", " ", "automatically"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorComponents", "[", "mm_", "]"}], ":=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "/@", "mm"}], ")"}], "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "mm", "]"}], "===", "Plus"}], ")"}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Use", " ", "TensorsProduct", " ", "to", " ", "take", " ", "care", 
          " ", "of", " ", 
          RowBox[{"TensorProduct", "'"}], "s"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           RowBox[{"TensorComponents", "[", "mm_", "]"}], ":=", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"allTensors", ",", "therest"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"allTensors", "=", 
                RowBox[{"Times", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"List", "@@", "mm"}], ")"}], ",", "_Tensor"}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"therest", "=", 
                RowBox[{"Times", "@@", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"List", "@@", "mm"}], ")"}], ",", "_Tensor"}], 
                  "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"therest", " ", 
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"TensorsProduct", "[", "allTensors", "]"}], 
                 "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "mm", "]"}], "===", "Times"}], ")"}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"TensorComponents", " ", "for", " ", 
            RowBox[{"Times", "[", 
             RowBox[{"scalar", ",", " ", 
              RowBox[{"Plus", "[", 
               RowBox[{"t1", ",", "t2"}], "]"}]}], "]"}]}]}],
          FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TensorComponents", "/:", 
           RowBox[{"TensorComponents", "[", "mm_Times", "]"}], ":=", 
           RowBox[{"Module", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "allTensors", ",", "therest", ",", "therestpower", ",", 
               "therestscalar"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"allTensors", "=", 
               RowBox[{"Times", "@@", 
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"List", "@@", "mm"}], ")"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"_Tensor", "|", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Not", " ", "only", " ", 
                    StyleBox["Tensor",
                    FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
                    RowBox[{"but", " ", "also", " ", "a", " ", 
                    StyleBox["Plus",
                    FontColor->RGBColor[1, 0, 1]], " ", "including", " ", 
                    "Tensor", " ", "inside", " ", 
                    RowBox[{"it", ".", " ", "We"}], " ", "need", " ", "to", 
                    " ", "truly", " ", "check", " ", "that", " ", "there", 
                    " ", "is", " ", "at", " ", "least", " ", "one", " ", 
                    "Tensor", " ", "inside", " ", 
                    RowBox[{"Plus", "."}]}]}], "*)"}], 
                    RowBox[{"Plus", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], 
                    "]"}]}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"therest", "=", 
               RowBox[{"Times", "@@", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"List", "@@", "mm"}], ")"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"_Tensor", "|", 
                    RowBox[{"Plus", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], "]"}], 
                    "|", 
                    RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], 
                    "]"}]}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"therestscalar", "=", 
               RowBox[{"Times", "@@", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"List", "@@", "therest"}], ")"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], "]"}], 
                   ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"therestpower", "=", 
               RowBox[{"Times", "@@", 
                RowBox[{"Cases", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"List", "@@", "therest"}], ")"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"Power", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], "]"}], 
                   ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"therestscalar", " ", 
               RowBox[{"TensorComponents", "[", "therestpower", "]"}], " ", 
               RowBox[{"TensorComponents", "[", 
                RowBox[{"TensorsProduct", "[", "allTensors", "]"}], 
                "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TensorComponents", "/:", 
           RowBox[{"TensorComponents", "[", "mm_", "]"}], ":=", 
           RowBox[{
            RowBox[{"Module", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"allTensors", ",", "therest"}], "}"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"allTensors", "=", 
                RowBox[{"Times", "@@", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"List", "@@", "mm"}], ")"}], ",", 
                   RowBox[{"(", 
                    RowBox[{"_Tensor", "|", 
                    RowBox[{"(*", 
                    RowBox[{
                    RowBox[{"Not", " ", "only", " ", 
                    StyleBox["Tensor",
                    FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
                    RowBox[{"but", " ", "also", " ", "a", " ", 
                    StyleBox["Plus",
                    FontColor->RGBColor[1, 0, 1]], " ", "including", " ", 
                    "Tensor", " ", "inside", " ", 
                    RowBox[{"it", ".", " ", "We"}], " ", "need", " ", "to", 
                    " ", "truly", " ", "check", " ", "that", " ", "there", 
                    " ", "is", " ", "at", " ", "least", " ", "one", " ", 
                    "Tensor", " ", "inside", " ", 
                    RowBox[{"Plus", "."}]}]}], "*)"}], 
                    RowBox[{"Plus", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], 
                    "]"}]}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"therest", "=", 
                RowBox[{"Times", "@@", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"List", "@@", "mm"}], ")"}], ",", 
                   RowBox[{"(", 
                    RowBox[{"_Tensor", "|", 
                    RowBox[{"Plus", "[", 
                    RowBox[{
                    RowBox[{"Tensor", "[", "___", "]"}], ",", "___"}], 
                    "]"}]}], ")"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"therest", " ", 
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"TensorsProduct", "[", "allTensors", "]"}], 
                 "]"}]}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "mm", "]"}], "===", "Times"}], ")"}]}]}], 
          ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"TensorComponents", " ", "and", " ", "TensorsProduct"}]}], 
         "*)"}], "\[IndentingNewLine]", "TensorComponents"}]}]}], "/:", 
     RowBox[{"TensorComponents", "[", "mm_Times", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"listmm", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "mm"}], "]"}]}], ",", "allTensors", ",", 
         "therest", ",", "scalartensor", ",", "ttt", ",", "allTensorsPlus", 
         ",", "expressionscalar", ",", "a", ",", "aaa", ",", "tttt"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allTensors", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"listmm", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"aaa_Tensor", "/;", 
               RowBox[{"(", 
                RowBox[{"!", 
                 RowBox[{"TestScalarTensor", "[", "aaa", "]"}]}], ")"}]}], 
              ")"}], "|", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Not", " ", "only", " ", 
                StyleBox["Tensor",
                 FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
               RowBox[{"but", " ", "also", " ", "a", " ", 
                StyleBox["Plus",
                 FontColor->RGBColor[1, 0, 1]], " ", "including", " ", 
                "Tensor", " ", "inside", " ", 
                RowBox[{"it", ".", " ", "We"}], " ", "need", " ", "to", " ", 
                "truly", " ", "check", " ", "that", " ", "there", " ", "is", 
                " ", "at", " ", "least", " ", "one", " ", "Tensor", " ", 
                "inside", " ", 
                RowBox[{"Plus", "."}]}]}], "*)"}], 
             RowBox[{"Plus", "[", 
              RowBox[{
               RowBox[{"tttt_", "/;", 
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"TestExpressionForm", "[", "tttt", "]"}]}], ")"}]}],
                ",", "___"}], "]"}]}], ")"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allTensorsPlus", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"(", "allTensors", ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"Plus", "[", 
             RowBox[{
              RowBox[{"tttt_", "/;", 
               RowBox[{"(", 
                RowBox[{"!", 
                 RowBox[{"TestExpressionForm", "[", "tttt", "]"}]}], ")"}]}], 
              ",", "___"}], "]"}], ")"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allTensors", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"(", "allTensors", ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"Plus", "[", 
             RowBox[{
              RowBox[{"tttt_", "/;", 
               RowBox[{"(", 
                RowBox[{"!", 
                 RowBox[{"TestExpressionForm", "[", "tttt", "]"}]}], ")"}]}], 
              ",", "___"}], "]"}], ")"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"therest", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"listmm", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"aaa_Tensor", "/;", 
               RowBox[{"(", 
                RowBox[{"!", 
                 RowBox[{"TestScalarTensor", "[", "aaa", "]"}]}], ")"}]}], 
              ")"}], "|", 
             RowBox[{"Plus", "[", 
              RowBox[{
               RowBox[{"tttt_", "/;", 
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"TestExpressionForm", "[", "tttt", "]"}]}], ")"}]}],
                ",", "___"}], "]"}]}], ")"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"scalartensor", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"therest", ",", 
           RowBox[{"ttt_", "/;", 
            RowBox[{"ContainOnlyScalarTensor", "[", "ttt", "]"}]}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"scalartensor", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TensorComponents", "[", "#", "]"}], "&"}], "/@", 
            "scalartensor"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"expressionscalar", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"therest", ",", 
            RowBox[{"ttt_", "/;", 
             RowBox[{"ContainOnlyScalarTensor", "[", "ttt", "]"}]}]}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"expressionscalar", " ", "scalartensor", " ", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"TensorsProduct", "[", "allTensors", "]"}], "]"}], " ", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"allTensorsPlus", "===", 
             RowBox[{"{", "}"}]}], ")"}], ",", "1", ",", 
           RowBox[{"(", 
            RowBox[{"allTensorsPlus", "=!=", 
             RowBox[{"{", "}"}]}], ")"}], ",", 
           RowBox[{"TensorComponents", "[", 
            RowBox[{"TensorsProduct", "[", "allTensorsPlus", "]"}], "]"}]}], 
          "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"TensorComponents", "[", 
      RowBox[{"t_Power", "/;", 
       RowBox[{"(", 
        RowBox[{"TestScalarTensor", "[", 
         RowBox[{"t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         "]"}], ")"}]}], "]"}], ":=", 
     RowBox[{"Power", "[", 
      RowBox[{
       RowBox[{"TensorComponents", "[", 
        RowBox[{"t", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "]"}], ",", 
       RowBox[{"t", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}]}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TensorComponents", "[", 
       RowBox[{
        RowBox[{"func_", "[", 
         RowBox[{"leftargs___", ",", 
          RowBox[{"t_Tensor", "/;", 
           RowBox[{"(", 
            RowBox[{"TestScalarTensor", "[", "t", "]"}], ")"}]}], ",", 
          "rightargs___"}], "]"}], "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], ")"}]}]}], 
       "]"}], ":=", 
      RowBox[{"func", "/.", 
       RowBox[{"{", 
        RowBox[{"t", "\[RuleDelayed]", 
         RowBox[{"TensorComponents", "[", "t", "]"}]}], "}"}]}]}], ";"}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"TensorComponents", " ", "and", " ", "TensorsProduct"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorComponents", "[", 
     RowBox[{"func_", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Cases", "[", 
             RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], "]"}]}], 
           "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], "]"}], ":=", 
    RowBox[{"func", "/.", 
     RowBox[{"{", 
      RowBox[{"t_Tensor", "\[RuleDelayed]", 
       RowBox[{"TensorComponents", "[", "t", "]"}]}], "}"}]}]}], ";"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6064499785628433`*^9, 
   3.6064499929366655`*^9}, {3.6064500574063525`*^9, 3.606450058631423*^9}, {
   3.6064510852071395`*^9, 3.606451086894236*^9}, {3.6064957751048594`*^9, 
   3.6064958314960847`*^9}, {3.606495864783989*^9, 3.606495906263361*^9}, {
   3.6064959827927384`*^9, 3.6064960048419995`*^9}, {3.6064972708594117`*^9, 
   3.606497304087312*^9}, {3.6298436659408836`*^9, 3.629843682214212*^9}, {
   3.671395015105917*^9, 3.671395097297049*^9}, {3.6713951275160985`*^9, 
   3.6713951282661*^9}, {3.6713952573363037`*^9, 3.6713952581263046`*^9}, {
   3.6713952890963526`*^9, 3.671395389552517*^9}, {3.671575147938959*^9, 
   3.67157516683904*^9}, {3.6716547168925376`*^9, 3.6716548227991643`*^9}, {
   3.672006215211959*^9, 3.672006239339607*^9}, {3.6720239071214185`*^9, 
   3.6720239370893784`*^9}, {3.6720239903626966`*^9, 3.672024034530875*^9}, {
   3.672075814149295*^9, 3.6720758711815567`*^9}, {3.6720780052956214`*^9, 
   3.6720780609238033`*^9}, {3.672078279481304*^9, 3.6720783139002724`*^9}, {
   3.6720783679563646`*^9, 3.672078378456965*^9}, {3.672078417753213*^9, 
   3.672078456238414*^9}, {3.6720785531679583`*^9, 3.6720786273452005`*^9}, {
   3.672078662314201*^9, 3.6720786839144363`*^9}, {3.6720787590987363`*^9, 
   3.6720787732125435`*^9}, 3.672078919916935*^9, {3.672078961492313*^9, 
   3.672078989841934*^9}, {3.6720790233588514`*^9, 3.6720791037344484`*^9}, {
   3.6720791523702307`*^9, 3.672079180523841*^9}, {3.6720792292646284`*^9, 
   3.672079248677739*^9}, {3.672329668385748*^9, 3.672329733119242*^9}, {
   3.672329787257574*^9, 3.6723297945251856`*^9}, {3.6723298401683865`*^9, 
   3.672329841243403*^9}, {3.672329884296564*^9, 3.6723299093819494`*^9}, {
   3.845519790776492*^9, 3.8455198019129496`*^9}, 3.845520991633094*^9, {
   3.845523915517109*^9, 3.845523942301623*^9}, {3.845528405575433*^9, 
   3.845528410780142*^9}, {3.8455297503921127`*^9, 3.8455297558434243`*^9}, {
   3.8471689803959026`*^9, 3.8471690035549755`*^9}, {3.847169164006483*^9, 
   3.847169173072529*^9}, 3.847232288647233*^9, 3.8472332285042324`*^9, {
   3.8472342501822357`*^9, 3.847234263460235*^9}, {3.8472353483452344`*^9, 
   3.847235349730235*^9}, {3.8472437607700787`*^9, 3.8472437961656075`*^9}, {
   3.8472444957633944`*^9, 3.8472445032631345`*^9}, {3.855235244188817*^9, 
   3.855235284164158*^9}, {3.8750996638702283`*^9, 3.8750996647396927`*^9}, {
   3.875099766749401*^9, 3.875099768378398*^9}, {3.8750998598661833`*^9, 
   3.875099866057372*^9}, {3.87510057050688*^9, 3.8751005725286355`*^9}, {
   3.875101146069038*^9, 3.8751011479388857`*^9}, {3.8751024121606665`*^9, 
   3.87510241811102*^9}, {3.875747664972567*^9, 3.875747696931139*^9}, {
   3.875747986379917*^9, 3.8757479866142845`*^9}, {3.875752766070489*^9, 
   3.875752768836007*^9}, {3.875759843181634*^9, 3.875759866814891*^9}, {
   3.8757601686361785`*^9, 3.875760178389155*^9}, {3.8775685284860764`*^9, 
   3.8775685779812245`*^9}, {3.8775690210337696`*^9, 
   3.8775690272549295`*^9}, {3.877569294063362*^9, 3.8775693130554857`*^9}, {
   3.877569568492636*^9, 3.877569572908909*^9}, {3.8775704902845984`*^9, 
   3.8775705119052525`*^9}, {3.877570551340905*^9, 3.8775705699475145`*^9}, 
   3.877570692292062*^9, {3.877571007333535*^9, 3.8775710106175065`*^9}, {
   3.8775710837033863`*^9, 3.87757110739076*^9}, {3.877571221871748*^9, 
   3.8775712395578303`*^9}, {3.877571376669183*^9, 3.8775714005574346`*^9}, {
   3.8775714944534645`*^9, 3.877571562771285*^9}, 3.877571594452726*^9, {
   3.877571737000267*^9, 3.877571739867496*^9}, {3.8781743266306562`*^9, 
   3.878174377077073*^9}, {3.8781744452772036`*^9, 3.8781744762941275`*^9}, {
   3.8781745108688593`*^9, 3.878174599851853*^9}, {3.878175823733711*^9, 
   3.878175823920596*^9}, {3.8781759736697206`*^9, 3.878176014162665*^9}, {
   3.8781760923068743`*^9, 3.878176111871501*^9}, {3.8781762080423484`*^9, 
   3.87817622212069*^9}, {3.8781764836719475`*^9, 3.8781764853116555`*^9}, {
   3.878176547496023*^9, 3.878176550207356*^9}, {3.8781766077208767`*^9, 
   3.878176639270095*^9}, {3.8781767712539682`*^9, 3.878176844645253*^9}, 
   3.8781769333826213`*^9, {3.878177205644706*^9, 3.878177238746477*^9}, {
   3.8781772881730766`*^9, 3.878177308635491*^9}, {3.8781805818768435`*^9, 
   3.878180582661361*^9}, {3.878180669134446*^9, 3.878180736018301*^9}, {
   3.878180770172403*^9, 3.878180808471966*^9}, {3.878180851345192*^9, 
   3.878181032549712*^9}, {3.878181100742981*^9, 3.878181279206338*^9}, {
   3.878181701078003*^9, 3.878181704903227*^9}, 3.878181974965434*^9, {
   3.8860375940103245`*^9, 3.886037596432128*^9}, 3.886037765290517*^9, 
   3.8893291672662735`*^9, 3.889666088786619*^9, 3.8920431205872965`*^9, 
   3.8920442566645546`*^9, {3.8922042468467655`*^9, 3.8922042681616464`*^9}, {
   3.892204342545171*^9, 3.8922043510966225`*^9}, {3.8922044846237774`*^9, 
   3.8922045312471943`*^9}, 3.892204977735071*^9, {3.8922050640296726`*^9, 
   3.8922050866208005`*^9}, {3.892205191061092*^9, 3.8922052001870766`*^9}, {
   3.8922110583541746`*^9, 3.8922111079446297`*^9}, {3.8928629636246395`*^9, 
   3.8928630486628447`*^9}, {3.8932891242525525`*^9, 
   3.8932891242675424`*^9}, {3.8943392248743*^9, 3.8943392257465153`*^9}, 
   3.8950723635892124`*^9, 3.8950724011507144`*^9, {3.8955490656277328`*^9, 
   3.8955490656607094`*^9}, {3.8955553396283984`*^9, 
   3.8955553396473885`*^9}, {3.8955558380393815`*^9, 
   3.8955558380623674`*^9}},ExpressionUUID->"462b9870-eaf5-4e85-8821-\
8f23f6226b83"]
}, Closed]],

Cell[CellGroupData[{

Cell["Coordinates", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 
   3.5338800148345547`*^9}},ExpressionUUID->"afc02d37-1a20-42d1-8887-\
b5233f42effe"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Coordinates", "[", "t_", 
    RowBox[{"(*", 
     RowBox[{"/;", 
      RowBox[{"!", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}]}], "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"CoordinateSystem", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
         "mmm"}], ",", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"Coordinates", " ", "one", " ", "layer"}]}], "*)"}], 
        RowBox[{"(*", "\[Infinity]", "*)"}], "1"}], "]"}], 
      "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"CoordinatesNoPart", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"CoordinateSystem", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
        "mmm"}], ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Coordinates", "[", 
      RowBox[{"stuff_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
     RowBox[{"{", "}"}]}], ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"CoordinatesNoPart", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Coordinates", "[", 
   RowBox[{"t_Tensor", ",", "coords_List"}], "]"}], ":=", 
  RowBox[{"t", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"CoordinateSystem", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ")"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6698433615844946`*^9, 
   3.6698433880800104`*^9}, {3.669843474192936*^9, 3.6698434754330063`*^9}, {
   3.6698435353114314`*^9, 3.6698435357544565`*^9}, {3.875743971743964*^9, 
   3.8757439829660597`*^9}, {3.875747614296013*^9, 3.875747654883006*^9}, 
   3.8757477023229423`*^9, {3.8757479909925957`*^9, 3.875747991258222*^9}, {
   3.875752777800908*^9, 3.875752785114856*^9}, {3.8757602068070116`*^9, 
   3.8757602189517016`*^9}, {3.8861130176660748`*^9, 3.886113041948106*^9}, {
   3.8901990429958506`*^9, 3.8901990690527115`*^9}, 3.8950713769890904`*^9, {
   3.895555838066365*^9, 
   3.895555838071362*^9}},ExpressionUUID->"835e3df6-d88f-4a15-96ec-\
a1877aacb2a8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Indices", "Subsubsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 
   3.606497441942197*^9},ExpressionUUID->"4066e9c4-6855-4c5e-b8c7-\
c1fa83be599e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Indices", "[", 
    RowBox[{"t_", "/;", 
     RowBox[{"(", 
      RowBox[{"!", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Indices", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}], 
      ",", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", 
        RowBox[{"Indices", " ", "one", " ", "layer"}]}], "*)"}], 
      RowBox[{"(*", "\[Infinity]", "*)"}], "1"}], "]"}], 
    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Indices", " ", "for", " ", "ExpressionForm"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Indices", "[", "stuff_", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "||"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"Scalar", " ", 
       StyleBox["Expression",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["Form",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}]}], ":=", 
   RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Indices", "[", 
     RowBox[{"(", 
      RowBox[{"t_Tensor", "|", "t_List"}], ")"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Indices", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Indices", " ", "one", " ", "layer"}]}], "*)"}], 
       RowBox[{"(*", "\[Infinity]", "*)"}], "1"}], "]"}], 
     "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IndicesNoPart", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
   RowBox[{"Cases", "[", 
    RowBox[{"t", ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Indices", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}], ",",
      "1"}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"IndicesNoPart", "[", "stuff_", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "||"}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"Scalar", " ", 
       StyleBox["Expression",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["Form",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}]}], ":=", 
   RowBox[{"{", 
    RowBox[{"{", "}"}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Indices", "[", 
   RowBox[{"t_Tensor", ",", "indices_List"}], "]"}], ":=", 
  RowBox[{"t", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"Indices", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, {
   3.869045786004552*^9, 3.869045818873536*^9}, 3.8691008170883627`*^9, {
   3.8692874769265437`*^9, 3.8692874941040273`*^9}, {3.875743935792083*^9, 
   3.8757439420562305`*^9}, {3.875747719805605*^9, 3.875747728761551*^9}, {
   3.8757479746635723`*^9, 3.8757479803995376`*^9}, {3.8757527369863043`*^9, 
   3.875752752897251*^9}, {3.875760120552158*^9, 3.87576013266424*^9}, {
   3.8765435500809064`*^9, 3.8765435690752225`*^9}, {3.88603753230795*^9, 
   3.886037539998308*^9}, {3.8860454563612833`*^9, 3.8860454843691874`*^9}, {
   3.8860456652277884`*^9, 3.886045669354272*^9}, 3.886045767178056*^9, {
   3.886110907124282*^9, 3.886110919621586*^9}, {3.8861109901008615`*^9, 
   3.8861109926922693`*^9}, 3.886111024269823*^9, {3.886111353058346*^9, 
   3.886111353457098*^9}, {3.8861129892768383`*^9, 3.8861129941408405`*^9}, {
   3.890198785749992*^9, 3.890198806766276*^9}, {3.8901988959038424`*^9, 
   3.890198934597074*^9}, {3.893289124060669*^9, 3.8932891240636663`*^9}, 
   3.8950713915556073`*^9, {3.8955553396523843`*^9, 3.895555339655382*^9}, {
   3.89555583807436*^9, 3.895555838080723*^9}, {3.897192287574514*^9, 
   3.8971922972495265`*^9}},ExpressionUUID->"b3f00983-0f85-4982-a9d0-\
43b38e4a62f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["StartIndex", "Subsubsection",
 CellChangeTimes->{{3.8757460439908066`*^9, 
  3.875746051439226*^9}},ExpressionUUID->"3c0f78f8-7661-40b4-b4b7-\
efc05743b3c1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"StartIndex", "[", "t_Tensor", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}],
        ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StartIndexNoPart", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
       RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}], 
      ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"StartIndex", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", "0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"StartIndexNoPart", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"{", "0", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"StartIndex", "[", 
   RowBox[{"t_Tensor", ",", "si_Integer"}], "]"}], ":=", 
  RowBox[{"t", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
    RowBox[{"(", 
     RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}]}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8757460750817432`*^9, 3.8757461118151484`*^9}, 
   3.875752729046141*^9, {3.8757538000115633`*^9, 3.8757538025427384`*^9}, {
   3.875760084061901*^9, 3.875760101424614*^9}, {3.8757678385036755`*^9, 
   3.875767855914982*^9}, {3.8915716142409115`*^9, 3.8915716279545255`*^9}, {
   3.8915716996588*^9, 3.8915717041440563`*^9}, 3.8950713997234077`*^9, {
   3.89555583808372*^9, 
   3.895555838085719*^9}},ExpressionUUID->"4565b3fa-2feb-49ba-8e39-\
bcadf8538a29"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorName", "Subsubsection",
 CellChangeTimes->{
  3.875746244359597*^9},ExpressionUUID->"b1347b2c-9378-472d-8d1f-\
d2969626c983"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", "t_Tensor", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
         "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorNameNoPart", "[", 
    RowBox[{"(", 
     RowBox[{"t_Tensor", "|", "t_List"}], ")"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}],
        ",", "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
   RowBox[{"ToString", "[", 
    RowBox[{"stuff", ",", "InputForm"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorNameNoPart", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{"ToString", "[", 
     RowBox[{"stuff", ",", "InputForm"}], "]"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", 
    RowBox[{"t_Tensor", ",", "tn_"}], "]"}], ":=", 
   RowBox[{"t", "/.", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
     RowBox[{"(", 
      RowBox[{"TensorName", "\[Rule]", "tn"}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"(", "t_List", ")"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Apply", "[", 
       RowBox[{"TensorProduct", ",", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{"ttt_Tensor", "\[RuleDelayed]", 
           RowBox[{"TensorName", "[", "ttt", "]"}]}], " ", "}"}]}]}], "]"}]}],
      "]"}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorName", "[", 
      RowBox[{"(", 
       RowBox[{"t_Times", "|", "t_Plus"}], ")"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Times", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"aaat___", "/;", 
                RowBox[{"(", 
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"{", "aaat", "}"}]}], ")"}], "]"}], ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "}"}], "|", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "]"}], ")"}]}], 
               ")"}], ",", 
              RowBox[{"(", 
               RowBox[{"aaa___", "/;", 
                RowBox[{"(", 
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestExpressionForm", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"{", "aaa", "}"}]}], ")"}], "]"}], ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "}"}], "|", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "]"}], ")"}]}], 
               ")"}], ",", 
              RowBox[{"(", 
               RowBox[{"tt___", "/;", 
                RowBox[{"(", 
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestTensorTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"{", "tt", "}"}]}], ")"}], "]"}], ",", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"{", "}"}], "|", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "]"}], ")"}]}], 
               ")"}]}], "]"}], "\[RuleDelayed]", 
            RowBox[{
             RowBox[{"Apply", "[", 
              RowBox[{"Times", ",", 
               RowBox[{"{", "aaa", "}"}]}], "]"}], " ", 
             RowBox[{"Apply", "[", 
              RowBox[{"Times", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"{", "aaat", "}"}]}], ")"}]}], "]"}], " ", 
             RowBox[{"Apply", "[", 
              RowBox[{"TensorProduct", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"{", "tt", "}"}]}], ")"}]}], "]"}]}]}], " ", "}"}]}],
          ")"}], "/.", 
        RowBox[{"{", 
         RowBox[{"ttt_Tensor", "\[RuleDelayed]", 
          RowBox[{"TensorName", "[", "ttt", "]"}]}], " ", "}"}]}]}], "]"}]}], 
    ";"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorName", "[", 
    RowBox[{"(", 
     RowBox[{"t_Times", "|", "t_Plus"}], ")"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{"t", "/.", 
      RowBox[{"{", 
       RowBox[{"ttt_Tensor", "\[RuleDelayed]", 
        RowBox[{"TensorName", "[", "ttt", "]"}]}], " ", "}"}]}]}], "]"}]}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.89555533966038*^9, {3.8955558380887175`*^9, 
   3.8955558380937147`*^9}},ExpressionUUID->"bb0ea90d-c494-44be-a406-\
c9e0494f9712"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorName", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mmm", "}"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
          "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorNameNoPart", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mmm", "}"}], ",", 
      RowBox[{"Cases", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
         "mmm"}], ",", "1"}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"ToString", "[", 
     RowBox[{"stuff", ",", "InputForm"}], "]"}]}], ";", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorNameNoPart", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"ToString", "[", 
      RowBox[{"stuff", ",", "InputForm"}], "]"}], "}"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"t_Tensor", ",", "tn_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"t", "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorName", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorName", "\[Rule]", "tn"}], ")"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"TensorName", "[", "t_Plus", "]"}]}]}]}], ":=", 
     RowBox[{"TensorPlusName", "[", "t", "]"}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"(", 
      RowBox[{"t_Times", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"t", ",", 
             RowBox[{"Times", "[", 
              RowBox[{
               RowBox[{"scalar_", "/;", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
                 RowBox[{"(", 
                  RowBox[{"TestExpressionForm", "[", "scalar", "]"}], 
                  ")"}]}]}], ",", "_Tensor"}], "]"}]}], "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "t"}], ")"}]}], "]"}], "===", 
             RowBox[{"{", "Tensor", "}"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "t"}], ")"}]}], "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"Tensor", ",", "Plus"}], "}"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "t"}], ")"}]}], "]"}], "===", 
             RowBox[{"{", "Plus", "}"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "t"}], ")"}]}], "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"Plus", ",", "Tensor"}], "}"}]}], ")"}]}], ")"}]}], 
        ")"}]}], ")"}], "]"}], ":=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}]}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"(", 
      RowBox[{"t_List", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"t", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"scalar_", "/;", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
                 RowBox[{"(", 
                  RowBox[{"TestExpressionForm", "[", "scalar", "]"}], 
                  ")"}]}]}], ",", "_Tensor"}], "}"}]}], "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", "t", ")"}]}], "]"}], "===", 
             RowBox[{"{", "Tensor", "}"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", "t", ")"}]}], "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"Tensor", ",", "Plus"}], "}"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", "t", ")"}]}], "]"}], "===", 
             RowBox[{"{", "Plus", "}"}]}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", "t", ")"}]}], "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"Plus", ",", "Tensor"}], "}"}]}], ")"}]}], ")"}], "&&", 
         RowBox[{"(*", 
          RowBox[{"Avoid", " ", "infinite", " ", "loop"}], "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", "t", "]"}], "=!=", "1"}], ")"}]}], ")"}]}], 
      ")"}], "]"}], ":=", 
    RowBox[{"TensorProduct", "[", 
     RowBox[{"Sequence", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", "t"}], ")"}]}], 
     "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"Times", "[", 
      RowBox[{
       RowBox[{"scalar_", "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
         RowBox[{"(", 
          RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}], ",", 
       "t_Tensor"}], "]"}], "]"}], ":=", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TensorName", "[", "scalar", "]"}], ",", 
       RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorName", "[", 
     RowBox[{"(", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"scalar_", "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}], ",",
         "t_Tensor"}], "}"}], 
      RowBox[{"(*", 
       RowBox[{"|", 
        RowBox[{"{", 
         RowBox[{"t_Tensor", ",", 
          RowBox[{"scalar_", "/;", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}]}], 
         "}"}]}], "*)"}], ")"}], "]"}], ":=", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TensorName", "[", "scalar", "]"}], ",", 
       RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], ";"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875746292519969*^9, 3.8757462978636813`*^9}, 
   3.875752724669737*^9, {3.875758695885746*^9, 3.8757587330854235`*^9}, {
   3.8757588150440407`*^9, 3.875758841854862*^9}, {3.875760064577089*^9, 
   3.875760073140682*^9}, 3.8757678516026316`*^9, 3.875768000541441*^9, {
   3.876366164421177*^9, 3.876366174182337*^9}, {3.8893349546236677`*^9, 
   3.8893349899912663`*^9}, {3.8901823138006225`*^9, 
   3.8901823232406554`*^9}, {3.890189520198183*^9, 3.8901895314203215`*^9}, {
   3.891571770863692*^9, 3.891571785536721*^9}, {3.891572010271448*^9, 
   3.891572012199266*^9}, {3.8928595832550387`*^9, 3.8928595856103673`*^9}, {
   3.8928597095948095`*^9, 3.89285971401888*^9}, {3.89286036606841*^9, 
   3.8928604283153925`*^9}, {3.8928607447529216`*^9, 
   3.8928607469923615`*^9}, {3.8928608104254074`*^9, 3.892860826503474*^9}, {
   3.8928612847165194`*^9, 3.8928612849640484`*^9}, 3.892861361331791*^9, {
   3.892861590091811*^9, 3.892861594457453*^9}, {3.893289124073661*^9, 
   3.8932891240766616`*^9}, {3.894292466930987*^9, 3.894292474339141*^9}, {
   3.8942925947628355`*^9, 3.8942926064660378`*^9}, {3.894292637632886*^9, 
   3.894292653146562*^9}, {3.8942926933155365`*^9, 3.8942927576257463`*^9}, {
   3.8942928115950937`*^9, 3.8942928341932*^9}, {3.894293188098487*^9, 
   3.8942931945837193`*^9}, {3.894293240233243*^9, 3.894293254847245*^9}, {
   3.894293384358128*^9, 3.8942934002102737`*^9}, {3.8942934755576534`*^9, 
   3.89429353448814*^9}, {3.8942935685891323`*^9, 3.894293581140811*^9}, {
   3.8942937065161552`*^9, 3.89429370970496*^9}, {3.894293767012418*^9, 
   3.894293772160133*^9}, {3.894293829459885*^9, 3.894293844267803*^9}, {
   3.894293907188147*^9, 3.89429394379623*^9}, {3.8942942108214054`*^9, 
   3.8942942427613325`*^9}, 3.894294355224544*^9, 3.894294421326463*^9, {
   3.894294505580612*^9, 3.8942945099149227`*^9}, {3.894294681235716*^9, 
   3.894294705099181*^9}, 3.8942947714055324`*^9, 3.8942948163134375`*^9, 
   3.8942949223244686`*^9, 3.894294987676506*^9, {3.894338322835724*^9, 
   3.8943383333638425`*^9}, 3.895071406545415*^9, 3.8950729388440943`*^9, {
   3.895555339665379*^9, 3.8955553396773715`*^9}, {3.895555838096712*^9, 
   3.8955558381121297`*^9}},ExpressionUUID->"bee3196f-15a2-4a02-be51-\
bbd1feefe179"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorType", "Subsubsection",
 CellChangeTimes->{3.875746244359597*^9, 
  3.8757471685336537`*^9},ExpressionUUID->"1a17629d-a506-40d7-a32b-\
bf58a766190a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TensorType", "[", "t_Tensor", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorType", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}],
        ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorTypeNoPart", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
       RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TensorType", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", "mmm"}], 
      ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TensorType", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
   "Null"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorTypeNoPart", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"{", "Null", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorType", "[", 
   RowBox[{"t_Tensor", ",", "tt_"}], 
   RowBox[{"(*", "String", "*)"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorType", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
           "mmm"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], ",", 
      RowBox[{"Append", "[", 
       RowBox[{"t", ",", 
        RowBox[{"TensorType", "\[Rule]", "tt"}]}], "]"}], ",", "True", ",", 
      RowBox[{"t", "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorType", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"TensorType", "\[Rule]", "tt"}], ")"}]}]}]}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875746292519969*^9, 3.8757462978636813`*^9}, {
   3.8757471064641714`*^9, 3.8757471160639086`*^9}, 3.8757527215834594`*^9, {
   3.8757600452744193`*^9, 3.87576004939929*^9}, {3.891571819719816*^9, 
   3.8915718540808077`*^9}, 3.8915720497042437`*^9, 3.892005873878061*^9, 
   3.895071412418853*^9, {3.8955558381151285`*^9, 
   3.8955558381171274`*^9}},ExpressionUUID->"651c226d-6609-4b62-84bd-\
4cd7cee36332"]
}, Closed]],

Cell[CellGroupData[{

Cell["TooltipDisplay", "Subsubsection",
 CellChangeTimes->{3.875746244359597*^9, 
  3.8757464068069487`*^9},ExpressionUUID->"650aa254-73b5-4ec3-ba41-\
8826e283f1a4"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TooltipDisplay", "[", "t_Tensor", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
        "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
     "\[RightDoubleBracket]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TooltipDisplayNoPart", "[", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
       RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Cases", "[", 
     RowBox[{"t", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
       "mmm"}], ",", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TooltipDisplay", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
   "Null"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TooltipDisplayNoPart", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"{", "Null", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TooltipDisplay", "[", 
   RowBox[{"t_Tensor", ",", "disp_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
           "mmm"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], ",", 
      RowBox[{"Append", "[", 
       RowBox[{"t", ",", 
        RowBox[{"TooltipDisplay", "\[Rule]", "disp"}]}], "]"}], ",", "True", 
      ",", 
      RowBox[{"t", "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TooltipDisplay", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"TooltipDisplay", "\[Rule]", "disp"}], ")"}]}]}]}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875746292519969*^9, 3.8757462978636813`*^9}, {
   3.875746393069105*^9, 3.875746406062407*^9}, 3.8757527183431144`*^9, {
   3.8757597874452896`*^9, 3.8757597909452057`*^9}, 3.8757599440395494`*^9, {
   3.875760013020107*^9, 3.875760021630728*^9}, {3.88538281426154*^9, 
   3.8853829400330057`*^9}, 3.8853831081167984`*^9, {3.8853856351032157`*^9, 
   3.8853856434970407`*^9}, 3.8853873095464635`*^9, 3.8893324322048655`*^9, 
   3.895119338090108*^9, {3.8955558381221237`*^9, 
   3.895555838124123*^9}},ExpressionUUID->"9e368f45-d1d0-410d-bd81-\
bfdc7ae926b7"]
}, Closed]],

Cell[CellGroupData[{

Cell["TooltipStyle", "Subsubsection",
 CellChangeTimes->{3.875746244359597*^9, 3.8757464068069487`*^9, 
  3.875746627396842*^9},ExpressionUUID->"80b4b81a-4cbf-44a8-b5cb-\
d8713f3ffa99"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Tensor", "/:", 
    RowBox[{"TooltipStyle", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mmm", "}"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TooltipStyle", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
          "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
       "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "TooltipStyle", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TooltipStyle", "[", 
    RowBox[{"stuff_", "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "stuff", "]"}], "=!=", "List"}], ")"}]}], 
      ")"}]}], "]"}], ":=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TooltipStyle", "[", 
    RowBox[{"t_List", "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"t", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
          RowBox[{"(", 
           RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
       RowBox[{"{", "}"}]}], ")"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"t", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TooltipStyle", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
         "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Protect", "[", "TooltipStyle", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TooltipStyleNoPart", "[", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
           RowBox[{"(", 
            RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "mmm", "}"}], ",", 
     RowBox[{"Cases", "[", 
      RowBox[{"t", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TooltipStyle", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
        "mmm"}], ",", "1"}], "]"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TooltipStyleNoPart", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"Tensor", "/:", 
  RowBox[{"TooltipStyle", "[", 
   RowBox[{"t_Tensor", ",", "style_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "mmm", "}"}], ",", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"t", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TooltipStyle", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
           "mmm"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}], ",", 
      RowBox[{"Append", "[", 
       RowBox[{"t", ",", 
        RowBox[{"TooltipStyle", "\[Rule]", "style"}]}], "]"}], ",", "True", 
      ",", 
      RowBox[{"t", "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TooltipStyle", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
        RowBox[{"(", 
         RowBox[{"TooltipStyle", "\[Rule]", "style"}], ")"}]}]}]}], "]"}]}], 
   "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875746292519969*^9, 3.8757462978636813`*^9}, {
   3.875746393069105*^9, 3.8757464191569567`*^9}, {3.8757466295774975`*^9, 
   3.8757466317481623`*^9}, {3.875747506892691*^9, 3.875747513717491*^9}, {
   3.875752703272806*^9, 3.8757527105990314`*^9}, {3.8757590649883633`*^9, 
   3.875759065316481*^9}, {3.8757596706875043`*^9, 3.875759721961787*^9}, {
   3.875759992953367*^9, 3.875760026819584*^9}, 3.8757682131291723`*^9, 
   3.8757682869883113`*^9, {3.8853829461162558`*^9, 3.885383004870039*^9}, {
   3.8853856019366612`*^9, 3.8853856284393225`*^9}, {3.885958766128955*^9, 
   3.885958766742583*^9}, {3.8859588274861794`*^9, 3.885958837686942*^9}, {
   3.8859588689105186`*^9, 3.8859588796229687`*^9}, {3.8859593724291725`*^9, 
   3.8859593904681406`*^9}, {3.885961856151286*^9, 3.8859618582010317`*^9}, {
   3.8859619168435707`*^9, 3.8859619417223563`*^9}, {3.885961979393321*^9, 
   3.8859619856924686`*^9}, {3.885962038940872*^9, 3.8859620463193636`*^9}, {
   3.8859621416032324`*^9, 3.8859621496653037`*^9}, {3.8859624876277723`*^9, 
   3.885962518907339*^9}, {3.8859625678747163`*^9, 3.885962568042611*^9}, 
   3.8950714204389453`*^9, 3.89511936948377*^9, {3.8955558381281204`*^9, 
   3.8955558381301203`*^9}},ExpressionUUID->"66275e49-0229-48bf-86d9-\
5f71bbb1bb90"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorAssumption", "Subsubsection",
 CellChangeTimes->{3.875746244359597*^9, 3.8757464068069487`*^9, 
  3.886570508876636*^9, 
  3.886734688179941*^9},ExpressionUUID->"d54d3da9-b877-45bd-9080-\
d8575f7b7de7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TensorAssumption", "[", "t_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mmm", ",", "result"}], "}"}], ",", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorAssumption", "\[Rule]", "mmm_"}], ")"}], 
            "\[Rule]", "mmm"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"{", "}"}], ",", "True", ",", 
          RowBox[{
          "result", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorAssumptionNoPart", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mmm", ",", "result"}], "}"}], ",", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorAssumption", "\[Rule]", "mmm_"}], ")"}], 
            "\[Rule]", "mmm"}], ",", "1"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", "}"}], "}"}], ",", "True", ",", "result"}], "]"}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorAssumptionNoPart", "[", "stuff_", "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "||"}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"Scalar", " ", 
        StyleBox["Expression",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["Form",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}]}], ":=", 
    RowBox[{"{", 
     RowBox[{"{", "}"}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorAssumption", "[", 
     RowBox[{"t_Tensor", ",", "SL_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mmm", "}"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorAssumption", "\[Rule]", "mmm_"}], ")"}], 
             "\[Rule]", "mmm"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"Append", "[", 
         RowBox[{"t", ",", 
          RowBox[{"TensorAssumption", "\[Rule]", "SL"}]}], "]"}], ",", "True",
         ",", 
        RowBox[{"t", "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorAssumption", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorAssumption", "\[Rule]", "SL"}], ")"}]}]}]}], 
       "]"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875746292519969*^9, 3.8757462978636813`*^9}, {
   3.875746393069105*^9, 3.875746406062407*^9}, 3.8757527183431144`*^9, {
   3.8757597874452896`*^9, 3.8757597909452057`*^9}, 3.8757599440395494`*^9, {
   3.875760013020107*^9, 3.875760021630728*^9}, {3.88538281426154*^9, 
   3.8853829400330057`*^9}, 3.8853831081167984`*^9, {3.8853856351032157`*^9, 
   3.8853856434970407`*^9}, 3.8853873095464635`*^9, {3.8865705110412955`*^9, 
   3.886570534288515*^9}, {3.8865705823374186`*^9, 3.886570596982376*^9}, {
   3.8865708057249775`*^9, 3.886570887772316*^9}, {3.8865739875759006`*^9, 
   3.8865740077920094`*^9}, {3.886734688307865*^9, 3.8867346883388467`*^9}, {
   3.8869082564676294`*^9, 3.8869084126362524`*^9}, 3.88933242176495*^9, 
   3.893289124089653*^9, 3.8950714250909004`*^9, 3.895555339682366*^9, 
   3.8955558381341166`*^9},ExpressionUUID->"41e88635-2b04-436f-9e5d-\
cb3af399831b"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorOperator", "Subsubsection",
 CellChangeTimes->{
  3.875746244359597*^9, 3.8757464068069487`*^9, {3.886737902050011*^9, 
   3.8867379055458684`*^9}, 
   3.8867391318978004`*^9},ExpressionUUID->"c80e352f-b229-4543-817b-\
6f93f3646a9d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TensorOperator", "[", 
      RowBox[{"(", 
       RowBox[{"t_Tensor", "|", "t_Times", "|", "t_Plus"}], ")"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mmm", ",", "result"}], "}"}], ",", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorOperator", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
            "mmm"}], ",", "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", "Simplify", ",", "True", ",", 
          RowBox[{
          "result", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorOperatorNoPart", "[", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t_Tensor", "|", "t_List"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"a_", "\[Rule]", " ", "b_"}], ")"}], "\[Rule]", " ", 
             RowBox[{"(", 
              RowBox[{"a", "\[Rule]", " ", "b"}], ")"}]}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mmm", ",", "result"}], "}"}], ",", 
       RowBox[{
        RowBox[{"result", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorOperator", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
            "mmm"}], ",", "1"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"result", "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", 
          RowBox[{"{", "Simplify", "}"}], ",", "True", ",", "result"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorOperator", "[", 
      RowBox[{"stuff_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
     "Simplify"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorOperatorNoPart", "[", 
      RowBox[{"stuff_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], "]"}], ":=", 
     RowBox[{"{", "Simplify", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorOperator", "[", 
     RowBox[{"t_Tensor", ",", "top_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "mmm", "}"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorOperator", "\[Rule]", "mmm_"}], ")"}], "\[Rule]",
              "mmm"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], ",", 
        RowBox[{"Append", "[", 
         RowBox[{"t", ",", 
          RowBox[{"TensorOperator", "\[Rule]", "top"}]}], "]"}], ",", "True", 
        ",", 
        RowBox[{"t", "/.", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorOperator", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TensorOperator", "\[Rule]", "top"}], ")"}]}]}]}], "]"}]}],
      "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.875746292519969*^9, 3.8757462978636813`*^9}, {
   3.875746393069105*^9, 3.875746406062407*^9}, 3.8757527183431144`*^9, {
   3.8757597874452896`*^9, 3.8757597909452057`*^9}, 3.8757599440395494`*^9, {
   3.875760013020107*^9, 3.875760021630728*^9}, {3.88538281426154*^9, 
   3.8853829400330057`*^9}, 3.8853831081167984`*^9, {3.8853856351032157`*^9, 
   3.8853856434970407`*^9}, 3.8853873095464635`*^9, {3.88673790910069*^9, 
   3.886737944747837*^9}, {3.8867381942648754`*^9, 3.886738194770568*^9}, {
   3.88673915278115*^9, 3.88673931919538*^9}, 3.889332221710679*^9, {
   3.8893322552950687`*^9, 3.889332258552353*^9}, 3.8893324117251115`*^9, {
   3.8893324944291067`*^9, 3.8893324962880383`*^9}, 3.895071429429136*^9, {
   3.8955558381391134`*^9, 
   3.8955558381411123`*^9}},ExpressionUUID->"ee6ef492-15bd-49cf-b99c-\
f24451caf889"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorPlus (Abandoned)", "Subsubsection",
 CellChangeTimes->{{3.8871159422436657`*^9, 3.887115942803321*^9}, 
   3.887116567721857*^9, {3.8947757488435726`*^9, 3.8947757551877875`*^9}, {
   3.8950714581946273`*^9, 
   3.8950714583821487`*^9}},ExpressionUUID->"f6ddef79-ceac-444b-9b8f-\
0cb002174997"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "TensorPlus"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorPlus", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"LHSt_Tensor", "|", "LHSt_Times"}], 
        RowBox[{"(*", 
         RowBox[{"|", "LHSt_Plus"}], "*)"}], ")"}], "+", 
       RowBox[{"(", 
        RowBox[{"RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus"}], ")"}]}],
       "]"}], "/;", 
     RowBox[{"(*", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"LHSt", ",", 
          RowBox[{"Tensor", "[", "___", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}], "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "LHSt", "]"}]}], ")"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"RHSt", ",", 
           RowBox[{"Tensor", "[", "___", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "=!=", 
         RowBox[{"{", "}"}]}], ")"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{
         RowBox[{"{", "LHSt", "}"}], ",", 
         RowBox[{"Tensor", "[", "xx___", "]"}], ",", "\[Infinity]"}], "]"}], 
       "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "LHStc_"}], ")"}], 
        "\[RuleDelayed]", "   ", 
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"LHSt", "+", "RHSt"}], "]"}]}], ")"}]}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorName", "\[Rule]", "LHStn_"}], ")"}], "\[RuleDelayed]",
         "   ", 
        RowBox[{"(", 
         RowBox[{"TensorName", "\[Rule]", 
          RowBox[{"TensorPlusName", "[", 
           RowBox[{"LHSt", "+", "RHSt"}], "]"}]}], ")"}]}]}], "}"}]}]}], 
   "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.887115965499324*^9, 3.887116027307145*^9}, {
   3.887116057434755*^9, 3.8871162505446987`*^9}, {3.887116502281208*^9, 
   3.8871165050784826`*^9}, {3.8871165583956127`*^9, 
   3.8871166172233243`*^9}, {3.887116674437029*^9, 3.8871166749906874`*^9}, {
   3.8871174264311485`*^9, 3.8871174614725533`*^9}, {3.887117587040702*^9, 
   3.887117655989662*^9}, 3.8871178257001204`*^9, 3.8877675281837873`*^9, {
   3.889327571436737*^9, 3.889327580332929*^9}, {3.889328083441069*^9, 
   3.889328124928286*^9}, {3.889665765775412*^9, 3.8896657679554453`*^9}, {
   3.8901819585723777`*^9, 3.8901819699558973`*^9}, {3.890182074091158*^9, 
   3.890182097098976*^9}, {3.89018217489922*^9, 3.890182200507307*^9}, {
   3.8901824304074183`*^9, 3.8901824540497427`*^9}, {3.8901875490916476`*^9, 
   3.8901875778419952`*^9}, {3.8901876937410555`*^9, 
   3.8901877168892527`*^9}, {3.890187756726964*^9, 3.890187760304902*^9}, 
   3.890188659156553*^9, {3.8901887526916003`*^9, 3.8901887621228685`*^9}, {
   3.890188798728603*^9, 3.8901888850186415`*^9}, {3.890188968177595*^9, 
   3.890188975736879*^9}, {3.8901891710321193`*^9, 3.8901891732917395`*^9}, {
   3.8901892047128315`*^9, 3.8901892789357986`*^9}, {3.890189448538638*^9, 
   3.8901894573015733`*^9}, 3.890191192077525*^9, {3.894775778240085*^9, 
   3.8947757824729667`*^9}, {3.89555583814411*^9, 
   3.8955558381461096`*^9}},ExpressionUUID->"9c23682d-a789-407b-848f-\
e713449f4f9b"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Operators\[CloseCurlyQuote] Rules", "Subsection",
 CellChangeTimes->{{3.8950681941601295`*^9, 
  3.8950682052275953`*^9}},ExpressionUUID->"f3f44c39-e189-4599-a024-\
fd5d7b9b5c7b"],

Cell[CellGroupData[{

Cell["OperatorNullList", "Subsubsection",
 CellChangeTimes->{3.8950725408048186`*^9, 
  3.89507338817723*^9},ExpressionUUID->"23ecd828-5ed8-439a-8735-8f25774e6733"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"OperatorNullList", "[", "a_", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Function", " ", "Name"}],
     FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"a", "[", 
    RowBox[{"x1___", ",", 
     RowBox[{"{", "}"}], ",", 
     RowBox[{"x2___", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
          RowBox[{"{", "1", "}"}]}], "]"}], "===", 
        RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
   "1"}]}], "\[IndentingNewLine]", 
 RowBox[{"OperatorNullList", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorNullList", "[", "TensorComponents", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.895073372902302*^9, 3.895073377324029*^9}, 
   3.895073612840896*^9, 3.8950743923250165`*^9, 
   3.895074849409528*^9},ExpressionUUID->"8df9954d-80ca-4556-9487-\
8ff41072a942"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorDistributeOverPlus", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072594132703*^9},ExpressionUUID->"1aa6c251-39ee-4486-8824-\
260a86b5abeb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorDistributeOverPlus", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", "t_Plus", ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Apply", "[", 
     RowBox[{"Plus", ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"x1", ",", "#", ",", "x2"}], "}"}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistributeOverPlus", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorDistributeOverPlus", "[", "TensorComponents", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "PartialD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "CovariantD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "LieDerivative", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "LieBracket", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "ExteriorD", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Conjugate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorDistributeOverPlus", "[", "Conjugate", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Conjugate", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950725919921627`*^9, 3.8950736200685687`*^9, 
   3.8950744045288415`*^9, 3.895074850284481*^9, {3.895549279309618*^9, 
   3.8955492830710707`*^9}, {3.8984011733807507`*^9, 
   3.8984012091886573`*^9}, {3.8987524414261913`*^9, 
   3.8987524472555437`*^9}},ExpressionUUID->"0ddf66b2-2c4f-46d3-a8b5-\
2c4366356ce4"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorExpansion", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072626577613*^9},ExpressionUUID->"7c82a65f-04a3-4068-a8d3-\
46c810bf713b"],

Cell[BoxData[{
 RowBox[{"OperatorDistributeOverPlus", "[", "LT", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"OperatorExpansion", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"(", "t_Times", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"|", "t_List"}], "/;", 
             RowBox[{"(", 
              RowBox[{"t", "=!=", 
               RowBox[{"{", "}"}]}], ")"}]}], "*)"}], ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "t"}], "]"}], ",", 
            RowBox[{"Plus", "[", 
             RowBox[{
              RowBox[{"tt_", "/;", 
               RowBox[{"!", 
                RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
              "___"}], "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ":=", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", 
         RowBox[{"Expand", "[", "t", "]"}], ",", "x2"}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"(", 
           RowBox[{"t_List", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "=!=", 
                RowBox[{"{", "}"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
                RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{"Plus", "[", 
             RowBox[{
              RowBox[{"tt_", "/;", 
               RowBox[{"!", 
                RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
              "___"}], "]"}], ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}], ")"}]}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"LTttt", ",", "output1"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"LTttt", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"LT", ",", "t"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"output1", "=", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "LTttt", ",", "x2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"output1", "=", 
           RowBox[{"output1", "/.", 
            RowBox[{"{", 
             RowBox[{"LT", "\[Rule]", " ", "List"}], "}"}]}]}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ";"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpansion", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpansion", "[", "TensorComponents", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, {3.8950726171829147`*^9, 3.8950726226871204`*^9}, 
   3.8950744056538095`*^9, 3.8950748514719505`*^9, {3.895555838150107*^9, 
   3.8955558381531043`*^9}},ExpressionUUID->"f48a2b94-e898-4e99-8e01-\
5f1f5164877b"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorFactorOutScalar", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072792222621*^9},ExpressionUUID->"8c83a780-d5bd-4f42-9a88-\
4a2610da6da9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorFactorOutScalar", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "t", "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"(", "t_Times", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"|", "t_List"}], "/;", 
             RowBox[{"(", 
              RowBox[{"t", "=!=", 
               RowBox[{"{", "}"}]}], ")"}]}], "*)"}], ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Apply", "[", 
                RowBox[{"List", ",", "t"}], "]"}], ",", 
               RowBox[{"Plus", "[", 
                RowBox[{
                 RowBox[{"tt_", "/;", 
                  RowBox[{"!", 
                   RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
                 "___"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"(", 
             RowBox[{"TestTensorTensor", "/@", 
              RowBox[{"(", 
               RowBox[{"Apply", "[", 
                RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}], "]"}], "=!=", 
           RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "allTensors", ",", "scalarexpr", ",", "scalartensor", ",", 
           "FunctionOfScalarTensor", ",", 
           RowBox[{"Listmm", "=", 
            RowBox[{"(", 
             RowBox[{"Apply", "[", 
              RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ",", 
           "FunctionOfTensorTensor"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"scalarexpr", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"se_", "/;", 
               RowBox[{"TestExpressionForm", "[", "se", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"scalartensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"st_", "/;", 
               RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfScalarTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"func_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                   RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfTensorTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"Listmm", ",", 
             RowBox[{"(", 
              RowBox[{"fott_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"fott", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"TestExpressionForm", "[", "fott", "]"}]}]}], 
                ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Complement", "[", 
            RowBox[{
            "Listmm", ",", "scalarexpr", ",", "scalartensor", ",", 
             "FunctionOfScalarTensor", ",", "FunctionOfTensorTensor"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "scalarexpr"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "scalartensor"}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "FunctionOfScalarTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "FunctionOfTensorTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", 
             RowBox[{"TensorsProduct", "[", 
              RowBox[{"(", 
               RowBox[{"Times", "@@", "allTensors"}], ")"}], "]"}], ",", 
             "x2"}], "]"}]}]}]}], "\[IndentingNewLine]", " ", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"(", 
           RowBox[{"t_List", "/;", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", "=!=", 
                RowBox[{"{", "}"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Cases", "[", 
                 RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
                RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
          RowBox[{"x2___", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"!", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"t", ",", 
               RowBox[{"Plus", "[", 
                RowBox[{
                 RowBox[{"tt_", "/;", 
                  RowBox[{"!", 
                   RowBox[{"TestExpressionForm", "[", "tt", "]"}]}]}], ",", 
                 "___"}], "]"}], ",", 
               RowBox[{"{", "1", "}"}]}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{"TestTensorTensor", "/@", 
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}], "]"}], "=!=", 
             RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{"MatchQ", "[", 
              RowBox[{"t", ",", 
               RowBox[{"{", 
                RowBox[{"___", ",", 
                 RowBox[{"TensorsProduct", "[", 
                  RowBox[{"___", ",", "Tensor"}], "]"}], ",", "___"}], 
                "}"}]}], "]"}], ")"}]}]}], ")"}]}]}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "allTensors", ",", "scalarexpr", ",", "scalartensor", ",", 
           "FunctionOfScalarTensor", ",", "FunctionOfTensorTensor", ",", 
           "TimesScalarTensor", ",", "TimesScalarTensorR"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"scalarexpr", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"se_", "/;", 
               RowBox[{"TestExpressionForm", "[", "se", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"scalartensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"st_", "/;", 
               RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfScalarTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"func_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                   RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FunctionOfTensorTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{"fott_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Tensor"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Plus"}], ")"}],
                  "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Head", "[", "fott", "]"}], "=!=", "Times"}], 
                  ")"}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Cases", "[", 
                    RowBox[{"fott", ",", "_Tensor", ",", "Infinity"}], 
                    "]"}]}], "]"}], "===", 
                    RowBox[{"{", "True", "}"}]}], ")"}]}], "&&", 
                 RowBox[{"!", 
                  RowBox[{"TestExpressionForm", "[", "fott", "]"}]}]}], 
                ")"}]}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"t", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "scalarexpr"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "scalartensor"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "FunctionOfScalarTensor"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"allTensors", "=", 
           RowBox[{"Replace", "[", 
            RowBox[{"allTensors", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"#", "\[Rule]", " ", "Nothing"}], ")"}], "&"}], "/@",
                "FunctionOfTensorTensor"}], ")"}], ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", "scalarexpr"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{"a", "/@", "scalartensor"}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "FunctionOfScalarTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "FunctionOfTensorTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "allTensors", ",", "x2"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"TimesScalarTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{"allTensors", ",", "_Times", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"TimesScalarTensorR", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "TimesScalarTensor", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "\[Rule]", " ", 
               RowBox[{"TensorsProduct", "[", 
                RowBox[{"(*", 
                 RowBox[{"x1", ","}], "*)"}], 
                RowBox[{
                 RowBox[{
                 "TimesScalarTensor", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{"(*", 
                  RowBox[{",", "x2"}], "*)"}], ",", "Tensor"}], "]"}]}], 
              ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "TimesScalarTensor", "]"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "scalarexpr"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "scalartensor"}], ")"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "FunctionOfScalarTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"Times", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"a", "[", 
                 RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
               "FunctionOfTensorTensor"}], ")"}]}], ")"}], " ", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", 
             RowBox[{"TensorsProduct", "[", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TimesScalarTensor", "===", 
                  RowBox[{"{", "}"}]}], ")"}], ",", "allTensors", ",", "True",
                 ",", 
                RowBox[{"Replace", "[", 
                 RowBox[{"allTensors", ",", "TimesScalarTensorR", ",", 
                  RowBox[{"{", "1", "}"}]}], "]"}]}], "]"}], "]"}], ",", 
             "x2"}], "]"}]}]}]}], "\[IndentingNewLine]", " ", "]"}]}], 
      ";"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorFactorOutScalar", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorFactorOutScalar", "[", "TensorComponents", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.895072783613448*^9, {3.8950744094199347`*^9, 
   3.895074423091793*^9}, {3.8950744882775497`*^9, 3.8950744912618465`*^9}, {
   3.8950745605477467`*^9, 3.8950745620477047`*^9}, 3.89507485225318*^9, {
   3.895555339697356*^9, 3.89555533974433*^9}, {3.8955558381610994`*^9, 
   3.895555838197076*^9}},ExpressionUUID->"2c93cd0b-eca5-4afe-839b-\
d6a84edb3bc6"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorRemoveSingleComponentList", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.8950728029872255`*^9},ExpressionUUID->"93e1a582-cf2e-4df0-8776-\
723340952030"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorRemoveSingleComponentList", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"{", 
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"t", "=!=", "Tensor"}], ")"}]}], "}"}], ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"a", "[", 
     RowBox[{"x1", ",", "t", ",", "x2"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorRemoveSingleComponentList", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorRemoveSingleComponentList", "[", "TensorComponents", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.895072551585758*^9, 3.8950728015341644`*^9, 
  3.895074563063302*^9, 3.895074852878163*^9, 3.895118706411739*^9, 
  3.895118789270382*^9},ExpressionUUID->"68673e80-1522-444a-8f48-\
9a4fcb952557"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorThreadThroughFunction", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.8950728148585377`*^9},ExpressionUUID->"93ad3344-221c-47ed-8021-\
9301d3e0e3f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorThreadThroughFunction", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"func_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "LT"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "a"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "List"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Cases", "[", 
              RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], "]"}]}], 
            "]"}], "===", 
           RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"func", "/.", 
     RowBox[{"{", 
      RowBox[{"t_Tensor", "\[RuleDelayed]", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", "t", ",", "x2"}], "]"}]}], "}"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorThreadThroughFunction", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorThreadThroughFunction", "[", "TensorComponents", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.895072551585758*^9, 3.8950728129679356`*^9, 
  3.895074563907031*^9, 3.895074853659416*^9, 
  3.8955553397493258`*^9},ExpressionUUID->"f4bf9519-da37-4584-8229-\
68da2fcbca6e"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorTensorReturnItself", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072841836537*^9},ExpressionUUID->"10bafcd7-3513-408d-abb3-\
134089a6cebd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorTensorReturnItself", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"(*", 
      RowBox[{"x1___", ","}], "*)"}], 
     RowBox[{"(", 
      RowBox[{"t_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{"t", "=!=", "Tensor"}], ")"}]}], ")"}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"x2___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}], "*)"}], "]"}], ":=", "t"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorReturnItself", "[", "TensorsProduct", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.895072551585758*^9, 3.895072840477172*^9, 
  3.8950745647038827`*^9},ExpressionUUID->"4e371737-231c-4a4c-b82d-\
436fd001d52c"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorExpressionFormReturnItself", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072851452937*^9},ExpressionUUID->"75ca5e59-f155-4b3b-a983-\
7ded1a3e689c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorExpressionFormReturnItself", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"(*", 
      RowBox[{"x1___", ","}], "*)"}], 
     RowBox[{"(", 
      RowBox[{"t_", "/;", 
       RowBox[{
        RowBox[{"TestExpressionForm", "[", "t", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"t", "=!=", "Tensor"}], ")"}]}]}], ")"}], 
     RowBox[{"(*", 
      RowBox[{",", 
       RowBox[{"(", 
        RowBox[{"x2___", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], "*)"}], "]"}], ":=", 
    "t"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpressionFormReturnItself", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorExpressionFormReturnItself", "[", "TensorComponents", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.895072551585758*^9, 3.8950728499217014`*^9, 
  3.8950745658757544`*^9, 3.8950748543156476`*^9, 
  3.895555838200074*^9},ExpressionUUID->"f7074981-1802-4521-80a0-\
1bdf63318722"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorTensorsProduct", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.8950728652731066`*^9, 
   3.895074567906929*^9},ExpressionUUID->"21366297-de70-431e-bb9a-\
44742026c5d0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorTensorsProduct", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t_Times", "|", "t_List"}], "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"t", "=!=", 
             RowBox[{"{", "}"}]}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"t", ",", "_Tensor", ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], ",", 
       RowBox[{"x2___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
      RowBox[{"(*", " ", 
       RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Head", "/@", 
           RowBox[{"(", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "t"}], "]"}], ")"}]}], "]"}], "===", 
         RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", " ", 
        RowBox[{
        "all", " ", "coordinate", " ", "systems", " ", "are", " ", "the", " ",
          "same"}], " ", "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Coordinates", "/@", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"Apply", "[", 
               RowBox[{"List", ",", "t"}], "]"}], ",", 
              RowBox[{"Tensor", "[", "___", "]"}]}], "]"}]}], "]"}], "]"}], "===",
          "1"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Apply", "[", 
             RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
           RowBox[{"(", 
            RowBox[{"st_", "/;", 
             RowBox[{"TestScalarTensor", "[", "st", "]"}]}], ")"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "t"}], "]"}], "]"}], "=!=", "1"}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"tensorproduct", ",", "allindices", ",", "tensornames", ",", 
        RowBox[{"listt", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}]}], ",", "ii"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensorproduct", "=", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "/@", "listt"}], ")"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Join", " ", "all", " ", "indices", " ", "to", " ", "form", " ", 
         "index", " ", "structure", " ", "of", " ", "Tensor", " ", 
         "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allindices", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Indices", "/@", "listt"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Tensor", " ", "all", " ", "the", " ", "names"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"tensornames", "=", 
          RowBox[{"TensorProduct", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(*", 
             RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"(", 
               RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}]}], "]"}]}], ";"}],
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tensornames", "=", 
        RowBox[{"TensorName", "[", "listt", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
         "properties", " ", "of", " ", "the", " ", "first", " ", "Tensor"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "listt", ")"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
               ")"}]}]}], "}"}]}], ")"}], ",", "x2"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorsProduct", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorTensorsProduct", "[", "TensorComponents", "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728615232306`*^9, {3.8950745687506523`*^9, 
   3.895074576656689*^9}, 3.8950748550500026`*^9, 3.895555339757321*^9, {
   3.898406112540882*^9, 3.898406116567314*^9}, {3.898406147390956*^9, 
   3.8984061478767996`*^9}, {3.8984062078321314`*^9, 
   3.8984062152465277`*^9}, {3.898406254449374*^9, 
   3.898406261126567*^9}},ExpressionUUID->"5ee271bf-6c2a-458e-8e57-\
9e23e8a922f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorContractThroughFunction", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072888853574*^9},ExpressionUUID->"bd0e82e6-1ea8-4e4f-a672-\
f441813d8795"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OperatorContractThroughFunction", "[", "a_", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Function", " ", "Name"}],
      FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"a", "[", 
     RowBox[{"x1___", ",", 
      RowBox[{"func_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "TensorsProduct"}], 
          ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "LT"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "a"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "List"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Tensor"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Plus"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "func", "]"}], "=!=", "Times"}], ")"}], "&&", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TestScalarTensor", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"Cases", "[", 
               RowBox[{"func", ",", "_Tensor", ",", "Infinity"}], "]"}]}], 
             "]"}], "===", 
            RowBox[{"{", "True", "}"}]}], ")"}]}], "&&", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "func", "]"}]}]}], ")"}]}], ",", 
      RowBox[{"x2___", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Replace", "[", 
     RowBox[{"func", ",", 
      RowBox[{
       RowBox[{"ContentWithTensor_", "/;", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestExpressionForm", "[", "ContentWithTensor", "]"}]}], 
         ")"}]}], "\[RuleDelayed]", 
       RowBox[{"a", "[", 
        RowBox[{"x1", ",", 
         RowBox[{"TensorsProduct", "[", "ContentWithTensor", "]"}], ",", 
         "x2"}], "]"}]}], ",", 
      RowBox[{"{", "1", "}"}]}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorContractThroughFunction", "[", "TensorsProduct", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"OperatorContractThroughFunction", "[", "TensorComponents", 
  "]"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.8950728857755537`*^9, {3.895074577875435*^9, 
   3.8950745803765173`*^9}, 3.8950748557843595`*^9, 3.8955553397613187`*^9, {
   3.895555838204072*^9, 
   3.895555838206071*^9}},ExpressionUUID->"a9ffbde1-9315-41e5-99ca-\
9ce6e4cdab7c"]
}, Closed]],

Cell[CellGroupData[{

Cell["OutputBecomesOneTensor", "Subsubsection",
 CellChangeTimes->{{3.8950725408048186`*^9, 3.895072550695156*^9}, 
   3.895072959633258*^9},ExpressionUUID->"5abeb7ce-6d51-43f6-a46b-\
d7054dbb4971"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"OutputBecomesOneTensor", "[", 
    RowBox[{"a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], ",", 
     RowBox[{"namerule_", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "namerule", "}"}], ",", "TensorName", ",", 
          "Infinity"}], "]"}], "=!=", 
        RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"x1___", ",", 
         RowBox[{"wholeBunchOfStuff_", "/;", 
          RowBox[{"!", 
           RowBox[{"TestExpressionForm", "[", "wholeBunchOfStuff", "]"}]}]}], 
         ",", "x2___", ",", "Tensor"}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "FirstOutput", ",", "AllTensor", ",", "FirstTensor", ",", "output", 
           ",", "name", ",", "indices"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FirstOutput", "=", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "wholeBunchOfStuff", ",", "x2"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AllTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "wholeBunchOfStuff", "}"}], ",", "_Tensor", ",", 
             "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FirstTensor", "=", 
           RowBox[{
           "AllTensor", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{"t_", "/;", 
                  RowBox[{"TestTensorTensor", "[", "t", "]"}]}], ")"}], ",", 
                "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Indices", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"idx_", "/;", 
                    RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
                  " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"name", "=", 
           RowBox[{"namerule", "/.", 
            RowBox[{"{", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", " ", 
               RowBox[{"TensorName", "[", "wholeBunchOfStuff", "]"}]}], ")"}],
              "}"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", "FirstOutput", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"FirstTensor", ",", "indices"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"output", ",", "name"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "FirstOutput"}], 
                  ")"}]}], "}"}]}]}]}], ",", "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"FirstTensor", ",", "name"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", 
                   RowBox[{"TensorComponents", "[", "FirstOutput", "]"}]}], 
                  ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"output", ",", "indices"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Replace", "[", 
             RowBox[{"output", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "*)"}], "\[IndentingNewLine]",
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a", "[", 
        RowBox[{"x1___", ",", 
         RowBox[{"wholeBunchOfStuff_", "/;", 
          RowBox[{"!", 
           RowBox[{"TestExpressionForm", "[", "wholeBunchOfStuff", "]"}]}]}], 
         ",", "x2___", ",", "Tensor", ",", 
         RowBox[{"TensorName", "\[Rule]", " ", "username_"}]}], "]"}], ":=", 
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "FirstOutput", ",", "AllTensor", ",", "FirstTensor", ",", "output", 
           ",", "name", ",", "indices"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"FirstOutput", "=", 
           RowBox[{"a", "[", 
            RowBox[{"x1", ",", "wholeBunchOfStuff", ",", "x2"}], "]"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"AllTensor", "=", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "wholeBunchOfStuff", "}"}], ",", "_Tensor", ",", 
             "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"FirstTensor", "=", 
           RowBox[{
           "AllTensor", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{"t_", "/;", 
                  RowBox[{"TestTensorTensor", "[", "t", "]"}]}], ")"}], ",", 
                "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "True", ",", 
            "\[IndentingNewLine]", 
            RowBox[{"indices", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "FirstOutput", "}"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Indices", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"idx_", "/;", 
                    RowBox[{"(", 
                    RowBox[{"idx", "=!=", 
                    RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ")"}], "\[Rule]", 
                  " ", "idx"}], " ", ")"}], ",", "Infinity"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", "FirstOutput", "]"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"FirstTensor", ",", 
                RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"output", ",", "username"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "FirstOutput"}], 
                  ")"}]}], "}"}]}]}]}], ",", "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"output", "=", 
              RowBox[{"TensorName", "[", 
               RowBox[{"FirstTensor", ",", "username"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"output", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TensorComponents", "\[Rule]", 
                   RowBox[{"TensorComponents", "[", "FirstOutput", "]"}]}], 
                  ")"}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"output", "=", 
              RowBox[{"Indices", "[", 
               RowBox[{"output", ",", "indices"}], "]"}]}]}]}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Replace", "[", 
             RowBox[{"output", ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}], ",", 
              RowBox[{"{", "1", "}"}]}], "]"}], "*)"}], "\[IndentingNewLine]",
            "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OutputBecomesOneTensor", "[", 
   RowBox[{"TensorsProduct", ",", "TensorName"}], "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.895072551585758*^9, 3.895072955333823*^9, {3.8950738577996945`*^9, 
   3.8950738722056046`*^9}, 3.8950745813452673`*^9, {3.895540312444418*^9, 
   3.895540374995787*^9}, 3.8955404174133015`*^9, {3.895540509477047*^9, 
   3.8955405158202944`*^9}, {3.895540580347581*^9, 3.895540616643103*^9}, {
   3.8955408241144743`*^9, 3.8955408290267076`*^9}, {3.8955409552097793`*^9, 
   3.8955410202354493`*^9}, {3.8955410519856853`*^9, 
   3.8955411395292735`*^9}, {3.8955412146999264`*^9, 3.895541236845701*^9}, {
   3.895541518536989*^9, 3.8955415204245663`*^9}, {3.895541766690523*^9, 
   3.8955417827534246`*^9}, {3.895541832641014*^9, 3.895541835527197*^9}, {
   3.8955558382135787`*^9, 3.895555838226572*^9}, {3.8984078010452347`*^9, 
   3.8984078145528903`*^9}, {3.8984078608573217`*^9, 3.898407863076021*^9}, {
   3.898407953557758*^9, 3.898407958250008*^9}, {3.898407989092769*^9, 
   3.898407992485592*^9}, {3.8984080535007777`*^9, 3.898408089336933*^9}, {
   3.8984082411587453`*^9, 3.8984082643815613`*^9}, {3.8984084966172295`*^9, 
   3.8984085036689496`*^9}, 3.8984753140844183`*^9, {3.8984755454493604`*^9, 
   3.8984755479138455`*^9}, 3.898543297734887*^9, {3.898543373070589*^9, 
   3.8985433763745594`*^9}},ExpressionUUID->"1f65dda3-6561-49d3-b889-\
ec8afc65b582"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorProductRule", "Subsubsection",
 CellChangeTimes->{{3.868567905630082*^9, 3.868567906389614*^9}, 
   3.8685713395391026`*^9, {3.8692685734412975`*^9, 3.8692685747773304`*^9}, 
   3.869784486679248*^9, 
   3.8950729811170626`*^9},ExpressionUUID->"a7f7f10d-763e-4c72-a7ca-\
7359b6939cd0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["OperatorProductRule",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OperatorProductRule", "[", "a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"t_Times", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Union", "[", 
                RowBox[{"(", 
                 RowBox[{"Head", "/@", 
                  RowBox[{"(", 
                   RowBox[{"List", "@@", "t"}], ")"}]}], ")"}], "]"}], "=!=", 
               RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{"!", 
               RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}]}], 
            ")"}]}], ",", "x2___"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"allTensors", ",", "therest", ",", "part1", ",", "part2"}],
            "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"allTensors", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
                RowBox[{"tt_", "/;", 
                 RowBox[{"TestTensorTensor", "[", "tt", "]"}]}]}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"therest", "=", 
            RowBox[{"Apply", "[", 
             RowBox[{"Times", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"List", ",", "t"}], "]"}], ")"}], ",", 
                RowBox[{"tt_", "/;", 
                 RowBox[{"TestTensorTensor", "[", "tt", "]"}]}]}], "]"}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"part1", "=", 
            RowBox[{"a", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"x1", ",", "allTensors", ",", "x2"}], "}"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"part2", "=", 
            RowBox[{"a", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"x1", ",", "therest", ",", "x2"}], "}"}]}], "]"}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"part1", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"TensorIsZero", "[", "part1", "]"}], ",", "0", ",", 
              "True", ",", "part1"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"part2", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"TensorIsZero", "[", "part2", "]"}], ",", "0", ",", 
              "True", ",", "part2"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"therest", " ", "part1"}], "+", 
            RowBox[{"TensorsProduct", "[", 
             RowBox[{"allTensors", " ", "part2"}], "]"}]}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "[", 
         RowBox[{"x1___", ",", 
          RowBox[{"t_Times", "/;", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(", 
               RowBox[{"Head", "/@", 
                RowBox[{"(", 
                 RowBox[{"Apply", "[", 
                  RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}], "]"}], "===", 
             RowBox[{"{", "Tensor", "}"}]}], ")"}]}], ",", "x2___"}], "]"}], ":=", 
        RowBox[{"a", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"{", 
           RowBox[{"x1", ",", 
            RowBox[{"TensorsProduct", "[", 
             RowBox[{"t", ",", "Tensor"}], "]"}], ",", "x2"}], "}"}]}], 
         "]"}]}], ";"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OperatorProductRule", "[", "PartialD", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OperatorProductRule", "[", "CovariantD", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OperatorProductRule", "[", "LieDerivative", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OperatorProductRule", "[", "LieBracket", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"OperatorProductRule", "[", "ExteriorD", "]"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"OperatorProductRule", "[", "a_", 
      RowBox[{"(*", 
       StyleBox[
        RowBox[{"Function", " ", "Name"}],
        FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"x1___", ",", "t_Times", ",", "x2___"}], "}"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"Module", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"allTensors", ",", "therest"}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"allTensors", "=", 
              RowBox[{"Times", "@@", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"List", "@@", "t"}], ")"}], ",", "_Tensor"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"therest", "=", 
              RowBox[{"Times", "@@", 
               RowBox[{"DeleteCases", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"List", "@@", "t"}], ")"}], ",", "_Tensor"}], 
                "]"}]}]}], ";", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"therest", " ", 
               RowBox[{"a", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"{", 
                  RowBox[{"x1", ",", "allTensors", ",", "x2"}], "}"}]}], 
                "]"}]}], "+", 
              RowBox[{"allTensors", " ", 
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"TensorIsZero", "[", 
                  RowBox[{"a", "[", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"{", 
                    RowBox[{"x1", ",", "therest", ",", "x2"}], "}"}]}], "]"}],
                   "]"}], ",", "0", ",", "True", ",", 
                 RowBox[{"a", "[", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"{", 
                    RowBox[{"x1", ",", "therest", ",", "x2"}], "}"}]}], 
                  "]"}]}], "]"}]}]}]}]}], "]"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "t"}], ")"}]}], ")"}], "]"}], "=!=", 
            RowBox[{"{", "Tensor", "}"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"{", 
            RowBox[{"x1___", ",", "t_Times", ",", "x2___"}], "}"}]}], "]"}], ":=", 
         RowBox[{
          RowBox[{"a", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"{", 
             RowBox[{"x1", ",", 
              RowBox[{"TensorsProduct", "[", "t", "]"}], ",", "x2"}], "}"}]}],
            "]"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"Head", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "t"}], ")"}]}], ")"}], "]"}], "===", 
            RowBox[{"{", "Tensor", "}"}]}], ")"}]}]}], ";"}]}], "]"}]}], 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8685679623021145`*^9, 3.8685680314928904`*^9}, {
   3.8685681569581947`*^9, 3.8685681641497574`*^9}, {3.8685691764693556`*^9, 
   3.868569195171815*^9}, {3.868569322339351*^9, 3.868569329441968*^9}, {
   3.86856969760701*^9, 3.8685697216387405`*^9}, {3.8685697542816424`*^9, 
   3.8685697850306654`*^9}, {3.8685698168875837`*^9, 
   3.8685698331490974`*^9}, {3.868569901430086*^9, 3.8685699165013437`*^9}, {
   3.8685700571434937`*^9, 3.868570062308307*^9}, {3.868570631278344*^9, 
   3.8685706321193624`*^9}, {3.8685713749040813`*^9, 3.868571385397997*^9}, {
   3.868585260863675*^9, 3.868585269575096*^9}, {3.8685853292384205`*^9, 
   3.8685853659269342`*^9}, {3.86858586200412*^9, 3.8685858653304224`*^9}, {
   3.8692685792576027`*^9, 3.869268581764486*^9}, {3.869268770906531*^9, 
   3.8692688149768305`*^9}, {3.869268880688589*^9, 3.86926889686454*^9}, {
   3.8692689409365473`*^9, 3.8692689582249627`*^9}, {3.869269009312674*^9, 
   3.8692690195040016`*^9}, {3.8692690598797956`*^9, 3.8692690914544606`*^9}, 
   3.8696539130614195`*^9, {3.8696595977559977`*^9, 3.869659626167713*^9}, {
   3.8696596857138553`*^9, 3.8696597056014357`*^9}, 3.869659844861117*^9, {
   3.869659879545611*^9, 3.8696598828111525`*^9}, 3.8696599805295024`*^9, {
   3.8696603808613415`*^9, 3.869660391316813*^9}, 3.869660426445712*^9, {
   3.869660562302675*^9, 3.8696606109036407`*^9}, {3.869660732303149*^9, 
   3.8696607344148293`*^9}, {3.8696610257207403`*^9, 
   3.8696610266994286`*^9}, {3.869661092751726*^9, 3.869661097879053*^9}, {
   3.8696611534659452`*^9, 3.8696611557783885`*^9}, {3.8696612161894655`*^9, 
   3.869661216439459*^9}, {3.869661549015382*^9, 3.8696615605825176`*^9}, {
   3.8696615919862003`*^9, 3.8696616165348463`*^9}, {3.8696628404281015`*^9, 
   3.869662878557923*^9}, {3.869662951246763*^9, 3.8696629528682675`*^9}, {
   3.869736260489716*^9, 3.8697363893193007`*^9}, 3.8697364639982686`*^9, {
   3.8697365410127926`*^9, 3.869736552173975*^9}, {3.8697368702522235`*^9, 
   3.8697368719861546`*^9}, {3.8697369623634496`*^9, 
   3.8697369775780706`*^9}, {3.869780586093996*^9, 3.869780626021951*^9}, {
   3.869780720757214*^9, 3.8697807276609554`*^9}, {3.8697833609914165`*^9, 
   3.869783368295017*^9}, {3.8697834874231205`*^9, 3.869783509998849*^9}, {
   3.869784472723075*^9, 3.8697844837960243`*^9}, {3.869784550419446*^9, 
   3.869784615882824*^9}, 3.8697851155517893`*^9, {3.8697851629836664`*^9, 
   3.8697851865511255`*^9}, {3.8697870038720407`*^9, 
   3.8697870890085225`*^9}, {3.8697871355418167`*^9, 
   3.8697871467579594`*^9}, {3.8697878504716015`*^9, 
   3.8697879121680965`*^9}, {3.869807029923705*^9, 3.869807157825574*^9}, 
   3.869807209826666*^9, 3.8698072862740574`*^9, {3.8726560742949734`*^9, 
   3.8726560890334406`*^9}, {3.873938944121187*^9, 3.8739389745703926`*^9}, 
   3.875245713080204*^9, {3.875245928780851*^9, 3.8752459595012364`*^9}, {
   3.8752459912209635`*^9, 3.8752460435115013`*^9}, {3.8752463227198257`*^9, 
   3.875246326235374*^9}, {3.875246360042892*^9, 3.875246387344263*^9}, {
   3.8752465082725024`*^9, 3.875246549904358*^9}, {3.8752469634629526`*^9, 
   3.875246964969907*^9}, {3.875247461640865*^9, 3.875247471780938*^9}, {
   3.8752476568665023`*^9, 3.875247695363555*^9}, {3.875248359532177*^9, 
   3.875248370803824*^9}, {3.875248435234214*^9, 3.875248487544714*^9}, {
   3.884769124813263*^9, 3.884769126975298*^9}, 3.895072991194916*^9, {
   3.8955490510140657`*^9, 3.895549061932602*^9}, {3.895549292023367*^9, 
   3.895549358984203*^9}, 3.8955558382325664`*^9, {3.8971955878271246`*^9, 
   3.897195589401308*^9}, {3.89874898055123*^9, 3.898748983051158*^9}, {
   3.898752392518583*^9, 
   3.898752399961263*^9}},ExpressionUUID->"4ce8865e-e8e3-49bd-81b4-\
905700e9f61e"]
}, Closed]],

Cell[CellGroupData[{

Cell["OperatorThreadThroughTimes", "Subsubsection",
 CellChangeTimes->{
  3.898401764120573*^9},ExpressionUUID->"0f0f2248-1ca5-4f9f-85f4-\
262176613ebb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"OperatorThreadThroughTimes", "[", "a_", 
     RowBox[{"(*", 
      StyleBox[
       RowBox[{"Function", " ", "Name"}],
       FontColor->RGBColor[1, 0, 1]], "*)"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"a", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"(", "t_Times", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"|", "t_List"}], "/;", 
          RowBox[{"(", 
           RowBox[{"t", "=!=", 
            RowBox[{"{", "}"}]}], ")"}]}], "*)"}], ")"}], ",", 
       RowBox[{"x2___", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "x2", "}"}], ",", "Tensor", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}], "]"}], ":=", 
     RowBox[{"Times", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a", "[", 
          RowBox[{"x1", ",", "#", ",", "x2"}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", "t"}], "]"}], ")"}]}], ")"}]}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Unprotect", "[", "Conjugate", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"OperatorThreadThroughTimes", "[", "Conjugate", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Protect", "[", "Conjugate", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8984013386702724`*^9, 3.8984013386859045`*^9}, {
  3.8984015269509964`*^9, 3.898401559717451*^9}, {3.8984015951781006`*^9, 
  3.898401715647459*^9}},ExpressionUUID->"216ec684-5d09-4555-9dbd-\
c9030a7b3685"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorComponentsManipulation (Expand)", "Subsubsection",
 CellChangeTimes->{
  3.887159309454103*^9, {3.887159346908943*^9, 3.8871593485488877`*^9}, {
   3.887159856004425*^9, 
   3.887159859775711*^9}},ExpressionUUID->"7dfb31c1-6cd3-4f41-a858-\
7d9052b29eaa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"TensorComponentsManipulation", "[", "name_", "]"}], ":=", 
    RowBox[{"(", 
     RowBox[{"Tensor", "/:", 
      RowBox[{"name", "[", "t_Tensor", "]"}], ":=", 
      RowBox[{"t", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], ")"}], 
         "\[RuleDelayed]", " ", 
         RowBox[{"(", 
          RowBox[{"TensorComponents", "\[Rule]", " ", 
           RowBox[{"name", "[", "comp", "]"}]}], ")"}]}], "}"}]}]}], ")"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "Expand", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "ExpToTrig", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "TrigToExp", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "TrigReduce", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "ComplexExpand", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "FunctionExpand", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TensorComponentsManipulation", "[", "PowerExpand", "]"}], 
  ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.887159360916139*^9, 3.887159387950362*^9}, {
   3.8871594225002747`*^9, 3.8871594569811983`*^9}, {3.8871594874828796`*^9, 
   3.8871594945791883`*^9}, {3.887159573539638*^9, 3.8871597547926397`*^9}, 
   3.887762233516088*^9, 
   3.8877623136488776`*^9},ExpressionUUID->"390ef9bb-7716-4452-8d5b-\
ae7722bd9d7f"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["ToExpressionForm", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, 
   3.8691357631635294`*^9, 3.8932955067668486`*^9, 
   3.8947748025855646`*^9},ExpressionUUID->"a6b6a354-d554-49ba-8092-\
63da772c0038"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "ToExpressionForm"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ToExpressionForm", "[", "tt_Tensor", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coord", ",", "dcoords", ",", "delcoords", ",", "indices", ",", "idxl",
         ",", "mx", ",", "mx2", ",", "mx2basis", ",", "mx2component", ",", 
        "output", ",", "dim", ",", "basislist", ",", "ilist", ",", "i", ",", 
        "j", ",", "sequencelist", ",", "isequencelist", ",", "a", ",", "b", 
        ",", "sa", ",", "IndptElements", ",", "indptN", ",", "position", ",", 
        "indptEleValue", ",", "iilistValue", ",", "countlist"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coord", "=", 
        RowBox[{"Coordinates", "[", "tt", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"dcoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", "coord"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"delcoords", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", "coord"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"RemoveUnderBarredIndices", "[", 
         RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"idxl", "=", 
        RowBox[{"RankNumber", "[", "indices", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"dim", "=", 
        RowBox[{"Length", "[", "coord", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"basislist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", 
              RowBox[{
              "indices", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
            "delcoords", ",", 
            RowBox[{
             RowBox[{"Sgn", "[", 
              RowBox[{
              "indices", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "]"}], "===", 
             RowBox[{"-", "1"}]}], ",", "dcoords"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ilist", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Unique", "[", "i", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"b", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sequencelist", "=", 
        RowBox[{"Quiet", "[", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Part", "[", 
            RowBox[{
             RowBox[{
             "basislist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "ilist", "\[LeftDoubleBracket]", "a", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "idxl"}], "}"}]}], "]"}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorSymmetry", "[", "tt", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
           RowBox[{"Antisymmetric", "[", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "]"}], 
            "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sa", "=", 
           RowBox[{"SymmetrizedArray", "[", 
            RowBox[{"TensorComponents", "[", "tt", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"IndptElements", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"SymmetrizedArrayRules", "[", "sa", "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"indptN", "=", 
           RowBox[{"Length", "[", "IndptElements", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"position", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indptEleValue", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"iilistValue", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"(", 
               RowBox[{"ilist", "\[Rule]", "#"}], ")"}], "]"}], "&"}], "/@", 
            "position"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Plus", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "indptEleValue", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], " ", 
              RowBox[{"(", 
               RowBox[{"TensorWedge", "@@", 
                RowBox[{"(", 
                 RowBox[{"sequencelist", "/.", 
                  RowBox[{
                  "iilistValue", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], ")"}]}], ")"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorSymmetry", "[", "tt", "]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
           RowBox[{"Symmetric", "[", 
            RowBox[{"Range", "[", 
             RowBox[{"Length", "[", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "]"}], 
            "]"}]}], ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"sa", "=", 
           RowBox[{"SymmetrizedArray", "[", 
            RowBox[{"TensorComponents", "[", "tt", "]"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"IndptElements", "=", 
           RowBox[{"Drop", "[", 
            RowBox[{
             RowBox[{"SymmetrizedArrayRules", "[", "sa", "]"}], ",", 
             RowBox[{"-", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"indptN", "=", 
           RowBox[{"Length", "[", "IndptElements", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"position", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"indptEleValue", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"IndptElements", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"iilistValue", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Thread", "[", 
              RowBox[{"(", 
               RowBox[{"ilist", "\[Rule]", "#"}], ")"}], "]"}], "&"}], "/@", 
            "position"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Plus", "@@", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"countlist", "=", 
               RowBox[{"Counts", "[", 
                RowBox[{
                "position", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}], "]"}]}], ";", 
              RowBox[{
               RowBox[{"Multinomial", "[", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"Table", "[", 
                  RowBox[{
                   RowBox[{
                   "countlist", "\[LeftDoubleBracket]", "j", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", 
                    RowBox[{"Length", "[", "countlist", "]"}]}], "}"}]}], 
                  "]"}]}], "]"}], " ", 
               RowBox[{
               "indptEleValue", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{"(", 
                RowBox[{"Times", "@@", 
                 RowBox[{"(", 
                  RowBox[{"sequencelist", "/.", 
                   RowBox[{
                   "iilistValue", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], ")"}]}], ")"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "indptN"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", ",", "True", ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"isequencelist", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "1", ",", "dim"}], "}"}], "&"}], "/@", 
            "ilist"}]}], ";", 
          RowBox[{"Plus", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"TensorComponents", "[", "tt", "]"}], 
                "\[LeftDoubleBracket]", 
                RowBox[{"Sequence", "@@", "ilist"}], 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{"TensorProduct", "[", 
                RowBox[{"Sequence", "@@", "sequencelist"}], "]"}]}], ",", 
              RowBox[{"Evaluate", "[", 
               RowBox[{"Sequence", "@@", "isequencelist"}], "]"}]}], "]"}], 
            "]"}]}]}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, {
   3.869045786004552*^9, 3.869045818873536*^9}, 3.8691008170883627`*^9, {
   3.8691357685763817`*^9, 3.869135793280121*^9}, {3.8691358557040486`*^9, 
   3.8691359078236876`*^9}, {3.8691359596871786`*^9, 3.869135965936968*^9}, 
   3.8691360363909674`*^9, {3.8698006308619995`*^9, 3.869800727978799*^9}, 
   3.8703878650567365`*^9, {3.8703879080710335`*^9, 3.870387931141947*^9}, 
   3.871551777474723*^9, {3.871596998629507*^9, 3.871597000475988*^9}, {
   3.8752417741682405`*^9, 3.875241802158727*^9}, {3.8947748041388054`*^9, 
   3.8947748052926655`*^9}},ExpressionUUID->"b8663cdd-4807-484a-941a-\
972af46a9cf8"]
}, Closed]],

Cell[CellGroupData[{

Cell["ToTensorComponents", "Subsection",
 CellChangeTimes->{
  3.894776773532593*^9},ExpressionUUID->"f950017d-de23-4b3a-bc36-\
deac1ceb23c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"ToTensorComponents", " ", 
     RowBox[{"w", "/", " ", "TensorProduct"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ToTensorComponents", "[", 
      RowBox[{
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], 
              ")"}]}]}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{"TensorProduct", "[", "__", "]"}], ",", "Infinity"}], 
               "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "&&", 
          RowBox[{"!", 
           RowBox[{
           "TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}]}], 
         ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tpexpand", ",", "dcoords", ",", "delcoords", ",", "idxl", ",", "dim",
          ",", "basislist", ",", "ilist", ",", "sequencelist", ",", 
         "isequencelist", ",", "output", ",", "i", ",", "b", ",", "a", ",", 
         "coord", ",", "CasesTP", ",", "CasesTPFirstList", ",", "basissgn"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coord", "=", 
         RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tpexpand", "=", 
         RowBox[{"stuff", "//", "TensorExpand"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dcoords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", 
          "coord"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delcoords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", "coord"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CasesTP", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"tpexpand", ",", 
           RowBox[{
            RowBox[{"TensorProduct", "[", 
             RowBox[{"a_", ",", "___"}], "]"}], "/;", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"a", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[DifferentialD]", "__"}], "|", 
                RowBox[{"\[Del]", "__"}]}], ")"}]}], "]"}]}], ",", 
           "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CasesTPFirstList", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", 
           RowBox[{"First", "[", "CasesTP", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"basissgn", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"BasisSgn", "[", "#", "]"}], "&"}], "/@", 
          "CasesTPFirstList"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "basissgn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dim", "=", 
         RowBox[{"Length", "[", "coord", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basislist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "basissgn", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "===", "1"}], ",", "delcoords", ",", 
             RowBox[{
              RowBox[{
              "basissgn", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "===", 
              RowBox[{"-", "1"}]}], ",", "dcoords"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Unique", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sequencelist", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{
              "basislist", "\[LeftDoubleBracket]", "a", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "ilist", "\[LeftDoubleBracket]", "a", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "idxl"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"isequencelist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "1", ",", "dim"}], "}"}], "&"}], "/@", 
          "ilist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"tpexpand", ",", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{"Sequence", "@@", "sequencelist"}], "]"}]}], "]"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "isequencelist"}], "]"}]}], "]"}]}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"ToTensorComponents", " ", 
      RowBox[{"w", "/", " ", "Times"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToTensorComponents", "[", 
      RowBox[{"indices_List", ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], 
              ")"}]}]}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{"TensorProduct", "[", "__", "]"}], ",", "Infinity"}], 
               "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "&&", 
          RowBox[{"TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}], 
         ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "texpand", ",", "dcoords", ",", "delcoords", ",", "idxl", ",", "dim", 
         ",", "basislist", ",", "ilist", ",", "sequencelist", ",", 
         "isequencelist", ",", "output", ",", "i", ",", "b", ",", "a", ",", 
         "coord", ",", "CasesTP", ",", "CasesTPFirstList", ",", "basissgn"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coord", "=", 
         RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"texpand", "=", 
         RowBox[{"stuff", "//", "Expand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dcoords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", 
          "coord"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delcoords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", "coord"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"CasesTP", "=", 
         RowBox[{"Cases", "[", 
          RowBox[{"tpexpand", ",", 
           RowBox[{
            RowBox[{"TensorProduct", "[", 
             RowBox[{"a_", ",", "___"}], "]"}], "/;", 
            RowBox[{"MatchQ", "[", 
             RowBox[{"a", ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[DifferentialD]", "__"}], "|", 
                RowBox[{"\[Del]", "__"}]}], ")"}]}], "]"}]}], ",", 
           "Infinity"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CasesTPFirstList", "=", 
         RowBox[{"Apply", "[", 
          RowBox[{"List", ",", 
           RowBox[{"First", "[", "CasesTP", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"basissgn", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"BasisSgn", "[", "#", "]"}], "&"}], "/@", 
          "CasesTPFirstList"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "basissgn", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"dim", "=", 
         RowBox[{"Length", "[", "coord", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"basislist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "basissgn", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "===", "1"}], ",", "delcoords", ",", 
             RowBox[{
              RowBox[{
              "basissgn", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}], "===", 
              RowBox[{"-", "1"}]}], ",", "dcoords"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ilist", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Unique", "[", "i", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sequencelist", "=", 
         RowBox[{"Quiet", "[", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Part", "[", 
             RowBox[{
              RowBox[{
              "basislist", "\[LeftDoubleBracket]", "a", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "ilist", "\[LeftDoubleBracket]", "a", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "idxl"}], "}"}]}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"isequencelist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"#", ",", "1", ",", "dim"}], "}"}], "&"}], "/@", 
          "ilist"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Permutations", "[", "sequencelist", "]"}], "//", 
               "Length"}], ")"}]], " ", 
            RowBox[{"Coefficient", "[", 
             RowBox[{"texpand", ",", 
              RowBox[{"Times", "[", 
               RowBox[{"Sequence", "@@", "sequencelist"}], "]"}]}], "]"}]}], 
           ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", "isequencelist"}], "]"}]}], "]"}]}]}]}],
       "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ToTensorComponents", "[", 
      RowBox[{"indices_List", ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], 
              ")"}]}]}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "twteProduct", ",", "dcoords", ",", "delcoords", ",", "idxl", ",", 
         "dim", ",", "basislist", ",", "ilist", ",", "sequencelist", ",", 
         "isequencelist", ",", "output", ",", "i", ",", "b", ",", "a", ",", 
         "coord"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"twteProduct", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"stuff", "//", "TensorExpand"}], ")"}], "//", 
          "WedgeProductExpand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ToTensorComponents", "[", 
         RowBox[{"indices", ",", "twteProduct", ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", 
           RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "[", "TensorProduct", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[DifferentialD]", "coord_"}], ")"}], ",", 
         RowBox[{"x3___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", 
             RowBox[{
              RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                 "a"}], ",", "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}],
       "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"x1", ",", 
        RowBox[{"\[DifferentialD]", "coord"}], ",", "x2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorProduct", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Del]", "coord_"}], ")"}], ",", 
         RowBox[{"x3___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", 
             RowBox[{
              RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                 "a"}], ",", "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}],
       "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
      RowBox[{"TensorProduct", "[", 
       RowBox[{"x1", ",", 
        RowBox[{"\[Del]", "coord"}], ",", "x2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", "TensorProduct", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.894784174085971*^9, 3.894784180327305*^9}, {
   3.894886198642889*^9, 3.8948861990796223`*^9}, {3.8948863500420837`*^9, 
   3.8948863803795466`*^9}, 3.894886426279498*^9, {3.8948878892653427`*^9, 
   3.894887899059771*^9}, 3.8948883811674385`*^9, 3.8948884713319635`*^9, {
   3.8948885365609837`*^9, 3.894888566434301*^9}, {3.8948887478682528`*^9, 
   3.8948887553827143`*^9}, {3.8948888600468254`*^9, 
   3.8948888844893503`*^9}, {3.8948896470131865`*^9, 3.8948896551791925`*^9}, 
   3.894890235819585*^9, {3.8948904816645813`*^9, 3.8948904835775843`*^9}, {
   3.895116389466457*^9, 3.8951163990525527`*^9}, 3.8951165584633303`*^9, {
   3.8955558382405624`*^9, 3.895555838252555*^9}, {3.8973008939411807`*^9, 
   3.897300896508587*^9}, {3.953086801722981*^9, 3.953086802626281*^9}, 
   3.9533460576475887`*^9},ExpressionUUID->"bea6ffd1-ee56-429a-9016-\
22680cfeaabc"]
}, Closed]],

Cell[CellGroupData[{

Cell["WedgeProductExpand", "Subsection",
 CellChangeTimes->{3.894776845533681*^9, 
  3.895542967354926*^9},ExpressionUUID->"311d1f40-968d-4328-b149-\
24ed785a7f46"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "WedgeProductExpand"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"WedgeProductExpand", "[", 
      RowBox[{"tw_", "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "tw", "]"}], "=!=", "TensorWedge"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "tw", "}"}], ",", 
             RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
            "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], "]"}], ":=", 
     RowBox[{"tw", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"TensorWedge", "[", "xxx___", "]"}], "\[RuleDelayed]", " ", 
        RowBox[{"WedgeProductExpand", "[", 
         RowBox[{"TensorWedge", "[", "xxx", "]"}], "]"}]}], "}"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Unprotect", "[", "TensorWedge", "]"}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorWedge", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[DifferentialD]", "coord_"}], ")"}], ",", 
         RowBox[{"x3___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", 
             RowBox[{
              RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                 "a"}], ",", "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}],
       "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
      RowBox[{"TensorWedge", "[", 
       RowBox[{"x1", ",", 
        RowBox[{"\[DifferentialD]", "coord"}], ",", "x2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorWedge", "[", 
      RowBox[{"x1___", ",", 
       RowBox[{"Times", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Del]", "coord_"}], ")"}], ",", 
         RowBox[{"x3___", "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TestExpressionForm", "[", 
             RowBox[{
              RowBox[{"Unique", "[", "a", "]"}], "[", "x3", "]"}], "]"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                 "a"}], ",", "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "x3", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], "]"}], ",", "x2___"}],
       "]"}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Times", "@@", 
        RowBox[{"{", "x3", "}"}]}], ")"}], " ", 
      RowBox[{"TensorWedge", "[", 
       RowBox[{"x1", ",", 
        RowBox[{"\[Del]", "coord"}], ",", "x2"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Protect", "[", "TensorWedge", "]"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8947841563956447`*^9, 3.8947841689053955`*^9}, {
  3.8947997720788603`*^9, 3.89479977340701*^9}, {3.8955429582866173`*^9, 
  3.8955429582896156`*^9}, {3.8955431086795607`*^9, 3.895543143796641*^9}, {
  3.895555838257552*^9, 3.8955558382595525`*^9}, {3.897528778781376*^9, 
  3.897528781603902*^9}},ExpressionUUID->"21e201e5-ef62-4f4d-b138-\
529dc05ee9fc"]
}, Closed]],

Cell[CellGroupData[{

Cell["Metric", "Subsection",
 CellChangeTimes->{{3.520303444109375*^9, 3.520303449859375*^9}, {
  3.520303728828125*^9, 3.52030373996875*^9}, {3.52169976384375*^9, 
  3.52169981365625*^9}, {3.52173410659375*^9, 
  3.52173414321875*^9}},ExpressionUUID->"b3b5ca54-2a98-41b1-b0bc-\
4a1ae48419be"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Entering", " ", "a", " ", "geometry"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"I", " ", "of", " ", 
     RowBox[{"II", ":", " ", 
      RowBox[{
      "Metric", " ", "takes", " ", "in", " ", "a", " ", "specific", " ", 
       "metric", " ", "and", " ", "CoordinateSystem"}]}]}], ",", " ", 
    RowBox[{"computes", " ", "Christoffel", " ", "symbols"}], ",", "Riemann", 
    ",", " ", 
    RowBox[{"Ricci", " ", "tensor", " ", "and", " ", "scalar"}], ",", 
    RowBox[{
    "and", " ", "returns", " ", "a", " ", "Tensor", " ", "containing", " ", 
     "these", " ", 
     RowBox[{"computations", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", 
        RowBox[{"matrix_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Dimensions", "[", "matrix", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"nn_", ",", "nn_"}], "}"}]}], "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "matrix", "]"}], "===", "List"}], ")"}]}], 
          ")"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SubMinus", "[", "_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
            RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
       ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"CoordinateSystem", "\[Rule]", 
         RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorName", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TensorName", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"StartIndex", "\[Rule]", 
         RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristoffelOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RiemannOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "RiemannOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "RicciOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"RicciScalarOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"TooltipDisplay", " ", "for", " ", "metric"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipDisplay", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"TooltipStyle", " ", "for", " ", "metric"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TooltipStyle", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Indices", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TensorComponents", "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"matrix", "//", 
           RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], ")"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"FlatMetric", "\[Rule]", 
         RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameField", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
         RowBox[{"OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}],
         ",", 
        RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TensorAssumption", "\[Rule]", " ", 
         RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"TensorOperator", "\[Rule]", " ", 
         RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}], "]"}], "===", 
          "Integer"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OptionValue", "[", "StartIndex", "]"}], "\[GreaterEqual]", 
          "0"}], ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"II", " ", "of", " ", 
      RowBox[{"II", ":", " ", 
       RowBox[{"Same", " ", "as", " ", "above"}]}]}], ",", " ", 
     RowBox[{
     "except", " ", "we", " ", "allow", " ", "the", " ", "metric", " ", "to", 
      " ", "be", " ", "entered", " ", "in", " ", "terms", " ", "of", " ", 
      "differentials", " ", 
      RowBox[{"\[DifferentialD]", "t"}]}], ",", " ", 
     RowBox[{"\[DifferentialD]", "x"}], ",", " ", 
     RowBox[{"etc", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", 
        RowBox[{"matrix_", "/;", 
         RowBox[{"TestExpressionForm", "[", "matrix", "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SubMinus", "[", "_", "]"}], ",", 
           RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "MetricM", ",", "\[Mu]", ",", "\[Nu]", ",", "dcoords", ",", "lgth"}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "convert", " ", "the", " ", "expression", " ", "matrix", " ", "to", 
          " ", "a", " ", 
          RowBox[{"dim", ".", " ", "x"}], " ", 
          RowBox[{"dim", ".", " ", "List"}], " ", "matrix"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"dcoords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[DifferentialD]", "#"}], ")"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricM", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"off", " ", "diagonal", " ", "terms"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"\[Mu]", "=!=", "\[Nu]"}], ",", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "dcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "dcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                   "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", " ", 
               RowBox[{"diagonal", " ", "terms"}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\[Mu]", "===", "\[Nu]"}], ",", 
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                RowBox[{
                 RowBox[{
                 "dcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "dcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "then", " ", "feed", " ", "matrix", " ", "into", " ", "the", " ", 
           "same", " ", "code", " ", "as", " ", "above"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ChristoffelOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RiemannOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RiemannOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciScalarOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"TooltipDisplay", " ", "for", " ", "metric"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"TooltipStyle", " ", "for", " ", "metric"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipStyle", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"(*", 
             RowBox[{"NewCode", ":", " ", "MetricOperator"}], "*)"}], 
            RowBox[{"(", 
             RowBox[{"MetricM", "//", 
              RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"FlatMetric", "\[Rule]", 
            RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ",", 
           RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TensorAssumption", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TensorOperator", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}], "]"}], "===", 
          "Integer"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OptionValue", "[", "StartIndex", "]"}], "\[GreaterEqual]", 
          "0"}], ")"}], "&&", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TestQuadratic"}], "*)"}], 
        RowBox[{"TestQuadratic", "[", 
         RowBox[{"matrix", ",", 
          RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}], ",", 
          RowBox[{"-", "1"}]}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NewCode", ":", " ", 
      RowBox[{
      "Inverse", " ", "Metric", " ", "with", " ", "quadratic", " ", "form", 
       " ", "Try", " ", "to", " ", "make", " ", "user", " ", "be", " ", 
       "able", " ", "to", " ", "input"}]}], ",", " ", 
     RowBox[{"e", ".", "g", "."}], ",", " ", 
     RowBox[{"g2cy", "=", 
      RowBox[{"Metric", "[", 
       RowBox[{
        SuperscriptBox["i", "-"], ",", 
        SuperscriptBox["j", "-"], ",", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"\[Del]", "r"}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["r", 
           RowBox[{"-", "2"}]], "*", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"\[Del]", "\[Phi]"}], ")"}], "2"]}]}], ",", 
        RowBox[{"CoordinateSystem", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"r", ",", "\[Phi]"}], "}"}]}], ",", 
        RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
        RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", 
        RowBox[{"matrix_", "/;", 
         RowBox[{"TestExpressionForm", "[", "matrix", "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
           RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "MetricM", ",", "\[Mu]", ",", "\[Nu]", ",", "pdcoords", ",", 
          "lgth"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "convert", " ", "the", " ", "expression", " ", "matrix", " ", "to", 
          " ", "a", " ", 
          RowBox[{"dim", ".", " ", "x"}], " ", 
          RowBox[{"dim", ".", " ", "List"}], " ", "matrix"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"pdcoords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Del]", "#"}], ")"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricM", "=", 
          RowBox[{"Table", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Which", "[", "\[IndentingNewLine]", "\t", 
             RowBox[{"(*", " ", 
              RowBox[{"off", " ", "diagonal", " ", "terms"}], " ", "*)"}], 
             "\[IndentingNewLine]", "\t", 
             RowBox[{
              RowBox[{"\[Mu]", "=!=", "\[Nu]"}], ",", 
              RowBox[{
               FractionBox["1", "2"], 
               RowBox[{"Coefficient", "[", 
                RowBox[{
                 RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                 RowBox[{
                  RowBox[{
                  "pdcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                   "\[RightDoubleBracket]"}], 
                  RowBox[{
                  "pdcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                   "\[RightDoubleBracket]"}]}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"(*", " ", 
               RowBox[{"diagonal", " ", "terms"}], " ", "*)"}], 
              "\[IndentingNewLine]", "\t", 
              RowBox[{"\[Mu]", "===", "\[Nu]"}], ",", 
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{"Expand", "[", "matrix", "]"}], ",", 
                RowBox[{
                 RowBox[{
                 "pdcoords", "\[LeftDoubleBracket]", "\[Mu]", 
                  "\[RightDoubleBracket]"}], 
                 RowBox[{
                 "pdcoords", "\[LeftDoubleBracket]", "\[Nu]", 
                  "\[RightDoubleBracket]"}]}]}], "]"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "then", " ", "feed", " ", "matrix", " ", "into", " ", "the", " ", 
           "same", " ", "code", " ", "as", " ", "above"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TensorType", "\[Rule]", "\"\<Metric\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"ChristoffelOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "ChristoffelOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RiemannOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RiemannOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"RicciScalarOperator", "\[Rule]", 
            RowBox[{"OptionValue", "[", "RicciScalarOperator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"TooltipDisplay", " ", "for", " ", "metric"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"TooltipStyle", " ", "for", " ", "metric"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipStyle", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"MetricM", "//", 
              RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"FlatMetric", "\[Rule]", 
            RowBox[{"OptionValue", "[", "FlatMetric", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], ",",
            "\[IndentingNewLine]", 
           RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ",", 
           RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TensorAssumption", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TensorOperator", "\[Rule]", " ", 
            RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}], "]"}], "===", 
          "Integer"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"OptionValue", "[", "StartIndex", "]"}], "\[GreaterEqual]", 
          "0"}], ")"}], "&&", 
        RowBox[{"TestQuadratic", "[", 
         RowBox[{"matrix", ",", 
          RowBox[{"OptionValue", "[", "CoordinateSystem", "]"}], ",", 
          RowBox[{"+", "1"}]}], "]"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Metric", " ", "also", " ", "takes", " ", "in", " ", "a", " ", "Tensor", 
     " ", "object", " ", "of", " ", "type", " ", "Metric", " ", "and", " ", 
     "spits", " ", "out", " ", "the", " ", "components"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "aka", " ", "Raising", " ", "and", " ", "lowering", " ", "of", " ", 
     "Metric", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"one", " ", "up", " ", "and", " ", "one", " ", "down"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "m_Tensor", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
              RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"SubMinus", "[", "_", "]"}], ",", 
              RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}]}], 
         ")"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "idx", ",", "cpts", ",", "row", ",", "col", ",", "l", ",", "ix", ",", 
         "mx", ",", "id", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l", "=", 
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"id", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"KroneckerDelta", "[", 
            RowBox[{"row", ",", "col"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"row", ",", "1", ",", "l"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "1", ",", "l"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"m", "/.", 
          RowBox[{"{", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "id"}], ")"}]}]}], 
           "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
               ")"}]}], "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"both", " ", "lower"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "m_Tensor", ",", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "MetricOperator"}], "*)"}], 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SubMinus", "[", "_", "]"}], ",", 
            RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ix", ",", "mx", ",", "output"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "both", " ", "lower", " ", "then", " ", "just", " ", "return", " ",
             "the", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "both", " ", "upper", " ", "we", " ", "have", " ", "to", " ", 
             "invert", " ", "the", " ", "TensorComponents"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", 
                 RowBox[{"(*", 
                  RowBox[{"NewCode", ":", " ", "MetricOperator"}], "*)"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Inverse", "[", "mx", "]"}], "//", 
                   RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], 
                  ")"}]}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"both", " ", "upper"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Metric", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "m_Tensor", ",", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "MetricOperator"}], "*)"}], 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
            RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ix", ",", "mx", ",", "output"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "both", " ", "upper", " ", "then", " ", "just", " ", "return", " ",
             "the", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "both", " ", "lower", " ", "we", " ", "have", " ", "to", " ", 
             "invert", " ", "the", " ", "TensorComponents"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"ix", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"m", "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "ix"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"{", 
                  RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}]}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", 
                 RowBox[{"(*", 
                  RowBox[{"NewCode", ":", " ", "MetricOperator"}], "*)"}], 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Inverse", "[", "mx", "]"}], "//", 
                   RowBox[{"OptionValue", "[", "MetricOperator", "]"}]}], 
                  ")"}]}], ")"}]}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"output", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
              ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "Endow", " ", "Metric", " ", "as", " ", "a", " ", "property", " ", "of", 
      " ", "a", " ", "Tensor"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"Metric", "[", 
      RowBox[{"t_Tensor", ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Which", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"t", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Metric", "\[Rule]", "metric_"}], ")"}], "\[Rule]", 
            "metric"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], ",", 
       RowBox[{"Append", "[", 
        RowBox[{"t", ",", 
         RowBox[{"Metric", "\[Rule]", "m"}]}], "]"}], ",", "True", ",", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Metric", "\[Rule]", "metric_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Metric", "\[Rule]", "m"}], ")"}]}]}]}], "]"}]}], 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}, {3.5203034191875*^9, 3.52030344328125*^9}, 
   3.520351041640625*^9, {3.520354657265625*^9, 3.52035465828125*^9}, {
   3.520376497171875*^9, 3.5203766185625*^9}, 3.520440086609375*^9, {
   3.520449996078125*^9, 3.52045002709375*^9}, {3.520699768765625*^9, 
   3.520699779125*^9}, {3.521673438296875*^9, 3.52167372978125*^9}, {
   3.5216737615625*^9, 3.52167376675*^9}, {3.52167382796875*^9, 
   3.521673927234375*^9}, {3.521673968046875*^9, 3.52167405828125*^9}, {
   3.521674091125*^9, 3.521674102953125*^9}, {3.521674145703125*^9, 
   3.521674146078125*^9}, {3.52167507421875*^9, 3.521675077796875*^9}, {
   3.521675520296875*^9, 3.521675520765625*^9}, {3.521675570890625*^9, 
   3.52167562759375*^9}, {3.521734146375*^9, 3.521734155234375*^9}, {
   3.521785471109375*^9, 3.521785474859375*^9}, {3.52195362765625*^9, 
   3.521953698625*^9}, {3.538313545475878*^9, 3.5383135716059237`*^9}, {
   3.5383136026343784`*^9, 3.538313654098869*^9}, {3.5383137245017924`*^9, 
   3.538313891219285*^9}, {3.538313927598549*^9, 3.538314020933513*^9}, {
   3.538314096578046*^9, 3.5383142462915087`*^9}, {3.538314425036623*^9, 
   3.5383147351963673`*^9}, {3.538314771996832*^9, 3.538314772355633*^9}, {
   3.538314865955797*^9, 3.538314871571807*^9}, {3.5383149199474916`*^9, 
   3.5383151912163687`*^9}, {3.5383153640646725`*^9, 3.538315425013979*^9}, {
   3.538317548755187*^9, 3.5383176524271164`*^9}, {3.53831769269742*^9, 
   3.538317746465495*^9}, {3.538317798316461*^9, 3.538317805799889*^9}, {
   3.538318262821029*^9, 3.53831826720428*^9}, {3.5383182999311514`*^9, 
   3.538318301021214*^9}, {3.5383183594935584`*^9, 3.538318427411443*^9}, 
   3.53831847701128*^9, {3.538318512643318*^9, 3.5383185165065393`*^9}, {
   3.53945193646068*^9, 3.539452027824099*^9}, {3.5394613154963274`*^9, 
   3.539461359753606*^9}, {3.5394615573903522`*^9, 3.53946183502404*^9}, {
   3.5394618904821377`*^9, 3.539461891152939*^9}, {3.5394619302154074`*^9, 
   3.5394619338190136`*^9}, {3.539549024833885*^9, 3.539549091414802*^9}, {
   3.539549759688776*^9, 3.539549782090415*^9}, {3.5395498214648843`*^9, 
   3.539549822900087*^9}, {3.5395499318350782`*^9, 3.539549973377951*^9}, {
   3.5395512665890226`*^9, 3.5395512750286374`*^9}, {3.5395515248006763`*^9, 
   3.5395515341918926`*^9}, {3.53955223868913*^9, 3.5395522519023533`*^9}, {
   3.5396586403653665`*^9, 3.539658650318184*^9}, {3.5404892022296424`*^9, 
   3.5404892583898544`*^9}, {3.5942339653207917`*^9, 
   3.5942340103589835`*^9}, {3.5942355577222557`*^9, 3.594235574513513*^9}, {
   3.594235703314992*^9, 3.5942357213387685`*^9}, {3.594236103856645*^9, 
   3.5942361269665003`*^9}, 3.5942361602240114`*^9, {3.5965848362773194`*^9, 
   3.5965848512221456`*^9}, {3.827371828371171*^9, 3.827371857003539*^9}, {
   3.827371897783679*^9, 3.827371959741398*^9}, {3.8273788315252905`*^9, 
   3.8273788548534107`*^9}, {3.8273789087040186`*^9, 
   3.8273789243915205`*^9}, {3.827378954813406*^9, 3.8273789767821565`*^9}, {
   3.827379676740183*^9, 3.827379678318308*^9}, 3.8273797547432065`*^9, {
   3.8273829922434273`*^9, 3.827382993350428*^9}, 3.8274025362384357`*^9, {
   3.8381932800303555`*^9, 3.838193299809534*^9}, {3.847250291794485*^9, 
   3.847250314022805*^9}, {3.847833609920641*^9, 3.847833634175925*^9}, {
   3.847833783430523*^9, 3.8478337900827403`*^9}, {3.847836296193078*^9, 
   3.847836309209085*^9}, {3.8478376479177656`*^9, 3.847837654124908*^9}, {
   3.8478379065442896`*^9, 3.8478379522882586`*^9}, {3.854158895216339*^9, 
   3.854158898346294*^9}, {3.8541589594657373`*^9, 3.8541589800659804`*^9}, {
   3.8541593052339115`*^9, 3.854159324684156*^9}, {3.8541594597131147`*^9, 
   3.8541594649628363`*^9}, {3.854159495083087*^9, 3.8541594999525537`*^9}, {
   3.854411932440406*^9, 3.8544119483163996`*^9}, {3.854412102888397*^9, 
   3.854412204181672*^9}, 3.8575342780515895`*^9, {3.8586824322849913`*^9, 
   3.8586824538374486`*^9}, {3.8586832294851484`*^9, 
   3.8586832543653717`*^9}, {3.8586837615229235`*^9, 3.858683789335107*^9}, {
   3.8586843609452667`*^9, 3.858684382044056*^9}, {3.859455182811283*^9, 
   3.859455183640324*^9}, {3.859455331550561*^9, 3.859455367758347*^9}, {
   3.8594554784025893`*^9, 3.859455498833501*^9}, {3.8594559617700167`*^9, 
   3.8594560088336163`*^9}, {3.8594624086270685`*^9, 
   3.8594624428603296`*^9}, {3.8595076776108923`*^9, 3.859507702521445*^9}, {
   3.85951318259258*^9, 3.8595131941694603`*^9}, {3.8596008517198443`*^9, 
   3.859600858540743*^9}, {3.8601115288446465`*^9, 3.8601115678403373`*^9}, {
   3.86133228216689*^9, 3.861332305869296*^9}, {3.8673180819280505`*^9, 
   3.8673181509471893`*^9}, {3.8750914221695566`*^9, 
   3.8750914954262314`*^9}, {3.8750915297299204`*^9, 
   3.8750916413195724`*^9}, {3.875092686440316*^9, 3.8750926961753225`*^9}, {
   3.8750927345410776`*^9, 3.875092738728498*^9}, 3.8752375275244617`*^9, 
   3.875249537336472*^9, 3.875250921526145*^9, {3.8757538453334646`*^9, 
   3.8757539241871843`*^9}, {3.875753970353657*^9, 3.875753975823884*^9}, {
   3.87575474604679*^9, 3.875754888552393*^9}, {3.8757594193940907`*^9, 
   3.875759428379321*^9}, {3.8870135353603306`*^9, 3.887013644035818*^9}, {
   3.887262087187251*^9, 3.887262087420108*^9}, {3.8872621765567017`*^9, 
   3.887262177476135*^9}, {3.887262970336014*^9, 3.887263007534269*^9}, {
   3.887263039140789*^9, 3.8872630497592435`*^9}, 3.8872631938992863`*^9, 
   3.891515032450389*^9, {3.8915157682646255`*^9, 3.891515774346943*^9}, {
   3.8915165959643493`*^9, 3.8915165963231306`*^9}, {3.891516727064974*^9, 
   3.891516749887664*^9}, {3.892080112838269*^9, 3.8920801228324356`*^9}, {
   3.895554774149148*^9, 3.8955547742400928`*^9}, {3.8955550194261084`*^9, 
   3.8955550194460955`*^9}, {3.8955551721487484`*^9, 
   3.8955551721687365`*^9}, {3.8955558382765408`*^9, 3.895555838286533*^9}, {
   3.898832564271274*^9, 3.898832603953411*^9}, {3.956199042567376*^9, 
   3.9561990426002693`*^9}},ExpressionUUID->"4aba9fe4-8dc2-4999-9899-\
a395918895d5"]
}, Closed]],

Cell[CellGroupData[{

Cell["NonMetricTensor", "Subsection",
 CellChangeTimes->{{3.629916437629241*^9, 3.6299164515196667`*^9}, 
   3.629916481882225*^9, 3.8532781798529825`*^9, 
   3.8532820254048448`*^9},ExpressionUUID->"c24b1520-13e6-4858-9683-\
fcd039868295"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Generates", " ", "a", " ", "Tensor", " ", "with", " ", "components", " ", 
    "stuff", " ", "and", " ", "indices", " ", "\[Mu]T"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
     RowBox[{"For", " ", "non"}], "-", "scalar"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"NonMetricTensor", "[", 
       RowBox[{"\[Mu]T_List", ",", 
        RowBox[{"(", 
         RowBox[{
         "stuff_List", "|", "stuff_SparseArray", "|", 
          "stuff_SymmetrizedArray"}], ")"}], ",", "exp_", ",", 
        RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"TestIndices", "/@", "\[Mu]T"}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Dimensions", "[", "stuff", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"nnn_Integer", ".."}], "}"}]}], "]"}]}]}], ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Indices", "\[Rule]", "\[Mu]T"}], ",", "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "stuff"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", "exp"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", 
        RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
       RowBox[{"TensorType", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TensorType", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TensorOperator", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Generates", " ", "a", " ", "Tensor", " ", "with", " ", "components", " ",
      "stuff", " ", "and", " ", "indices", " ", "\[Mu]T"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"For", " ", "scalar"}],
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
               "a"}], ",", "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",", 
              "Infinity"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], 
         RowBox[{"(*", 
          RowBox[{"&&", 
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], ")"}]}]}],
           "*)"}], ")"}]}], ",", "exp_", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Indices", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorComponents", "\[Rule]", "stuff"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TensorName", "\[Rule]", "exp"}], ",", "\[IndentingNewLine]", 
       RowBox[{"StartIndex", "\[Rule]", 
        RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipDisplay", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TooltipStyle", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
       RowBox[{"TensorType", "\[Rule]", 
        RowBox[{"OptionValue", "[", "TensorType", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TensorAssumption", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorAssumption", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"TensorOperator", "\[Rule]", " ", 
        RowBox[{"OptionValue", "[", "TensorOperator", "]"}]}]}], "\n", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"NonMetricTensor", " ", "for", " ", "ExpressionForm", " ", 
      RowBox[{"(", 
       RowBox[{"not", " ", "scalar"}], ")"}], " ", "with", " ", 
      RowBox[{"TensorProduct", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"indices_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "indices", "]"}], "=!=", "0"}], ")"}]}], 
       ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], 
              ")"}]}]}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{"TensorProduct", "[", "__", "]"}], ",", "Infinity"}], 
               "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "&&", 
          RowBox[{"!", 
           RowBox[{
           "TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}]}], 
         ")"}]}], ",", "exp_", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{"indices", ",", 
       RowBox[{"ToTensorComponents", "[", 
        RowBox[{"indices", ",", "stuff", ",", 
         RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}], ",", 
       "exp", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], " ", ",", "opts"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"NonMetricTensor", " ", "for", " ", "ExpressionForm", " ", 
      RowBox[{"(", 
       RowBox[{"not", " ", "scalar"}], ")"}], " ", "with", " ", 
      RowBox[{"TensorWedge", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"indices_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "indices", "]"}], "=!=", "0"}], ")"}]}], 
       ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], 
              ")"}]}]}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ")"}], "&&", 
          RowBox[{"!", 
           RowBox[{
           "TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}]}], 
         ")"}]}], ",", "exp_", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"twteProduct", ",", "m"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"twteProduct", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"stuff", "//", "TensorExpand"}], ")"}], "//", 
          "WedgeProductExpand"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{"ToTensorComponents", "[", 
          RowBox[{"indices", ",", "twteProduct", ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{"indices", ",", "m", ",", "exp", ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", "opts"}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
     "Symmetric", " ", "NonMetricTensor", " ", "for", " ", "ExpressionForm", 
      " ", 
      RowBox[{"(", 
       RowBox[{"not", " ", "scalar"}], ")"}], " ", "with", " ", 
      RowBox[{"Times", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{
       RowBox[{"indices_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "indices", "]"}], "=!=", "0"}], ")"}]}], 
       ",", 
       RowBox[{"stuff_", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "stuff", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"\[DifferentialD]", "a_"}], ")"}], "\[Rule]", " ", 
                "a"}], ",", "Infinity"}], "]"}], "=!=", 
             RowBox[{"{", "}"}]}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"{", "stuff", "}"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"\[Del]", "a_"}], ")"}], "\[Rule]", " ", "a"}], ",",
                 "Infinity"}], "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "stuff", "]"}], "===", "List"}], 
              ")"}]}]}], "*)"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "stuff", "}"}], ",", 
              RowBox[{"TensorWedge", "[", "__", "]"}], ",", "Infinity"}], 
             "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "stuff", "}"}], ",", 
                 RowBox[{"TensorProduct", "[", "__", "]"}], ",", "Infinity"}],
                 "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ")"}]}]}], "*)"}], "&&", 
          RowBox[{"TestSymmetricTensorExpressionForm", "[", "stuff", "]"}]}], 
         ")"}]}], ",", "exp_", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"NonMetricTensor", "[", 
      RowBox[{"indices", ",", 
       RowBox[{"ToTensorComponents", "[", 
        RowBox[{"indices", ",", "stuff", ",", 
         RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}], ",", 
       "exp", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], " ", ",", "opts"}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6299331236734877`*^9, 3.6299331641123896`*^9}, {
   3.6299331964067764`*^9, 3.6299332680446024`*^9}, {3.6299333320359144`*^9, 
   3.6299333771043935`*^9}, {3.6299334299416866`*^9, 3.629933613143939*^9}, {
   3.629933685650297*^9, 3.62993370978354*^9}, {3.6299346632097187`*^9, 
   3.629934681209852*^9}, {3.629934752898698*^9, 3.629934755433402*^9}, {
   3.6299348636856337`*^9, 3.629934922260865*^9}, {3.629934993988804*^9, 
   3.629935023007456*^9}, {3.629935128681553*^9, 3.6299351442586823`*^9}, {
   3.629935334095628*^9, 3.629935336567932*^9}, {3.6299353946274443`*^9, 
   3.6299353988302526`*^9}, {3.6299354476149464`*^9, 
   3.6299354480673475`*^9}, {3.629935502874649*^9, 3.629935503093049*^9}, {
   3.629935551106537*^9, 3.6299355559781456`*^9}, {3.629936551072497*^9, 
   3.629936612044925*^9}, {3.6299367892033534`*^9, 3.629936796945967*^9}, {
   3.6299377624410257`*^9, 3.6299377926834807`*^9}, {3.6299379377013726`*^9, 
   3.629937949759297*^9}, {3.7810027968065405`*^9, 3.7810027977151113`*^9}, 
   3.7810028477632437`*^9, {3.7810052367295804`*^9, 3.781005311006933*^9}, {
   3.8105263903568463`*^9, 3.810526404546586*^9}, {3.810526472349375*^9, 
   3.810526577760407*^9}, {3.8479656805085526`*^9, 3.8479656969406185`*^9}, {
   3.875251155989257*^9, 3.875251160832858*^9}, {3.875251268136101*^9, 
   3.8752512796859117`*^9}, 3.8763674667863073`*^9, {3.887014188468592*^9, 
   3.887014206049587*^9}, {3.8947834785770617`*^9, 3.8947835107197127`*^9}, {
   3.8947847676371794`*^9, 3.8947848156123934`*^9}, {3.8947964824544554`*^9, 
   3.894796503350196*^9}, {3.8947965918919544`*^9, 3.8947966068166895`*^9}, {
   3.8947967311641293`*^9, 3.8947967783221865`*^9}, {3.894797790979706*^9, 
   3.894797858487443*^9}, {3.8947979074270425`*^9, 3.8947979304219875`*^9}, 
   3.8947980566374516`*^9, {3.89479809763582*^9, 3.8947981024965334`*^9}, {
   3.894798227052437*^9, 3.8947982536013165`*^9}, 3.89479830076906*^9, {
   3.894798395597806*^9, 3.894798421817698*^9}, {3.89479846772228*^9, 
   3.8947985822565026`*^9}, {3.894798739985142*^9, 3.8947987885748434`*^9}, {
   3.8947990793623066`*^9, 3.894799086062415*^9}, {3.894799641897766*^9, 
   3.8947996433876343`*^9}, {3.8948846958099174`*^9, 
   3.8948847213568993`*^9}, {3.894884795738093*^9, 3.894884852034692*^9}, {
   3.894885076927269*^9, 3.894885087175006*^9}, {3.8948855422867355`*^9, 
   3.894885549824132*^9}, {3.8948862395079174`*^9, 3.8948862498995686`*^9}, {
   3.894886486698395*^9, 3.894886487155118*^9}, 3.8948865282360115`*^9, {
   3.8948878613165607`*^9, 3.8948878786341467`*^9}, 3.894888270011814*^9, {
   3.8948884223091393`*^9, 3.8948884550385647`*^9}, 3.894888667211878*^9, {
   3.8948887102022543`*^9, 3.894888731624566*^9}, {3.8948889011818933`*^9, 
   3.8948889189018917`*^9}, {3.8948892410613317`*^9, 3.894889244901925*^9}, {
   3.8948895584683323`*^9, 3.894889563157584*^9}, {3.894889624037278*^9, 
   3.894889636875182*^9}, 3.895116579026664*^9, 3.895542935974187*^9, 
   3.89555477426108*^9, {3.895555838296528*^9, 
   3.8955558383095217`*^9}},ExpressionUUID->"e180f111-643b-4ad9-9190-\
34b76f2b913a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Christoffel", "Subsection",
 CellChangeTimes->{{3.52170197*^9, 
  3.521701990984375*^9}},ExpressionUUID->"3e851b52-9d26-44b4-88b1-\
d76b3c349201"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Internally", " ", "we", " ", "build", " ", "the", " ", "Tensor", " ", 
    "with", " ", "abstract", " ", "indices", " ", "before", " ", "evaluating",
     " ", "it", " ", "with", " ", "the", " ", "specified", " ", "ones"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Christoffel", "[", 
      RowBox[{
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", 
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", "m_Tensor", ",", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Tooltip", " ", "for", " ", "Christoffel"}]}], "*)"}], 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Mu]I", ",", 
         RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Alpha]I", ",", 
         RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{"\[Beta]I", ",", 
         RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Mu]", ",", "\[Alpha]", ",", "\[Beta]", ",", "cooo", ",", "st", ",", 
        "d", ",", "mm", ",", "Chris", ",", "cc", ",", "disp"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"st", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Layer", " ", "one"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Chris", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"ChristoffelComponents", "\[Rule]", "cc_"}], ")"}], 
            "\[Rule]", "cc"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ChristoffelComponents", "[", 
             RowBox[{
              RowBox[{"SuperMinus", "[", "\[Mu]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Alpha]", "]"}], ",", 
              RowBox[{"SubMinus", "[", "\[Beta]", "]"}]}], "]"}], "/.", 
            "Chris"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "st", ",", 
            RowBox[{"st", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "st", ",", 
            RowBox[{"st", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "st", ",", 
            RowBox[{"st", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Tooltip", " ", "for", " ", "Christoffel"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "===", 
            "Null"}], ",", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"display", " ", "only", " ", "non"}], "-", 
             RowBox[{"zero", " ", "components"}]}], " ", "*)"}], 
           RowBox[{
            RowBox[{"disp", "=", 
             RowBox[{"Select", "[", 
              RowBox[{"Chris", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Flatten", "[", 
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"{", "#", "}"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ChristoffelComponents", "[", "__", "]"}], 
                    "\[Rule]", "cc_"}], ")"}], "\[Rule]", "cc"}]}], "]"}], 
                    "]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "=!=", "0"}], ")"}], "&"}]}], 
              "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"disp", "=", 
             RowBox[{"(", 
              RowBox[{"disp", "/.", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"ChristoffelComponents", "[", 
                  RowBox[{
                   RowBox[{"SuperMinus", "[", "\[Mu]s_", "]"}], ",", 
                   RowBox[{"SubMinus", "[", "\[Alpha]s_", "]"}], ",", 
                   RowBox[{"SubMinus", "[", "\[Beta]s_", "]"}]}], "]"}], 
                 "\[RuleDelayed]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"cooo", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Mu]s", "-", "st", "+", "1"}], 
                    "\[RightDoubleBracket]"}], ",", "Null"}], "}"}], "]"}], 
                    ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"Null", ",", 
                    RowBox[{"cooo", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Alpha]s", "-", "st", "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"Null", ",", 
                    RowBox[{"cooo", "\[LeftDoubleBracket]", 
                    RowBox[{"\[Beta]s", "-", "st", "+", "1"}], 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], 
                  "]"}]}], "}"}]}], ")"}]}]}], ",", "True", ",", 
           RowBox[{"disp", "=", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], "]"}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<ChristoffelSymbols\>\""}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "\"\<\[CapitalGamma]\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "st"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]I", ",", "\[Alpha]I", ",", "\[Beta]I"}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Tooltip", " ", "for", " ", "Christoffel"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521701940859375*^9, 3.521701962421875*^9}, {
   3.5217019955*^9, 3.521702083*^9}, {3.52170211303125*^9, 
   3.521702153515625*^9}, {3.52170220340625*^9, 3.521702243140625*^9}, {
   3.521702276890625*^9, 3.52170228828125*^9}, {3.521702356546875*^9, 
   3.52170261825*^9}, {3.5217026784375*^9, 3.521702780828125*^9}, {
   3.52170315325*^9, 3.521703346140625*^9}, {3.521703396078125*^9, 
   3.521703477015625*^9}, {3.5217036863125*^9, 3.52170370946875*^9}, {
   3.5217037753125*^9, 3.521703777578125*^9}, {3.521703871046875*^9, 
   3.521704226390625*^9}, {3.521704278875*^9, 3.521704286*^9}, {
   3.521704316265625*^9, 3.521704321015625*^9}, {3.521704371890625*^9, 
   3.5217043791875*^9}, {3.52170445840625*^9, 3.521704518171875*^9}, {
   3.52170460028125*^9, 3.5217046210625*^9}, {3.521704660421875*^9, 
   3.52170466371875*^9}, {3.521704822625*^9, 3.52170482784375*^9}, {
   3.521704897203125*^9, 3.5217049498125*^9}, {3.521705017578125*^9, 
   3.521705036828125*^9}, {3.521705074375*^9, 3.52170508596875*^9}, {
   3.521705117359375*^9, 3.5217051225625*^9}, {3.521705165140625*^9, 
   3.521705169703125*^9}, {3.52173392034375*^9, 3.52173392140625*^9}, {
   3.521734619109375*^9, 3.5217346573125*^9}, {3.52173516965625*^9, 
   3.5217352035*^9}, {3.521757092171875*^9, 3.52175712196875*^9}, {
   3.521757212578125*^9, 3.5217572370625*^9}, {3.52175731115625*^9, 
   3.521757395625*^9}, {3.521757462703125*^9, 3.52175747228125*^9}, {
   3.521758798625*^9, 3.521758851703125*^9}, {3.521758919484375*^9, 
   3.5217589975*^9}, {3.5217590398125*^9, 3.5217591825625*^9}, {
   3.521759574546875*^9, 3.5217596046875*^9}, {3.521785540296875*^9, 
   3.52178557575*^9}, {3.52178565253125*^9, 3.52178571865625*^9}, {
   3.521920863046875*^9, 3.521920863578125*^9}, {3.521921206046875*^9, 
   3.521921214390625*^9}, {3.5219212558125*^9, 3.521921258515625*^9}, {
   3.52192150490625*^9, 3.52192150825*^9}, {3.52192180103125*^9, 
   3.521921821484375*^9}, {3.521923471453125*^9, 3.5219234891875*^9}, {
   3.521923550609375*^9, 3.521923569515625*^9}, {3.5219236754375*^9, 
   3.5219237076875*^9}, 3.521923899484375*^9, {3.5219240685*^9, 
   3.521924091390625*^9}, {3.52192419671875*^9, 3.521924199671875*^9}, {
   3.521924313953125*^9, 3.521924377609375*^9}, {3.521924417515625*^9, 
   3.521924454765625*^9}, {3.521926034671875*^9, 3.52192606040625*^9}, {
   3.521926156203125*^9, 3.52192615959375*^9}, {3.52192629628125*^9, 
   3.52192629725*^9}, {3.521926336015625*^9, 3.52192633659375*^9}, {
   3.5219264416875*^9, 3.52192644578125*^9}, {3.521926494203125*^9, 
   3.5219264944375*^9}, {3.521926644359375*^9, 3.521926660171875*^9}, {
   3.6297527622404857`*^9, 3.6297527725920773`*^9}, {3.6298218719754953`*^9, 
   3.6298218730014973`*^9}, {3.629821921547593*^9, 3.6298219335150166`*^9}, {
   3.847838528961491*^9, 3.8478385603648305`*^9}, {3.8478386605111895`*^9, 
   3.847838786818737*^9}, {3.847839671348936*^9, 3.847839725284182*^9}, {
   3.87342015136122*^9, 3.8734201577712746`*^9}, {3.8757549136847267`*^9, 
   3.8757549858368845`*^9}, {3.875755319164792*^9, 3.8757553193679132`*^9}, 
   3.8757585752981043`*^9, {3.8870142738989477`*^9, 3.8870142974097195`*^9}, 
   3.887017305014722*^9, {3.8955547742750716`*^9, 3.8955547742830667`*^9}, 
   3.895555172174732*^9, {3.896615872905754*^9, 3.896615936007663*^9}, 
   3.8966165647263737`*^9},ExpressionUUID->"88c465ea-0b26-453a-9f87-\
54d52741b1bd"]
}, Closed]],

Cell[CellGroupData[{

Cell["Riemann", "Subsection",
 CellChangeTimes->{{3.521734694046875*^9, 3.521734695609375*^9}, 
   3.521734751328125*^9},ExpressionUUID->"a2143a5b-8e99-4039-af31-\
7b892d4f9ccb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Internally", " ", "we", " ", "build", " ", "the", " ", "Tensor", " ", 
    "with", " ", "abstract", " ", "indices", " ", "before", " ", "evaluating",
     " ", "it", " ", "with", " ", "the", " ", "specified", " ", "ones"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Riemann", "[", 
      RowBox[{
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", 
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]I", "]"}]}], ",", 
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", "m_Tensor", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Tooltip", " ", "for", " ", "Riemann"}]}], "*)"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",",
         "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", 
        "rl", ",", "si", ",", "cooo", ",", "disp", ",", "d", ",", "cc", ",", 
        "Rie", ",", "lhs", ",", "rhs", ",", "RL1", ",", "RL2", ",", "RL3", 
        ",", "RL4", ",", "RiemannTemp", ",", "\[Tau]"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Layer", " ", "one"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Rie", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RiemannComponents", "\[Rule]", "cc_"}], ")"}], 
            "\[Rule]", "cc"}], ",", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL1", "[", 
           RowBox[{"\[Mu]", ",", "\[Mu]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Mu]", ",", "\[Mu]I"}], "]"}], ",", 
            SuperscriptBox["\[Mu]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL2", "[", 
           RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Nu]", ",", "\[Nu]I"}], "]"}], ",", 
            SubscriptBox["\[Nu]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL3", "[", 
           RowBox[{"\[Alpha]", ",", "\[Alpha]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Alpha]", ",", "\[Alpha]I"}], "]"}], ",", 
            SubscriptBox["\[Alpha]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL4", "[", 
           RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Beta]", ",", "\[Beta]I"}], "]"}], ",", 
            SubscriptBox["\[Beta]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RiemannTemp", "[", 
           RowBox[{
           "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1"}], 
           "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RiemannComponents", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]1", "-"], ",", 
              SubscriptBox["\[Nu]1", "-"], ",", 
              SubscriptBox["\[Alpha]1", "-"], ",", 
              SubscriptBox["\[Beta]1", "-"]}], "]"}], "/.", "Rie"}], ")"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RL1", "[", 
              RowBox[{"\[Mu]", ",", "\[Mu]1"}], "]"}], 
             RowBox[{"RL2", "[", 
              RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], 
             RowBox[{"RL3", "[", 
              RowBox[{"\[Alpha]", ",", "\[Alpha]1"}], "]"}], 
             RowBox[{"RL4", "[", 
              RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], 
             RowBox[{"RiemannTemp", "[", 
              RowBox[{
              "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1"}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Mu]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Originally", " ", "we", " ", "wanted", " ", "to", " ", "display", 
         " ", "Riemann", " ", "components"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "But", " ", "there", " ", "are", " ", "so", " ", "many", " ", 
         "components", " ", "and", " ", "it", " ", "slows", " ", "the", " ", 
         "whole", " ", "process", " ", "down", " ", "too", " ", "much"}], " ",
         "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "So", " ", "we", " ", "are", " ", "going", " ", "to", " ", "skip", 
         " ", "this", " ", "for", " ", "now"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"disp", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<R\>\"", ",", 
                  RowBox[{"UpOrDown", "[", 
                   RowBox[{"ReplaceIndex", "[", 
                    RowBox[{
                    RowBox[{
                    "cooo", "\[LeftDoubleBracket]", "\[Mu]", 
                    "\[RightDoubleBracket]"}], ",", "\[Mu]I"}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"UpOrDown", "[", 
                   RowBox[{"ReplaceIndex", "[", 
                    RowBox[{
                    RowBox[{
                    "cooo", "\[LeftDoubleBracket]", "\[Nu]", 
                    "\[RightDoubleBracket]"}], ",", "\[Nu]I"}], "]"}], "]"}], 
                  ",", 
                  RowBox[{"UpOrDown", "[", 
                   RowBox[{"ReplaceIndex", "[", 
                    RowBox[{
                    RowBox[{
                    "cooo", "\[LeftDoubleBracket]", "\[Alpha]", 
                    "\[RightDoubleBracket]"}], ",", "\[Alpha]I"}], "]"}], 
                   "]"}], ",", 
                  RowBox[{"UpOrDown", "[", 
                   RowBox[{"ReplaceIndex", "[", 
                    RowBox[{
                    RowBox[{
                    "cooo", "\[LeftDoubleBracket]", "\[Beta]", 
                    "\[RightDoubleBracket]"}], ",", "\[Beta]I"}], "]"}], 
                   "]"}]}], "}"}], "]"}], "\[Rule]", 
               RowBox[{"mm", "\[LeftDoubleBracket]", 
                RowBox[{
                "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
                "\[RightDoubleBracket]"}]}], "}"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]", ",", "1", ",", "d"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]", ",", "1", ",", "d"}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"disp", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"disp", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "#", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Row", "[", 
                    RowBox[{"{", "__", "}"}], "]"}], "\[Rule]", "cc_"}], 
                    ")"}], "\[Rule]", "cc"}]}], "]"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
                "0"}], ")"}], "&"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<RiemannCurvatureTensor\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"R\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\[Mu]I", ",", "\[Nu]I", ",", "\[Alpha]I", ",", "\[Beta]I"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Tooltip", " ", "for", " ", "Riemann"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{
           "TooltipDisplay", "\[Rule]", 
            "\"\<Tidal forces encoded here. \[HappySmiley]\>\""}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521734700765625*^9, 3.521734734640625*^9}, {
   3.52173487478125*^9, 3.52173492440625*^9}, {3.5217352561875*^9, 
   3.521735312953125*^9}, {3.52173546925*^9, 3.52173547059375*^9}, {
   3.52174123378125*^9, 3.52174125609375*^9}, {3.52174142909375*^9, 
   3.521741443109375*^9}, {3.521741495765625*^9, 3.52174152578125*^9}, 
   3.52174221153125*^9, {3.52174227078125*^9, 3.521742318828125*^9}, {
   3.52174237790625*^9, 3.521742387515625*^9}, {3.5217425573125*^9, 
   3.52174261503125*^9}, {3.5217429701875*^9, 3.521743060046875*^9}, {
   3.52174309034375*^9, 3.52174312703125*^9}, {3.521743202421875*^9, 
   3.52174328740625*^9}, {3.5217433179375*^9, 3.52174332475*^9}, {
   3.5217433954375*^9, 3.521743463265625*^9}, {3.521743504828125*^9, 
   3.52174368890625*^9}, {3.521744190296875*^9, 3.521744191921875*^9}, {
   3.521757495484375*^9, 3.521757496546875*^9}, {3.521759661171875*^9, 
   3.521759719875*^9}, {3.52178575603125*^9, 3.52178577840625*^9}, {
   3.521785830296875*^9, 3.521785836796875*^9}, 3.52178631140625*^9, 
   3.5217865115*^9, {3.521786556609375*^9, 3.521786631640625*^9}, {
   3.52178668678125*^9, 3.52178682984375*^9}, {3.521786892046875*^9, 
   3.521786892359375*^9}, {3.52178695025*^9, 3.521786955328125*^9}, {
   3.52178699525*^9, 3.5217870186875*^9}, {3.521787374609375*^9, 
   3.521787502640625*^9}, 3.52191031203125*^9, {3.521921372765625*^9, 
   3.52192137315625*^9}, {3.52192155775*^9, 3.5219215621875*^9}, {
   3.5219221798125*^9, 3.5219221976875*^9}, {3.521923986484375*^9, 
   3.52192404196875*^9}, {3.52192447690625*^9, 3.52192448615625*^9}, {
   3.521926319296875*^9, 3.521926320171875*^9}, {3.52192646428125*^9, 
   3.521926469640625*^9}, {3.521926708734375*^9, 3.521926711578125*^9}, {
   3.52192726475*^9, 3.521927265390625*^9}, {3.52192732678125*^9, 
   3.521927331109375*^9}, {3.52192737059375*^9, 3.5219276574375*^9}, {
   3.521986638453125*^9, 3.5219867519375*^9}, {3.5219869874375*^9, 
   3.52198702090625*^9}, {3.52198776375*^9, 3.52198783859375*^9}, {
   3.52198857421875*^9, 3.52198860203125*^9}, {3.521989040203125*^9, 
   3.52198904790625*^9}, {3.52198924446875*^9, 3.521989323203125*^9}, {
   3.521989457359375*^9, 3.521989503859375*^9}, {3.52198970278125*^9, 
   3.5219897270625*^9}, {3.521989966171875*^9, 3.52198999225*^9}, {
   3.521990024421875*^9, 3.521990051515625*^9}, {3.5219901530625*^9, 
   3.521990263921875*^9}, {3.52199040546875*^9, 3.52199044909375*^9}, {
   3.521990681125*^9, 3.52199068253125*^9}, {3.629752726741455*^9, 
   3.6297527409332666`*^9}, {3.6298218168917894`*^9, 
   3.6298218174221907`*^9}, {3.6298431069387007`*^9, 3.6298431091851044`*^9}, 
   3.6299266252952766`*^9, {3.630638678608488*^9, 3.6306386825084953`*^9}, {
   3.8478397656562805`*^9, 3.847839791841218*^9}, {3.8478398490019493`*^9, 
   3.8478399032348657`*^9}, {3.8478401002461095`*^9, 
   3.8478401051422186`*^9}, {3.8757550009021716`*^9, 3.875755107112735*^9}, {
   3.8757553234706583`*^9, 3.8757553236738005`*^9}, 3.887014308763605*^9, {
   3.8955547743040714`*^9, 3.895554774321104*^9}, 3.8955551721807284`*^9, {
   3.896616039985834*^9, 3.896616045533027*^9}, {3.896616086535396*^9, 
   3.896616124936182*^9}, 
   3.8966165879066396`*^9},ExpressionUUID->"c9a30d29-04d5-45c8-bb1d-\
513ed83291b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ricci", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 
  3.5217437626875*^9}},ExpressionUUID->"c2def25f-1776-4a82-abe4-e31e6156b5ce"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ricci", "[", 
      RowBox[{
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", "m_Tensor", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Tooltip", " ", "for", " ", "Ricci"}]}], "*)"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",",
         "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", 
        "rl", ",", "si", ",", "cooo", ",", "disp", ",", "d", ",", "cc", ",", 
        "Ric", ",", "RL1", ",", "RL2", ",", "RicciTemp"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"Layer", " ", "one"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Ric", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"RicciComponents", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
            "cc"}], ",", "1"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL1", "[", 
           RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Nu]", ",", "\[Nu]I"}], "]"}], ",", 
            SubscriptBox["\[Nu]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RL2", "[", 
           RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], "=", 
          RowBox[{"RaiseLower", "[", 
           RowBox[{
            RowBox[{"ReplaceIndex", "[", 
             RowBox[{"\[Beta]", ",", "\[Beta]I"}], "]"}], ",", 
            SubscriptBox["\[Beta]1", "-"], ",", "m"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"RicciTemp", "[", 
           RowBox[{"\[Nu]1", ",", "\[Beta]1"}], "]"}], "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"RicciComponents", "[", 
             RowBox[{
              SubscriptBox["\[Nu]1", "-"], ",", 
              SubscriptBox["\[Beta]1", "-"]}], "]"}], "/.", "Ric"}], ")"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Nu]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Beta]1", ",", "si", ",", 
           RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"RL1", "[", 
              RowBox[{"\[Nu]", ",", "\[Nu]1"}], "]"}], 
             RowBox[{"RL2", "[", 
              RowBox[{"\[Beta]", ",", "\[Beta]1"}], "]"}], 
             RowBox[{"RicciTemp", "[", 
              RowBox[{"\[Nu]1", ",", "\[Beta]1"}], "]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Beta]1", ",", "si", ",", 
              RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         StyleBox[
          RowBox[{
          "Delete", " ", "the", " ", "format", " ", "of", " ", 
           "TooltipDisplay", " ", "for", " ", "Ricci", " ", "Tensor"}],
          FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"disp", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*StyleBox[\"R\",FontSlant->\"Italic\"]\)\>\"", ",", 
                RowBox[{"UpOrDown", "[", "\[Nu]I", "]"}], ",", 
                RowBox[{"UpOrDown", "[", "\[Beta]I", "]"}]}], "}"}], "]"}], 
             "\[Rule]", "mm"}], ",", 
            RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "cooo"}]}], "}"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"Comment", " ", "out", " ", "RicciCurvatureTensor"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<RicciCurvatureTensor\>\""}], 
          ","}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"R\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[Nu]I", ",", "\[Beta]I"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Tooltip", " ", "for", " ", "Ricci"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"TooltipDisplay", "\[Rule]", "disp"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, {3.8364449484985237`*^9, 
   3.836444976697261*^9}, {3.836526197033885*^9, 3.836526201288885*^9}, {
   3.8381936494228725`*^9, 3.8381936501728716`*^9}, 3.8381942219189725`*^9, 
   3.8381942764834757`*^9, {3.847839941309194*^9, 3.8478399739321556`*^9}, {
   3.847840091019245*^9, 3.8478400933960853`*^9}, 3.874560218593365*^9, {
   3.875141420387806*^9, 3.8751414358123174`*^9}, {3.875755117850466*^9, 
   3.8757551698007727`*^9}, {3.8757552434406815`*^9, 
   3.8757552553027973`*^9}, {3.8757552903368187`*^9, 3.8757553064586596`*^9}, 
   3.887014320241514*^9, {3.8955547743370776`*^9, 3.8955547743411026`*^9}, 
   3.8955551721867247`*^9, {3.896616141846331*^9, 3.8966161428494377`*^9}, 
   3.896616595550499*^9},ExpressionUUID->"1d2b45cd-c3da-4db1-94aa-\
061cf78888fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["RicciScalar", "Subsection",
 CellChangeTimes->{{3.52174379078125*^9, 
  3.52174380503125*^9}},ExpressionUUID->"c25be501-361d-4b91-9c14-\
1d4568313200"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RicciScalar", "[", "m_Tensor", "]"}], 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], "/;", 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"(", 
     RowBox[{"RicciScalar", "/.", 
      RowBox[{"Flatten", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"m", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"RicciScalarInvariant", "\[Rule]", "cc_"}], ")"}], 
          "\[Rule]", "cc"}], 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"RicciScalar", " ", "one", " ", "layer"}]}], "*)"}], ",", 
         "1"}], "]"}], "]"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "TensorForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"RicciScalar", "[", 
    RowBox[{"m_Tensor", ",", "Tensor"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NonMetricTensor", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"RicciScalar", "[", "m", "]"}], ",", "\"\<R\>\"", ",", 
    RowBox[{"CoordinateSystem", "\[Rule]", 
     RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
    RowBox[{"StartIndex", "\[Rule]", 
     RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
    RowBox[{"TooltipDisplay", "\[Rule]", " ", "Null"}], ",", 
    RowBox[{"TooltipStyle", "\[Rule]", " ", 
     RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorAssumption", "\[Rule]", " ", 
     RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorOperator", "\[Rule]", " ", 
     RowBox[{"TensorOperator", "[", "m", "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521743810890625*^9, 3.521743821640625*^9}, {
   3.52174386515625*^9, 3.52174389903125*^9}, {3.8757478876069565`*^9, 
   3.8757478954519525`*^9}, {3.875755263727872*^9, 3.8757552756086197`*^9}, {
   3.875755376923614*^9, 3.8757553812868214`*^9}, {3.887018957420314*^9, 
   3.8870189907480216`*^9}, {3.887019036734419*^9, 3.887019046670129*^9}, {
   3.8955551721907225`*^9, 3.895555172192722*^9}, {3.8966161794772377`*^9, 
   3.8966161863824224`*^9}, 
   3.8966163122061896`*^9},ExpressionUUID->"b3fdcfec-523d-4d23-bb28-\
efc266000646"]
}, Closed]],

Cell[CellGroupData[{

Cell["Weyl", "Subsection",
 CellChangeTimes->{{3.521734694046875*^9, 3.521734695609375*^9}, 
   3.521734751328125*^9, {3.6297617465893908`*^9, 
   3.6297617474989944`*^9}},ExpressionUUID->"39601059-4c8d-4012-9dea-\
8af07a0a4633"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Internally", " ", "we", " ", "build", " ", "the", " ", "Tensor", " ", 
    "with", " ", "abstract", " ", "indices", " ", "before", " ", "evaluating",
     " ", "it", " ", "with", " ", "the", " ", "specified", " ", "ones"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"d", ">", "3"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Weyl", "[", 
      RowBox[{
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", 
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", 
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]I", "]"}]}], ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"check", " ", "d"}], ">", "3"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Dimensions", "[", "m", "]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ">", "3"}], 
       ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "W", ",", "W0", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]",
         ",", "\[Beta]", ",", "si", ",", "cooo", ",", "d", ",", "op"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "=", 
        RowBox[{"OptionValue", "[", "WeylOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"W", "[", 
         RowBox[{
         "\[Alpha]_", ",", "\[Beta]_", ",", "\[Mu]_", ",", "\[Nu]_", ",", 
          "mm_Tensor"}], "]"}], ":=", 
        RowBox[{
         RowBox[{"Riemann", "[", 
          RowBox[{
          "\[Alpha]", ",", "\[Beta]", ",", "\[Mu]", ",", "\[Nu]", ",", "mm"}],
           "]"}], "-", 
         RowBox[{
          FractionBox["1", 
           RowBox[{"d", "-", "2"}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Alpha]", ",", "\[Mu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Nu]", ",", "\[Beta]", ",", "mm"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Alpha]", ",", "\[Nu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Mu]", ",", "\[Beta]", ",", "mm"}], "]"}]}]}], 
             ")"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Beta]", ",", "\[Mu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Nu]", ",", "\[Alpha]", ",", "mm"}], "]"}]}], "-", 
              RowBox[{
               RowBox[{"Ricci", "[", 
                RowBox[{"\[Beta]", ",", "\[Nu]", ",", "mm"}], "]"}], 
               RowBox[{"Metric", "[", 
                RowBox[{"\[Mu]", ",", "\[Alpha]", ",", "mm"}], "]"}]}]}], 
             ")"}]}], ")"}]}], "+", 
         RowBox[{
          FractionBox[
           RowBox[{"RicciScalar", "[", "mm", "]"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"d", "-", "1"}], ")"}], 
            RowBox[{"(", 
             RowBox[{"d", "-", "2"}], ")"}]}]], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Metric", "[", 
              RowBox[{"\[Alpha]", ",", "\[Mu]", ",", "mm"}], "]"}], 
             RowBox[{"Metric", "[", 
              RowBox[{"\[Nu]", ",", "\[Beta]", ",", "mm"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{"Metric", "[", 
              RowBox[{"\[Alpha]", ",", "\[Nu]", ",", "mm"}], "]"}], 
             RowBox[{"Metric", "[", 
              RowBox[{"\[Mu]", ",", "\[Beta]", ",", "mm"}], "]"}]}]}], 
           ")"}]}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"W0", "=", 
        RowBox[{"W", "[", 
         RowBox[{
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Alpha]", ",", "\[Alpha]I"}], "]"}], ",", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Beta]", ",", "\[Beta]I"}], "]"}], ",", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Mu]", ",", "\[Mu]I"}], "]"}], ",", 
          RowBox[{"ReplaceIndex", "[", 
           RowBox[{"\[Nu]", ",", "\[Nu]I"}], "]"}], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"W0", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"op", "[", "W0", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "si", ",", 
            RowBox[{"si", "+", "d", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<WeylCurvatureTensor\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"C\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "W0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]I", ",", "\[Beta]I", ",", "\[Mu]I", ",", "\[Nu]I"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Tooltip", " ", "for", " ", "Weyl"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{
           "TooltipDisplay", "\[Rule]", 
            "\"\<Weyl is the traceless part of the Riemann tensor.\>\""}]}], 
          "*)"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521734700765625*^9, 3.521734734640625*^9}, {
   3.52173487478125*^9, 3.52173492440625*^9}, {3.5217352561875*^9, 
   3.521735312953125*^9}, {3.52173546925*^9, 3.52173547059375*^9}, {
   3.52174123378125*^9, 3.52174125609375*^9}, {3.52174142909375*^9, 
   3.521741443109375*^9}, {3.521741495765625*^9, 3.52174152578125*^9}, 
   3.52174221153125*^9, {3.52174227078125*^9, 3.521742318828125*^9}, {
   3.52174237790625*^9, 3.521742387515625*^9}, {3.5217425573125*^9, 
   3.52174261503125*^9}, {3.5217429701875*^9, 3.521743060046875*^9}, {
   3.52174309034375*^9, 3.52174312703125*^9}, {3.521743202421875*^9, 
   3.52174328740625*^9}, {3.5217433179375*^9, 3.52174332475*^9}, {
   3.5217433954375*^9, 3.521743463265625*^9}, {3.521743504828125*^9, 
   3.52174368890625*^9}, {3.521744190296875*^9, 3.521744191921875*^9}, {
   3.521757495484375*^9, 3.521757496546875*^9}, {3.521759661171875*^9, 
   3.521759719875*^9}, {3.52178575603125*^9, 3.52178577840625*^9}, {
   3.521785830296875*^9, 3.521785836796875*^9}, 3.52178631140625*^9, 
   3.5217865115*^9, {3.521786556609375*^9, 3.521786631640625*^9}, {
   3.52178668678125*^9, 3.52178682984375*^9}, {3.521786892046875*^9, 
   3.521786892359375*^9}, {3.52178695025*^9, 3.521786955328125*^9}, {
   3.52178699525*^9, 3.5217870186875*^9}, {3.521787374609375*^9, 
   3.521787502640625*^9}, 3.52191031203125*^9, {3.521921372765625*^9, 
   3.52192137315625*^9}, {3.52192155775*^9, 3.5219215621875*^9}, {
   3.5219221798125*^9, 3.5219221976875*^9}, {3.521923986484375*^9, 
   3.52192404196875*^9}, {3.52192447690625*^9, 3.52192448615625*^9}, {
   3.521926319296875*^9, 3.521926320171875*^9}, {3.52192646428125*^9, 
   3.521926469640625*^9}, {3.521926708734375*^9, 3.521926711578125*^9}, {
   3.52192726475*^9, 3.521927265390625*^9}, {3.52192732678125*^9, 
   3.521927331109375*^9}, {3.52192737059375*^9, 3.5219276574375*^9}, {
   3.521986638453125*^9, 3.5219867519375*^9}, {3.5219869874375*^9, 
   3.52198702090625*^9}, {3.52198776375*^9, 3.52198783859375*^9}, {
   3.52198857421875*^9, 3.52198860203125*^9}, {3.521989040203125*^9, 
   3.52198904790625*^9}, {3.52198924446875*^9, 3.521989323203125*^9}, {
   3.521989457359375*^9, 3.521989503859375*^9}, {3.52198970278125*^9, 
   3.5219897270625*^9}, {3.521989966171875*^9, 3.52198999225*^9}, {
   3.521990024421875*^9, 3.521990051515625*^9}, {3.5219901530625*^9, 
   3.521990263921875*^9}, {3.52199040546875*^9, 3.52199044909375*^9}, {
   3.521990681125*^9, 3.52199068253125*^9}, {3.629752726741455*^9, 
   3.6297527409332666`*^9}, {3.6297617545920153`*^9, 
   3.6297617553428164`*^9}, {3.6297617945443063`*^9, 
   3.6297618111627455`*^9}, {3.6297618445874224`*^9, 3.629761871731298*^9}, {
   3.629761903142968*^9, 3.6297621381319532`*^9}, {3.62976238261876*^9, 
   3.6297623918905773`*^9}, {3.6297624865225897`*^9, 
   3.6297625240860853`*^9}, {3.629762563940586*^9, 3.629762736237419*^9}, {
   3.6297627759801335`*^9, 3.6297627925663767`*^9}, {3.6297628761608286`*^9, 
   3.6297629075250955`*^9}, {3.629762957887407*^9, 3.6297629714540377`*^9}, {
   3.6297630520534487`*^9, 3.6297630986135473`*^9}, {3.6297645525047197`*^9, 
   3.629764582551174*^9}, {3.6297647840345716`*^9, 3.629764787654778*^9}, {
   3.6297651274614244`*^9, 3.629765128242426*^9}, {3.629765216948803*^9, 
   3.6297653417704325`*^9}, {3.62976555127981*^9, 3.6297656157873244`*^9}, {
   3.6297661357466607`*^9, 3.6297661396466675`*^9}, {3.6297661840407457`*^9, 
   3.629766217020605*^9}, {3.6297665433073854`*^9, 3.6297667847348146`*^9}, {
   3.629766859449747*^9, 3.6297668639133554`*^9}, {3.629766948098504*^9, 
   3.6297670085344114`*^9}, {3.6297671291576295`*^9, 
   3.6297671318408346`*^9}, {3.6297673443323603`*^9, 
   3.6297674245403256`*^9}, {3.629767497506068*^9, 3.6297675228775144`*^9}, {
   3.6297676001496615`*^9, 3.629767680439425*^9}, {3.629767760335778*^9, 
   3.629767977089387*^9}, {3.6297680266076803`*^9, 3.629768029079485*^9}, 
   3.6297685964429665`*^9, 3.6297686657964897`*^9, {3.6297687146989765`*^9, 
   3.6297687365460157`*^9}, {3.629768866183045*^9, 3.629768868211048*^9}, {
   3.6297690014112897`*^9, 3.629769090328247*^9}, {3.6298194414104404`*^9, 
   3.629819460006674*^9}, {3.6298194901459265`*^9, 3.6298195206811805`*^9}, {
   3.6298196059353304`*^9, 3.6298197214223332`*^9}, {3.6298214424336243`*^9, 
   3.6298214669324694`*^9}, {3.629821615464175*^9, 3.62982161773918*^9}, {
   3.629821767881694*^9, 3.6298218007117596`*^9}, {3.7670018459356575`*^9, 
   3.767001899349289*^9}, {3.767004084712014*^9, 3.7670040902724733`*^9}, {
   3.794028857121798*^9, 3.794028861076228*^9}, {3.847840162537179*^9, 
   3.847840166046197*^9}, {3.875755368453453*^9, 3.875755369250282*^9}, {
   3.875755405768169*^9, 3.8757554577621603`*^9}, 3.887014359043078*^9, {
   3.895554774359083*^9, 3.895554774370076*^9}, 3.8955551721977167`*^9, {
   3.8966161959794707`*^9, 3.8966161967599525`*^9}, 
   3.89661661658348*^9},ExpressionUUID->"c9ec7425-5271-46ed-a20b-\
5b9376c901fe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"d", "<=", "3"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Weyl", ",", " ", 
    RowBox[{
     RowBox[{
     "defined", " ", "to", " ", "be", " ", "the", " ", "traceless", " ", 
      "part", " ", "of", " ", "Riemann", " ", "is", " ", "zero", " ", "if", 
      " ", "d"}], " ", "=", 
     RowBox[{
      RowBox[{"2", " ", "or", " ", "d"}], " ", "=", " ", "3."}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "For", " ", "3", "D", " ", "we", " ", "have", " ", "done", " ", "a", " ", 
    "brute", " ", "force", " ", "calculation", " ", "to", " ", "prove", " ", 
    RowBox[{"it", "."}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "For", " ", "2", "D", " ", "the", " ", "usual", " ", "formula", " ", 
     "for", " ", "Weyl", " ", "breaks", " ", "down"}], ";", " ", 
    RowBox[{
    "Use", " ", "fact", " ", "that", " ", "einstein", " ", "tensor", " ", 
     "is", " ", "zero", " ", "and", " ", "2", "D", " ", "metrics", " ", "are",
      " ", "conformally", " ", "flat", " ", "to", " ", "prove"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Riemann", " ", "has", " ", "only", " ", "1", " ", "independent", " ", 
    "component", " ", "in", " ", "2", "D", " ", "so", " ", "heuristically", 
    " ", "that", " ", "means", " ", "subtracting", " ", "its", " ", "trace", 
    " ", "should", " ", "yield", " ", "zero"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Weyl", "[", 
      RowBox[{
       RowBox[{"\[Alpha]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Alpha]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", 
       RowBox[{"\[Mu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]I", "]"}]}], ",", 
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]I", "]"}]}], ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"check", " ", "d"}], "<=", "3"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Dimensions", "[", "m", "]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
        "\[LessEqual]", "3"}], ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "W", ",", "W0", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]",
         ",", "\[Beta]", ",", "si", ",", "cooo", ",", "d", ",", "op"}], "}"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "generate", " ", "an", " ", "array", " ", "of", " ", "zeroes"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"W0", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"d", ",", "d", ",", "d", ",", "d"}], "}"}]}], "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<WeylCurvatureTensor\>\""}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"TensorName", "\[Rule]", "\"\<C\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "W0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\[Alpha]I", ",", "\[Beta]I", ",", "\[Mu]I", ",", "\[Nu]I"}], 
           "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
         "TooltipDisplay", "\[Rule]", 
          "\"\<Weyl, being the traceless part of the Riemann tensor, is zero \
in 2D and 3D.\>\""}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521734700765625*^9, 3.521734734640625*^9}, {
   3.52173487478125*^9, 3.52173492440625*^9}, {3.5217352561875*^9, 
   3.521735312953125*^9}, {3.52173546925*^9, 3.52173547059375*^9}, {
   3.52174123378125*^9, 3.52174125609375*^9}, {3.52174142909375*^9, 
   3.521741443109375*^9}, {3.521741495765625*^9, 3.52174152578125*^9}, 
   3.52174221153125*^9, {3.52174227078125*^9, 3.521742318828125*^9}, {
   3.52174237790625*^9, 3.521742387515625*^9}, {3.5217425573125*^9, 
   3.52174261503125*^9}, {3.5217429701875*^9, 3.521743060046875*^9}, {
   3.52174309034375*^9, 3.52174312703125*^9}, {3.521743202421875*^9, 
   3.52174328740625*^9}, {3.5217433179375*^9, 3.52174332475*^9}, {
   3.5217433954375*^9, 3.521743463265625*^9}, {3.521743504828125*^9, 
   3.52174368890625*^9}, {3.521744190296875*^9, 3.521744191921875*^9}, {
   3.521757495484375*^9, 3.521757496546875*^9}, {3.521759661171875*^9, 
   3.521759719875*^9}, {3.52178575603125*^9, 3.52178577840625*^9}, {
   3.521785830296875*^9, 3.521785836796875*^9}, 3.52178631140625*^9, 
   3.5217865115*^9, {3.521786556609375*^9, 3.521786631640625*^9}, {
   3.52178668678125*^9, 3.52178682984375*^9}, {3.521786892046875*^9, 
   3.521786892359375*^9}, {3.52178695025*^9, 3.521786955328125*^9}, {
   3.52178699525*^9, 3.5217870186875*^9}, {3.521787374609375*^9, 
   3.521787502640625*^9}, 3.52191031203125*^9, {3.521921372765625*^9, 
   3.52192137315625*^9}, {3.52192155775*^9, 3.5219215621875*^9}, {
   3.5219221798125*^9, 3.5219221976875*^9}, {3.521923986484375*^9, 
   3.52192404196875*^9}, {3.52192447690625*^9, 3.52192448615625*^9}, {
   3.521926319296875*^9, 3.521926320171875*^9}, {3.52192646428125*^9, 
   3.521926469640625*^9}, {3.521926708734375*^9, 3.521926711578125*^9}, {
   3.52192726475*^9, 3.521927265390625*^9}, {3.52192732678125*^9, 
   3.521927331109375*^9}, {3.52192737059375*^9, 3.5219276574375*^9}, {
   3.521986638453125*^9, 3.5219867519375*^9}, {3.5219869874375*^9, 
   3.52198702090625*^9}, {3.52198776375*^9, 3.52198783859375*^9}, {
   3.52198857421875*^9, 3.52198860203125*^9}, {3.521989040203125*^9, 
   3.52198904790625*^9}, {3.52198924446875*^9, 3.521989323203125*^9}, {
   3.521989457359375*^9, 3.521989503859375*^9}, {3.52198970278125*^9, 
   3.5219897270625*^9}, {3.521989966171875*^9, 3.52198999225*^9}, {
   3.521990024421875*^9, 3.521990051515625*^9}, {3.5219901530625*^9, 
   3.521990263921875*^9}, {3.52199040546875*^9, 3.52199044909375*^9}, {
   3.521990681125*^9, 3.52199068253125*^9}, {3.629752726741455*^9, 
   3.6297527409332666`*^9}, {3.6297617545920153`*^9, 
   3.6297617553428164`*^9}, {3.6297617945443063`*^9, 
   3.6297618111627455`*^9}, {3.6297618445874224`*^9, 3.629761871731298*^9}, {
   3.629761903142968*^9, 3.6297621381319532`*^9}, {3.62976238261876*^9, 
   3.6297623918905773`*^9}, {3.6297624865225897`*^9, 
   3.6297625240860853`*^9}, {3.629762563940586*^9, 3.629762736237419*^9}, {
   3.6297627759801335`*^9, 3.6297627925663767`*^9}, {3.6297628761608286`*^9, 
   3.6297629075250955`*^9}, {3.629762957887407*^9, 3.6297629714540377`*^9}, {
   3.6297630520534487`*^9, 3.6297630986135473`*^9}, {3.6297645525047197`*^9, 
   3.629764582551174*^9}, {3.6297647840345716`*^9, 3.629764787654778*^9}, {
   3.6297651274614244`*^9, 3.629765128242426*^9}, {3.629765216948803*^9, 
   3.6297653417704325`*^9}, {3.62976555127981*^9, 3.6297656157873244`*^9}, {
   3.6297661357466607`*^9, 3.6297661396466675`*^9}, {3.6297661840407457`*^9, 
   3.629766217020605*^9}, {3.6297665433073854`*^9, 3.6297667847348146`*^9}, {
   3.629766859449747*^9, 3.6297668639133554`*^9}, {3.629766948098504*^9, 
   3.6297670085344114`*^9}, {3.6297671291576295`*^9, 
   3.6297671318408346`*^9}, {3.6297673443323603`*^9, 
   3.6297674245403256`*^9}, {3.629767497506068*^9, 3.6297675228775144`*^9}, {
   3.6297676001496615`*^9, 3.629767680439425*^9}, {3.629767760335778*^9, 
   3.629767977089387*^9}, {3.6297680266076803`*^9, 3.629768029079485*^9}, 
   3.6297685964429665`*^9, 3.6297686657964897`*^9, {3.6297687146989765`*^9, 
   3.6297687365460157`*^9}, {3.629768866183045*^9, 3.629768868211048*^9}, {
   3.6297690014112897`*^9, 3.629769090328247*^9}, {3.6298194414104404`*^9, 
   3.629819460006674*^9}, {3.6298194901459265`*^9, 3.6298195206811805`*^9}, {
   3.6298196059353304`*^9, 3.6298197214223332`*^9}, {3.6298214424336243`*^9, 
   3.6298214669324694`*^9}, {3.629821615464175*^9, 3.62982161773918*^9}, {
   3.629821767881694*^9, 3.6298218007117596`*^9}, {3.7670019325712566`*^9, 
   3.767001952068388*^9}, 3.767002511678125*^9, {3.767002585422539*^9, 
   3.767002646876587*^9}, {3.7670027091542053`*^9, 3.767002713455365*^9}, {
   3.767002823773355*^9, 3.767002857699437*^9}, {3.7670029515761995`*^9, 
   3.7670029594384484`*^9}, {3.7670030151143847`*^9, 3.767003026695181*^9}, {
   3.767004077752054*^9, 3.7670040787586403`*^9}, {3.7670041180466757`*^9, 
   3.7670042804674006`*^9}, 3.7940287284746866`*^9, {3.8757554657658195`*^9, 
   3.8757555100435486`*^9}, 3.8870143732272563`*^9, {3.895554774382067*^9, 
   3.8955547743900647`*^9}, 
   3.895555172201713*^9},ExpressionUUID->"21f8df74-d008-4560-b592-\
59d81d7698c8"]
}, Closed]],

Cell[CellGroupData[{

Cell["Einstein", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.6294767609205427`*^9, 
  3.6294767624605446`*^9}},ExpressionUUID->"7cbc090d-7a83-4153-ae68-\
cc167684801f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Einstein", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "either", " ", "input", " ", "the", " ", "coordinates", " ", "or", " ", 
    "their", " ", "corresponding", " ", "numbers"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Einstein", "[", 
      RowBox[{
       RowBox[{"\[Nu]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Nu]I", "]"}]}], ",", 
       RowBox[{"\[Beta]I_", "/;", 
        RowBox[{"TestIndices", "[", "\[Beta]I", "]"}]}], ",", "m_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
     RowBox[{"(", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "cooo", ",", "si", ",", "disp", ",", "RicciScalarT", ",", 
        "RicciTensorT", ",", "MetricT", ",", "op", ",", "\[Nu]T", ",", 
        "\[Beta]T"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"op", "=", 
        RowBox[{"OptionValue", "[", "EinsteinOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RicciScalarT", "=", 
        RowBox[{"RicciScalar", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "will", " ", "construct", " ", "Einstein", " ", "with", 
          " ", "abstract", " ", "indices", " ", "first"}], "..."}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"RicciTensorT", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"Ricci", "[", 
          RowBox[{
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Nu]T", ",", "\[Nu]I"}], "]"}], ",", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Beta]T", ",", "\[Beta]I"}], "]"}], ",", "m"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MetricT", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"Metric", "[", 
          RowBox[{
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Nu]T", ",", "\[Nu]I"}], "]"}], ",", 
           RowBox[{"ReplaceIndex", "[", 
            RowBox[{"\[Beta]T", ",", "\[Beta]I"}], "]"}], ",", "m"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mm", "=", 
        RowBox[{"RicciTensorT", "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MetricT", "/", "2"}], ")"}], "RicciScalarT"}]}]}], ";", 
       RowBox[{"mm", "=", 
        RowBox[{"op", "[", "mm", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         StyleBox[
          RowBox[{
          "Delete", " ", "the", " ", "format", " ", "of", " ", 
           "TooltipDisplay", " ", "for", " ", "Einstein", " ", "Tensor"}],
          FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"disp", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{
               "\"\<\!\(\*StyleBox[\"G\",FontSlant->\"Italic\"]\)\>\"", ",", 
                RowBox[{"UpOrDown", "[", "\[Nu]I", "]"}], ",", 
                RowBox[{"UpOrDown", "[", "\[Beta]I", "]"}]}], "}"}], "]"}], 
             "\[Rule]", "mm"}], ",", 
            RowBox[{"\"\<Coordinates\>\"", "\[Rule]", "cooo"}]}], "}"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "...", "then", " ", "we", " ", "will", " ", "evaluate", " ", "it", 
          " ", "with", " ", "specified", " ", "indices", " ", "which", " ", 
          "may", " ", "be", " ", "non"}], "-", "abstract"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"TensorType", "\[Rule]", "\"\<EinsteinTensor\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "TensorName", "\[Rule]", 
          "\"\<\!\(\*StyleBox[\"G\",FontSlant->\"Italic\"]\)\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"\[Nu]I", ",", "\[Beta]I"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Tooltip", " ", "for", " ", "Einstein"}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipDisplay", "\[Rule]", 
          RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"TooltipStyle", "\[Rule]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], ",", "True", 
            ",", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], "]"}]}], 
         RowBox[{"(*", 
          RowBox[{",", "\[IndentingNewLine]", 
           RowBox[{"TooltipDisplay", "\[Rule]", "disp"}]}], "*)"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorAssumption", "\[Rule]", " ", 
          RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"TensorOperator", "\[Rule]", 
          RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6294767558105354`*^9, 3.6294767579105387`*^9}, 
   3.629476819010624*^9, {3.629476855280675*^9, 3.6294768627906857`*^9}, {
   3.6294769420807962`*^9, 3.6294769782008467`*^9}, {3.6294770387409315`*^9, 
   3.629477203181162*^9}, {3.6294798110415907`*^9, 3.6294798411316333`*^9}, {
   3.6294799183917413`*^9, 3.6294799514217873`*^9}, {3.629479982661831*^9, 
   3.6294800828419714`*^9}, 3.6294819207671757`*^9, {3.629483491756879*^9, 
   3.629483500526891*^9}, {3.629483590307017*^9, 3.6294836211570597`*^9}, {
   3.629747897740327*^9, 3.629747915448358*^9}, {3.6297481546121883`*^9, 
   3.6297482356537313`*^9}, {3.629748275436802*^9, 3.629748305868657*^9}, {
   3.629753251057444*^9, 3.6297532569207797`*^9}, 3.836444871675889*^9, {
   3.8364449186542997`*^9, 3.8364449245081587`*^9}, {3.8364449612656736`*^9, 
   3.83644496355101*^9}, {3.83652621470687*^9, 3.8365262151608677`*^9}, {
   3.838194318651956*^9, 3.838194328878889*^9}, {3.8478400683664017`*^9, 
   3.8478400808462744`*^9}, {3.8757555360810723`*^9, 3.8757555641553893`*^9}, 
   3.8870143869214177`*^9, 3.887015669394334*^9, 3.8870157171937666`*^9, {
   3.895554774403056*^9, 3.8955547744070535`*^9}, 3.8955551722067127`*^9, {
   3.8966162069425187`*^9, 3.896616208014423*^9}, 
   3.8966166277006645`*^9},ExpressionUUID->"7f1ccae2-3c30-4371-8618-\
d91a4f17ca91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Determinant", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9},ExpressionUUID->"31e090b9-dd85-40b9-a7df-\
ce03fcde407b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Determinant", "[", "m_Tensor", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
   RowBox[{
    RowBox[{"Cases", "[", 
     RowBox[{"m", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"MetricDeterminant", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
       "mmm"}], 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", 
        RowBox[{"Determinant", " ", "one", " ", "layer"}]}], "*)"}], ",", 
      "1"}], "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "TensorForm"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Determinant", "[", 
    RowBox[{"m_Tensor", ",", "Tensor"}], "]"}], "/;", 
   RowBox[{"(", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"NonMetricTensor", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{"Determinant", "[", "m", "]"}], ",", 
    RowBox[{"Row", "[", 
     RowBox[{"{", 
      RowBox[{"\"\<|\>\"", ",", 
       RowBox[{"TensorName", "[", "m", "]"}], ",", "\"\<|\>\""}], "}"}], 
     "]"}], ",", 
    RowBox[{"CoordinateSystem", "\[Rule]", 
     RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
    RowBox[{"StartIndex", "\[Rule]", 
     RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
    RowBox[{"TooltipDisplay", "\[Rule]", " ", "Null"}], ",", 
    RowBox[{"TooltipStyle", "\[Rule]", " ", 
     RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorAssumption", "\[Rule]", " ", 
     RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
    RowBox[{"TensorOperator", "\[Rule]", " ", 
     RowBox[{"TensorOperator", "[", "m", "]"}]}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
  3.8757478168229427`*^9, 3.8757478170104313`*^9}, {3.875747869710776*^9, 
  3.8757478987658987`*^9}, {3.87575557445354*^9, 3.8757555815235987`*^9}, {
  3.887018713637618*^9, 3.8870187362742324`*^9}, {3.88701882766383*^9, 
  3.8870189409166346`*^9}, {3.8870190506997623`*^9, 3.887019050949607*^9}, {
  3.895555172209711*^9, 3.8955551722127094`*^9}, {3.8966162416384373`*^9, 
  3.8966162557192945`*^9}, {3.8966162866628656`*^9, 
  3.8966163053334227`*^9}},ExpressionUUID->"0d49aaa7-8277-4d46-b9c9-\
435647c290fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["OrthonormalFrameField", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.8594633251764164`*^9, 
   3.859463333056177*^9}},ExpressionUUID->"55230c28-b185-4766-80cb-\
5916481cf9ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["OrthonormalFrameField",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    StyleBox["Extract",
     FontColor->RGBColor[1, 0, 1]], " ", "from", " ", "a", " ", 
    StyleBox["metric",
     FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"OrthonormalFrameField", "[", "m_Tensor", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Extract", " ", "both", " ", 
     StyleBox["OrthonormalFrameField",
      FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
     StyleBox["InverseOrthonormalFrameField",
      FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
     StyleBox["list",
      FontColor->RGBColor[1, 0, 1]], " ", 
     RowBox[{"output", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"OrthonormalFrameField", "\[Rule]", "mmm_"}], ")"}], 
         "\[Rule]", "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}], ",", 
     RowBox[{
      RowBox[{"Cases", "[", 
       RowBox[{"m", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "mmm_"}], ")"}], 
         "\[Rule]", "mmm"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
      "\[RightDoubleBracket]"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.859463335019122*^9, 3.8594633391156645`*^9}, {3.859464367519883*^9, 
   3.8594643690732255`*^9}, {3.859507713580587*^9, 3.8595077139573507`*^9}, {
   3.8596023095771112`*^9, 3.859602322728838*^9}, {3.861138859121119*^9, 
   3.861138875501281*^9}, {3.861139044404683*^9, 3.8611390670508685`*^9}, {
   3.87574403265349*^9, 3.875744034950078*^9}, {3.875755593216878*^9, 
   3.875755602188178*^9}, 
   3.895555172215708*^9},ExpressionUUID->"a95930d0-217d-4427-a008-\
12e0a3b0dc8e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["OrthonormalFrameField",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Declare", " ", "OrthonormalFrameField", " ", "as", " ", "a", " ", 
    StyleBox["Tensor",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[
     RowBox[{"object", ".", " ", "Input"}],
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox["a",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox["metric",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[1, 0, 1]], 
    StyleBox[
     RowBox[{"w", "/", " ", "OrthonormalFrameField"}],
     FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"OrthonormalFrameField", "[", 
     RowBox[{
      RowBox[{"\[Mu]1_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]1", "]"}]}], ",", 
      RowBox[{"\[Mu]2_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]2", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Flatmetric", ",", "invonfft", ",", "onfft", ",", "invonffm", ",", 
        "onffm"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", 
        StyleBox["Flatmetric",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Flatmetric", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "fm_"}], ")"}], "\[Rule]", 
            "fm"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"onfft", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
            "\[Rule]", "onf"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
         "1", "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"invonfft", "=", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
             ")"}], "\[Rule]", "ionf"}], ",", "1"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"onffm", "=", 
        RowBox[{"TensorComponents", "[", "onfft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"invonffm", "=", 
        RowBox[{"TensorComponents", "[", "invonfft", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Declare", " ", 
         RowBox[{"w", "/", " ", 
          StyleBox["NonMetricTensor",
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"NonMetricTensor", "[", 
        RowBox[{"(*", 
         RowBox[{"Add", " ", "a", " ", 
          StyleBox["OverHat",
           FontColor->RGBColor[1, 0, 1]], " ", "for", " ", "first", " ", 
          RowBox[{"index", "."}]}], "*)"}], 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"OverHat", "[", 
             RowBox[{
             "\[Mu]1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
              "]"}], "//", 
            RowBox[{"(", 
             RowBox[{
             "\[Mu]1", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}],
              ")"}]}], ",", "\[Mu]2"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Its", " ", "TensorComponent", " ", "differs", " ", 
            RowBox[{"w", ".", "r", ".", "t"}], " ", 
            StyleBox[
             SubscriptBox[
              SuperscriptBox["\[CurlyEpsilon]", 
               OverscriptBox["a", "^"]], "b"],
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            SuperscriptBox["\[CurlyEpsilon]", 
             RowBox[{
              OverscriptBox["a", "^"], "b"}]],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox[
             SubscriptBox[
              SubscriptBox["\[CurlyEpsilon]", 
               OverscriptBox["a", "^"]], "b"],
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["or",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox[
              SuperscriptBox[
               SubscriptBox["\[CurlyEpsilon]", 
                OverscriptBox["a", "^"]], "b"],
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", "1"}], "&&", 
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", 
              RowBox[{"-", "1"}]}]}], ")"}], ",", 
           RowBox[{"(*", 
            StyleBox[
             SubscriptBox[
              SuperscriptBox["\[CurlyEpsilon]", 
               OverscriptBox["a", "^"]], "b"],
             FontColor->RGBColor[1, 0, 1]], "*)"}], "onffm", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", 
              RowBox[{"-", "1"}]}]}], ")"}], ",", 
           RowBox[{"(*", 
            StyleBox[
             RowBox[{
              SubscriptBox[
               SubscriptBox[
                StyleBox["\[CurlyEpsilon]",
                 FontColor->RGBColor[1, 0, 1]], 
                OverscriptBox["a", "^"]], "b"], "=", 
              RowBox[{
               SubscriptBox["\[Eta]", "ac"], 
               SubscriptBox[
                SuperscriptBox[
                 StyleBox["\[CurlyEpsilon]",
                  FontColor->RGBColor[1, 0, 1]], 
                 OverscriptBox["c", "^"]], "b"]}]}],
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[
             RowBox[{
              StyleBox["*",
               FontColor->RGBColor[1, 0, 1]], ")"}]]}], 
           RowBox[{"Flatmetric", ".", "onffm"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", 
              RowBox[{"-", "1"}]}], "&&", 
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", "1"}]}], ")"}], ",", 
           RowBox[{"(*", 
            StyleBox[
             SuperscriptBox[
              SubscriptBox["\[CurlyEpsilon]", 
               OverscriptBox["a", "^"]], "b"],
             FontColor->RGBColor[1, 0, 1]], "*)"}], "invonffm", ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]1", "]"}], "===", "1"}], "&&", 
             RowBox[{
              RowBox[{"Sgn", "[", "\[Mu]2", "]"}], "===", "1"}]}], ")"}], ",", 
           RowBox[{"(*", 
            StyleBox[
             RowBox[{
              SuperscriptBox["\[CurlyEpsilon]", 
               RowBox[{
                OverscriptBox["a", "^"], "b"}]], "=", 
              RowBox[{
               SuperscriptBox["\[Eta]", "ac"], 
               SuperscriptBox[
                SubscriptBox[
                 StyleBox["\[CurlyEpsilon]",
                  FontColor->RGBColor[1, 0, 1]], 
                 OverscriptBox["c", "^"]], "b"]}]}],
             FontColor->RGBColor[1, 0, 1]], "*)"}], 
           RowBox[{"Flatmetric", ".", "invonffm"}]}], "]"}], ",", 
         "\"\<\[CurlyEpsilon]\>\"", ",", 
         RowBox[{"CoordinateSystem", "\[Rule]", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
         RowBox[{"TooltipStyle", "\[Rule]", " ", 
          RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8596038964070253`*^9, 3.859603925518066*^9}, {
   3.8596045418323236`*^9, 3.8596045787998104`*^9}, {3.8596046297375183`*^9, 
   3.85960464509505*^9}, {3.859604838547741*^9, 3.8596048429860063`*^9}, {
   3.860069680577582*^9, 3.8600697491115823`*^9}, {3.860069809128106*^9, 
   3.8600699958960943`*^9}, {3.8600707987140965`*^9, 
   3.8600708276229396`*^9}, {3.8600709159052453`*^9, 3.8600709197903757`*^9}, 
   3.860071224435073*^9, {3.860071299365382*^9, 3.860071319425085*^9}, {
   3.8600713973703203`*^9, 3.8600713983938313`*^9}, {3.860071432945159*^9, 
   3.8600714494050827`*^9}, {3.8600714833254213`*^9, 
   3.8600715075550413`*^9}, {3.860071660435388*^9, 3.8600716789850674`*^9}, {
   3.8600717567213583`*^9, 3.8600717579950676`*^9}, {3.8600719208454685`*^9, 
   3.8600719616455045`*^9}, {3.8611389873711805`*^9, 
   3.8611390338411837`*^9}, {3.861139080130872*^9, 3.8611392960209627`*^9}, {
   3.8611393394309373`*^9, 3.861139444591175*^9}, {3.8611395013809657`*^9, 
   3.8611395376909866`*^9}, {3.8611399816967936`*^9, 3.8611399959312706`*^9}, 
   3.861140027652315*^9, {3.861140070991314*^9, 3.861140080791297*^9}, {
   3.8611424698671317`*^9, 3.8611425281325417`*^9}, {3.8611425629302006`*^9, 
   3.861142648906053*^9}, {3.8612291720969276`*^9, 3.861229174950161*^9}, {
   3.8612303391843367`*^9, 3.8612303553893957`*^9}, {3.8757556135227385`*^9, 
   3.8757556358427544`*^9}, {3.8955547744240427`*^9, 3.8955547744280405`*^9}, 
   3.895555172221701*^9, {3.897125884814992*^9, 3.897125903954294*^9}, 
   3.8993785019466133`*^9, {3.902823645204873*^9, 3.9028237227525187`*^9}, {
   3.952993829649548*^9, 
   3.9529938441230497`*^9}},ExpressionUUID->"31fa951b-fa09-4c1b-8761-\
c958895c180d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["OrthonormalFrameField",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Input", " ", "a", " ", 
    StyleBox["metric",
     FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
    StyleBox["FlatMetric",
     FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"OrthonormalFrameField", "[", 
       RowBox[{"m_Tensor", ",", "fm_List", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Trigger", " ", "Tensor", " ", 
       RowBox[{"code", ".", " ", 
        RowBox[{"See", ":", " ", 
         StyleBox[
          RowBox[{"OrthonormalFrameField", " ", "Tensor", " ", "part"}],
          FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
     RowBox[{"m", "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"FlatMetric", "\[Rule]", "fmm_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"FlatMetric", "\[Rule]", "fm"}], ")"}]}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"OrthonormalFrameField", "\[Rule]", "fmm_"}], ")"}], 
         "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"OrthonormalFrameField", "\[Rule]", 
           RowBox[{"OptionValue", "[", "OrthonormalFrameField", "]"}]}], 
          ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "fmm_"}], ")"}], 
         "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"InverseOrthonormalFrameField", "\[Rule]", 
           RowBox[{
           "OptionValue", "[", "InverseOrthonormalFrameField", "]"}]}], 
          ")"}]}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "onffop_"}], 
           ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], 
           ")"}]}], ")"}], ",", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TestOrthonormalFrameField", "\[Rule]", "checkonff_"}], 
           ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}]}], 
           ")"}]}], ")"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", "onffidx_"}], 
           ")"}], "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], 
           ")"}]}], ")"}]}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Declare", " ", "OrthonormalFrameField", " ", "as", " ", "a", " ", 
     StyleBox["Tensor",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     RowBox[{
      StyleBox["object",
       FontColor->RGBColor[1, 0, 1]], ".", 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], "Input"}], " ", "a", 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["metric",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[
      RowBox[{"w", "/", "o"}],
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox["OrthonormalFrameField",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], "and", 
     StyleBox[" ",
      FontColor->RGBColor[1, 0, 1]], 
     StyleBox[
      RowBox[{"FlatMetric", "."}],
      FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalFrameField", "[", 
      RowBox[{
       RowBox[{"\[Mu]1_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]1", "]"}]}], ",", 
       RowBox[{"\[Mu]2_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]2", "]"}]}], ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ",", "fm_List",
        ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "newm", "}"}], ",", 
       RowBox[{
        RowBox[{"newm", "=", 
         RowBox[{"OrthonormalFrameField", "[", 
          RowBox[{"m", ",", "fm", ",", 
           RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ",", 
           RowBox[{"TestOrthonormalFrameField", "\[Rule]", 
            RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"OrthonormalFrameFieldIndices", "\[Rule]", 
            RowBox[{
            "OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}], "===",
            "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"OrthonormalFrameField", "[", 
             RowBox[{"\[Mu]1", ",", "\[Mu]2", ",", 
              RowBox[{
              "newm", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{
            "newm", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "newm", "\[LeftDoubleBracket]", "5", "\[RightDoubleBracket]"}]}], 
           "}"}], ",", "True", ",", 
          RowBox[{"OrthonormalFrameField", "[", 
           RowBox[{"\[Mu]1", ",", "\[Mu]2", ",", 
            RowBox[{
            "newm", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}], 
           "]"}]}], "]"}]}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Second", " ", "strategy", " ", "of", " ", "ONFF"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"OrthonormalFrameField", "[", 
      RowBox[{
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ",", "eigens_List", 
       ",", "order_List", ",", 
       RowBox[{"FlatMetric", "\[Rule]", " ", "fm_List"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", "eigens", "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], "}"}]}], ")"}], 
       "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "order", "]"}], "===", 
         RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "fm", "]"}], "===", 
         RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ")"}]}], ")"}]}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Flatmetric", ",", "g", ",", "ginv", ",", "d", ",", "rotm", ",", 
        "valuesqrt", ",", "ONFFm", ",", "ONFFinvm", ",", "output", ",", 
        "onff", ",", "invonff", ",", "idx", ",", "matrix", ",", "onffop", ",",
         "cc", ",", "checkonff", ",", "tempm", ",", "ONFFt", ",", "ONFFinvt", 
        ",", "\[Alpha]", ",", "\[Mu]", ",", "coord", ",", "onffidx", ",", 
        "ONFFtidx", ",", "ONFFinvtidx", ",", "eigenvalue", ",", "eigenvector",
         ",", "i", ",", "Listt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"onffop", "=", 
        RowBox[{"OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"checkonff", "=", 
        RowBox[{"OptionValue", "[", "TestOrthonormalFrameField", "]"}]}], ";",
        "\[IndentingNewLine]", 
       RowBox[{"onffidx", "=", 
        RowBox[{"OptionValue", "[", "OrthonormalFrameFieldIndices", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"idx", "=", 
        RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"matrix", "=", 
        RowBox[{"TensorComponents", "[", "m", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"coord", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"idx", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SubMinus", "[", "_", "]"}], ",", 
             RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"g", "=", "matrix"}], ";", 
          RowBox[{"ginv", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
            ")"}]}]}], ",", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"idx", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
             RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"ginv", "=", "matrix"}], ";", 
          RowBox[{"g", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Inverse", "[", "matrix", "]"}], "//", "onffop"}], 
            ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "fm", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"eigenvalue", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"eigens", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", 
            RowBox[{
            "order", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"eigenvector", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"eigens", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", 
            RowBox[{
            "order", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "\[RightDoubleBracket]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatmetric", "=", 
        RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"rotm", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Normalize", "[", 
             RowBox[{
             "eigenvector", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "//", "onffop"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"valuesqrt", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sqrt", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"Flatmetric", ".", "eigenvalue"}], ")"}]}], ")"}], "//", 
         "onffop"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONFFm", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "valuesqrt", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], " ", 
             RowBox[{
             "rotm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
             ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], ")"}], "//", 
         "onffop"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONFFinvm", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Flatmetric", ".", "ONFFm", ".", "ginv"}], ")"}], "//", 
         "onffop"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Listt", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"List", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONFFtidx", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
              ")"}], "===", 
             RowBox[{"{", 
              RowBox[{"Symbol", ",", "Symbol"}], "}"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox[
              RowBox[{
              "onffidx", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "^"], "-"], ",", 
            SubscriptBox[
             RowBox[{
             "onffidx", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            SuperscriptBox[
             OverscriptBox["\[Alpha]", "^"], "-"], ",", 
            SubscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvtidx", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"onffidx", "=!=", "Null"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Head", "[", "#", "]"}], "&"}], "/@", "onffidx"}], 
              ")"}], "===", 
             RowBox[{"{", 
              RowBox[{"Symbol", ",", "Symbol"}], "}"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             RowBox[{"(", 
              OverscriptBox[
               RowBox[{
               "onffidx", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "^"], ")"}], "-"], ",", 
            SuperscriptBox[
             RowBox[{
             "onffidx", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", "True", ",", 
          RowBox[{"{", 
           RowBox[{
            SubscriptBox[
             OverscriptBox["\[Alpha]", "^"], "-"], ",", 
            SuperscriptBox["\[Mu]", "-"]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFt", "=", 
        RowBox[{"Listt", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "fmmmm_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
              "\[Rule]", "Nothing"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
               ")"}], "\[Rule]", "Nothing"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "oop_"}], 
               ")"}], "\[Rule]", "Nothing"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TestOrthonormalFrameField", "\[Rule]", "conf_"}], 
               ")"}], "\[Rule]", "Nothing"}], ","}], "*)"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", " ", 
            "Nothing"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "\"\<\[CurlyEpsilon]\>\""}], 
             ")"}]}], " ", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "ONFFtidx"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], "\[Rule]",
             " ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ONFFm"}], ")"}]}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MetricDeterminant", "\[Rule]", "md_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"ChristoffelComponents", "\[Rule]", "ccc_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RiemannComponents", "\[Rule]", "rc_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RicciComponents", "\[Rule]", "ric_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"RicciScalarInvariant", "\[Rule]", "rsi_"}], ")"}], 
             "\[Rule]", "Nothing"}], " ", ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
              "OrthonormalFrameFieldIndices", "\[Rule]", "onffidxxx_"}], 
              ")"}], "\[Rule]", "Nothing"}]}], " ", "*)"}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvt", "=", 
        RowBox[{"ONFFt", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idxx_"}], ")"}], "\[Rule]", " ", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "ONFFinvtidx"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "tc_"}], ")"}], "\[Rule]",
             " ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ONFFinvm"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"ONFFt", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Tensor", ",", "ONFFt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ONFFinvt", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Tensor", ",", "ONFFinvt"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"ONFFt", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
           "ONFFtidx", ",", "\[IndentingNewLine]", "ONFFm", ",", 
            "\"\<\[CurlyEpsilon]\>\"", ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", "coord"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"ONFFinvt", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
           "ONFFinvtidx", ",", "\[IndentingNewLine]", "ONFFinvm", ",", 
            "\"\<\[CurlyEpsilon]\>\"", ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", "coord"}]}], "]"}]}], 
         ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Replace", " ", 
         RowBox[{"w", "/", " ", "calculation"}], " ", 
         RowBox[{"result", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"tempm", "=", 
        RowBox[{"Listt", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "fmmmm_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onf_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFt"}], ")"}]}], 
           ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ionf_"}], 
             ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "ONFFinvt"}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "oop_"}], 
             ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameFieldOperator", "\[Rule]", "Null"}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TestOrthonormalFrameField", "\[Rule]", "conf_"}], ")"}],
             "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TestOrthonormalFrameField", "\[Rule]", "Null"}], 
             ")"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"tempm", "=", 
        RowBox[{"Apply", "[", 
         RowBox[{"Tensor", ",", "tempm"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"{", 
         RowBox[{"ONFFt", ",", "ONFFinvt", ",", "tempm"}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"checkonff", "===", "True"}], ",", 
         RowBox[{"output", "=", 
          RowBox[{"Append", "[", 
           RowBox[{
            RowBox[{"Append", "[", 
             RowBox[{"output", ",", "\[IndentingNewLine]", 
              RowBox[{"(*", 
               StyleBox[
                RowBox[{
                 SubscriptBox["g", "cd"], "=", 
                 RowBox[{
                  SubscriptBox[
                   SuperscriptBox[
                    StyleBox["\[CurlyEpsilon]",
                    FontColor->RGBColor[1, 0, 1]], 
                    OverscriptBox["a", "^"]], "c"], 
                  FormBox[
                   SubscriptBox["\[Eta]", "ab"],
                   TraditionalForm], 
                  SubscriptBox[
                   SuperscriptBox["\[CurlyEpsilon]", 
                    OverscriptBox["b", "^"]], "d"]}]}],
                FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Transpose", "[", "ONFFm", "]"}], ".", "Flatmetric",
                   ".", "ONFFm"}], "\[Equal]", "g"}], ")"}], "//", 
               "onffop"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SubscriptBox["\[Eta]", "cd"], "=", 
               RowBox[{
                SuperscriptBox[
                 SubscriptBox[
                  StyleBox["\[CurlyEpsilon]",
                   FontColor->RGBColor[1, 0, 1]], 
                  OverscriptBox["c", "^"]], "a"], 
                FormBox[
                 SubscriptBox["g", "ab"],
                 TraditionalForm], 
                SuperscriptBox[
                 SubscriptBox["\[CurlyEpsilon]", 
                  OverscriptBox["d", "^"]], "b"]}]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"ONFFinvm", ".", "g", ".", 
                 RowBox[{"Transpose", "[", "ONFFinvm", "]"}]}], "==", 
                "Flatmetric"}], ")"}], "//", "onffop"}], ")"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"OrthonormalFrameField", "[", 
        RowBox[{"m_Tensor", ",", "fm_List", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
            "tt"}]}], "]"}], "===", 
         RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "matrix", ",", "idx", ",", "eigens", ",", "Flatmetric", ",", "g", 
          ",", "ginv", ",", "d", ",", "rotm", ",", "valuesqrt", ",", "ONFFm", 
          ",", "ONFFinvm", ",", "op", ",", "mtemp", ",", "fmm", ",", "onff"}],
          "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"matrix", "=", 
          RowBox[{"m", "//", "TensorComponents"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"idx", "=", 
          RowBox[{"Indices", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"op", "=", 
          RowBox[{
          "OptionValue", "[", "OrthonormalFrameFieldOperator", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SubMinus", "[", "_", "]"}], ",", 
               RowBox[{"SubMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"g", "=", "matrix"}], ";", 
            RowBox[{"ginv", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inverse", "[", "matrix", "]"}], "//", "op"}], 
              ")"}]}]}], ",", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"SuperMinus", "[", "_", "]"}], ",", 
               RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"ginv", "=", "matrix"}], ";", 
            RowBox[{"g", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Inverse", "[", "matrix", "]"}], "//", "op"}], 
              ")"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Flatmetric", "=", 
          RowBox[{"DiagonalMatrix", "[", "fm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eigens", "=", 
          RowBox[{"Eigensystem", "[", "g", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Length", "[", "fm", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"rotm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Normalize", "[", 
               RowBox[{"eigens", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", "i"}], "\[RightDoubleBracket]"}], "]"}], "//",
               "op"}], ")"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"valuesqrt", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Sqrt", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{"Flatmetric", ".", 
               RowBox[{
               "eigens", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "//", "op"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFm", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "valuesqrt", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], " ", 
               RowBox[{
               "rotm", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "d"}], "}"}]}], "]"}], "//", 
            "op"}], ")"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"ONFFinvm", "=", 
          RowBox[{"Flatmetric", ".", "ONFFm", ".", "ginv"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"mtemp", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"m", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"FlatMetric", "\[Rule]", "fmm_"}], ")"}], "\[Rule]",
                  "fmm"}]}], "]"}], "===", 
              RowBox[{"{", "}"}]}], ")"}], ",", 
            RowBox[{"Append", "[", 
             RowBox[{"m", ",", 
              RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}]}], "]"}], ",", 
            "True", ",", 
            RowBox[{"m", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"FlatMetric", "\[Rule]", "fmm_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"FlatMetric", "\[Rule]", "Flatmetric"}], ")"}]}], 
              "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"mtemp", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}],
                 "\[Rule]", "onff"}]}], "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"ONFFm", ",", "ONFFinvm", ",", 
             RowBox[{"Append", "[", 
              RowBox[{
               RowBox[{"Append", "[", 
                RowBox[{"mtemp", ",", 
                 RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFm"}]}], 
                "]"}], ",", 
               RowBox[{
               "InverseOrthonormalFrameField", "\[Rule]", "ONFFinvm"}]}], 
              "]"}]}], "}"}], ",", "True", ",", 
           RowBox[{"{", 
            RowBox[{"ONFFm", ",", "ONFFinvm", ",", 
             RowBox[{"mtemp", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], 
                  ")"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"OrthonormalFrameField", "\[Rule]", "ONFFm"}], 
                  ")"}]}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                  "InverseOrthonormalFrameField", "\[Rule]", "onffinv_"}], 
                  ")"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                  "InverseOrthonormalFrameField", "\[Rule]", "ONFFinvm"}], 
                  ")"}]}]}], "}"}]}]}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.859463335019122*^9, 3.8594633391156645`*^9}, {3.859464367519883*^9, 
   3.859464391632702*^9}, {3.859464452769555*^9, 3.8594644880892754`*^9}, {
   3.859464618161083*^9, 3.8594646228577676`*^9}, {3.8595024952531805`*^9, 
   3.8595025289382677`*^9}, {3.8595027151916833`*^9, 
   3.8595027355233316`*^9}, {3.859502782470359*^9, 3.8595028008309746`*^9}, 
   3.8595028351596828`*^9, {3.8595029136000357`*^9, 3.8595029469893312`*^9}, {
   3.859502995133472*^9, 3.859503019173564*^9}, {3.85950364424656*^9, 
   3.8595036881333413`*^9}, {3.8595037643723617`*^9, 3.859503909492855*^9}, {
   3.8595039808743496`*^9, 3.859504012881143*^9}, {3.859504060345304*^9, 
   3.8595040724887753`*^9}, {3.8595041439218183`*^9, 3.859504197700467*^9}, 
   3.8595043124312744`*^9, {3.8595077167656107`*^9, 3.859507717094408*^9}, {
   3.859600932965207*^9, 3.8596009374764423`*^9}, {3.859602329842342*^9, 
   3.8596023339864054`*^9}, {3.8596023967141*^9, 3.859602578496228*^9}, {
   3.8606707705520325`*^9, 3.8606707736173344`*^9}, {3.8606708487181234`*^9, 
   3.860670927271941*^9}, {3.860671014351989*^9, 3.8606710808985023`*^9}, {
   3.8606711145220604`*^9, 3.860671134671993*^9}, {3.860671227842003*^9, 
   3.8606712485420094`*^9}, {3.8606713020420732`*^9, 
   3.8606713370420513`*^9}, {3.8606714331118574`*^9, 3.860671489222354*^9}, {
   3.8606719714548535`*^9, 3.86067198113586*^9}, {3.860673100105175*^9, 
   3.8606732721052413`*^9}, {3.860673448495226*^9, 3.8606734531652203`*^9}, {
   3.8606735346574316`*^9, 3.8606735897751274`*^9}, {3.860673632525326*^9, 
   3.860673707815308*^9}, {3.860673768745264*^9, 3.8606737911053715`*^9}, {
   3.861138827835783*^9, 3.8611388322112074`*^9}, {3.8611395634509287`*^9, 
   3.8611395938511086`*^9}, {3.8611396630104284`*^9, 
   3.8611396978812866`*^9}, {3.8611397817613583`*^9, 
   3.8611398627412343`*^9}, {3.861139962340995*^9, 3.8611399632012177`*^9}, {
   3.8611401006613417`*^9, 3.861140129951003*^9}, {3.8613325596625423`*^9, 
   3.8613326203092036`*^9}, {3.8655626600762515`*^9, 
   3.8655626641731806`*^9}, {3.8757557682682624`*^9, 
   3.8757557865109835`*^9}, {3.8955547744430313`*^9, 
   3.8955547744460297`*^9}, {3.895555172226699*^9, 3.895555172229698*^9}, {
   3.8991747485634193`*^9, 3.899174869149788*^9}, {3.899174902279078*^9, 
   3.899175088367309*^9}, {3.899175118860524*^9, 3.899175194555848*^9}, {
   3.899175307708144*^9, 3.8991753406418567`*^9}, {3.8991753744350386`*^9, 
   3.8991753870582623`*^9}, {3.8991754249139423`*^9, 3.899175481049362*^9}, 
   3.8991755364182334`*^9, {3.8991755939606557`*^9, 3.8991756078900743`*^9}, {
   3.899175638080456*^9, 3.8991756510804467`*^9}, 3.8991756879598117`*^9, {
   3.8991757479802556`*^9, 3.8991758130894265`*^9}, {3.899175847307356*^9, 
   3.8991758822258425`*^9}, {3.8991759128549757`*^9, 
   3.8991759339209986`*^9}, {3.899177335078223*^9, 3.899177335287097*^9}, 
   3.8991885530214653`*^9, 3.899377029018897*^9, {3.9028240668540874`*^9, 
   3.902824068793251*^9}, {3.952993846824641*^9, 3.952993851955427*^9}, {
   3.956199042606863*^9, 
   3.956199042650248*^9}},ExpressionUUID->"34349c22-e864-41cf-ad64-\
9e5af6463d2e"]
}, Closed]],

Cell[CellGroupData[{

Cell["ContractTensors (Abandoned, temporarily)", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6063295871603746`*^9, 
   3.6063295903404236`*^9}, {3.6719161852351665`*^9, 
   3.6719161897602363`*^9}, {3.6720788835848565`*^9, 3.672078885110944*^9}, 
   3.895549051059042*^9, {3.895549110830656*^9, 3.895549136083763*^9}, {
   3.896614300254381*^9, 3.8966143394381533`*^9}, 
   3.89661436961596*^9},ExpressionUUID->"1e02da7f-dadb-4d22-9e40-\
becc081cf057"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"New", " ", "ContractTensors"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ContractTensors", "[", 
      RowBox[{"wholeBunchOfStuff_", "/;", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TestRepeatedIndices", "[", "wholeBunchOfStuff", "]"}], ",", 
         "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{"TestRepeatedIndices", "::", "TestRepeatedIndicesFalse"}],
             ",", "wholeBunchOfStuff"}], "]"}], ";", "False"}]}], "]"}]}], 
      "]"}], ":=", 
     RowBox[{"TensorsProduct", "[", "wholeBunchOfStuff", "]"}]}], ";"}], 
   "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.895553990030738*^9, 3.8955539917922945`*^9}, {
   3.895556090116927*^9, 3.895556090120925*^9}, 
   3.896614319065859*^9},ExpressionUUID->"1deee915-48bf-442d-9992-\
412e1585ee56"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "main", " ", "function", " ", "for", " ", "ContractTensors", 
    " ", "to", " ", "act", " ", "as", " ", "a", " ", "TensorProduct", " ", 
    "of", " ", "sorts", " ", "for", " ", "Tensor", " ", "objects"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "Assigning", " ", "upvalues", " ", "for", " ", "Tensor", " ", 
      "involving", " ", "TensorProduct", " ", "yields", " ", "levels", " ", 
      "too", " ", "deep", " ", "for", " ", "MMA", " ", "to", " ", 
      "handle"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"that", "'"}], "s", " ", "why", " ", "we", " ", "need", " ", 
     "ContractTensors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"one", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ContractTensors", "[", "tt_Tensor", "]"}], ":=", "tt"}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{"tt_Tensor", ",", "Tensor"}], "]"}], ":=", "tt"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{
      RowBox[{
       RowBox[{"See", ":", " ", 
        RowBox[{"Operator", " ", "Linearity"}]}], " ", "&"}], " ", "Operator",
       " ", "ProductRule"}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Thread", " ", "over", " ", "Plus", " ", "automatically"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"ContractTensors", "[", "mm_Plus", "]"}], ":=", 
      RowBox[{"(", 
       RowBox[{"ContractTensors", "/@", "mm"}], ")"}]}], ";"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"TensorComponents", " ", "and", " ", "ContractTensors"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{"{", "}"}], "]"}], ":=", "1"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Pull", " ", "out", " ", "non"}], "-", 
     RowBox[{"Tensor", " ", "objects"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"mm_Times", "|", "mm_List"}], "/;", 
       RowBox[{"(", 
        RowBox[{"mm", "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"allTensors", ",", "therest", ",", "tensorplus", ",", 
         RowBox[{"Listmm", "=", 
          RowBox[{"(", 
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "mm"}], "]"}], ")"}]}], ",", "tp"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allTensors", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{"Listmm", ",", "_Tensor", ",", "1"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tensorplus", "=", 
         RowBox[{"List", "@@", 
          RowBox[{"Expand", "[", 
           RowBox[{"Times", "@@", 
            RowBox[{"Cases", "[", 
             RowBox[{"Listmm", ",", 
              RowBox[{"tp_Plus", "/;", 
               RowBox[{"(", 
                RowBox[{"!", 
                 RowBox[{"TestExpressionForm", "[", "tp", "]"}]}], ")"}]}], 
              ",", "1"}], "]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"therest", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"Listmm", ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"_Tensor", "|", "tp_Plus"}], "/;", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"TestExpressionForm", "[", "tp", "]"}]}], ")"}]}], 
             ")"}], ",", "1"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"tensorplus", "=!=", 
            RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"therest", " ", 
           RowBox[{"Plus", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ContractTensors", "[", 
                RowBox[{"allTensors", " ", "#"}], "]"}], "&"}], "/@", 
              "tensorplus"}], ")"}]}]}], ",", 
          RowBox[{"(", 
           RowBox[{"tensorplus", "===", 
            RowBox[{"{", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
          RowBox[{"therest", " ", 
           RowBox[{"ContractTensors", "[", "allTensors", "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", " ", "]"}], 
     "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"(", 
         RowBox[{"Head", "/@", 
          RowBox[{"(", 
           RowBox[{"List", "@@", "mm"}], ")"}]}], ")"}], "]"}], "=!=", 
       RowBox[{"{", "Tensor", "}"}]}], ")"}]}]}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"ContractTensors", " ", "ExpressionForm"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{"stuff_", "/;", 
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}], 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "stuff", "]"}], "=!=", "Plus"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "stuff", "]"}], "=!=", "Times"}], ")"}]}], 
        "*)"}], ")"}]}], "]"}], ":=", "stuff"}], ";", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Tensor", " ", "product", " ", "of", " ", "more", " ", "than", " ", "one",
      " ", "Tensors", " ", "with", " ", "same", " ", "CoordinateSystem"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Case", " ", "1"}], ":", " ", 
     RowBox[{
     "Every", " ", "Tensor", " ", "in", " ", "the", " ", "product", " ", 
      "has", " ", "the", " ", "same", " ", "coordinate", " ", "system"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"TensorComponents", " ", "and", " ", "ContractTensors"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"tt_Times", "|", "tt_List"}], "/;", 
       RowBox[{"(", 
        RowBox[{"tt", "=!=", 
         RowBox[{"{", "}"}]}], ")"}]}], ")"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensorproduct", ",", "allindices", ",", "tensornames", ",", 
         RowBox[{"scalartensor", "=", "1"}], ",", 
         RowBox[{"othertensor", "=", "1"}], ",", 
         RowBox[{"listtt", "=", 
          RowBox[{"Apply", "[", 
           RowBox[{"List", ",", "tt"}], "]"}]}], ",", "ii", ",", "aaa", ",", 
         "bbb"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"listtt", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"aaa_", "/;", 
              RowBox[{"TestScalarTensor", "[", "aaa", "]"}]}], ",", 
             RowBox[{"(", 
              RowBox[{"bbb_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Head", "[", "bbb", "]"}], "===", "Tensor"}], 
                ")"}]}], 
              RowBox[{"(*", 
               RowBox[{"||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Head", "[", "bbb", "]"}], "===", "Plus"}], ")"}]}],
                "*)"}], ")"}]}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"ContractTensors", "[", 
          RowBox[{"listtt", ",", "Tensor"}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"listtt", ",", 
           RowBox[{"{", "bbb_Tensor", "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
         "listtt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
         ",", "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RemoveUnderBarredIndices", "[", 
                 RowBox[{"Indices", "[", 
                  RowBox[{
                  "listtt", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "]"}], "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"scalartensor", "=", 
               RowBox[{"scalartensor", " ", 
                RowBox[{"TensorComponents", "[", 
                 RowBox[{
                 "listtt", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RemoveUnderBarredIndices", "[", 
                 RowBox[{"Indices", "[", 
                  RowBox[{
                  "listtt", "\[LeftDoubleBracket]", "ii", 
                   "\[RightDoubleBracket]"}], "]"}], "]"}], "=!=", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"othertensor", "=", 
               RowBox[{"othertensor", " ", 
                RowBox[{
                "listtt", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"ii", ",", "1", ",", 
              RowBox[{"Length", "[", "listtt", "]"}]}], "}"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tensorproduct", "=", 
           RowBox[{"scalartensor", " ", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Head", "[", "othertensor", "]"}], "===", "Times"}], 
               ")"}], ",", 
              RowBox[{"TensorProduct", "[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "/@", 
                  RowBox[{"(", 
                   RowBox[{"List", "@@", "othertensor"}], ")"}]}], ")"}]}], 
               "]"}], ",", "True", ",", 
              RowBox[{"TensorComponents", "[", "othertensor", "]"}]}], 
             "]"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Join", " ", "all", " ", "indices", " ", "to", " ", "form", " ", 
            "index", " ", "structure", " ", "of", " ", "Tensor", " ", 
            "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"allindices", "=", 
           RowBox[{"Join", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{"Indices", "/@", 
               RowBox[{"(", 
                RowBox[{"List", "@@", "othertensor"}], ")"}]}], ")"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Tensor", " ", "all", " ", "the", " ", "names"}], " ", 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"tensornames", "=", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"(*", 
                RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}]}], "]"}]}], 
            ";"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"tensornames", "=", 
           RowBox[{"TensorName", "[", "tt", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
            "properties", " ", "of", " ", "the", " ", "first", " ", 
            "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "listtt", ")"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
               ")"}]}]}], "}"}]}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}], 
     "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
      RowBox[{"(*", " ", 
       RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Head", "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
          RowBox[{"{", "Tensor", "}"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Head", "/@", 
              RowBox[{"(", 
               RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"Tensor", ",", "Plus"}], "}"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Head", "/@", 
              RowBox[{"(", 
               RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
            RowBox[{"{", "Plus", "}"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Head", "/@", 
              RowBox[{"(", 
               RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"Plus", ",", "Tensor"}], "}"}]}], ")"}]}], "*)"}], ")"}],
        "&&", 
       RowBox[{"(*", " ", 
        RowBox[{
        "all", " ", "coordinate", " ", "systems", " ", "are", " ", "the", " ",
          "same"}], " ", "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Coordinates", "/@", 
            RowBox[{"Cases", "[", 
             RowBox[{"tt", ",", 
              RowBox[{"Tensor", "[", "___", "]"}]}], "]"}]}], "]"}], "]"}], "===",
          "1"}], ")"}]}], 
      RowBox[{"(*", 
       RowBox[{"&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"no", " ", "Metrics"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "tt", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorType", "\[Rule]", "xx_"}], ")"}], "\[Rule]", 
                "xx"}], ",", "\[Infinity]"}], "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<Metric\>\"", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], "*)"}], ")"}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Case", " ", "2"}], ":", " ", 
     RowBox[{
     "Not", " ", "All", " ", "Tensors", " ", "Have", " ", "Same", " ", 
      "Coordinate", " ", "Systems"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", "tt_Times", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"tensorproduct", ",", "test", ",", "t1", ",", "t2"}], "}"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "two", " ", "Tensors", " ", "are", " ", "considered", " ", "the", 
          " ", "same", " ", "if", " ", "their", " ", "Coordinates", " ", 
          "are", " ", "the", " ", "same"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Coordinates", " ", "must", " ", "be", " ", "exactly", " ", "the", 
          " ", 
          RowBox[{"same", " ", "--"}], " ", "including", " ", "order"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"test", "[", 
           RowBox[{"t1_Tensor", ",", "t2_Tensor"}], "]"}], ":=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Coordinates", "[", "t1", "]"}], "===", 
            RowBox[{"Coordinates", "[", "t2", "]"}]}], ")"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "group", " ", "Tensors", " ", "according", " ", "to", " ", 
           "whether", " ", "they", " ", "have", " ", "the", " ", "same", " ", 
           "Coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"tensorproduct", "=", 
          RowBox[{"Gather", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}], ",", "test"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Only", " ", "ContractTensors", " ", "on", " ", "Tensors", " ", "w",
            " ", "the", " ", "same", " ", "Coordinates"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"ContractTensors", "[", 
              RowBox[{"Times", "@@", "#"}], "]"}], "&"}], "/@", 
            "tensorproduct"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
        RowBox[{"(*", " ", 
         RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", 
         "*)"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Union", "[", 
            RowBox[{"Head", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
           RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
         RowBox[{"(*", " ", 
          RowBox[{
          "not", " ", "all", " ", "coordinate", " ", "systems", " ", "are", 
           " ", "the", " ", "same"}], " ", "*)"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Union", "[", 
             RowBox[{"Coordinates", "/@", 
              RowBox[{"Cases", "[", 
               RowBox[{"tt", ",", 
                RowBox[{"Tensor", "[", "___", "]"}]}], "]"}]}], "]"}], "]"}], 
           ">", "1"}], ")"}]}], ")"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Wei", " ", 
         RowBox[{"Hao", "'"}], "s", " ", "ContractTensors"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
          RowBox[{"ContractTensors", "[", 
           RowBox[{"tt_List", "/;", 
            RowBox[{"(", 
             RowBox[{"tt", "=!=", 
              RowBox[{"{", "}"}]}], ")"}]}], "]"}], ":=", 
          RowBox[{
           RowBox[{"Module", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "tensorproduct", ",", "allindices", ",", "tensornames", ",", 
               RowBox[{"scalartensor", "=", "1"}], ",", 
               RowBox[{"othertensor", "=", "1"}], ",", "ii", ",", "aaa", ",", 
               "bbb"}], "}"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"MatchQ", "[", 
                RowBox[{"tt", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"aaa_", "/;", 
                    RowBox[{"TestScalarTensor", "[", "aaa", "]"}]}], ",", 
                   RowBox[{"(", 
                    RowBox[{"bbb_", "/;", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Head", "[", "bbb", "]"}], "===", "Tensor"}], 
                    ")"}], "||", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Head", "[", "bbb", "]"}], "===", "Plus"}], 
                    ")"}]}]}], ")"}]}], "}"}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"ContractTensors", "[", 
                RowBox[{"tt", ",", "Tensor"}], "]"}], ",", 
               "\[IndentingNewLine]", "True", ",", "\[IndentingNewLine]", 
               RowBox[{"(*", " ", 
                RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], 
                " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Do", "[", 
                 RowBox[{
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    "tt", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}], "===", 
                    RowBox[{"{", "}"}]}], ")"}], ",", 
                    RowBox[{"scalartensor", "=", 
                    RowBox[{"scalartensor", " ", 
                    RowBox[{
                    "tt", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}], ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Indices", "[", 
                    RowBox[{
                    "tt", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}], "]"}], "=!=", 
                    RowBox[{"{", "}"}]}], ")"}], ",", 
                    RowBox[{"othertensor", "=", 
                    RowBox[{"othertensor", " ", 
                    RowBox[{
                    "tt", "\[LeftDoubleBracket]", "ii", 
                    "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"ii", ",", "1", ",", 
                    RowBox[{"Length", "[", "tt", "]"}]}], "}"}]}], "]"}], ";",
                 "\[IndentingNewLine]", 
                RowBox[{"tensorproduct", "=", 
                 RowBox[{"scalartensor", " ", 
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Head", "[", "othertensor", "]"}], "===", 
                    "Times"}], ")"}], ",", 
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "/@", 
                    RowBox[{"(", 
                    RowBox[{"List", "@@", "othertensor"}], ")"}]}], ")"}]}], 
                    "]"}], ",", "True", ",", 
                    RowBox[{"TensorComponents", "[", "othertensor", "]"}]}], 
                   "]"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "Join", " ", "all", " ", "indices", " ", "to", " ", "form", 
                  " ", "index", " ", "structure", " ", "of", " ", "Tensor", 
                  " ", "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{"Indices", "/@", 
                    RowBox[{"(", "tt", ")"}]}], ")"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"Tensor", " ", "all", " ", "the", " ", "names"}], 
                 " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{"tensornames", "=", 
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(*", 
                    RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"(", "tt", ")"}]}], ")"}]}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
                  "properties", " ", "of", " ", "the", " ", "first", " ", 
                  "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{
                 "tt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "/.", 
                 RowBox[{"{", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], 
                    "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}],
                    ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                    "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
                    ")"}]}]}], "}"}]}]}]}], "]"}]}], "\[IndentingNewLine]", 
            "]"}], "/;", 
           RowBox[{"(", 
            RowBox[{"(*", " ", 
             RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
            RowBox[{"(*", " ", 
             RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", 
             "*)"}], 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Head", "/@", "tt"}], "]"}], "===", 
                 RowBox[{"{", "Tensor", "}"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Head", "/@", "tt"}], "]"}], "===", 
                 RowBox[{"{", 
                  RowBox[{"Tensor", ",", "Plus"}], "}"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Head", "/@", "tt"}], "]"}], "===", 
                 RowBox[{"{", "Plus", "}"}]}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Union", "[", 
                  RowBox[{"Head", "/@", "tt"}], "]"}], "===", 
                 RowBox[{"{", 
                  RowBox[{"Plus", ",", "Tensor"}], "}"}]}], ")"}]}], ")"}], "&&", 
             RowBox[{"(*", " ", 
              RowBox[{
              "all", " ", "coordinate", " ", "systems", " ", "are", " ", 
               "the", " ", "same"}], " ", "*)"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"Union", "[", 
                 RowBox[{"Coordinates", "/@", 
                  RowBox[{"Cases", "[", 
                   RowBox[{"tt", ",", 
                    RowBox[{"Tensor", "[", "___", "]"}]}], "]"}]}], "]"}], 
                "]"}], "===", "1"}], ")"}]}], ")"}]}]}], ";"}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TensorForm"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ContractTensors", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"tt_Times", "|", "tt_List"}], ")"}], ",", "Tensor"}], 
        "]"}]}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "tensorproduct", ",", "allindices", ",", "tensornames", ",", 
          "output", ",", 
          RowBox[{"scalartensor", "=", "1"}], ",", 
          RowBox[{"othertensor", "=", "1"}], ",", 
          RowBox[{"listtt", "=", 
           RowBox[{"Apply", "[", 
            RowBox[{"List", ",", "tt"}], "]"}]}], ",", "ii"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                 "listtt", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}], "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"scalartensor", "=", 
              RowBox[{"scalartensor", " ", 
               RowBox[{"TensorComponents", "[", 
                RowBox[{
                "listtt", "\[LeftDoubleBracket]", "ii", 
                 "\[RightDoubleBracket]"}], "]"}]}]}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", 
                 RowBox[{
                 "listtt", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}], "]"}], "=!=", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"othertensor", "=", 
              RowBox[{"othertensor", " ", 
               RowBox[{
               "listtt", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"ii", ",", "1", ",", 
             RowBox[{"Length", "[", "listtt", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"tensorproduct", "=", 
          RowBox[{"scalartensor", " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "othertensor", "]"}], "===", "Times"}], 
              ")"}], ",", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "/@", 
                 RowBox[{"(", 
                  RowBox[{"List", "@@", "othertensor"}], ")"}]}], ")"}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"TensorComponents", "[", "othertensor", "]"}]}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Join", " ", "all", " ", "indices", " ", "to", " ", "form", " ", 
           "index", " ", "structure", " ", "of", " ", "Tensor", " ", 
           "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"allindices", "=", 
          RowBox[{"Join", "[", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{"Indices", "/@", 
              RowBox[{"(", 
               RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Tensor", " ", "all", " ", "the", " ", "names"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"tensornames", "=", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(*", 
               RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"TensorName", "[", "#", "]"}], "&"}], "/@", 
                RowBox[{"(", "listtt", ")"}]}], ")"}]}], "]"}]}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"tensornames", "=", 
          RowBox[{"TensorName", "[", "tt", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
           "properties", " ", "of", " ", "the", " ", "first", " ", "Tensor"}],
           " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"output", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "listtt", ")"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "/.", 
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], ",",
              "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
               ")"}]}]}], "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"TestExpressionForm", "[", "output", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", "listtt", ")"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "/.", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], 
               ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", 
                  RowBox[{"{", "}"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}],
               "}"}]}], ")"}], ",", "True", ",", "output"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
       RowBox[{"(*", " ", 
        RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", 
        "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"Head", "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
          RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{
         "all", " ", "coordinate", " ", "systems", " ", "are", " ", "the", 
          " ", "same"}], " ", "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"Coordinates", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "]"}], "===", 
          "1"}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"&&", 
          RowBox[{"(", 
           RowBox[{"(*", " ", 
            RowBox[{"no", " ", "Metrics"}], " ", "*)"}], 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{"Union", "[", 
               RowBox[{"Cases", "[", 
                RowBox[{
                 RowBox[{"{", "tt", "}"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"TensorType", "\[Rule]", "xx_"}], ")"}], "\[Rule]",
                   "xx"}], ",", "\[Infinity]"}], "]"}], "]"}], ",", 
              RowBox[{"{", "\"\<Metric\>\"", "}"}]}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestScalarTensor", "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
          RowBox[{"{", "False", "}"}]}], ")"}]}], ")"}]}]}]}], ";", 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "TensorForm"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ContractTensors", "[", 
     RowBox[{
      RowBox[{"Times", "[", 
       RowBox[{
        RowBox[{"scalar_", "/;", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}], ",",
         "t_Tensor"}], "]"}], ",", "Tensor"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"t", "/.", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
          "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TensorComponents", "[", "scalar", "]"}], " ", "mx"}], 
             ")"}]}], ")"}]}], " ", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"TensorNameNoPart", "[", "scalar", "]"}], "=!=", 
                  RowBox[{"{", "}"}]}], ",", 
                 RowBox[{"TensorName", "[", "scalar", "]"}], ",", "True", ",", 
                 RowBox[{"ToString", "[", 
                  RowBox[{"scalar", ",", "InputForm"}], "]"}]}], "]"}], "<>", 
               "tn"}]}], ")"}]}]}], "*)"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[RuleDelayed]", 
          RowBox[{"(", 
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{"(*", "TimesScalar", "*)"}], 
            RowBox[{"TensorName", "[", 
             RowBox[{"scalar", " ", "t"}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TensorName", "[", "scalar", "]"}], "[", "tn", "]"}], 
             ")"}], "*)"}], ")"}]}]}], "}"}], "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"ContractTensors", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"List", "[", 
            RowBox[{
             RowBox[{"scalar_", "/;", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"TestExpressionForm", "[", "scalar", "]"}], ")"}]}]}],
              ",", 
             RowBox[{"(", 
              RowBox[{"t_Tensor", "|", "t_Plus"}], ")"}]}], "]"}], "|", 
           RowBox[{"List", "[", 
            RowBox[{"t_Tensor", ",", 
             RowBox[{"scalar_", "/;", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TestScalarTensor", "[", "scalar", "]"}], ")"}], "||", 
               RowBox[{"(", 
                RowBox[{"TestExpressionForm", "[", "scalar", "]"}], 
                ")"}]}]}]}], "]"}]}], ")"}], ",", "Tensor"}], "]"}]}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "t", "]"}], "===", "Tensor"}], ")"}], ",", 
         RowBox[{"t", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"TensorComponents", "[", "scalar", "]"}], " ", 
                 "mx"}], ")"}]}], ")"}]}], " ", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", 
               RowBox[{"(*", "TimesScalar", "*)"}], 
               RowBox[{"TensorName", "[", 
                RowBox[{"scalar", " ", "t"}], "]"}]}], ")"}]}]}], "}"}]}], 
         ",", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "t", "]"}], "===", "Plus"}], ")"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"tp", "=", 
           RowBox[{"TensorPlus", "[", "t", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"tp", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"TensorComponents", "[", "scalar", "]"}], " ", 
                  "mx"}], ")"}]}], ")"}]}], " ", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", 
                RowBox[{"TimesScalarTensorName", "[", 
                 RowBox[{"scalar", " ", "t"}], "]"}]}], ")"}]}]}], 
            "}"}]}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}]}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606329772953229*^9, 3.6063298493684025`*^9}, {
   3.6063299122113686`*^9, 3.6063299142989006`*^9}, {3.6063299569095554`*^9, 
   3.6063300075653334`*^9}, {3.606330261673237*^9, 3.606330262978257*^9}, {
   3.606330304518895*^9, 3.60633030614392*^9}, {3.6063303677518663`*^9, 
   3.6063304884247203`*^9}, {3.606330565357402*^9, 3.6063305711234903`*^9}, {
   3.60633078917634*^9, 3.606330809641155*^9}, {3.6063333733005404`*^9, 
   3.606333437622528*^9}, {3.60633358418828*^9, 3.6063335862283115`*^9}, {
   3.6063336180318003`*^9, 3.606333659233933*^9}, {3.6063338496803584`*^9, 
   3.6063338510053787`*^9}, {3.6063339010896482`*^9, 
   3.6063339433767977`*^9}, {3.6063459037446346`*^9, 
   3.6063459108190393`*^9}, {3.6063470816620073`*^9, 3.606347084600176*^9}, {
   3.6063471348460493`*^9, 3.606347160693528*^9}, {3.6063472655665264`*^9, 
   3.606347266261566*^9}, {3.6063473812891455`*^9, 3.6063474203563795`*^9}, {
   3.606347567858816*^9, 3.60634765760695*^9}, {3.6063478667949142`*^9, 
   3.6063478904042645`*^9}, {3.606347967654683*^9, 3.6063479692917767`*^9}, {
   3.6063480783310137`*^9, 3.6063480791370597`*^9}, {3.6063481440287714`*^9, 
   3.606348171198325*^9}, {3.606348209843536*^9, 3.606348210352565*^9}, {
   3.606348281718647*^9, 3.606348320320855*^9}, 3.606348411957096*^9, {
   3.606348678957368*^9, 3.6063487769929748`*^9}, {3.6063488086487856`*^9, 
   3.6063488224615755`*^9}, {3.606348896829829*^9, 3.606348955287173*^9}, {
   3.606349002586878*^9, 3.6063490056820555`*^9}, {3.6063490685596514`*^9, 
   3.60634912641096*^9}, {3.6063491642251234`*^9, 3.60634938516376*^9}, {
   3.6063494539866967`*^9, 3.6063495452039137`*^9}, {3.6063497017798696`*^9, 
   3.6063497046480336`*^9}, {3.6063497474284806`*^9, 3.606349753815846*^9}, {
   3.606349792106036*^9, 3.606349818879567*^9}, {3.6063616952520213`*^9, 
   3.6063616984592047`*^9}, {3.6063618804956164`*^9, 3.606361897570593*^9}, {
   3.606492841870088*^9, 3.6064928438422008`*^9}, {3.6064962239465313`*^9, 
   3.606496225999649*^9}, {3.606496479306137*^9, 3.606496493996978*^9}, {
   3.6064970212291336`*^9, 3.6064970214301453`*^9}, {3.606497496140297*^9, 
   3.6064975034017124`*^9}, {3.606497719274008*^9, 3.606497745201254*^9}, {
   3.60649778301572*^9, 3.6064978204869857`*^9}, {3.6064978658674655`*^9, 
   3.60649789127991*^9}, {3.606498026750548*^9, 3.6064980272029486`*^9}, {
   3.60649824976854*^9, 3.60649830107703*^9}, {3.6065023945773077`*^9, 
   3.606502420385784*^9}, {3.6065024677544937`*^9, 3.6065024712686944`*^9}, {
   3.606502586737299*^9, 3.6065025869273095`*^9}, {3.606502681188701*^9, 
   3.6065027172807655`*^9}, {3.6065028851733685`*^9, 
   3.6065028905986786`*^9}, {3.6065030521409187`*^9, 3.606503062357503*^9}, {
   3.606508021326345*^9, 3.6065080567183695`*^9}, {3.6065743687961006`*^9, 
   3.606574371900506*^9}, {3.6065756553826823`*^9, 3.6065756693354807`*^9}, {
   3.6065758098195157`*^9, 3.6065758406842813`*^9}, {3.6065763172855415`*^9, 
   3.6065763489863544`*^9}, {3.630042363477578*^9, 3.6300423670343847`*^9}, {
   3.6300424077473564`*^9, 3.630042465354558*^9}, {3.6300934477721934`*^9, 
   3.630093522495831*^9}, {3.630094092095019*^9, 3.630094095389125*^9}, {
   3.6716490557745323`*^9, 3.671649148969096*^9}, {3.6716491832735558`*^9, 
   3.67164918564476*^9}, {3.6716492430216613`*^9, 3.671649302114565*^9}, 
   3.6716493878991156`*^9, {3.6716496042402954`*^9, 3.6716496327415457`*^9}, {
   3.6716496704936123`*^9, 3.6716497000868635`*^9}, {3.671649732909322*^9, 
   3.6716498029378443`*^9}, {3.6716498850251884`*^9, 3.671649888800395*^9}, {
   3.6716533150660057`*^9, 3.67165333355379*^9}, {3.67165346507331*^9, 
   3.671653501148864*^9}, {3.671653731442401*^9, 3.671653735527464*^9}, {
   3.671653856796827*^9, 3.671653922690339*^9}, {3.671653975433649*^9, 
   3.6716540156192665`*^9}, {3.671654205882189*^9, 3.6716542205724144`*^9}, {
   3.6716542647380924`*^9, 3.6716542931035285`*^9}, {3.6716628891344976`*^9, 
   3.671662891106008*^9}, {3.671662928315199*^9, 3.6716629379147425`*^9}, {
   3.671663337672762*^9, 3.671663340470172*^9}, {3.671663586568463*^9, 
   3.67166358879359*^9}, {3.671664326909501*^9, 3.671664354767865*^9}, {
   3.6716643960802593`*^9, 3.6716644206539197`*^9}, {3.671664455045695*^9, 
   3.6716644598539047`*^9}, 3.671668348717533*^9, {3.67166940497793*^9, 
   3.6716694062354493`*^9}, {3.6716697409767904`*^9, 
   3.6716697491644163`*^9}, {3.671670260591355*^9, 3.6716702677774687`*^9}, {
   3.6716703178152647`*^9, 3.6716704406677046`*^9}, {3.671670547252713*^9, 
   3.6716705511746206`*^9}, {3.6716705975868196`*^9, 3.6716706506529217`*^9}, 
   3.671670691781802*^9, {3.6716711420602818`*^9, 3.6716711438037853`*^9}, {
   3.6716721373735857`*^9, 3.6716721397809896`*^9}, {3.6716721968133154`*^9, 
   3.6716722030946274`*^9}, {3.671674884611085*^9, 3.6716748950414047`*^9}, {
   3.6716749358214846`*^9, 3.671674986872879*^9}, {3.672023571713766*^9, 
   3.6720235921015797`*^9}, {3.6720237902696238`*^9, 3.672023797657237*^9}, {
   3.6720238621732283`*^9, 3.6720238625282335`*^9}, {3.672025898698493*^9, 
   3.6720259223658466`*^9}, {3.672025985067433*^9, 3.672026002832449*^9}, {
   3.6720302380254917`*^9, 3.672030242315737*^9}, {3.672030584243294*^9, 
   3.672030586584428*^9}, {3.672030700002915*^9, 3.6720307203640795`*^9}, {
   3.672031358612585*^9, 3.6720313670460677`*^9}, 3.6720314142997704`*^9, 
   3.672031877663273*^9, {3.672031915249423*^9, 3.6720319291212163`*^9}, 
   3.672032037805433*^9, {3.672032160103428*^9, 3.672032174159232*^9}, {
   3.6720322045769715`*^9, 3.6720322061960645`*^9}, {3.6720322664125085`*^9, 
   3.672032274095948*^9}, 3.6720323695634084`*^9, {3.6720719691033707`*^9, 
   3.67207199967612*^9}, {3.672072593961111*^9, 3.6720726088159604`*^9}, {
   3.672072717332167*^9, 3.6720727660309525`*^9}, {3.6720728495577297`*^9, 
   3.6720728586372495`*^9}, {3.6720730108519554`*^9, 
   3.6720730188294115`*^9}, {3.672073214825622*^9, 3.672073238480975*^9}, {
   3.672075664525737*^9, 3.6720756724091883`*^9}, 3.672075703583971*^9, {
   3.6720757598561897`*^9, 3.6720757603462176`*^9}, {3.6720759492400217`*^9, 
   3.672075954471321*^9}, {3.6720760184919825`*^9, 3.6720760227002234`*^9}, {
   3.672076055784116*^9, 3.672076069635908*^9}, {3.67207611163431*^9, 
   3.6720761768690414`*^9}, {3.672076220120515*^9, 3.6720762243667583`*^9}, {
   3.672076443840311*^9, 3.67207644871459*^9}, {3.6720765053858314`*^9, 
   3.6720766007942886`*^9}, {3.672076638323435*^9, 3.6720766742314887`*^9}, {
   3.6720767334828777`*^9, 3.672076735163974*^9}, {3.672077330629033*^9, 
   3.672077339607546*^9}, {3.6720773886563516`*^9, 3.672077439272247*^9}, {
   3.672077478478489*^9, 3.67207752779731*^9}, {3.6720776826981697`*^9, 
   3.6720777657409196`*^9}, {3.67259221230241*^9, 3.672592213631814*^9}, {
   3.672592246863079*^9, 3.6725922552310953`*^9}, {3.672713838187889*^9, 
   3.6727138384078894`*^9}, 3.6727723545654783`*^9, {3.6728107212659287`*^9, 
   3.672810847889171*^9}, {3.673039563370195*^9, 3.673039568474806*^9}, 
   3.6730396480719953`*^9, {3.673039718617352*^9, 3.673039731878384*^9}, {
   3.673039893546356*^9, 3.673039937360453*^9}, {3.673039971301431*^9, 
   3.673039983822462*^9}, {3.6730400218748465`*^9, 3.67304006809785*^9}, {
   3.6730488891487384`*^9, 3.673048903101474*^9}, {3.8066410523233604`*^9, 
   3.806641086979685*^9}, {3.806645464856251*^9, 3.8066454763488307`*^9}, {
   3.806645716494006*^9, 3.80664575256258*^9}, {3.8066458742097673`*^9, 
   3.806645890861457*^9}, {3.806645950546249*^9, 3.8066459551109624`*^9}, {
   3.806647127492586*^9, 3.8066471843851595`*^9}, {3.8066620799645214`*^9, 
   3.806662260436735*^9}, {3.8066623367623672`*^9, 3.80666242594937*^9}, {
   3.8066626488643503`*^9, 3.806662733715821*^9}, {3.8066658500062895`*^9, 
   3.8066658516419516`*^9}, {3.840774223694127*^9, 3.8407742547135305`*^9}, {
   3.868579518561637*^9, 3.8685795403057127`*^9}, {3.8685795948309183`*^9, 
   3.8685796616240883`*^9}, 3.8685800597904935`*^9, {3.869098735522915*^9, 
   3.869098743841112*^9}, {3.869098775986576*^9, 3.8690987866501403`*^9}, {
   3.8691006690467596`*^9, 3.8691006998368073`*^9}, {3.869103177146164*^9, 
   3.8691031960336475`*^9}, {3.869103267783539*^9, 3.8691033021260767`*^9}, {
   3.8691739899279933`*^9, 3.8691740092031326`*^9}, {3.8692675542325144`*^9, 
   3.8692676029362683`*^9}, {3.869267772256629*^9, 3.8692677942962894`*^9}, {
   3.869267923112097*^9, 3.86926798890248*^9}, {3.8692680316643395`*^9, 
   3.869268094434563*^9}, {3.8692865766167164`*^9, 3.869286623301129*^9}, 
   3.8697832646426954`*^9, {3.869790408968092*^9, 3.8697904333256173`*^9}, {
   3.8750811111214933`*^9, 3.8750811503135643`*^9}, {3.875081189544191*^9, 
   3.8750812410486965`*^9}, {3.8750812832986813`*^9, 
   3.8750813208402576`*^9}, {3.87508136190397*^9, 3.8750813720473623`*^9}, 
   3.8750833216520414`*^9, 3.8750834103427153`*^9, 3.8750854070938025`*^9, {
   3.8750854406851177`*^9, 3.8750854485104084`*^9}, {3.875085967665722*^9, 
   3.875085969585541*^9}, {3.8750860060271907`*^9, 3.8750860515695133`*^9}, {
   3.8750860817282677`*^9, 3.8750860871529264`*^9}, {3.875086162257763*^9, 
   3.875086323703765*^9}, {3.87508635376825*^9, 3.875086361526535*^9}, {
   3.875086430094019*^9, 3.875086430287899*^9}, {3.8757558241154547`*^9, 
   3.8757558915152884`*^9}, {3.8757559235394564`*^9, 3.8757559455443482`*^9}, 
   3.8763661830843077`*^9, {3.876972625794467*^9, 3.876972658071721*^9}, {
   3.884220544372243*^9, 3.8842205487345343`*^9}, {3.8847797698178577`*^9, 
   3.8847797707240844`*^9}, {3.886568553388768*^9, 3.8865685674042044`*^9}, 
   3.8865688414907513`*^9, {3.8865688817459655`*^9, 3.8865688993031225`*^9}, {
   3.8866400750533886`*^9, 3.8866400927633505`*^9}, {3.8869119356750793`*^9, 
   3.886911940363795*^9}, 3.886913635396478*^9, 3.8869139236362877`*^9, 
   3.886914043540765*^9, {3.890189400279251*^9, 3.890189424368125*^9}, {
   3.8915842006212196`*^9, 3.8915842186259303`*^9}, {3.8920441480234795`*^9, 
   3.8920441553130293`*^9}, 3.892094725397072*^9, {3.892094825198519*^9, 
   3.8920948263208303`*^9}, {3.8920948949356213`*^9, 3.89209490399205*^9}, 
   3.8920949690010614`*^9, {3.892095156830576*^9, 3.8920951587895103`*^9}, {
   3.8920952335340652`*^9, 3.892095360375106*^9}, {3.892095832795846*^9, 
   3.892095843303385*^9}, 3.8920959026498785`*^9, 3.8920960118856835`*^9, 
   3.892096214411799*^9, 3.8920962922832537`*^9, {3.892096407325638*^9, 
   3.8920964354376736`*^9}, {3.892096563683196*^9, 3.8920965891552343`*^9}, {
   3.8920966623113966`*^9, 3.8920966720753937`*^9}, {3.8920967296779585`*^9, 
   3.892096819265691*^9}, {3.8920969154262404`*^9, 3.8920969201223526`*^9}, {
   3.8920972393468904`*^9, 3.8920973115821867`*^9}, {3.892097345969034*^9, 
   3.89209736046012*^9}, 3.892097665890291*^9, {3.8920977468030996`*^9, 
   3.8920978398243127`*^9}, {3.892097966359424*^9, 3.8920980049029765`*^9}, 
   3.8920980521908884`*^9, {3.8920981405828233`*^9, 3.8920981448372087`*^9}, {
   3.892098209053802*^9, 3.8920982184929924`*^9}, {3.892098548521392*^9, 
   3.8920985735769076`*^9}, {3.8920986121072087`*^9, 3.892098646508047*^9}, {
   3.8921856828847055`*^9, 3.8921856981436825`*^9}, {3.892186103382001*^9, 
   3.8921861082390184`*^9}, 3.892186197284009*^9, {3.89218624348775*^9, 
   3.892186281841194*^9}, {3.8921863178420825`*^9, 3.8921863392879114`*^9}, {
   3.892186375422719*^9, 3.8921864352945395`*^9}, {3.8921865199295597`*^9, 
   3.8921865275184817`*^9}, 3.892186644671624*^9, 3.892186687838278*^9, {
   3.8921867235627823`*^9, 3.8921867722621336`*^9}, {3.8921868299719615`*^9, 
   3.892186900411478*^9}, {3.8921870421864433`*^9, 3.8921870838962793`*^9}, {
   3.8921875091071405`*^9, 3.89218752895494*^9}, {3.8921876470325084`*^9, 
   3.892187658220971*^9}, 3.892187747411891*^9, 3.8921878560069084`*^9, {
   3.892188232275335*^9, 3.8921882456911383`*^9}, {3.8921883639156113`*^9, 
   3.8921883642811337`*^9}, {3.8921883958671246`*^9, 
   3.8921883986824036`*^9}, {3.892188490144771*^9, 3.892188493425352*^9}, {
   3.892188523600525*^9, 3.892188526392681*^9}, {3.892188808974831*^9, 
   3.8921888116787286`*^9}, {3.8921888839467444`*^9, 3.892188901534075*^9}, {
   3.8921890337445173`*^9, 3.8921890447975903`*^9}, {3.8921890806394444`*^9, 
   3.8921891070772095`*^9}, {3.8921891740381355`*^9, 3.892189177415092*^9}, {
   3.892189659961707*^9, 3.8921897170269203`*^9}, {3.892189778995405*^9, 
   3.8921897822651415`*^9}, 3.8921904922715545`*^9, {3.892211117819583*^9, 
   3.892211126964176*^9}, {3.892617276016088*^9, 3.8926173254051065`*^9}, 
   3.8926174299311976`*^9, {3.8926175115564003`*^9, 3.8926175321349993`*^9}, {
   3.8926176340791655`*^9, 3.892617639446905*^9}, {3.892617733919198*^9, 
   3.8926177554776754`*^9}, 3.8927856875350647`*^9, {3.8927857313192987`*^9, 
   3.892785741354164*^9}, {3.8928597659563684`*^9, 3.892859771618367*^9}, {
   3.8928631768722744`*^9, 3.8928632721692877`*^9}, {3.892867465780639*^9, 
   3.892867479147416*^9}, {3.893159740733451*^9, 3.893159744058339*^9}, {
   3.8932891241895914`*^9, 3.8932891242205725`*^9}, {3.8955490510937324`*^9, 
   3.895549051326597*^9}, {3.895549138114855*^9, 3.8955491720068054`*^9}, 
   3.895549202265218*^9, {3.8955553397773104`*^9, 3.895555339813286*^9}, {
   3.8955558383175163`*^9, 
   3.8955558383524933`*^9}},ExpressionUUID->"5a630646-5eed-4f17-8285-\
6decb04988a6"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"(*", " ", 
   RowBox[{
   "The", " ", "main", " ", "function", " ", "for", " ", "TensorsProduct", 
    " ", "to", " ", "act", " ", "as", " ", "a", " ", "TensorProduct", " ", 
    "of", " ", "sorts", " ", "for", " ", "Tensor", " ", "objects"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", ":", " ", 
     RowBox[{
     "Assigning", " ", "upvalues", " ", "for", " ", "Tensor", " ", 
      "involving", " ", "TensorProduct", " ", "yields", " ", "levels", " ", 
      "too", " ", "deep", " ", "for", " ", "MMA", " ", "to", " ", 
      "handle"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"that", "'"}], "s", " ", "why", " ", "we", " ", "need", " ", 
     "TensorsProduct"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"one", " ", "Tensor"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TensorsProduct", "[", "tt_Tensor", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"ReleaseHold", "[", "tt", "]"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Thread", " ", "over", " ", "Plus", " ", "automatically"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"TensorsProduct", "[", "mm_", "]"}]}], ":=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TensorsProduct", "/@", 
        RowBox[{"ReleaseHold", "[", "mm", "]"}]}], ")"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", "mm", "]"}], "===", "Plus"}], ")"}]}]}]}], ";", 
   " ", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Pull", " ", "out", " ", "non"}], "-", 
     RowBox[{"Tensor", " ", "objects"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorsProduct", "[", "mm_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"allTensors", ",", "therest", ",", "releasem"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"releasem", "=", 
         RowBox[{"ReleaseHold", "[", "mm", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"allTensors", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"List", "@@", "releasem"}], ")"}], ",", "_Tensor"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"therest", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"List", "@@", "releasem"}], ")"}], ",", "_Tensor"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"therest", " ", 
         RowBox[{"TensorsProduct", "[", "allTensors", "]"}]}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", "mm", "]"}], "===", "Times"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Union", "[", 
         RowBox[{"(", 
          RowBox[{"Head", "/@", 
           RowBox[{"(", 
            RowBox[{"List", "@@", "mm"}], ")"}]}], ")"}], "]"}], "=!=", 
        RowBox[{"{", "Tensor", "}"}]}], ")"}]}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorsProduct", "[", "1", "]"}], ":=", "1"}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "Tensor", " ", "product", " ", "of", " ", "more", " ", "than", " ", "one",
      " ", "Tensors", " ", "with", " ", "same", " ", "CoordinateSystem"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Case", " ", "1"}], ":", " ", 
     RowBox[{
     "Every", " ", "Tensor", " ", "in", " ", "the", " ", "product", " ", 
      "has", " ", "the", " ", "same", " ", "coordinate", " ", "system"}]}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"TensorsProduct", " ", "now", " ", "with", " ", "order"}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorsProduct", "[", "tt_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tensorproduct", ",", "allindices", ",", "tensornames", ",", 
         "ListwithOrder", ",", "holdtt", ",", "lgth"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Unprotect", "[", 
          RowBox[{"Times", ",", "HoldForm"}], "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"holdtt", "=", 
         RowBox[{"HoldForm", "[", "tt", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Protect", "[", 
           RowBox[{"Times", ",", "HoldForm"}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", 
          RowBox[{
           RowBox[{
           "holdtt", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
           RowBox[{"Times", "\[Rule]", "List"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ListwithOrder", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"lgth", "===", "1"}], ",", 
           RowBox[{"ReleaseHold", "[", "holdtt", "]"}], ",", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{
              TagBox["holdtt",
               HoldForm], ",", "_Symbol"}], "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"ReleaseHold", "[", "holdtt", "]"}], 
              "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "lgth"}], "}"}]}], "]"}], ",", 
           RowBox[{"lgth", ">", "1"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"holdtt", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "i"}], "\[RightDoubleBracket]"}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tensorproduct", "=", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "/@", "ListwithOrder"}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Join", " ", "all", " ", "indices", " ", "to", " ", "form", " ", 
          "index", " ", "structure", " ", "of", " ", "Tensor", " ", 
          "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{"Indices", "/@", "ListwithOrder"}], ")"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Tensor", " ", "all", " ", "the", " ", "names"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tensornames", "=", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Cases", "[", 
                RowBox[{"#", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"TensorName", "\[Rule]", "name_"}], ")"}], 
                  "\[RuleDelayed]", "name"}], ",", "\[Infinity]"}], "]"}], 
               "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], 
             "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
          "properties", " ", "of", " ", "the", " ", "first", " ", "Tensor"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", "tt"}], ")"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
             ")"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "tt", "]"}], "===", "Times"}], ")"}], "&&", 
       RowBox[{"(*", " ", 
        RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", 
        "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Head", "/@", 
           RowBox[{"(", 
            RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
         RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", " ", 
        RowBox[{
        "all", " ", "coordinate", " ", "systems", " ", "are", " ", "the", " ",
          "same"}], " ", "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Coordinates", "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "]"}], "===", 
         "1"}], ")"}]}], 
      RowBox[{"(*", 
       RowBox[{"&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"no", " ", "Metrics"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"{", "tt", "}"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorType", "\[Rule]", "xx_"}], ")"}], "\[Rule]", 
                "xx"}], ",", "\[Infinity]"}], "]"}], "]"}], ",", 
            RowBox[{"{", "\"\<Metric\>\"", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], "*)"}], ")"}]}]}], ";", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Case", " ", "2"}], ":", " ", 
     RowBox[{
     "Not", " ", "All", " ", "Tensors", " ", "Have", " ", "Same", " ", 
      "Coordinate", " ", "Systems"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"TensorsProduct", "[", "tt_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"tensorproduct", ",", "test", ",", "t1", ",", "t2"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "two", " ", "Tensors", " ", "are", " ", "considered", " ", "the", " ",
          "same", " ", "if", " ", "their", " ", "Coordinates", " ", "are", 
         " ", "the", " ", "same"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Coordinates", " ", "must", " ", "be", " ", "exactly", " ", "the", 
         " ", 
         RowBox[{"same", " ", "--"}], " ", "including", " ", "order"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"test", "[", 
          RowBox[{"t1_Tensor", ",", "t2_Tensor"}], "]"}], ":=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coordinates", "[", "t1", "]"}], "===", 
           RowBox[{"Coordinates", "[", "t2", "]"}]}], ")"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "group", " ", "Tensors", " ", "according", " ", "to", " ", "whether",
           " ", "they", " ", "have", " ", "the", " ", "same", " ", 
          "Coordinates"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tensorproduct", "=", 
         RowBox[{"Gather", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"List", "@@", "tt"}], ")"}], ",", "test"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "Only", " ", "TensorsProduct", " ", "on", " ", "Tensors", " ", "w", 
          " ", "the", " ", "same", " ", "Coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Times", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"TensorsProduct", "[", 
             RowBox[{"Times", "@@", "#"}], "]"}], "&"}], "/@", 
           "tensorproduct"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"check", " ", "tensor", " ", "product"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "tt", "]"}], "===", "Times"}], ")"}], "&&", 
       RowBox[{"(*", " ", 
        RowBox[{"everybody", " ", "is", " ", "a", " ", "Tensor"}], " ", 
        "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"Head", "/@", 
           RowBox[{"(", 
            RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "===", 
         RowBox[{"{", "Tensor", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", " ", 
        RowBox[{
        "not", " ", "all", " ", "coordinate", " ", "systems", " ", "are", " ",
          "the", " ", "same"}], " ", "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Union", "[", 
           RowBox[{"Coordinates", "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], "]"}], "]"}], ">", "1"}], 
        ")"}]}], ")"}]}]}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"TensorsProduct", "[", "tt_List", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "tensorproduct", ",", "allindices", ",", "tensornames", ",", 
        "ListwithOrder", ",", "holdtt"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"perform", " ", "a", " ", "tensor", " ", "product"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tensorproduct", "=", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"TensorComponents", "/@", "tt"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Join", " ", "all", " ", "indices", " ", "to", " ", "form", " ", 
         "index", " ", "structure", " ", "of", " ", "Tensor", " ", 
         "Product"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"allindices", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{"Indices", "/@", "tt"}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Tensor", " ", "all", " ", "the", " ", "names"}], " ", "*)"}],
        "\[IndentingNewLine]", 
       RowBox[{"tensornames", "=", 
        RowBox[{"TensorProduct", "[", 
         RowBox[{"Sequence", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"#", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorName", "\[Rule]", "name_"}], ")"}], 
                 "\[RuleDelayed]", "name"}], ",", "\[Infinity]"}], "]"}], 
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
         "properties", " ", "of", " ", "the", " ", "first", " ", "Tensor"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"List", "@@", "tt"}], ")"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}], "/.", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorName", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"TensorName", "\[Rule]", "tensornames"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
           "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
            ")"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], "*)"}], 
  "*)"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606329772953229*^9, 3.6063298493684025`*^9}, {
   3.6063299122113686`*^9, 3.6063299142989006`*^9}, {3.6063299569095554`*^9, 
   3.6063300075653334`*^9}, {3.606330261673237*^9, 3.606330262978257*^9}, {
   3.606330304518895*^9, 3.60633030614392*^9}, {3.6063303677518663`*^9, 
   3.6063304884247203`*^9}, {3.606330565357402*^9, 3.6063305711234903`*^9}, {
   3.60633078917634*^9, 3.606330809641155*^9}, {3.6063333733005404`*^9, 
   3.606333437622528*^9}, {3.60633358418828*^9, 3.6063335862283115`*^9}, {
   3.6063336180318003`*^9, 3.606333659233933*^9}, {3.6063338496803584`*^9, 
   3.6063338510053787`*^9}, {3.6063339010896482`*^9, 
   3.6063339433767977`*^9}, {3.6063459037446346`*^9, 
   3.6063459108190393`*^9}, {3.6063470816620073`*^9, 3.606347084600176*^9}, {
   3.6063471348460493`*^9, 3.606347160693528*^9}, {3.6063472655665264`*^9, 
   3.606347266261566*^9}, {3.6063473812891455`*^9, 3.6063474203563795`*^9}, {
   3.606347567858816*^9, 3.60634765760695*^9}, {3.6063478667949142`*^9, 
   3.6063478904042645`*^9}, {3.606347967654683*^9, 3.6063479692917767`*^9}, {
   3.6063480783310137`*^9, 3.6063480791370597`*^9}, {3.6063481440287714`*^9, 
   3.606348171198325*^9}, {3.606348209843536*^9, 3.606348210352565*^9}, {
   3.606348281718647*^9, 3.606348320320855*^9}, 3.606348411957096*^9, {
   3.606348678957368*^9, 3.6063487769929748`*^9}, {3.6063488086487856`*^9, 
   3.6063488224615755`*^9}, {3.606348896829829*^9, 3.606348955287173*^9}, {
   3.606349002586878*^9, 3.6063490056820555`*^9}, {3.6063490685596514`*^9, 
   3.60634912641096*^9}, {3.6063491642251234`*^9, 3.60634938516376*^9}, {
   3.6063494539866967`*^9, 3.6063495452039137`*^9}, {3.6063497017798696`*^9, 
   3.6063497046480336`*^9}, {3.6063497474284806`*^9, 3.606349753815846*^9}, {
   3.606349792106036*^9, 3.606349818879567*^9}, {3.6063616952520213`*^9, 
   3.6063616984592047`*^9}, {3.6063618804956164`*^9, 3.606361897570593*^9}, {
   3.606492841870088*^9, 3.6064928438422008`*^9}, {3.6064962239465313`*^9, 
   3.606496225999649*^9}, {3.606496479306137*^9, 3.606496493996978*^9}, {
   3.6064970212291336`*^9, 3.6064970214301453`*^9}, {3.606497496140297*^9, 
   3.6064975034017124`*^9}, {3.606497719274008*^9, 3.606497745201254*^9}, {
   3.60649778301572*^9, 3.6064978204869857`*^9}, {3.6064978658674655`*^9, 
   3.60649789127991*^9}, {3.606498026750548*^9, 3.6064980272029486`*^9}, {
   3.60649824976854*^9, 3.60649830107703*^9}, {3.6065023945773077`*^9, 
   3.606502420385784*^9}, {3.6065024677544937`*^9, 3.6065024712686944`*^9}, {
   3.606502586737299*^9, 3.6065025869273095`*^9}, {3.606502681188701*^9, 
   3.6065027172807655`*^9}, {3.6065028851733685`*^9, 
   3.6065028905986786`*^9}, {3.6065030521409187`*^9, 3.606503062357503*^9}, {
   3.606508021326345*^9, 3.6065080567183695`*^9}, {3.6065743687961006`*^9, 
   3.606574371900506*^9}, {3.6065756553826823`*^9, 3.6065756693354807`*^9}, {
   3.6065758098195157`*^9, 3.6065758406842813`*^9}, {3.6065763172855415`*^9, 
   3.6065763489863544`*^9}, {3.630042363477578*^9, 3.6300423670343847`*^9}, {
   3.6300424077473564`*^9, 3.630042465354558*^9}, {3.6300934477721934`*^9, 
   3.630093522495831*^9}, {3.630094092095019*^9, 3.630094095389125*^9}, {
   3.6716490557745323`*^9, 3.671649148969096*^9}, {3.6716491832735558`*^9, 
   3.67164918564476*^9}, {3.6716492430216613`*^9, 3.671649302114565*^9}, 
   3.6716493878991156`*^9, {3.6716496042402954`*^9, 3.6716496327415457`*^9}, {
   3.6716496704936123`*^9, 3.6716497000868635`*^9}, {3.671649732909322*^9, 
   3.6716498029378443`*^9}, {3.6716498850251884`*^9, 3.671649888800395*^9}, {
   3.6716533150660057`*^9, 3.67165333355379*^9}, {3.67165346507331*^9, 
   3.671653501148864*^9}, {3.671653731442401*^9, 3.671653735527464*^9}, {
   3.671653856796827*^9, 3.671653922690339*^9}, {3.671653975433649*^9, 
   3.6716540156192665`*^9}, {3.671654205882189*^9, 3.6716542205724144`*^9}, {
   3.6716542647380924`*^9, 3.6716542931035285`*^9}, {3.6716628891344976`*^9, 
   3.671662891106008*^9}, {3.671662928315199*^9, 3.6716629379147425`*^9}, {
   3.671663337672762*^9, 3.671663340470172*^9}, {3.671663586568463*^9, 
   3.67166358879359*^9}, {3.671664326909501*^9, 3.671664354767865*^9}, {
   3.6716643960802593`*^9, 3.6716644206539197`*^9}, {3.671664455045695*^9, 
   3.6716644598539047`*^9}, 3.671668348717533*^9, {3.67166940497793*^9, 
   3.6716694062354493`*^9}, {3.6716697409767904`*^9, 
   3.6716697491644163`*^9}, {3.671670260591355*^9, 3.6716702677774687`*^9}, {
   3.6716703178152647`*^9, 3.6716704406677046`*^9}, {3.671670547252713*^9, 
   3.6716705511746206`*^9}, {3.6716705975868196`*^9, 3.6716706506529217`*^9}, 
   3.671670691781802*^9, {3.6716711420602818`*^9, 3.6716711438037853`*^9}, {
   3.6716721373735857`*^9, 3.6716721397809896`*^9}, {3.6716721968133154`*^9, 
   3.6716722030946274`*^9}, {3.671674884611085*^9, 3.6716748950414047`*^9}, {
   3.6716749358214846`*^9, 3.671674986872879*^9}, {3.672023571713766*^9, 
   3.6720235921015797`*^9}, {3.6720237902696238`*^9, 3.672023797657237*^9}, {
   3.6720238621732283`*^9, 3.6720238625282335`*^9}, {3.672025898698493*^9, 
   3.6720259223658466`*^9}, {3.672025985067433*^9, 3.672026002832449*^9}, {
   3.6720302380254917`*^9, 3.672030242315737*^9}, {3.672030584243294*^9, 
   3.672030586584428*^9}, {3.672030700002915*^9, 3.6720307203640795`*^9}, {
   3.672031358612585*^9, 3.6720313670460677`*^9}, 3.6720314142997704`*^9, 
   3.672031877663273*^9, {3.672031915249423*^9, 3.6720319291212163`*^9}, 
   3.672032037805433*^9, {3.672032160103428*^9, 3.672032174159232*^9}, {
   3.6720322045769715`*^9, 3.6720322061960645`*^9}, {3.6720322664125085`*^9, 
   3.672032274095948*^9}, 3.6720323695634084`*^9, {3.6720719691033707`*^9, 
   3.67207199967612*^9}, {3.672072593961111*^9, 3.6720726088159604`*^9}, {
   3.672072717332167*^9, 3.6720727660309525`*^9}, {3.6720728495577297`*^9, 
   3.6720728586372495`*^9}, {3.6720730108519554`*^9, 
   3.6720730188294115`*^9}, {3.672073214825622*^9, 3.672073238480975*^9}, {
   3.672075664525737*^9, 3.6720756724091883`*^9}, 3.672075703583971*^9, {
   3.6720757598561897`*^9, 3.6720757603462176`*^9}, {3.6720759492400217`*^9, 
   3.672075954471321*^9}, {3.6720760184919825`*^9, 3.6720760227002234`*^9}, {
   3.672076055784116*^9, 3.672076069635908*^9}, {3.67207611163431*^9, 
   3.6720761768690414`*^9}, {3.672076220120515*^9, 3.6720762243667583`*^9}, {
   3.672076443840311*^9, 3.67207644871459*^9}, {3.6720765053858314`*^9, 
   3.6720766007942886`*^9}, {3.672076638323435*^9, 3.6720766742314887`*^9}, {
   3.6720767334828777`*^9, 3.672076735163974*^9}, {3.672077330629033*^9, 
   3.672077339607546*^9}, {3.6720773886563516`*^9, 3.672077439272247*^9}, {
   3.672077478478489*^9, 3.67207752779731*^9}, {3.6720776826981697`*^9, 
   3.6720777657409196`*^9}, {3.67259221230241*^9, 3.672592213631814*^9}, {
   3.672592246863079*^9, 3.6725922552310953`*^9}, {3.672713838187889*^9, 
   3.6727138384078894`*^9}, 3.6727723545654783`*^9, {3.6728107212659287`*^9, 
   3.672810847889171*^9}, {3.673039563370195*^9, 3.673039568474806*^9}, 
   3.6730396480719953`*^9, {3.673039718617352*^9, 3.673039731878384*^9}, {
   3.673039893546356*^9, 3.673039937360453*^9}, {3.673039971301431*^9, 
   3.673039983822462*^9}, {3.6730400218748465`*^9, 3.67304006809785*^9}, {
   3.6730488891487384`*^9, 3.673048903101474*^9}, {3.8066410523233604`*^9, 
   3.806641086979685*^9}, {3.806645464856251*^9, 3.8066454763488307`*^9}, {
   3.806645716494006*^9, 3.80664575256258*^9}, {3.8066458742097673`*^9, 
   3.806645890861457*^9}, {3.806645950546249*^9, 3.8066459551109624`*^9}, {
   3.806647127492586*^9, 3.8066471843851595`*^9}, {3.8066620799645214`*^9, 
   3.806662260436735*^9}, {3.8066623367623672`*^9, 3.80666242594937*^9}, {
   3.8066626488643503`*^9, 3.806662733715821*^9}, {3.8066658500062895`*^9, 
   3.8066658516419516`*^9}, {3.839218574584773*^9, 3.8392185861511517`*^9}, {
   3.8392947419437714`*^9, 3.8392948047780094`*^9}, {3.839294869117486*^9, 
   3.8392948850880938`*^9}, {3.839295984249628*^9, 3.8392960103919706`*^9}, {
   3.839301751894804*^9, 3.839301752354801*^9}, {3.8393018877937517`*^9, 
   3.839301930903267*^9}, {3.8399288947882156`*^9, 3.839928994997079*^9}, {
   3.8399292042755885`*^9, 3.839929217004899*^9}, {3.8399297428802176`*^9, 
   3.83992977408934*^9}, {3.839929811889368*^9, 3.8399298382091436`*^9}, {
   3.8399299915976334`*^9, 3.839930020377251*^9}, 3.839930067106807*^9, {
   3.8399305572024508`*^9, 3.839930558491845*^9}, {3.839930836829405*^9, 
   3.839930884228979*^9}, {3.8399309347285767`*^9, 3.839930934858347*^9}, {
   3.839931224515541*^9, 3.8399312377753344`*^9}, 3.840589368544978*^9, {
   3.895549051331593*^9, 
   3.895549051382562*^9}},ExpressionUUID->"05c7a639-9ef9-4f32-ada2-\
34a29d99e7aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Take", " ", "the", " ", "product", " ", "of", " ", "two", " ", "or", " ", 
    "more", " ", "tensors", " ", "and", " ", "sum", " ", "over", " ", 
    "repeated", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"contraction", " ", "between", " ", "2", 
     RowBox[{"g", "'"}], "s"}], ",", " ", 
    RowBox[{
     RowBox[{"g", " ", "non"}], "-", "g"}], ",", " ", 
    RowBox[{
     RowBox[{"or", " ", "both", " ", "non"}], "-", 
     RowBox[{
      RowBox[{"g", "'"}], "s"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"(", "I", ")"}], " ", "contract", " ", "of", " ", "2", " ", 
    RowBox[{"g", "'"}], "s"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorsProduct", "[", 
      RowBox[{"Times", "[", 
       RowBox[{"t1___", ",", "m1_", ",", "t2___", ",", "m2_", ",", "t3___"}], 
       "]"}], "]"}], ":="}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Right", " ", "now", " ", "we", " ", "do", " ", "not", " ", "check", " ", 
    "Dimensions", " ", "are", " ", "the", " ", "same", " ", "before", " ", 
    "we", " ", "do", " ", "TensorsProduct"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"old", " ", "code", "\[IndentingNewLine]", 
       RowBox[{"TensorsProduct", "[", 
        RowBox[{"Times", "[", "tt__", "]"}], "]"}]}], "/;", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"Head", "/@", 
         RowBox[{"(", 
          RowBox[{"List", "@@", 
           RowBox[{"Times", "[", "tt", "]"}]}], ")"}]}], "]"}], "===", 
       RowBox[{"{", "Tensor", "}"}]}]}], ":=", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tensorproduct", ",", "allindices", ",", "repeatedindices", ",", 
         "ix"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "first", " ", "perform", " ", "a", " ", "tensor", " ", "product"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tensorproduct", "=", 
         RowBox[{"TensorProduct", "[", 
          RowBox[{"Sequence", "@@", 
           RowBox[{"(", 
            RowBox[{"TensorComponents", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", 
               RowBox[{"Times", "[", "tt", "]"}]}], ")"}]}], ")"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "repeated", " ", "indices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ix", "=", 
         RowBox[{"Indices", "/@", 
          RowBox[{"(", 
           RowBox[{"List", "@@", 
            RowBox[{"Times", "[", "tt", "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"repeatedindices", "=", 
         RowBox[{"CollectRepeatedIndices", "[", 
          RowBox[{"Sequence", "@@", "ix"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "sum", " ", "over", " ", "repeated", " ", "indices", " ", "using", 
          " ", "TensorContract"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"list", " ", "of", " ", "all", " ", "indices", " ", 
          RowBox[{
           RowBox[{"w", "/", " ", "Sub"}], "/", "SuperMinus"}], " ", 
          "removed", " ", "from", " ", "repeated", " ", "ones"}], " ", "*)"}],
         "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Join", "[", 
            RowBox[{"Sequence", "@@", "ix"}], "]"}], "/.", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"SuperMinus", "[", "#", "]"}], "\[Rule]", "#"}], 
                 ")"}], ",", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"SubMinus", "[", "#", "]"}], "\[Rule]", "#"}], 
                 ")"}]}], "}"}], "&"}], "/@", "repeatedindices"}], "]"}]}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"tensorproduct", "=", 
         RowBox[{"TensorContract", "[", "\[IndentingNewLine]", 
          RowBox[{"tensorproduct", ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"pair", " ", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"pair", " ", "2"}], "}"}], ",", "..."}], "}"}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{"allindices", ",", "#"}], "]"}], "]"}], "&"}], "/@", 
            "repeatedindices"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"remove", " ", "repeated", " ", "indices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"allindices", ",", 
           RowBox[{"Alternatives", "@@", "repeatedindices"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "Tensor", " ", "will", " ", "inherit", " ", 
          "properties", " ", "of", " ", "the", " ", "first", " ", "Tensor"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "output", " ", "Tensor", " ", "indices", " ", "are", " ", 
           "inherited", " ", "from", " ", "tt"}], ",", " ", 
          RowBox[{"from", " ", "left", " ", "to", " ", "right"}], ",", " ", 
          RowBox[{
          "with", " ", "repeated", " ", "indices", " ", "discarded"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"List", "@@", 
            RowBox[{"Times", "[", "tt", "]"}]}], ")"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
             ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.606329772953229*^9, 3.6063298493684025`*^9}, {
   3.6063299122113686`*^9, 3.6063299142989006`*^9}, {3.6063299569095554`*^9, 
   3.6063300075653334`*^9}, {3.606330261673237*^9, 3.606330262978257*^9}, {
   3.606330304518895*^9, 3.60633030614392*^9}, {3.6063303677518663`*^9, 
   3.6063304884247203`*^9}, {3.606330565357402*^9, 3.6063305711234903`*^9}, {
   3.60633078917634*^9, 3.606330809641155*^9}, {3.6063333733005404`*^9, 
   3.606333437622528*^9}, {3.60633358418828*^9, 3.6063335862283115`*^9}, {
   3.6063336180318003`*^9, 3.606333659233933*^9}, {3.6063338496803584`*^9, 
   3.6063338510053787`*^9}, {3.6063339010896482`*^9, 
   3.6063339433767977`*^9}, {3.6063459037446346`*^9, 
   3.6063459108190393`*^9}, {3.6063470816620073`*^9, 3.606347084600176*^9}, {
   3.6063471348460493`*^9, 3.606347160693528*^9}, {3.6063472655665264`*^9, 
   3.606347266261566*^9}, {3.6063473812891455`*^9, 3.6063474203563795`*^9}, {
   3.606347567858816*^9, 3.60634765760695*^9}, {3.6063478667949142`*^9, 
   3.6063478904042645`*^9}, {3.606347967654683*^9, 3.6063479692917767`*^9}, {
   3.6063480783310137`*^9, 3.6063480791370597`*^9}, {3.6063481440287714`*^9, 
   3.606348171198325*^9}, {3.606348209843536*^9, 3.606348210352565*^9}, {
   3.606348281718647*^9, 3.606348320320855*^9}, 3.606348411957096*^9, {
   3.606348678957368*^9, 3.6063487769929748`*^9}, {3.6063488086487856`*^9, 
   3.6063488224615755`*^9}, {3.606348896829829*^9, 3.606348955287173*^9}, {
   3.606349002586878*^9, 3.6063490056820555`*^9}, {3.6063490685596514`*^9, 
   3.60634912641096*^9}, {3.6063491642251234`*^9, 3.60634938516376*^9}, {
   3.6063494539866967`*^9, 3.6063495452039137`*^9}, {3.6063497017798696`*^9, 
   3.6063497046480336`*^9}, {3.6063497474284806`*^9, 3.606349753815846*^9}, {
   3.606349792106036*^9, 3.606349818879567*^9}, {3.6063616952520213`*^9, 
   3.6063616984592047`*^9}, {3.6063618804956164`*^9, 3.606361897570593*^9}, {
   3.606492841870088*^9, 3.6064928438422008`*^9}, {3.6064962239465313`*^9, 
   3.606496225999649*^9}, {3.606496479306137*^9, 3.606496493996978*^9}, {
   3.6064970212291336`*^9, 3.6064970214301453`*^9}, {3.606497496140297*^9, 
   3.6064975034017124`*^9}, {3.606497719274008*^9, 3.606497745201254*^9}, {
   3.60649778301572*^9, 3.6064978204869857`*^9}, {3.6064978658674655`*^9, 
   3.60649789127991*^9}, {3.606498026750548*^9, 3.6064980272029486`*^9}, {
   3.60649824976854*^9, 3.60649830107703*^9}, {3.6065023945773077`*^9, 
   3.606502420385784*^9}, {3.6065024677544937`*^9, 3.6065024712686944`*^9}, {
   3.606502586737299*^9, 3.6065025869273095`*^9}, {3.606502681188701*^9, 
   3.6065027172807655`*^9}, {3.6065028851733685`*^9, 
   3.6065028905986786`*^9}, {3.6065030521409187`*^9, 3.606503062357503*^9}, {
   3.606508021326345*^9, 3.6065080567183695`*^9}, {3.6065743687961006`*^9, 
   3.606574371900506*^9}, {3.6065756553826823`*^9, 3.6065756693354807`*^9}, {
   3.6065758098195157`*^9, 3.6065758406842813`*^9}, {3.6065763172855415`*^9, 
   3.6065763489863544`*^9}, {3.630042363477578*^9, 3.6300423670343847`*^9}, {
   3.6300424077473564`*^9, 3.630042465354558*^9}, {3.6300934477721934`*^9, 
   3.630093522495831*^9}, {3.630094092095019*^9, 3.630094095389125*^9}, {
   3.671909765082483*^9, 3.6719097757224073`*^9}, {3.895549051394799*^9, 
   3.8955490514007955`*^9}},ExpressionUUID->"5b86961e-1cf5-4a46-bc04-\
811c99736b22"]
}, Closed]],

Cell[CellGroupData[{

Cell["SwapIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 
   3.606512376678954*^9}},ExpressionUUID->"05e9fa37-f55f-4e3e-90f1-\
83b8b508145e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "SwapIndices", " ", "returns", " ", "tt", " ", "except", " ", "the", " ", 
     "indices", " ", "are", " ", "permuted", " ", "into", " ", "idx"}], ";", 
    " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", 
      RowBox[{"Indices", "[", "tt", "]"}]}], " ", "\[Rule]", " ", "idx"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "idx", " ", "does", " ", "not", " ", "include", " ", "the", " ", 
    "UnderBarred", " ", "indices", " ", "in", " ", "tt"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SwapIndices", "[", 
      RowBox[{"tt_Tensor", ",", "idx_List"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Sort", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
         RowBox[{"Sort", "[", "idx", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"TestIndices", "[", 
              RowBox[{"#", "/.", 
               RowBox[{
                RowBox[{"UnderBar", "[", "ss_", "]"}], "\[Rule]", "ss"}]}], 
              "]"}], "&"}], "/@", "idx"}], ")"}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}]}], ")"}]}], ":=", 
    RowBox[{"tt", "/.", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"replace", " ", "TensorComponents"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "ss_"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", 
          RowBox[{"Transpose", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "tt", "]"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "this", " ", "is", " ", "the", " ", "ordering", " ", "of", 
                  " ", "indices", " ", "we", " ", "want"}], " ", "*)"}], 
                RowBox[{"idx", ",", "#"}], "]"}], "&"}], "/@", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], "]"}]}], "]"}]}],
          ")"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "Indices", " ", "but", " ", "remember", " ", "not", 
         " ", "to", " ", "throw", " ", "away", " ", "the", " ", "UnderBarred",
          " ", "Indices"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Indices", "\[Rule]", "ss_"}], ")"}], "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"Indices", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"ss", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"Rule", "[", 
              RowBox[{
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "tt", "]"}], "]"}], ",", "idx"}], 
              "]"}], "]"}]}], ")"}]}], ")"}]}]}], "\[IndentingNewLine]", 
      "}"}]}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, 
   3.895554774487012*^9},ExpressionUUID->"8843326f-3452-4b7e-9d9f-\
ecdc3baed4a3"]
}, Closed]],

Cell[CellGroupData[{

Cell["MoveIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}},ExpressionUUID->"62186d2f-6045-4bdd-821b-\
6e563a764add"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}], " ", 
    "returns", " ", "tt", " ", "with", " ", "its", " ", "indices", " ", 
    RowBox[{"moved", "/", "replaced"}], " ", "to", " ", "idx"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "idx", " ", "does", " ", "not", " ", "include", " ", "the", " ", 
    "UnderBarred", " ", "indices", " ", "in", " ", "tt", " ", "but", " ", 
    "has", " ", "to", " ", "contain", " ", "the", " ", "same", " ", "number", 
    " ", "of", " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
     "idx", " ", "may", " ", "also", " ", "contain", " ", "coordinates"}], 
     ";", " ", 
     RowBox[{"i", ".", "e", "."}]}], ",", " ", 
    RowBox[{
    "MoveIndices", " ", "should", " ", "be", " ", "able", " ", "to", " ", 
     "do", " ", "evaluate", " ", "specific", " ", "components", " ", "of", 
     " ", "the", " ", "tensor"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"new", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MoveIndices", "[", 
       RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
         "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", 
         "and", " ", "idx"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
          RowBox[{"Length", "[", "idx", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "idx", " ", "contain", " ", "proper", " ", 
           "indices"}], " ", "*)"}], 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"MoveIndices", " ", "for", " ", "scalar"}]}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
            RowBox[{"{", "True", "}"}]}], ")"}], "||", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Union", "[", 
             RowBox[{"(", 
              RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
            RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
           ";", " ", 
           RowBox[{
           "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
            " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
          "*)"}], 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"check", " ", "if", " ", "the", " ", 
          StyleBox["type",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], " ", "are", " ", "all", " ", 
          StyleBox["preserved",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  "idx"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"RemoveUnderBarredIndices", "[", 
                   RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ")"}]}], 
               "]"}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "}"}], "|", 
               RowBox[{"{", "1", "}"}]}], ")"}]}], "]"}], ")"}], "&&", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "We", " ", "can", " ", "only", " ", "move", " ", "on", " ", 
             "type", " ", "of", " ", "index"}], ",", " ", 
            RowBox[{"in", " ", 
             StyleBox["coordinate",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["basis",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["or",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["orthonormal",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["basis",
              FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
          RowBox[{"TestMoveOnlyOneType", "[", 
           RowBox[{"tt", ",", "idx"}], "]"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "outputindices", ",", "ttix", ",", "outputtensor", ",", "s", ",", "g",
          ",", "Invg", ",", "xxx123", ",", "i123", ",", "\[Mu]", ",", 
         "\[Nu]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "extract", " ", "relevant", " ", "indices", " ", "of", " ", "tt"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"ttix", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "replace", " ", "the", " ", "indices", " ", 
          "of", " ", "tt", " ", "with", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"ttix", ",", "idx"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"start", " ", "with"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"Normal", " ", "in", " ", "MoveIndices"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"outputtensor", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"TensorComponents", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "first", " ", "compute", " ", "metric", " ", "and", " ", "inverse", 
          " ", "and", " ", "extract", " ", "TensorComponents", " ", "of", " ",
           "tt"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"g", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SubscriptBox["\[Mu]", "-"], ",", 
            SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Invg", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "run", " ", "through", " ", "all", " ", 
          "relevant", " ", "indices", " ", "of", " ", "tt"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "compare", " ", "each", " ", "slot", " ", "with", " ", "the", " ", 
          "corresponding", " ", "one", " ", "in", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"different", " ", "sgn"}], ";", " ", 
             RowBox[{
             "append", " ", "appropriate", " ", "g", " ", "or", " ", 
              "Inv"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
             RowBox[{"raise", " ", "index"}], ";", " ", 
             RowBox[{"contract", " ", 
              SubscriptBox["T", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"i1", " ", "i2"}], " ", "..."}], " ", "j"}], " ", 
                 "..."}], " ", "iD"}]], " ", 
              SuperscriptBox["g", 
               RowBox[{"j", " ", "is"}]]}], ";", " ", 
             RowBox[{
             "then", " ", "transpose", " ", "to", " ", "get", " ", "the", " ",
               "right", " ", "ordering", " ", "of", " ", "indices"}]}], " ", 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "last", " ", "index", " ", "does", " ", "not", " ", "need", " ", 
             "to", " ", "be", " ", "further", " ", 
             RowBox[{"transposed", "!"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", "Invg"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "Invg"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"lower", " ", "index"}], ";", " ", 
              RowBox[{"contract", " ", 
               SuperscriptBox["T", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"i1", " ", "i2"}], " ", "..."}], " ", "j"}], " ", 
                  "..."}], " ", "iD"}]], " ", 
               SubscriptBox["g", 
                RowBox[{"j", " ", "is"}]]}], ";", " ", 
              RowBox[{
              "then", " ", "transpose", " ", "to", " ", "get", " ", "the", 
               " ", "right", " ", "ordering", " ", "of", " ", "indices"}]}], 
             " ", "*)"}], "\[IndentingNewLine]", 
            RowBox[{"(*", " ", 
             RowBox[{
             "last", " ", "index", " ", "does", " ", "not", " ", "need", " ", 
              "to", " ", "be", " ", "further", " ", 
              RowBox[{"transposed", "!"}]}], " ", "*)"}], 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", "g"}], "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "g"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", 
            RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", "output", " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tt", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxx123_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "outputtensor"}], ")"}]}],
            ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "i123_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"i123", "/.", "outputindices"}], ")"}]}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "OrthonormalFrameField"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MoveIndices", "[", 
       RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
         "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", 
         "and", " ", "idx"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
          RowBox[{"Length", "[", "idx", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "idx", " ", "contain", " ", "proper", " ", 
           "indices"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"(", 
            RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
           ";", " ", 
           RowBox[{
           "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
            " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
          "*)"}], 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "m", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}], 
             "\[Rule]", "onff"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"{", "m", "}"}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}],
               ")"}], "\[Rule]", "invonff"}], ",", "1"}], "]"}], "=!=", 
          RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"The", " ", "cases", " ", 
          RowBox[{"aren", "'"}], "t", " ", "taken", " ", "care", " ", "by", 
          " ", "previous", " ", 
          RowBox[{"code", "."}]}], "*)"}], 
        RowBox[{"!", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Union", "[", 
              RowBox[{"(*", 
               RowBox[{"Thread", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Head", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ")"}], "===", 
                    "Symbol"}], ")"}], ",", "1", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Head", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ")"}], "===", 
                    "OverHat"}], ")"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", "idx"}], ")"}], 
                 " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Head", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ")"}], "===", 
                    "Symbol"}], ")"}], ",", "1", ",", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Head", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ")"}], "===", 
                    "OverHat"}], ")"}], ",", 
                    RowBox[{"-", "1"}]}], "]"}], "&"}], "/@", 
                   RowBox[{"Indices", "[", "tt", "]"}]}], ")"}]}], "]"}], 
               "*)"}], 
              RowBox[{"Thread", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  "idx"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"RemoveUnderBarredIndices", "[", 
                   RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ")"}]}], 
               "]"}], "]"}], "===", 
             RowBox[{"{", "1", "}"}]}], ")"}], "&&", 
           RowBox[{"TestMoveOnlyOneType", "[", 
            RowBox[{"tt", ",", "idx"}], "]"}]}], ")"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"tt", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorType", "\[Rule]", "ttt_"}], ")"}], "\[Rule]", 
              "ttt"}]}], "]"}], "=!=", 
           RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}]}], "*)"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "outputindices", ",", "ttix", ",", "outputtensor", ",", "i123", ",", 
         "rank", ",", "idxlist", ",", "tttemp", ",", "idxlist2", ",", "fm", 
         ",", "onff", ",", "invonff", ",", "fmT", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "cc", ",", "s", ",", "ii"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"basic", " ", "arguments"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"rank", "=", 
         RowBox[{"RankNumber", "[", "idx", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ttix", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Obtain", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", "indices", " ", 
          "only", " ", "be", " ", 
          StyleBox["moved",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["by",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["metric",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxlist", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "ttix", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}], " ", 
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "idx", "\[LeftDoubleBracket]", "ii", 
                  "\[RightDoubleBracket]"}], "]"}]}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{
              RowBox[{"OverHatSgn", "[", 
               RowBox[{
               "ttix", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}], "]"}], "===", 
              RowBox[{"-", "1"}]}]}], ",", 
            RowBox[{"idxlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"idxlist", ",", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ttix", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
                 RowBox[{"idx", "\[LeftDoubleBracket]", 
                  RowBox[{"ii", ",", "0"}], "\[RightDoubleBracket]"}]}], 
                ")"}]}], "]"}]}], ",", "True", ",", 
            RowBox[{"idxlist", "=", 
             RowBox[{"Append", "[", 
              RowBox[{"idxlist", ",", 
               RowBox[{
               "ttix", "\[LeftDoubleBracket]", "ii", 
                "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "rank"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"First", " ", 
          StyleBox["MoveIndices",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tttemp", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"tt", ",", "idxlist", ",", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Obtain", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", "indices", " ", 
          "only", " ", "be", " ", 
          StyleBox["moved",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["by",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["FlatMetric",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxlist2", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"idxlist2", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"idxlist2", ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"idxlist", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
               RowBox[{"idx", "\[LeftDoubleBracket]", 
                RowBox[{"ii", ",", "0"}], "\[RightDoubleBracket]"}]}], 
              ")"}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", "rank"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["FlatMetric",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["orthonormal",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["frame",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["field",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{"stuff", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fm", "=", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"FlatMetric", "\[Rule]", "cc_"}], ")"}], "\[Rule]", 
             "cc"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"onff", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"OrthonormalFrameField", "\[Rule]", "cc_"}], ")"}], 
              "\[Rule]", "cc"}], ",", "1"}], "]"}], "\[LeftDoubleBracket]", 
           "1", "\[RightDoubleBracket]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"invonff", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "cc_"}], 
               ")"}], "\[Rule]", "cc"}], ",", "1"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Declare", " ", "FlatMetric", " ", "as", " ", "a", " ", 
          StyleBox["Tensor",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"fmT", "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["\[Mu]", "-"], ",", 
           SubscriptBox["\[Nu]", "-"], ",", "fm", ",", 
           RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
           RowBox[{"StartIndex", "\[Rule]", 
            RowBox[{"StartIndex", "[", "m", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Second", " ", "MoveIndices", " ", "with", " ", 
          RowBox[{
           StyleBox["FlatMetric",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"tttemp", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"tttemp", ",", "idxlist2", ",", "fmT"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "replace", " ", "the", " ", "indices", " ", 
          "of", " ", "tt", " ", "with", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"ttix", ",", "idx"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"start", " ", "with"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outputtensor", "=", 
         RowBox[{"TensorComponents", "[", "tt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "will", " ", "run", " ", "through", " ", "all", " ", 
          "relevant", " ", "indices", " ", "of", " ", "tt"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "compare", " ", "each", " ", "slot", " ", "with", " ", "the", " ", 
          "corresponding", " ", "one", " ", "in", " ", "idx"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Transform", " ", "between", " ", 
          StyleBox["orthonormal",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinate",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["and",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["basis",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["coordinate",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            StyleBox[
             RowBox[{
              SubscriptBox[
               OverscriptBox["\[Alpha]", "^"], "-"], "\[Rule]", 
              SubscriptBox["\[Mu]", "-"]}],
             FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", "rank"}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SubscriptBox[
                    SuperscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "onff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"rank", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "rank"}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Least", " ", "index", " ", 
                 RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                 RowBox[{"Transpose", "."}]}], "*)"}], 
               RowBox[{"s", "===", "rank"}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", 
                   RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SubscriptBox[
                    SuperscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "onff"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{"rank", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SubscriptBox["\[Mu]", "-"], "\[Rule]", 
               SubscriptBox[
                OverscriptBox["\[Alpha]", "^"], "-"]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SuperscriptBox[
                    SubscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "invonff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "invonff"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SuperscriptBox[
                StyleBox["\[Mu]",
                 FontColor->RGBColor[1, 0, 1]], "-"], "\[Rule]", 
               SuperscriptBox[
                StyleBox[
                 OverscriptBox["\[Alpha]", "^"],
                 FontColor->RGBColor[1, 0, 1]], "-"]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SubscriptBox[
                    SuperscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "onff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "onff"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             StyleBox[
              RowBox[{
               SuperscriptBox[
                StyleBox[
                 OverscriptBox["\[Alpha]", "^"],
                 FontColor->RGBColor[1, 0, 1]], "-"], "\[Rule]", 
               SuperscriptBox[
                StyleBox["\[Mu]",
                 FontColor->RGBColor[1, 0, 1]], "-"]}],
              FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "ttix", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", "1"}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}],
                 "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"outputtensor", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"outputtensor", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox[
                    SuperscriptBox[
                    SubscriptBox["\[Epsilon]", 
                    OverscriptBox["\[Alpha]", "^"]], "\[Mu]"],
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "invonff"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                    "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", 
                    RowBox[{"Length", "[", "idx", "]"}]}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"s", "===", 
                RowBox[{"Length", "[", "idx", "]"}]}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"outputtensor", ",", "invonff"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "idx", "]"}], "+", "1"}]}], "}"}], 
                  "}"}]}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", 
            RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         StyleBox["output",
          FontColor->RGBColor[1, 0, 1]], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tttemp", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxx123_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "outputtensor"}], ")"}]}],
            ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "i123_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Indices", "[", "tt", "]"}], "/.", "outputindices"}], 
               ")"}]}], ")"}]}]}], "}"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveIndices", "[", 
      RowBox[{"tt_Tensor", ",", "OrthonormalBasis", ",", "m_Tensor"}], "]"}], 
     "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
        "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", "and",
         " ", "idx"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
          ";", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
           " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
         "*)"}], 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}], 
            "\[Rule]", "onff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}], 
             ")"}], "\[Rule]", "invonff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "tt", "]"}], "]"}]}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", "1"}], ",", "#", ",", 
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
           RowBox[{"-", "1"}]}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"OverHat", "[", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "]"}], ")"}], "//", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"Indices", "[", "tt", "]"}]}], ",", "m"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MoveIndices", "[", 
      RowBox[{"tt_Tensor", ",", "CoordinateBasis", ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{
       "check", " ", "that", " ", "there", " ", "are", " ", "same", " ", 
        "number", " ", "of", " ", "indices", " ", "in", " ", "tt", " ", "and",
         " ", "idx"}], " ", "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
          ";", " ", 
          RowBox[{
          "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
           " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
         "*)"}], 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"OrthonormalFrameField", "\[Rule]", "onff_"}], ")"}], 
            "\[Rule]", "onff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"{", "m", "}"}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"InverseOrthonormalFrameField", "\[Rule]", "invonff_"}], 
             ")"}], "\[Rule]", "invonff"}], ",", "1"}], "]"}], "=!=", 
         RowBox[{"{", "Null", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "tt", "]"}], "]"}]}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", "1"}], ",", 
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "//", 
           RowBox[{
           "#", "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{
           RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
           RowBox[{"-", "1"}]}], ",", "#"}], "]"}], "&"}], "/@", 
       RowBox[{"Indices", "[", "tt", "]"}]}], ",", "m"}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.6697709526878996`*^9, 3.6697709567621326`*^9}, {3.6698259479070406`*^9, 
   3.6698259615764704`*^9}, {3.669826303628376*^9, 3.6698263128895936`*^9}, {
   3.6698270808996496`*^9, 3.669827085548458*^9}, {3.6698279958287897`*^9, 
   3.6698280147652407`*^9}, {3.6711274898826237`*^9, 
   3.6711275728375826`*^9}, {3.67112813167308*^9, 3.6711283135574245`*^9}, {
   3.671128889077386*^9, 3.6711288931003933`*^9}, {3.671130077000167*^9, 
   3.671130102411614*^9}, {3.6711301652814283`*^9, 3.6711301657494287`*^9}, {
   3.6711336012682314`*^9, 3.6711336155522614`*^9}, {3.6711337354231052`*^9, 
   3.671133802571046*^9}, {3.671134637455387*^9, 3.6711346393011904`*^9}, {
   3.6711368562485313`*^9, 3.6711369660607586`*^9}, {3.6711370118820477`*^9, 
   3.6711370578671484`*^9}, {3.6711371001150312`*^9, 
   3.6711372092000704`*^9}, {3.6711496093415504`*^9, 3.671149823732727*^9}, {
   3.671150208725803*^9, 3.671150242375062*^9}, {3.6711502760399213`*^9, 
   3.6711502773971233`*^9}, {3.6711503989681373`*^9, 
   3.6711504242713814`*^9}, {3.67115077093519*^9, 3.6711507754435987`*^9}, {
   3.6711510231472306`*^9, 3.6711510301360426`*^9}, {3.6711511545150614`*^9, 
   3.6711512315479965`*^9}, {3.6711516175082746`*^9, 
   3.6711516217046824`*^9}, {3.67115175711292*^9, 3.671151959975676*^9}, {
   3.6711520650262604`*^9, 3.6711522767030325`*^9}, {3.6711523724248004`*^9, 
   3.6711523726120005`*^9}, {3.6711524199268837`*^9, 
   3.6711524327969065`*^9}, {3.6711525118578453`*^9, 3.671152575677558*^9}, {
   3.6711526490600863`*^9, 3.6711527060937867`*^9}, 3.6711528707052755`*^9, {
   3.6711531637205906`*^9, 3.6711531825186234`*^9}, {3.6711534422746797`*^9, 
   3.6711534741455355`*^9}, {3.671156401246009*^9, 3.6711564200787983`*^9}, 
   3.6711565354030695`*^9, {3.6711567238309636`*^9, 3.671156735046136*^9}, {
   3.6711571206395583`*^9, 3.6711571211120653`*^9}, {3.671157182695512*^9, 
   3.6711571839655313`*^9}, {3.671157908978011*^9, 3.671157953147798*^9}, 
   3.671158067348332*^9, {3.6711581102608175`*^9, 3.6711582882286687`*^9}, {
   3.6711587438708615`*^9, 3.6711587580360794`*^9}, {3.6711589131002607`*^9, 
   3.6711589299004173`*^9}, {3.6711601244428263`*^9, 3.671160141190583*^9}, {
   3.6711604872033978`*^9, 3.6711604946335125`*^9}, {3.671160866844229*^9, 
   3.6711610180440516`*^9}, {3.671161172762429*^9, 3.6711611844576087`*^9}, {
   3.6711619106322355`*^9, 3.671161922139657*^9}, {3.671162268956931*^9, 
   3.671162269456132*^9}, {3.6711678585118375`*^9, 3.67116787079454*^9}, {
   3.671231290046423*^9, 3.671231297575037*^9}, {3.6712313325027018`*^9, 
   3.6712313358524084`*^9}, {3.6712315640817347`*^9, 
   3.6712315643469353`*^9}, {3.6712318291184893`*^9, 
   3.6712318294304895`*^9}, {3.6712324080856977`*^9, 3.671232408600498*^9}, {
   3.6712326006144733`*^9, 3.6712326108000917`*^9}, {3.6712326563289757`*^9, 
   3.671232659437782*^9}, {3.6712327594318686`*^9, 3.6712327682330866`*^9}, {
   3.6712329030403433`*^9, 3.6712329262708864`*^9}, {3.6712340623797555`*^9, 
   3.6712340678416653`*^9}, {3.6712353156195374`*^9, 
   3.6712353282152615`*^9}, {3.6712359786953845`*^9, 3.671235996519517*^9}, {
   3.671236102523715*^9, 3.6712361326914716`*^9}, {3.671236399625929*^9, 
   3.6712364185607634`*^9}, {3.671237006711313*^9, 3.6712370149681273`*^9}, 
   3.671237053949098*^9, {3.671237088982561*^9, 3.671237174034914*^9}, {
   3.671237216012889*^9, 3.6712372623151717`*^9}, {3.671237332856898*^9, 
   3.671237420601054*^9}, {3.6712374900089784`*^9, 3.6712374992204943`*^9}, {
   3.671237535342759*^9, 3.6712377025263577`*^9}, {3.6712377439377317`*^9, 
   3.671237763741067*^9}, {3.6712378151364584`*^9, 3.6712378769495687`*^9}, {
   3.671238019224722*^9, 3.6712380815894327`*^9}, {3.6712382006922445`*^9, 
   3.671238246170927*^9}, {3.671238647331741*^9, 3.671238685096408*^9}, {
   3.6712389094288096`*^9, 3.67123890964721*^9}, {3.671239152704443*^9, 
   3.671239177847987*^9}, 3.6712392716117787`*^9, {3.671252482533229*^9, 
   3.671252508418627*^9}, {3.6712537970003138`*^9, 3.67125379740032*^9}, {
   3.6712538309433355`*^9, 3.671253831138338*^9}, 3.6712538952918234`*^9, {
   3.727791540786441*^9, 3.7277915413880305`*^9}, {3.859507424050129*^9, 
   3.8595074398183503`*^9}, {3.8595077967332335`*^9, 3.859507798198323*^9}, {
   3.8595084390300016`*^9, 3.8595084555173965`*^9}, {3.8595085315823793`*^9, 
   3.859508556075876*^9}, {3.8595086109878817`*^9, 3.859508626340315*^9}, 
   3.859509139514032*^9, 3.8595092081349206`*^9, 3.859509441555049*^9, {
   3.86127806434093*^9, 3.8612780650110292`*^9}, {3.8612783584410524`*^9, 
   3.8612783640810213`*^9}, 3.8612807254060135`*^9, {3.861320203116994*^9, 
   3.8613202648811674`*^9}, {3.861320474749791*^9, 3.861320474906066*^9}, {
   3.861320521386611*^9, 3.861320529015644*^9}, {3.8613207078810005`*^9, 
   3.8613207095059505`*^9}, {3.8613207868995705`*^9, 3.86132078993221*^9}, {
   3.8613210534409432`*^9, 3.8613210738199215`*^9}, {3.861321405816964*^9, 
   3.8613214067148123`*^9}, {3.8613218385178947`*^9, 
   3.8613218640546875`*^9}, {3.8613219034253836`*^9, 3.861321916555071*^9}, 
   3.8613219821902966`*^9, {3.861322307966164*^9, 3.8613223602460947`*^9}, {
   3.861322584840629*^9, 3.861322585012477*^9}, {3.861322735600915*^9, 
   3.861322741446396*^9}, {3.861322783023175*^9, 3.861322793227331*^9}, {
   3.8613228433160267`*^9, 3.861322846615349*^9}, {3.86132290910822*^9, 
   3.861322928754201*^9}, {3.8613230129959726`*^9, 3.8613230201847744`*^9}, {
   3.8613235819582224`*^9, 3.861323590633213*^9}, {3.8613346830929165`*^9, 
   3.8613346999455433`*^9}, {3.8613347359863515`*^9, 
   3.8613347554563637`*^9}, {3.861648813732291*^9, 3.86164882527402*^9}, {
   3.8617023909787507`*^9, 3.8617023996818743`*^9}, {3.8617496742104416`*^9, 
   3.8617497306902494`*^9}, 3.8617497609102507`*^9, {3.8617497911303673`*^9, 
   3.8617498977702675`*^9}, {3.861749945596493*^9, 3.8617499982429595`*^9}, {
   3.861750253450308*^9, 3.861750254232177*^9}, {3.8617503351599903`*^9, 
   3.861750348809881*^9}, {3.8617504235104065`*^9, 3.861750433960668*^9}, {
   3.861750465130866*^9, 3.861750485210384*^9}, {3.8617505217399054`*^9, 
   3.8617505440603914`*^9}, {3.8617505780304446`*^9, 
   3.8617505938806343`*^9}, {3.861750628800365*^9, 3.8617506289604273`*^9}, {
   3.8617509009805555`*^9, 3.8617509016407423`*^9}, 3.861750932990773*^9, 
   3.8617509968058124`*^9, {3.8617510335204115`*^9, 3.8617510339404626`*^9}, 
   3.8617510956604877`*^9, {3.861751176090515*^9, 3.8617511933704996`*^9}, {
   3.861751256030507*^9, 3.8617512659805665`*^9}, {3.861751643750515*^9, 
   3.8617516682588606`*^9}, {3.861751750191495*^9, 3.8617518210302863`*^9}, 
   3.861751873921317*^9, 3.861766643035576*^9, 3.86176684326286*^9, {
   3.861936728178451*^9, 3.861936730028886*^9}, {3.861936784677888*^9, 
   3.8619368486384706`*^9}, {3.8619381981853743`*^9, 3.861938206895655*^9}, {
   3.861939331147955*^9, 3.861939507628111*^9}, {3.861939629680274*^9, 
   3.8619396964179025`*^9}, {3.861939731667883*^9, 3.8619397644102983`*^9}, {
   3.8619398116548414`*^9, 3.8619398120376263`*^9}, {3.8619398650483418`*^9, 
   3.861939866503418*^9}, {3.8619399230744724`*^9, 3.8619399235171127`*^9}, {
   3.861939957687299*^9, 3.8619399580994415`*^9}, {3.86194001794092*^9, 
   3.861940046709462*^9}, {3.862538813692727*^9, 3.86253883571146*^9}, {
   3.8627087419369917`*^9, 3.862708750185024*^9}, {3.8651172084234433`*^9, 
   3.865117261142193*^9}, {3.865117303501568*^9, 3.8651173043296947`*^9}, 
   3.865119248698264*^9, {3.8651198440468054`*^9, 3.865120012320426*^9}, {
   3.866706809562356*^9, 3.8667068097472878`*^9}, {3.8667068471214466`*^9, 
   3.866706868786438*^9}, {3.8667069374856215`*^9, 3.8667069592835283`*^9}, {
   3.8667069912179117`*^9, 3.866706998486289*^9}, {3.8667669781924534`*^9, 
   3.8667669806906414`*^9}, 3.8667672762563457`*^9, {3.8757559851157503`*^9, 
   3.8757560139199195`*^9}, {3.875756051342039*^9, 3.8757561362107987`*^9}, {
   3.8763610758860817`*^9, 3.8763610985746155`*^9}, {3.8763629875553503`*^9, 
   3.8763630268208265`*^9}, 3.8860342709645314`*^9, 3.886036799517524*^9, {
   3.8915170280828485`*^9, 3.8915170627527013`*^9}, {3.8950590016886234`*^9, 
   3.895059027022355*^9}, {3.895554774547974*^9, 3.8955547745759783`*^9}, {
   3.8955551722476854`*^9, 3.8955551722896605`*^9}, {3.8955554988180103`*^9, 
   3.8955555268035326`*^9}, {3.8993774138859177`*^9, 3.899377426359249*^9}, {
   3.9028241046894984`*^9, 
   3.902824119064123*^9}},ExpressionUUID->"92a3c042-dbe0-47d4-9c1c-\
a11b13a56496"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"old", " ", "code", " ", "\[IndentingNewLine]", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{"tt_Tensor", ",", "idx_List", ",", "m_Tensor"}], "]"}]}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "same", " ", "number", " ", "of", " ", "active", " ", 
         "indices", " ", "in", " ", "tt", " ", "and", " ", "idx"}], " ", 
        "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "tt", "]"}], "]"}], "]"}], "===", 
          RowBox[{"Length", "[", "idx", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
          "check", " ", "idx", " ", "contain", " ", "proper", " ", 
           "indices"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"(", 
            RowBox[{"TestIndices", "/@", "idx"}], ")"}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], 
           ";", " ", 
           RowBox[{
           "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
            " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
          "*)"}], 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tt1", ",", "outputindices", ",", "outidxRules", ",", "nx", ",", "sx",
          ",", "ix", ",", "ttix", ",", "g", ",", "Invg", ",", "\[Mu]", ",", 
         "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",", "\[Sigma]", ",", 
         "ttM", ",", "i", ",", "pos", ",", "\[CapitalSigma]", ",", "MetricG", 
         ",", "si", ",", "comehere", ",", "iidx"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outidxRules", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "tt", "]"}], "]"}], ",", "idx"}], "]"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"idx", " ", "may", " ", "contain", " ", "non"}], "-", 
           RowBox[{"abstract", " ", "indices"}]}], ";", " ", 
          RowBox[{
          "so", " ", "we", " ", "replace", " ", "everything", " ", "with", 
           " ", "dummy", " ", "indices", " ", "for", " ", "now"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ttix", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"#", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"SuperMinus", "[", "sx_", "]"}], "\[Rule]", 
                RowBox[{"SuperMinus", "[", 
                 RowBox[{"Unique", "[", "\[Mu]", "]"}], "]"}]}], ",", 
               RowBox[{
                RowBox[{"SuperPlus", "[", "sx_", "]"}], "\[Rule]", 
                RowBox[{"SuperPlus", "[", 
                 RowBox[{"Unique", "[", "\[Mu]", "]"}], "]"}]}]}], "}"}]}], 
            ")"}], "&"}], "/@", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "tt", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "replace", " ", "indices", " ", "with", " ", "these", " ", "dummy", 
          " ", "ones"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"tt1", "=", 
         RowBox[{"tt", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "tt", "]"}], "]"}], ",", "ttix"}], 
            "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "do", " ", "the", " ", "same", " ", "for", " ", "idx", " ", "using", 
          " ", "the", " ", "same", " ", "dummy", " ", "symbols"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"iidx", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", 
         RowBox[{
          RowBox[{"iidx", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"iidx", ",", 
             RowBox[{
              RowBox[{
              "idx", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"SuperMinus", "[", "sx_", "]"}], "\[Rule]", 
                 RowBox[{"SuperMinus", "[", 
                  RowBox[{
                   RowBox[{
                   "ttix", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"SuperPlus", "[", "sx_", "]"}], "\[Rule]", 
                 RowBox[{"SuperPlus", "[", 
                  RowBox[{
                   RowBox[{
                   "ttix", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "]"}]}]}], "}"}]}]}], "]"}]}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", 
            RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "we", " ", "really", " ", "only", " ", "need", " ", "to", " ", 
          "move", " ", "indices", " ", "when", " ", "they", " ", "are", " ", 
          "opposite", " ", "in", " ", "sign", " ", "to", " ", "those", " ", 
          "in", " ", "tt"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "so", " ", "first", " ", "we", " ", "delete", " ", "everything", " ",
           "in", " ", "idx", " ", "that", " ", "shows", " ", "up", " ", "in", 
          " ", "ttix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ix", "=", 
         RowBox[{"DeleteCases", "[", 
          RowBox[{"iidx", ",", 
           RowBox[{"xxxx_", "/;", 
            RowBox[{"MemberQ", "[", 
             RowBox[{"ttix", ",", "xxxx"}], "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"ix", "===", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"ttM", "=", 
            RowBox[{"TensorComponents", "[", "tt", "]"}]}], ";", 
           RowBox[{"Goto", "[", "comehere", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"new", " ", "indices", " ", "for", " ", "tt"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"outputindices", "=", 
           RowBox[{"(", 
            RowBox[{"ttix", "/.", 
             RowBox[{"Thread", "[", 
              RowBox[{"Rule", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Which", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "===", "1"}], ",", 
                    RowBox[{"SubMinus", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "===", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "]"}], "&"}], "/@", 
                 "ix"}], ",", "ix"}], "]"}], "]"}]}], ")"}]}], ";"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{
          RowBox[{"Indices", "[", "tt", "]"}], "/.", "outidxRules"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "compute", " ", "metric", " ", "and", " ", "inverse", " ", "and", 
          " ", "extract", " ", "TensorComponents", " ", "of", " ", "tt"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "[", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["\[Mu]", "-"], ",", 
           SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Invg", "[", 
          RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SuperscriptBox["\[Mu]", "-"], ",", 
           SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"MetricG", "[", 
           RowBox[{"\[Mu]_", ",", "\[Nu]_"}], "]"}], "/;", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sgn", "[", "\[Mu]", "]"}], "===", 
            RowBox[{"Sgn", "[", "\[Nu]", "]"}]}], ")"}]}], ":=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "\[Mu]", "]"}], "===", "1"}], ",", 
           RowBox[{"Invg", "[", 
            RowBox[{
             RowBox[{
             "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "\[Nu]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{
            RowBox[{"Sgn", "[", "\[Mu]", "]"}], "===", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"g", "[", 
            RowBox[{
             RowBox[{
             "\[Mu]", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             ",", 
             RowBox[{
             "\[Nu]", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "set", " ", "up", " ", "dummy", " ", "summation", " ", "variables"}],
          " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[CapitalSigma]", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "&"}], "/@", "ix"}], ")"}], ",", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Unique", "[", "\[Sigma]", "]"}], "&"}], "/@", "ix"}], 
             ")"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{"m", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "iii_"}], ")"}], "\[Rule]", 
              "iii"}], ",", "\[Infinity]"}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"aum", " ", "over", " ", "contraction", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ttM", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"tt1", "/.", "\[CapitalSigma]"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"Times", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"MetricG", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"(", 
                    RowBox[{"#", "/.", "\[CapitalSigma]"}], ")"}]}], "]"}], 
                  "&"}], "/@", "ix"}], ")"}]}], ")"}]}], ")"}], ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "/.", "\[CapitalSigma]"}], 
                   ")"}], ",", "si", ",", 
                  RowBox[{"si", "+", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
                   "1"}]}], "}"}], "&"}], "/@", "ix"}], ")"}]}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "all", " ", "relevant", " ", "indices", " ", "in", " ", "new", " ", 
          "tt"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ttM", "=", 
         RowBox[{"Table", "[", 
          RowBox[{"ttM", ",", 
           RowBox[{"Evaluate", "[", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "si", ",", 
                  RowBox[{"si", "-", "1", "+", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}]}], "}"}], 
                "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "all", " ", "relevant", " ", "indices", " ", "in", " ", "tt",
                   " ", 
                  RowBox[{"w", "/", " ", "contraction"}], " ", "indices", " ",
                   "replaced", " ", "with", " ", "dummy", " ", "ones"}], " ", 
                 "*)"}], 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", 
                   RowBox[{"RemoveUnderBarredIndices", "[", "ttix", "]"}]}], 
                  ")"}], "]"}], ")"}]}], ")"}]}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"output", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Label", "[", "comehere", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"tt", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "xxx123_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ttM"}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "i123_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "outputindices"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], " ", "\[IndentingNewLine]", 
      "]"}]}], ";"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MoveIndices", "[", 
     RowBox[{"tt_Tensor", ",", "m_Tensor"}], "]"}], " ", "basically", " ", 
    "returns", " ", "tt", " ", "with", " ", "readily", " ", "moveable", " ", 
    "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "it"}], " ", "returns", " ", 
     RowBox[{"output", "[", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", 
       RowBox[{"\[Gamma]", "..."}]}], "]"}], " ", "where", " ", "output"}], 
    " ", "=", " ", 
    RowBox[{
    "tt", " ", "except", " ", "the", " ", "indices", " ", "are", " ", 
     "automatically", " ", "moved", " ", "with", " ", "the", " ", "metric", 
     " ", "m", " ", "if", " ", "there", " ", "were", " ", "different", " ", 
     "from", " ", "the", " ", "original", " ", "input"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"problem", ":", " ", 
    RowBox[{
    "how", " ", "to", " ", "create", " ", "arbitrary", " ", "number", " ", 
     "of", " ", 
     RowBox[{"arguments", "?"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MoveIndices", "[", 
       RowBox[{"tt_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], ";",
          " ", 
         RowBox[{
         "we", " ", "are", " ", "going", " ", "use", " ", "it", " ", "to", 
          " ", "move", " ", "the", " ", "indices", " ", "with"}]}], " ", 
        "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"m", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tttt_"}], ")"}], "\[Rule]", 
            "tttt"}], ",", "\[Infinity]"}], "]"}], "===", 
         RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Alpha]", ",", "idx", ",", "newix", ",", "i1", ",", "i2", ",", "op",
          ",", "n"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "tt", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "feed", " ", "MoveIndices", " ", "the", " ", "original", " ", 
           "indices", " ", "in", " ", "tt"}], ",", " ", 
          RowBox[{"i", ".", "e", ".", " ", "idx"}], ",", " ", 
          RowBox[{
          "except", " ", "it", " ", "is", " ", "moved", " ", "according", " ",
            "to", " ", "newix"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MoveIndices", "[", 
             RowBox[{"tt", ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"Slot", "[", "n", "]"}], ",", 
                    RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], ",", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{
                    "idx", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"], ",", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"Slot", "[", "n", "]"}], ",", 
                    RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], ",", 
                  SubscriptBox[
                   RowBox[{
                    RowBox[{
                    "idx", "\[LeftDoubleBracket]", "n", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"n", ",", "1", ",", 
                  RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], ",", 
              "m"}], "]"}], "/.", 
            RowBox[{"(", 
             RowBox[{"(*", " ", 
              RowBox[{
              "after", " ", "MoveIndices", " ", "have", " ", "moved", " ", 
               "the", " ", "indices", " ", "accordingly", " ", "we", " ", 
               "need", " ", "to", " ", "replace", " ", "the", " ", "names", 
               " ", "with", " ", "the", " ", "ones", " ", "in", " ", 
               "newix"}], " ", "*)"}], 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Rule", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "idx", "\[LeftDoubleBracket]", "n", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{"Slot", "[", "n", "]"}], "\[LeftDoubleBracket]", 
                  "1", "\[RightDoubleBracket]"}]}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"n", ",", "1", ",", 
                 RowBox[{"Length", "[", "idx", "]"}]}], "}"}]}], "]"}], 
             ")"}]}], ")"}], "]"}], "&"}]}]}], "]"}]}], ";"}], " ", 
   "*)"}]}]], "Input",
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.6697709526878996`*^9, 3.6697709567621326`*^9}, {3.6698259479070406`*^9, 
   3.6698259615764704`*^9}, {3.669826303628376*^9, 3.6698263128895936`*^9}, {
   3.6698270808996496`*^9, 3.669827085548458*^9}, {3.6698279958287897`*^9, 
   3.6698280147652407`*^9}, {3.6711274898826237`*^9, 
   3.6711275728375826`*^9}, {3.67112813167308*^9, 3.6711283135574245`*^9}, {
   3.671128889077386*^9, 3.6711288931003933`*^9}, {3.671130077000167*^9, 
   3.671130102411614*^9}, {3.6711301652814283`*^9, 3.6711301657494287`*^9}, {
   3.6711336012682314`*^9, 3.6711336155522614`*^9}, {3.6711337354231052`*^9, 
   3.671133802571046*^9}, {3.671134637455387*^9, 3.6711346393011904`*^9}, {
   3.6711368562485313`*^9, 3.6711369660607586`*^9}, {3.6711370118820477`*^9, 
   3.6711370578671484`*^9}, {3.6711371001150312`*^9, 
   3.6711372092000704`*^9}, {3.6711496093415504`*^9, 3.671149823732727*^9}, {
   3.671150208725803*^9, 3.671150242375062*^9}, {3.6711502760399213`*^9, 
   3.6711502773971233`*^9}, {3.6711503989681373`*^9, 
   3.6711504242713814`*^9}, {3.67115077093519*^9, 3.6711507754435987`*^9}, {
   3.6711510231472306`*^9, 3.6711510301360426`*^9}, {3.6711511545150614`*^9, 
   3.6711512315479965`*^9}, {3.6711516175082746`*^9, 
   3.6711516217046824`*^9}, {3.67115175711292*^9, 3.671151959975676*^9}, {
   3.6711520650262604`*^9, 3.6711522767030325`*^9}, {3.6711523724248004`*^9, 
   3.6711523726120005`*^9}, {3.6711524199268837`*^9, 
   3.6711524327969065`*^9}, {3.6711525118578453`*^9, 3.671152575677558*^9}, {
   3.6711526490600863`*^9, 3.6711527060937867`*^9}, 3.6711528707052755`*^9, {
   3.6711531637205906`*^9, 3.6711531825186234`*^9}, {3.6711534422746797`*^9, 
   3.6711534741455355`*^9}, {3.671156401246009*^9, 3.6711564200787983`*^9}, 
   3.6711565354030695`*^9, {3.6711567238309636`*^9, 3.671156735046136*^9}, {
   3.6711571206395583`*^9, 3.6711571211120653`*^9}, {3.671157182695512*^9, 
   3.6711571839655313`*^9}, {3.671157908978011*^9, 3.671157953147798*^9}, 
   3.671158067348332*^9, {3.6711581102608175`*^9, 3.6711582882286687`*^9}, {
   3.6711587438708615`*^9, 3.6711587580360794`*^9}, {3.6711589131002607`*^9, 
   3.6711589299004173`*^9}, {3.6711601244428263`*^9, 3.671160141190583*^9}, {
   3.6711604872033978`*^9, 3.6711604946335125`*^9}, {3.671160866844229*^9, 
   3.6711610180440516`*^9}, {3.671161172762429*^9, 3.6711611844576087`*^9}, {
   3.6711619106322355`*^9, 3.671161922139657*^9}, {3.671162268956931*^9, 
   3.671162269456132*^9}, {3.6711678585118375`*^9, 3.67116787079454*^9}, {
   3.671231290046423*^9, 3.671231297575037*^9}, {3.6712313325027018`*^9, 
   3.6712313358524084`*^9}, {3.6712315640817347`*^9, 
   3.6712315643469353`*^9}, {3.6712318291184893`*^9, 
   3.6712318294304895`*^9}, {3.6712324080856977`*^9, 3.671232408600498*^9}, {
   3.6712326006144733`*^9, 3.6712326108000917`*^9}, {3.6712326563289757`*^9, 
   3.671232659437782*^9}, {3.6712327594318686`*^9, 3.6712327682330866`*^9}, {
   3.6712329030403433`*^9, 3.6712329262708864`*^9}, {3.6712340623797555`*^9, 
   3.6712340678416653`*^9}, {3.6712353156195374`*^9, 
   3.6712353282152615`*^9}, {3.6712359786953845`*^9, 3.671235996519517*^9}, {
   3.671236102523715*^9, 3.6712361326914716`*^9}, {3.671236399625929*^9, 
   3.6712364185607634`*^9}, {3.671237006711313*^9, 3.6712370149681273`*^9}, 
   3.671237053949098*^9, {3.671237088982561*^9, 3.671237174034914*^9}, {
   3.671237216012889*^9, 3.6712372623151717`*^9}, {3.671237332856898*^9, 
   3.671237420601054*^9}, {3.6712374900089784`*^9, 3.6712374992204943`*^9}, {
   3.671237535342759*^9, 3.6712377025263577`*^9}, {3.6712377439377317`*^9, 
   3.671237763741067*^9}, {3.6712378151364584`*^9, 3.6712378769495687`*^9}, {
   3.671238019224722*^9, 3.6712380815894327`*^9}, {3.6712382006922445`*^9, 
   3.671238246170927*^9}, {3.671238647331741*^9, 3.671238685096408*^9}, {
   3.6712389094288096`*^9, 3.67123890964721*^9}, {3.671239152704443*^9, 
   3.671239177847987*^9}, 3.6712392716117787`*^9, {3.671252482533229*^9, 
   3.671252495188423*^9}, 3.8955547745959787`*^9, 
   3.8955551722946577`*^9},ExpressionUUID->"267b9797-6b2b-430c-a9b6-\
975c0ade72be"]
}, Closed]],

Cell[CellGroupData[{

Cell["RaiseAllIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}, {3.6695632003793564`*^9, 
   3.6695632027043686`*^9}},ExpressionUUID->"3f734fc5-9c3f-4157-ab30-\
9d3e379fab20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"RaiseAllIndices", "[", 
     RowBox[{"tt_Tensor", ",", "m_Tensor"}], "]"}], " ", "returns", " ", "tt",
     " ", "with", " ", "all", " ", "its", " ", "indices", " ", "raised"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"RaiseAllIndices", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}]}], ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "idx", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "strip", " ", "off", " ", "all", " ", "the", " ", "SubMinus", " ", 
         "and", " ", "SuperMinus", " ", "and", " ", "then", " ", "replace", 
         " ", "them", " ", "all", " ", "with", " ", "SuperMinus"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SuperMinus", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"t", ",", "idx", ",", "m"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RaiseAllIndices", "[", 
     RowBox[{
      RowBox[{"t_Tensor", "/;", 
       RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", "t"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"RaiseAllIndices", "[", 
     RowBox[{
      RowBox[{"t_", "/;", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    "t"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.669593004802393*^9, 
   3.6695930225264063`*^9}, {3.66959321315331*^9, 3.6695932649702735`*^9}, {
   3.6695933127800083`*^9, 3.669593345813897*^9}, {3.6695933925994377`*^9, 
   3.6695934028360233`*^9}, {3.6695934797294216`*^9, 
   3.6695934816175294`*^9}, {3.6695943890364923`*^9, 
   3.6695943905115767`*^9}, {3.6696949698389616`*^9, 3.669694977298972*^9}, {
   3.6697669687191277`*^9, 3.6697669750864916`*^9}, {3.6697718596827335`*^9, 
   3.669771881028954*^9}, 3.893146170647874*^9, {3.8932891243125167`*^9, 
   3.893289124314515*^9}, {3.8955551722986565`*^9, 3.8955551723026547`*^9}, {
   3.895555339819285*^9, 3.8955553398213973`*^9}, 
   3.8955558383574915`*^9},ExpressionUUID->"0175fc62-84a9-4af5-bd42-\
c8f70b287fdb"]
}, Closed]],

Cell[CellGroupData[{

Cell["LowerAllIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}, {3.6695632003793564`*^9, 
   3.669563216695396*^9}},ExpressionUUID->"7ae3a39d-25a1-4c31-ab81-\
6f0c1e5a8675"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"LowerAllIndices", "[", 
     RowBox[{"tt_Tensor", ",", "m_Tensor"}], "]"}], " ", "returns", " ", "tt",
     " ", "with", " ", "all", " ", "its", " ", "indices", " ", "lowered"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LowerAllIndices", "[", 
      RowBox[{
       RowBox[{"t_Tensor", "/;", 
        RowBox[{"!", 
         RowBox[{"TestScalarTensor", "[", "t", "]"}]}]}], ",", 
       RowBox[{"m_Tensor", "/;", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "idx", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "strip", " ", "off", " ", "all", " ", "the", " ", "SubMinus", " ", 
         "and", " ", "SuperMinus", " ", "and", " ", "then", " ", "replace", 
         " ", "them", " ", "all", " ", "with", " ", "SuperMinus"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"idx", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"SubMinus", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"t", ",", "idx", ",", "m"}], "]"}]}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LowerAllIndices", "[", 
     RowBox[{
      RowBox[{"t_Tensor", "/;", 
       RowBox[{"TestScalarTensor", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", "t"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LowerAllIndices", "[", 
     RowBox[{
      RowBox[{"t_", "/;", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ",", 
      RowBox[{"m_Tensor", "/;", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], ":=", 
    "t"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563245602455*^9, 3.6695632500054617`*^9}, {3.6695935326524487`*^9, 
   3.6695935513725195`*^9}, {3.6695943853782835`*^9, 3.669594386452345*^9}, 
   3.669694981774984*^9, {3.669766981158839*^9, 3.669766983073949*^9}, {
   3.669771863596957*^9, 3.6697718761196733`*^9}, {3.8931327914010267`*^9, 
   3.893132791530949*^9}, {3.893145671826922*^9, 3.893145672818314*^9}, 
   3.8931461848731637`*^9, {3.893289124323509*^9, 3.893289124325508*^9}, {
   3.89555517230665*^9, 3.8955551723096485`*^9}, {3.8955553398262796`*^9, 
   3.8955553398292785`*^9}, 
   3.895555838361489*^9},ExpressionUUID->"3d65c77e-074d-4df2-90b5-\
34a2dc446b2d"]
}, Closed]],

Cell[CellGroupData[{

Cell["UniqueIndices", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.606329216258676*^9, 3.6063292218312616`*^9}, 3.606497441942197*^9, {
   3.606512368464484*^9, 3.606512376678954*^9}, {3.630042521633257*^9, 
   3.6300425280604687`*^9}, {3.6695632003793564`*^9, 
   3.6695632027043686`*^9}, {3.6695727851785326`*^9, 
   3.6695727922199354`*^9}, {3.669573170398018*^9, 
   3.6695731714178257`*^9}},ExpressionUUID->"3e71db93-4edc-48aa-a385-\
44c9fa8f6a67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"UniqueIndices", "[", "tt_Tensor", "]"}], " ", "returns", " ", 
    "tt", " ", "with", " ", "its", " ", "indices", " ", "made", " ", 
    "unique"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"UniqueIndices", "[", "t_Tensor", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"idx", ",", "xxx"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "strip", " ", "off", " ", "the", " ", "SubMinus", " ", "and", " ", 
        "SuperMinus"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"idx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "&"}], "/@", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "replace", " ", "them", " ", "with", " ", "Unique", " ", "ones"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"idx", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"Unique", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
         "idx"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"xxx", "/.", "idx"}], ")"}]}], ")"}]}]}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.6695727962541666`*^9, 
   3.66957280296255*^9}, {3.669573160323732*^9, 3.6695733097357454`*^9}, {
   3.669573543305316*^9, 3.6695735549105425`*^9}, {3.6695753844657793`*^9, 
   3.6695754468221025`*^9}, {3.669576382567544*^9, 3.669576384573659*^9}, 
   3.6695765844990935`*^9, {3.6695797133373833`*^9, 3.6695797652163506`*^9}, {
   3.669579961087554*^9, 3.6695799627676497`*^9}, 3.669694993946001*^9, {
   3.669767001915026*^9, 3.669767003877138*^9}, 
   3.669771853829398*^9},ExpressionUUID->"5d3c4916-383f-4df9-8f0d-\
5bc252b8f0ac"]
}, Closed]],

Cell[CellGroupData[{

Cell["SymmetrizeIndices", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
   3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
   3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
   3.7277792645777283`*^9}, {3.8430970828593497`*^9, 3.843097090194527*^9}, {
   3.843097987499811*^9, 3.843097991491143*^9}, 3.8436019540581245`*^9, 
   3.8439584389127026`*^9},ExpressionUUID->"2f9c189e-c61f-4528-b068-\
5ee78157f7a7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{"NewCode", ":", " ", "SymmetrizeIndices"}],
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    StyleBox["Partially",
     FontColor->RGBColor[1, 0, 1]], " ", "SymmetrizeIndices"}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"SymmetrizeIndices", "[", 
       RowBox[{"TargetIndices_List", ",", "t_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"Check", ":", " ", 
        RowBox[{
        "All", " ", "indices", " ", "in", " ", "TargetIndices", " ", "should",
          " ", "be", " ", "included", " ", "in", " ", "Indices", " ", "list", 
         " ", "of", " ", "t"}]}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "TargetIndices"}], 
        "]"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "indices2", ",", "takelist", ",", "targetposition", 
         ",", "newindiceslist", ",", "m", ",", "UntouchedIdx", ",", " ", 
         "ListwithVerticleBar"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"indices2", ":", " ", 
         RowBox[{"Extract", " ", "extracting", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["preserving",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["UnderBar",
            FontColor->RGBColor[1, 0, 1]], ".", " ", "This"}], " ", "will", 
          " ", "be", " ", "used", " ", "at", " ", "the", " ", "end"}]}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices2", "=", 
         RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"indices", ":", 
           RowBox[{"Extract", " ", 
            StyleBox["Indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["removing",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["UnderBar",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "Since"}], " ", 
            "UnderBar", " ", "has", " ", "no", " ", "meaning", " ", "in", " ",
             "this", " ", "operation"}]}], ",", 
          RowBox[{"we", " ", "should", " ", "remove", " ", "them", " ", 
           RowBox[{"first", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", "indices2", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"UntouchedIdx", ":", " ", 
           RowBox[{
           "To", " ", "add", " ", "curly", " ", "bracket", " ", "and", " ", 
            "vertical", " ", "bar", " ", "in", " ", "the", " ", "output", " ",
             "indices", " ", "list"}]}], ",", " ", 
          RowBox[{"we", " ", "should", " ", "extract", " ", 
           StyleBox["those",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["in",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["excluded",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["from",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["TargetIndices",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "use", " ",
            "Complement", " ", "to", " ", "get", " ", 
           RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"UntouchedIdx", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"indices", ",", "TargetIndices"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"targetposition", ":", " ", 
          RowBox[{
          "We", " ", "convert", " ", "TargetIndices", " ", "into", " ", "the",
            " ", "position", " ", 
           RowBox[{
            StyleBox["number",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"targetposition", "=", 
         RowBox[{"Sort", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"indices", ",", "#"}], "]"}], "&"}], "/@", 
            "TargetIndices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"m", " ", "is", " ", "the", " ", "output", " ", 
          RowBox[{
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "get", " ", 
          "the", " ", "symmetrized", " ", "tensor", " ", "of", " ", 
          RowBox[{"\"\<t\>\"", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Note", " ", "that", " ", "in", " ", "our", " ", "definition"}], 
          ",", " ", 
          RowBox[{"we", " ", "have", " ", "a", " ", 
           StyleBox["factorial",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coefficient",
            FontColor->RGBColor[1, 0, 1]], " ", "difference", " ", 
           RowBox[{"w", "/", " ", 
            RowBox[{"Mathematica", "'"}]}], "s", " ", 
           RowBox[{"one", "."}]}]}], "*)"}], 
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "TargetIndices", "]"}], "!"}], 
           RowBox[{"Normal", "[", 
            RowBox[{"Symmetrize", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", "t", "]"}], ",", 
              RowBox[{"Symmetric", "[", "targetposition", "]"}]}], "]"}], 
            "]"}]}], "//", 
          RowBox[{"OptionValue", "[", "SymmetrizeIndicesOperator", "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"From", " ", "here"}], ",", 
          RowBox[{
          "we", " ", "start", " ", "to", " ", "prepare", " ", "the", " ", 
           StyleBox["output",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Take", " ", "the", " ", "list", " ", "between", " ", "the", " ", 
          StyleBox["first",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "the", " ", 
          StyleBox["last",
           FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", "which", " ", 
          "need", " ", "to", " ", "be", " ", 
          RowBox[{"symmetrize", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"takelist", "=", 
         RowBox[{"Take", "[", 
          RowBox[{"indices", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"First", "[", "targetposition", "]"}], ",", 
             RowBox[{"Last", "[", "targetposition", "]"}]}], "}"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Extract", " ", "the", " ", "indices", " ", "which", " ", "need", 
           " ", "to", " ", "add", " ", "vertical", " ", "bars", " ", "around",
            " ", "them"}], ",", 
          RowBox[{
          "by", " ", "getting", " ", "intersection", " ", "of", " ", 
           "takelist", " ", "and", " ", "UntouchedIdx"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ListwithVerticleBar", "=", 
         RowBox[{"takelist", "\[Intersection]", "UntouchedIdx"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Output", " ", "indices", " ", "list"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], 
        RowBox[{"newindiceslist", "=", 
         RowBox[{"indices2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "TargetIndices", "]"}], "\[Rule]", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"UnderBar", "[", "\"\<{\>\"", "]"}], "//", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"First", "[", "TargetIndices", "]"}], ")"}], 
                 "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
               ",", 
               RowBox[{"First", "[", "TargetIndices", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "TargetIndices", "]"}], "\[Rule]", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{"Last", "[", "TargetIndices", "]"}], ",", 
               RowBox[{
                RowBox[{"UnderBar", "[", "\"\<}\>\"", "]"}], "//", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Last", "[", "TargetIndices", "]"}], ")"}], 
                 "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
              "]"}]}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Rule", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], "&"}], "/@",
                "ListwithVerticleBar"}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Change", " ", 
          StyleBox["TensorComponents",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "m"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "newindiceslist"}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"Fully", " ", "SymmetrizeIndices"}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymmetrizeIndices", "[", 
      RowBox[{"t_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"SymmetrizeIndices", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Recall", " ", 
         StyleBox["Partially",
          FontColor->RGBColor[1, 0, 1]], " ", "SymmetrizeIndices"}], ",", " ", 
        RowBox[{"but", " ", "symmetrize", " ", 
         RowBox[{"w", "/", " ", "all"}], " ", 
         RowBox[{"indices", "."}]}]}], "*)"}], 
      RowBox[{
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "t", ",", 
       RowBox[{"SymmetrizeIndicesOperator", "\[Rule]", 
        RowBox[{"OptionValue", "[", "SymmetrizeIndicesOperator", "]"}]}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.6695727962541666`*^9, 
   3.66957280296255*^9}, {3.669573160323732*^9, 3.6695733097357454`*^9}, {
   3.669573543305316*^9, 3.6695735549105425`*^9}, {3.6695753844657793`*^9, 
   3.6695754468221025`*^9}, {3.669576382567544*^9, 3.669576384573659*^9}, 
   3.6695765844990935`*^9, {3.6695797133373833`*^9, 3.6695797652163506`*^9}, {
   3.669579961087554*^9, 3.6695799627676497`*^9}, 3.669694993946001*^9, {
   3.669767001915026*^9, 3.669767003877138*^9}, 3.669771853829398*^9, {
   3.8435973050421762`*^9, 3.843597338632646*^9}, 3.8436007420518913`*^9, {
   3.8436014767828555`*^9, 3.843601671181758*^9}, {3.8436019366485043`*^9, 
   3.8436019566223125`*^9}, 3.8436021487185373`*^9, {3.8436027277674856`*^9, 
   3.8436027463021955`*^9}, 3.8436028384298425`*^9, {3.8448997049015245`*^9, 
   3.8448997080775747`*^9}, {3.845980585204308*^9, 3.84598061555431*^9}, {
   3.8459826007392807`*^9, 3.845982654035214*^9}, {3.8459826865194454`*^9, 
   3.8459827111990886`*^9}, {3.8459827990994005`*^9, 3.8459828601191807`*^9}, 
   3.8459832001791945`*^9, 3.8459833152190647`*^9, 3.8459833995294724`*^9, 
   3.845984243099217*^9, {3.8460212104701567`*^9, 3.8460212150138335`*^9}, {
   3.847846994630511*^9, 3.8478470032072372`*^9}, 3.847847100894129*^9, {
   3.847847407699396*^9, 3.847847448562264*^9}, {3.8478480767862444`*^9, 
   3.8478480846623993`*^9}, {3.847848221214572*^9, 3.8478482261021194`*^9}, {
   3.847969523425886*^9, 3.847969524946211*^9}, {3.854014362799085*^9, 
   3.8540143629171143`*^9}, {3.8540144240919952`*^9, 
   3.8540144376887226`*^9}, {3.8540144798360214`*^9, 3.854014632706029*^9}, {
   3.854014787983699*^9, 3.854014902996205*^9}, {3.854014935324292*^9, 
   3.854014985785879*^9}, {3.8540150240461864`*^9, 3.854015081896698*^9}, {
   3.854015991409299*^9, 3.8540160258596373`*^9}, {3.8540160882196608`*^9, 
   3.8540161941597214`*^9}},ExpressionUUID->"681613ce-1289-4aac-a8e3-\
82a65ac70130"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   StyleBox["(*",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox[
    RowBox[{"Abondoned", " ", 
     RowBox[{"code", ":", " ", "Start"}]}],
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "SymmetrizeIndices"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SymmetrizeIndices", "[", "t_Tensor", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"indices", ",", "lgth", ",", "m", ",", "newindiceslist"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"TensorComponents", "[", "t", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"lgth", "!"}], " ", 
            RowBox[{"Normal", "[", 
             RowBox[{"Symmetrize", "[", "m", "]"}], "]"}]}], ")"}], "//", 
          "FullSimplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newindiceslist", "=", 
         RowBox[{"AddCurlyBrackets", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "m"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "newindiceslist"}], ")"}]}]}], 
          "}"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Partially", "-", "SymmetrizeIndices"}], "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"SymmetrizeIndices", "[", 
       RowBox[{"TargetIndices_List", ",", "t_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"SubsetQ", "[", 
        RowBox[{
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "TargetIndices"}], 
        "]"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "indices2", ",", "Permutelist", ",", "Tsum", ",", 
         "newindiceslist", ",", "m", ",", "UntouchedIdx"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices2", "=", 
         RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"UntouchedIdx", "=", 
         RowBox[{"Complement", "[", 
          RowBox[{"indices", ",", "TargetIndices"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Permutelist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"indices", "/.", 
            RowBox[{"Thread", "[", 
             RowBox[{"Rule", "[", 
              RowBox[{"TargetIndices", ",", "#"}], "]"}], "]"}]}], "&"}], "/@", 
          RowBox[{"Permutations", "[", "TargetIndices", "]"}]}]}], ";", "\n", 
        RowBox[{"Tsum", "=", 
         RowBox[{"(", 
          RowBox[{"Plus", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", " ", 
               RowBox[{"SwapIndices", "[", 
                RowBox[{"t", ",", "#"}], "]"}], ")"}], "&"}], "/@", 
             "Permutelist"}], ")"}]}], ")"}]}], ";", "\n", 
        RowBox[{"m", "=", 
         RowBox[{
          RowBox[{"TensorComponents", "[", "Tsum", "]"}], "//", 
          "FullSimplify"}]}], ";", "\n", 
        RowBox[{"LeftBracketPosition", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"indices", ",", 
             RowBox[{"First", "[", "TargetIndices", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"RightBracketPosition", "=", 
         RowBox[{
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"indices", ",", 
             RowBox[{"Last", "[", "TargetIndices", "]"}]}], "]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", "\n", 
        RowBox[{"ListwithVerticleBar", "=", 
         RowBox[{
          RowBox[{"Take", "[", 
           RowBox[{"indices", ",", 
            RowBox[{"{", 
             RowBox[{"LeftBracketPosition", ",", "RightBracketPosition"}], 
             "}"}]}], "]"}], "\[Intersection]", "UntouchedIdx"}]}], ";", "\n", 
        RowBox[{"newindiceslist", "=", 
         RowBox[{"indices2", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"First", "[", "TargetIndices", "]"}], "\[Rule]", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"UnderBar", "[", "\"\<{\>\"", "]"}], "//", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"First", "[", "TargetIndices", "]"}], ")"}], 
                 "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
               ",", 
               RowBox[{"First", "[", "TargetIndices", "]"}]}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Last", "[", "TargetIndices", "]"}], "\[Rule]", 
             RowBox[{"Sequence", "[", 
              RowBox[{
               RowBox[{"Last", "[", "TargetIndices", "]"}], ",", 
               RowBox[{
                RowBox[{"UnderBar", "[", "\"\<}\>\"", "]"}], "//", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Last", "[", "TargetIndices", "]"}], ")"}], 
                 "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
              "]"}]}], ",", 
            RowBox[{"Sequence", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Rule", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Sequence", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], "&"}], "/@",
                "ListwithVerticleBar"}], ")"}]}]}], "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "m"}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "newindiceslist"}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
  StyleBox["\[IndentingNewLine]",
   FontColor->RGBColor[0.6, 0.4, 0.2]], 
  RowBox[{
   StyleBox["(*",
    FontColor->RGBColor[0.6, 0.4, 0.2]], 
   StyleBox[
    RowBox[{"Abondoned", " ", 
     RowBox[{"code", ":", " ", "End"}]}],
    FontColor->GrayLevel[0.5]], 
   StyleBox["*)",
    FontColor->RGBColor[0.6, 0.4, 0.2]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.6063292322449217`*^9, 
   3.606329256638296*^9}, {3.6064974490496035`*^9, 3.6064974614663134`*^9}, 
   3.606512382622294*^9, {3.60651242556575*^9, 3.6065125215382395`*^9}, {
   3.6065125556711917`*^9, 3.606512600995784*^9}, {3.606512761984992*^9, 
   3.6065128691121197`*^9}, {3.6065129691668425`*^9, 3.606512970031892*^9}, {
   3.6065131686742535`*^9, 3.6065131898644657`*^9}, {3.6065132669168725`*^9, 
   3.606513293923417*^9}, {3.629692178653521*^9, 3.6296921823366594`*^9}, {
   3.6296927745837092`*^9, 3.6296927894092307`*^9}, {3.6296928455681496`*^9, 
   3.629692856442544*^9}, {3.6296929535388727`*^9, 3.6296929933152556`*^9}, {
   3.6296930748191504`*^9, 3.6296930871695933`*^9}, {3.6296932234826612`*^9, 
   3.6296932524307303`*^9}, {3.6296933014895077`*^9, 3.629693381002375*^9}, {
   3.6297662869445314`*^9, 3.629766315970583*^9}, {3.6298439670933137`*^9, 
   3.62984398806225*^9}, {3.6298442399943933`*^9, 3.6298442410395956`*^9}, {
   3.630042532709276*^9, 3.6300426463617764`*^9}, {3.630042703883478*^9, 
   3.6300427521936626`*^9}, {3.630042825447692*^9, 3.6300428286456976`*^9}, {
   3.630042980332965*^9, 3.6300430264254456`*^9}, {3.630043060105305*^9, 
   3.630043072949128*^9}, {3.6300941467346215`*^9, 3.6300941501305285`*^9}, {
   3.630094422824464*^9, 3.6300944485833097`*^9}, {3.6300945129192295`*^9, 
   3.6300945130596294`*^9}, {3.63009456993493*^9, 3.630094604724292*^9}, {
   3.630094645506065*^9, 3.630094671206911*^9}, {3.6300950713827314`*^9, 
   3.6300950923929887`*^9}, {3.630095126572833*^9, 3.630095148924312*^9}, {
   3.6300952987629194`*^9, 3.630095317689753*^9}, {3.630095631618222*^9, 
   3.6300957899633107`*^9}, {3.6300960708098197`*^9, 
   3.6300960867862473`*^9}, {3.6300962273194976`*^9, 3.63009628683821*^9}, {
   3.630096394701002*^9, 3.630096400755813*^9}, {3.6300966069840384`*^9, 
   3.6300966275030746`*^9}, {3.630096752960698*^9, 3.6300968779735284`*^9}, {
   3.630096912059989*^9, 3.6300969145091934`*^9}, {3.63012458548705*^9, 
   3.6301245859862514`*^9}, {3.630171696268879*^9, 3.630171697187932*^9}, {
   3.6301721267055283`*^9, 3.630172187186988*^9}, {3.6301725465885444`*^9, 
   3.6301725574831676`*^9}, 3.6301726028587627`*^9, {3.630172639309848*^9, 
   3.630172639791875*^9}, {3.6301726869325714`*^9, 3.6301727745875854`*^9}, {
   3.630173004281803*^9, 3.6301730118478165`*^9}, 3.630173624767943*^9, {
   3.630174010129105*^9, 3.630174033250958*^9}, {3.630174068378629*^9, 
   3.6301740923886747`*^9}, {3.6301741428191967`*^9, 
   3.6301742377847843`*^9}, {3.6301743004723024`*^9, 
   3.6301743866434655`*^9}, {3.630174545460163*^9, 3.63017462231811*^9}, {
   3.6301746580413885`*^9, 3.6301748707160015`*^9}, {3.630184130800047*^9, 
   3.630184229457509*^9}, {3.6301850052789664`*^9, 3.6301850107509813`*^9}, {
   3.630201973676296*^9, 3.6302019811364107`*^9}, {3.6302020119268837`*^9, 
   3.6302020259195986`*^9}, {3.6302020865180297`*^9, 3.630202099130723*^9}, {
   3.6302062623687735`*^9, 3.630206262774374*^9}, {3.630206526945647*^9, 
   3.63020653465456*^9}, {3.630206589878859*^9, 3.630206598284174*^9}, {
   3.6302069385396786`*^9, 3.6302069408977823`*^9}, {3.6302077285487456`*^9, 
   3.630207751509098*^9}, {3.630207950034648*^9, 3.6302079508521605`*^9}, {
   3.6302528520300617`*^9, 3.630252907757249*^9}, {3.630253300900735*^9, 
   3.6302533587870464`*^9}, {3.6302533928009915`*^9, 3.630253437125527*^9}, {
   3.630253539353374*^9, 3.630253546644791*^9}, {3.6302538002332954`*^9, 
   3.63025391675496*^9}, 3.6302539719411163`*^9, {3.6302548553419456`*^9, 
   3.630254856263347*^9}, {3.63025524972278*^9, 3.6302553181907015`*^9}, {
   3.6302553846950192`*^9, 3.630255482220399*^9}, {3.630255622908106*^9, 
   3.630255771687378*^9}, 3.630255920597887*^9, {3.6302561838895245`*^9, 
   3.6302562374302197`*^9}, {3.63025627707789*^9, 3.6302562862079067`*^9}, {
   3.63027400911228*^9, 3.6302740095322804`*^9}, {3.6302760017164326`*^9, 
   3.6302760021532335`*^9}, {3.6302760803358254`*^9, 3.630276097643756*^9}, {
   3.6302779572998476`*^9, 3.630278019811158*^9}, {3.6302782118409033`*^9, 
   3.630278248205868*^9}, {3.6302789403728676`*^9, 3.630278952415489*^9}, 
   3.6302789849690466`*^9, {3.630279062704089*^9, 3.6302790721053057`*^9}, {
   3.630293787958753*^9, 3.6302938141230297`*^9}, {3.630295113013002*^9, 
   3.6302951563480787`*^9}, {3.6302953058709517`*^9, 
   3.6302953084134912`*^9}, {3.630295437321472*^9, 3.6302954415365367`*^9}, {
   3.6302955365114965`*^9, 3.630295543759108*^9}, 3.630295625172858*^9, {
   3.630295725821904*^9, 3.6302957316869946`*^9}, {3.6302958003830495`*^9, 
   3.630295817580814*^9}, 3.6302959076796975`*^9, {3.6302959991886034`*^9, 
   3.6302960013736367`*^9}, {3.630296040071731*^9, 3.6302960829273896`*^9}, {
   3.6302963683317733`*^9, 3.6302965572696753`*^9}, {3.6302967437550397`*^9, 
   3.630296785528181*^9}, {3.630297190921908*^9, 3.630297194781967*^9}, {
   3.6302973560094433`*^9, 3.630297421670452*^9}, {3.6302974957740903`*^9, 
   3.630297504921731*^9}, {3.6302975815729084`*^9, 3.630297588438014*^9}, {
   3.630297648163931*^9, 3.63029765981911*^9}, {3.6302977345252576`*^9, 
   3.63029775553808*^9}, {3.6302978060738564`*^9, 3.630297856057124*^9}, {
   3.6302979279460716`*^9, 3.6302979381762085`*^9}, {3.6302980130646505`*^9, 
   3.630298014179663*^9}, {3.630298187432942*^9, 3.630298246224647*^9}, {
   3.630298410811104*^9, 3.630298411016404*^9}, {3.630299459602931*^9, 
   3.630299468104946*^9}, {3.6302996293748393`*^9, 3.6302996671644063`*^9}, {
   3.630299758470379*^9, 3.630299770504901*^9}, {3.630325511370754*^9, 
   3.630325529185773*^9}, {3.63032947295944*^9, 3.6303295435792074`*^9}, {
   3.630329932277378*^9, 3.6303299364856186`*^9}, 3.63033040779436*^9, {
   3.630330550250988*^9, 3.6303305567702045`*^9}, {3.631825624068637*^9, 
   3.631825658439165*^9}, {3.6318257507005825`*^9, 3.6318260298298693`*^9}, {
   3.631826159996869*^9, 3.6318262041700478`*^9}, {3.631826384475317*^9, 
   3.631826396060495*^9}, {3.631826509542238*^9, 3.631826585975912*^9}, {
   3.631826637616705*^9, 3.631826670727214*^9}, {3.631826704277729*^9, 
   3.63182670760528*^9}, {3.6318268396848087`*^9, 3.6318268836604843`*^9}, {
   3.6318269391813374`*^9, 3.6318270895236464`*^9}, {3.6318273432600436`*^9, 
   3.6318274812321625`*^9}, {3.631828158368924*^9, 3.6318281754929037`*^9}, {
   3.6318285845362997`*^9, 3.6318286087286835`*^9}, {3.631828762404473*^9, 
   3.631828771986021*^9}, {3.631828840096917*^9, 3.631828866321417*^9}, {
   3.6318294994896317`*^9, 3.6318295065490355`*^9}, {3.6318296490301847`*^9, 
   3.631829659802801*^9}, {3.6318300255307198`*^9, 3.6318301388732023`*^9}, {
   3.631830194620391*^9, 3.631830228921353*^9}, {3.6318306202007327`*^9, 
   3.6318306275971556`*^9}, {3.631830978986254*^9, 3.6318311422415915`*^9}, {
   3.631831367524477*^9, 3.6318314192764373`*^9}, {3.631831451996309*^9, 
   3.631831473612545*^9}, 3.6318315143338747`*^9, {3.6318317153613725`*^9, 
   3.63183171741549*^9}, {3.6318318563964396`*^9, 3.6318318646279097`*^9}, {
   3.631832451265464*^9, 3.631832471373614*^9}, {3.6318325184543066`*^9, 
   3.631832528445878*^9}, {3.631832871047474*^9, 3.6318330583031845`*^9}, 
   3.6318331093941064`*^9, {3.6318331917598176`*^9, 3.6318332390455217`*^9}, 
   3.631833464854438*^9, {3.6318334955801954`*^9, 3.6318334980353355`*^9}, {
   3.6318335410857983`*^9, 3.6318335413018103`*^9}, {3.6318336921354375`*^9, 
   3.631833734824879*^9}, {3.631836917554921*^9, 3.631836933892855*^9}, {
   3.6318370914248657`*^9, 3.6318371186944256`*^9}, {3.631837192928671*^9, 
   3.6318372509739914`*^9}, {3.6318374289391704`*^9, 
   3.6318374350395193`*^9}, {3.6318374985801535`*^9, 
   3.6318375045954976`*^9}, {3.6318375677141075`*^9, 
   3.6318375769666367`*^9}, {3.6318406437960496`*^9, 
   3.6318406784790335`*^9}, {3.6318407656400185`*^9, 3.631840785437151*^9}, {
   3.6318409550198507`*^9, 3.631841008121888*^9}, {3.6318410848682775`*^9, 
   3.631841118450198*^9}, {3.631842017177603*^9, 3.631842021097827*^9}, {
   3.669563225736412*^9, 3.6695632328774233`*^9}, {3.6695727962541666`*^9, 
   3.66957280296255*^9}, {3.669573160323732*^9, 3.6695733097357454`*^9}, {
   3.669573543305316*^9, 3.6695735549105425`*^9}, {3.6695753844657793`*^9, 
   3.6695754468221025`*^9}, {3.669576382567544*^9, 3.669576384573659*^9}, 
   3.6695765844990935`*^9, {3.6695797133373833`*^9, 3.6695797652163506`*^9}, {
   3.669579961087554*^9, 3.6695799627676497`*^9}, 3.669694993946001*^9, {
   3.669767001915026*^9, 3.669767003877138*^9}, 3.669771853829398*^9, {
   3.8435973050421762`*^9, 3.843597338632646*^9}, 3.8436007420518913`*^9, {
   3.8436014767828555`*^9, 3.843601671181758*^9}, {3.8436019366485043`*^9, 
   3.8436019566223125`*^9}, {3.8436021487185373`*^9, 3.843602160751334*^9}, {
   3.8436022248835945`*^9, 3.8436023454466195`*^9}, 3.8436023986413584`*^9, {
   3.8436025631360235`*^9, 3.8436025934221463`*^9}, 3.843602639802062*^9, 
   3.8436027240027676`*^9, 3.843602842164104*^9, {3.8439584532252026`*^9, 
   3.843958461365828*^9}, {3.844775785104665*^9, 3.8447759652047997`*^9}, {
   3.8448098857206864`*^9, 3.8448099229290786`*^9}, {3.8448139554657326`*^9, 
   3.8448139708967323`*^9}, 3.844895719222246*^9, {3.8448959592045145`*^9, 
   3.8448959599330664`*^9}, {3.8448997012777505`*^9, 3.844899701982318*^9}, {
   3.844942753846594*^9, 3.844942759744957*^9}, {3.8449429495978236`*^9, 
   3.844942976790203*^9}, {3.844943157116053*^9, 3.84494315996364*^9}, {
   3.845980492230149*^9, 3.845980558127309*^9}, {3.845982755079296*^9, 
   3.8459827621391687`*^9}, {3.8540160678896847`*^9, 
   3.854016075149381*^9}},ExpressionUUID->"eb17d187-2648-4089-967a-\
01205d227499"]
}, Closed]],

Cell[CellGroupData[{

Cell["AntiSymmetrizeIndices", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
   3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
   3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
   3.7277792645777283`*^9}, {3.8430970828593497`*^9, 3.843097090194527*^9}, {
   3.843097987499811*^9, 3.843098001371838*^9}, 
   3.8439584446783285`*^9},ExpressionUUID->"0e319148-22dc-463b-b4f2-\
1996df21df7b"],

Cell[BoxData[
 StyleBox[
  RowBox[{
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"NewCode", ":", " ", 
      StyleBox[
       RowBox[{
        StyleBox["A", "Input"], "nt", 
        StyleBox[
         StyleBox["i", "Input"], "Input",
         FontColor->RGBColor[0.5, 0, 0.5]], "SymmetrizeIndices"}]]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      StyleBox["Partially",
       FontColor->RGBColor[1, 0, 1]], " ", "Anti"}], "-", 
     "SymmetrizeIndices"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"AntiSymmetrizeIndices", "[", 
        RowBox[{"TargetIndices_List", ",", "t_Tensor", ",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
       RowBox[{"(*", 
        RowBox[{"Check", ":", " ", 
         RowBox[{
         "All", " ", "indices", " ", "in", " ", "TargetIndices", " ", 
          "should", " ", "be", " ", "included", " ", "in", " ", "Indices", 
          " ", "list", " ", "of", " ", "t"}]}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"SubsetQ", "[", 
         RowBox[{
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "TargetIndices"}], 
         "]"}], ")"}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "indices", ",", "indices2", ",", "takelist", ",", "targetposition", 
          ",", "newindiceslist", ",", "m", ",", "UntouchedIdx", ",", " ", 
          "ListwithVerticleBar"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"indices2", ":", " ", 
          RowBox[{"Extract", " ", "extracting", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["preserving",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["UnderBar",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "This"}], " ", "will", 
           " ", "be", " ", "used", " ", "at", " ", "the", " ", "end"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices2", "=", 
          RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"indices", ":", 
            RowBox[{"Extract", " ", 
             StyleBox["Indices",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["removing",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             RowBox[{
              StyleBox["UnderBar",
               FontColor->RGBColor[1, 0, 1]], ".", " ", "Since"}], " ", 
             "UnderBar", " ", "has", " ", "no", " ", "meaning", " ", "in", 
             " ", "this", " ", "operation"}]}], ",", 
           RowBox[{"we", " ", "should", " ", "remove", " ", "them", " ", 
            RowBox[{"first", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", "indices2", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"UntouchedIdx", ":", " ", 
            RowBox[{
            "To", " ", "add", " ", "square", " ", "bracket", " ", "and", " ", 
             "vertical", " ", "bar", " ", "in", " ", "the", " ", "output", 
             " ", "indices", " ", "list"}]}], ",", " ", 
           RowBox[{"we", " ", "should", " ", "extract", " ", 
            StyleBox["those",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["in",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["excluded",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["from",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["TargetIndices",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "use", 
            " ", "Complement", " ", "to", " ", "get", " ", 
            RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"UntouchedIdx", "=", 
          RowBox[{"Complement", "[", 
           RowBox[{"indices", ",", "TargetIndices"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"targetposition", ":", " ", 
           RowBox[{
           "We", " ", "convert", " ", "TargetIndices", " ", "into", " ", 
            "the", " ", "position", " ", 
            RowBox[{
             StyleBox["number",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"targetposition", "=", 
          RowBox[{"Sort", "[", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"indices", ",", "#"}], "]"}], "&"}], "/@", 
             "TargetIndices"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"m", " ", "is", " ", "the", " ", "output", " ", 
            RowBox[{
             StyleBox["TensorComponents",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "We"}], " ", "get", 
            " ", "the", " ", "anti"}], "-", 
           RowBox[{"symmetrized", " ", "tensor", " ", "of", " ", 
            RowBox[{"\"\<t\>\"", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Note", " ", "that", " ", "in", " ", "our", " ", "definition"}], 
           ",", " ", 
           RowBox[{"we", " ", "have", " ", "a", " ", 
            StyleBox["factorial",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["coefficient",
             FontColor->RGBColor[1, 0, 1]], " ", "difference", " ", 
            RowBox[{"w", "/", " ", 
             RowBox[{"Mathematica", "'"}]}], "s", " ", 
            RowBox[{"one", "."}]}]}], "*)"}], 
         RowBox[{"m", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", "TargetIndices", "]"}], "!"}], 
            RowBox[{"Normal", "[", 
             RowBox[{"Symmetrize", "[", 
              RowBox[{
               RowBox[{"TensorComponents", "[", "t", "]"}], ",", 
               RowBox[{"Antisymmetric", "[", "targetposition", "]"}]}], "]"}],
              "]"}]}], "//", 
           RowBox[{
           "OptionValue", "[", "AntiSymmetrizeIndicesOperator", "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"From", " ", "here"}], ",", 
           RowBox[{
           "we", " ", "start", " ", "to", " ", "prepare", " ", "the", " ", 
            StyleBox["output",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Take", " ", "the", " ", "list", " ", "between", " ", "the", " ", 
            StyleBox["first",
             FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "the", " ", 
            StyleBox["last",
             FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", "which", " ",
             "need", " ", "to", " ", "be", " ", "anti"}], "-", 
           RowBox[{"symmetrized", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"takelist", "=", 
          RowBox[{"Take", "[", 
           RowBox[{"indices", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"First", "[", "targetposition", "]"}], ",", 
              RowBox[{"Last", "[", "targetposition", "]"}]}], "}"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Extract", " ", "the", " ", "indices", " ", "which", " ", "need", 
            " ", "to", " ", "add", " ", "vertical", " ", "bars", " ", 
            "around", " ", "them"}], ",", 
           RowBox[{
           "by", " ", "getting", " ", "intersection", " ", "of", " ", 
            "takelist", " ", "and", " ", "UntouchedIdx"}]}], "*)"}], 
         RowBox[{"ListwithVerticleBar", "=", 
          RowBox[{"takelist", "\[Intersection]", "UntouchedIdx"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Output", " ", "indices", " ", "list"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], 
         RowBox[{"newindiceslist", "=", 
          RowBox[{"indices2", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"First", "[", "takelist", "]"}], "\[Rule]", 
              RowBox[{"Sequence", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"UnderBar", "[", "\"\<[\>\"", "]"}], "//", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"First", "[", "takelist", "]"}], ")"}], 
                  "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}], 
                ",", 
                RowBox[{"First", "[", "takelist", "]"}]}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"Last", "[", "takelist", "]"}], "\[Rule]", 
              RowBox[{"Sequence", "[", 
               RowBox[{
                RowBox[{"Last", "[", "takelist", "]"}], ",", 
                RowBox[{
                 RowBox[{"UnderBar", "[", "\"\<]\>\"", "]"}], "//", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Last", "[", "takelist", "]"}], ")"}], 
                  "\[LeftDoubleBracket]", "0", "\[RightDoubleBracket]"}]}]}], 
               "]"}]}], ",", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Rule", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"Sequence", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}], ",", "#", ",", 
                    RowBox[{
                    RowBox[{"UnderBar", "[", "\"\<|\>\"", "]"}], "//", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}]}], "]"}]}], "]"}], "&"}], "/@",
                 "ListwithVerticleBar"}], ")"}]}]}], "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Change", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"t", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "m"}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "newindiceslist"}], ")"}]}]}], 
           "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\n", 
    RowBox[{"(*", 
     StyleBox[
      RowBox[{"Fully", "-", "AntiSymmetrizeIndices"}],
      FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\n", 
    RowBox[{
     RowBox[{
      RowBox[{"AntiSymmetrizeIndices", "[", 
       RowBox[{"t_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{"AntiSymmetrizeIndices", "[", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Recall", " ", 
          StyleBox["Partially",
           FontColor->RGBColor[1, 0, 1]], " ", "AntiSymmetrizeIndices"}], ",",
          " ", 
         RowBox[{"but", " ", "symmetrize", " ", 
          RowBox[{"w", "/", " ", "all"}], " ", 
          RowBox[{"indices", "."}]}]}], "*)"}], 
       RowBox[{
        RowBox[{"RemoveUnderBarredIndices", "[", 
         RowBox[{"Indices", "[", "t", "]"}], "]"}], ",", "t", ",", 
        RowBox[{"AntiSymmetrizeIndicesOperator", "\[Rule]", 
         RowBox[{
         "OptionValue", "[", "AntiSymmetrizeIndicesOperator", "]"}]}]}], 
       "]"}]}], ";"}]}]}], "Input"]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.629909176889841*^9, 3.6299091975004773`*^9}, 
   3.629913789766417*^9, {3.6299138340045967`*^9, 3.62991395336893*^9}, {
   3.6299140417827883`*^9, 3.62991407057073*^9}, {3.629914105261263*^9, 
   3.6299141170914445`*^9}, {3.62991463043447*^9, 3.629914631089671*^9}, {
   3.6299146885963717`*^9, 3.6299146937131815`*^9}, {3.629915088830967*^9, 
   3.6299153407597475`*^9}, {3.6299158092601366`*^9, 
   3.6299158115221405`*^9}, {3.629915927193079*^9, 3.62991594200121*^9}, {
   3.629915992793312*^9, 3.629916008839244*^9}, {3.6299175161541896`*^9, 
   3.629917520155297*^9}, {3.8352604732219753`*^9, 3.8352604820549183`*^9}, {
   3.8352605560487156`*^9, 3.8352605661361046`*^9}, {3.8352606134635315`*^9, 
   3.835260705039947*^9}, {3.835260944287466*^9, 3.835260981278107*^9}, {
   3.8352648500877113`*^9, 3.835264945400612*^9}, 3.835265138891713*^9, 
   3.835265250326704*^9, {3.8352654302317057`*^9, 3.835265468734707*^9}, {
   3.8352655060487137`*^9, 3.8352655385707192`*^9}, 3.8352655851567087`*^9, {
   3.8352656489007072`*^9, 3.8352656525567055`*^9}, {3.835265786824703*^9, 
   3.835265797340705*^9}, {3.8352658960417137`*^9, 3.835265912952714*^9}, {
   3.8358344604663134`*^9, 3.8358345415951815`*^9}, {3.835834660938274*^9, 
   3.8358346826122007`*^9}, 3.8358347516523027`*^9, {3.8358347824806023`*^9, 
   3.8358347897211666`*^9}, {3.835835027221261*^9, 3.83583504546306*^9}, 
   3.8358355241242986`*^9, {3.8358537209622617`*^9, 3.8358537218619366`*^9}, {
   3.835853860567198*^9, 3.8358538736692047`*^9}, {3.835853980327199*^9, 
   3.835854096390462*^9}, {3.835854154295315*^9, 3.8358542191043854`*^9}, 
   3.8358543188331223`*^9, 3.8358544858413568`*^9, {3.8358545448720794`*^9, 
   3.835854618507143*^9}, 3.835854670120367*^9, {3.8358550024069624`*^9, 
   3.8358550347031765`*^9}, {3.835855071842867*^9, 3.8358550737479362`*^9}, {
   3.8358554434619637`*^9, 3.835855447220962*^9}, {3.8358554908449535`*^9, 
   3.835855547995963*^9}, {3.8358555928489633`*^9, 3.8358556857759504`*^9}, 
   3.8358608694734063`*^9, {3.835861218022401*^9, 3.835861222666402*^9}, 
   3.8359204809663844`*^9, {3.835922515828598*^9, 3.8359225278335958`*^9}, {
   3.835922952245639*^9, 3.835922965302247*^9}, {3.8359229990234833`*^9, 
   3.835923000831025*^9}, {3.836445921150355*^9, 3.836445927413431*^9}, {
   3.8365264813084908`*^9, 3.836526505542826*^9}, {3.8365274865371704`*^9, 
   3.8365274874911737`*^9}, {3.8374039957093225`*^9, 3.837404033976358*^9}, {
   3.8374042086242533`*^9, 3.8374042355055265`*^9}, {3.8374043572113156`*^9, 
   3.8374043831501446`*^9}, {3.837404437456546*^9, 3.8374044624903917`*^9}, {
   3.83740449461442*^9, 3.8374045284836416`*^9}, {3.8374295136883783`*^9, 
   3.837429532989379*^9}, {3.837429592547739*^9, 3.837429623021738*^9}, {
   3.837429748577462*^9, 3.83742977871146*^9}, {3.8376093050331783`*^9, 
   3.837609322988505*^9}, {3.8376402802354355`*^9, 3.8376402992055955`*^9}, {
   3.8376420561552305`*^9, 3.837642073760215*^9}, {3.8376519822422276`*^9, 
   3.837652028610064*^9}, {3.837652062236641*^9, 3.837652085651631*^9}, {
   3.8381944240614862`*^9, 3.8381944631469693`*^9}, {3.8381945747683415`*^9, 
   3.8381945762084007`*^9}, {3.8381946413935595`*^9, 
   3.8381946436989913`*^9}, {3.838194687583386*^9, 3.838194700899796*^9}, {
   3.838194779023388*^9, 3.8381948081002626`*^9}, {3.838194905251423*^9, 
   3.838194956058038*^9}, {3.838194986065569*^9, 3.8381949953028364`*^9}, {
   3.8381950899579177`*^9, 3.8381950995470543`*^9}, {3.838195158198583*^9, 
   3.838195174793747*^9}, {3.8381952508727427`*^9, 3.8381952736796026`*^9}, {
   3.8381953500940866`*^9, 3.8381953820097623`*^9}, {3.838195468501559*^9, 
   3.8381954918887043`*^9}, {3.8381955357781076`*^9, 
   3.8381955716109304`*^9}, {3.8381956070075502`*^9, 
   3.8381956350348434`*^9}, {3.8381957049801264`*^9, 3.83819570533545*^9}, {
   3.838195738157835*^9, 3.8381957473195305`*^9}, {3.8454271998063774`*^9, 
   3.845427204004798*^9}, {3.845429990901543*^9, 3.8454299920938115`*^9}, {
   3.845982899361779*^9, 3.845982927289239*^9}, {3.8459831679594984`*^9, 
   3.845983185179139*^9}, {3.8459832968401794`*^9, 3.8459833060193915`*^9}, 
   3.845983407619465*^9, 3.8459842644895077`*^9, {3.846021076440152*^9, 
   3.8460211206792006`*^9}, {3.8478469977515926`*^9, 
   3.8478470002060823`*^9}, {3.8478470851269865`*^9, 
   3.8478470894961386`*^9}, {3.8478474225292745`*^9, 
   3.8478474245540285`*^9}, {3.8478474578686028`*^9, 
   3.8478474618421574`*^9}, {3.8478480892495775`*^9, 
   3.8478480915911374`*^9}, {3.847848243008292*^9, 3.8478482446632752`*^9}, {
   3.8479695062912054`*^9, 3.847969508511413*^9}, {3.854014311459194*^9, 
   3.8540143245691485`*^9}, {3.8540150694535074`*^9, 
   3.8540150762160463`*^9}, {3.8540162737395105`*^9, 3.854016377059682*^9}, {
   3.854016516649788*^9, 3.854016525809317*^9}, {3.85401657170969*^9, 
   3.8540166137997637`*^9}},ExpressionUUID->"f5045f13-e32e-4ccc-936b-\
6d56dd261ef9"]
}, Closed]],

Cell[CellGroupData[{

Cell["PartialD", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6299087800753407`*^9, 
   3.6299087836165466`*^9}},ExpressionUUID->"50ec6023-e205-4e05-b069-\
65396b86e78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Partial", " ", "derivative", " ", "on", " ", "a", " ", 
    RowBox[{"scalar", ":", " ", 
     RowBox[{
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "\[Mu]"], "stuff"}],
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["or",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      RowBox[{
       SuperscriptBox[
        StyleBox["\[Del]",
         FontColor->RGBColor[0.5, 0, 0.5]], 
        StyleBox["\[Mu]",
         FontColor->RGBColor[0.5, 0, 0.5]]], 
       StyleBox["stuff",
        FontColor->RGBColor[0.5, 0, 0.5]]}], " ", "using", " ", "the", " ", 
      "metric", " ", "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"scalar", ",", " ", 
    RowBox[{"Same", " ", "as", " ", "CovariantD"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "stuff_", ",", 
        "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"Scalar", " ", 
         StyleBox["Tensor",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["Form",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Scalar", " ", 
            StyleBox["Expression",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["Form",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"m", " ", "is", " ", "a", " ", "Metric"}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["CovariantD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"CovariantD", "[", 
      RowBox[{"\[Mu]T", ",", "stuff", ",", "m"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"PartialD", " ", "on", " ", "a", " ", 
      StyleBox["scalar",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"(", 
        RowBox[{"as", " ", "a", " ", "expression", " ", "form"}], ")"}],
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "with", " ", "given", " ", 
      StyleBox["coordinates",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      RowBox[{
       StyleBox["list",
        FontColor->RGBColor[0.5, 0, 0.5]], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PartialD", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "stuff_", ",", 
       RowBox[{"CoordinateSystem", "\[Rule]", "coords_List"}]}], "]"}], "/;", 
     RowBox[{"(*", 
      RowBox[{"Scalar", " ", 
       StyleBox["Expression",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox[" ",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["Form",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "Recall", " ", "by", " ", 
      "\"\<PartialD for \!\(\*StyleBox[\"downstair\",FontColor->RGBColor[1, \
0, 1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"on\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\
\" \",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"w\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"/\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"o\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \
\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"third\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\"argument\",FontColor->RGBColor[1, 0, 1]]\)\>\"", " ", 
      RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"PartialD", "[", 
     RowBox[{"\[Mu]T", ",", 
      RowBox[{"(*", 
       RowBox[{"Declare", " ", "a", " ", 
        StyleBox["new",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["Tensor",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{"NonMetricTensor", "[", 
       RowBox[{
        RowBox[{"{", "}"}], ",", "stuff", ",", "stuff", ",", 
        RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], "]"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Note", " ", 
     RowBox[{"III", ".", " ", "Internally"}], " ", "we", " ", "build", " ", 
     "the", " ", "PartialD", " ", "as", " ", "a", " ", "Tensor", " ", "with", 
     " ", "abstract", " ", "indices", " ", "then", " ", "replace", " ", "the",
      " ", 
     RowBox[{"\[PartialD]", 
      RowBox[{"-", "index"}]}], " ", "with", " ", "\[Mu]T"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"PartialD", " ", "for", " ", 
      StyleBox["downstair",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["on",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["Tensor",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"w", "/", "o"}],
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["the",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["third",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["argument",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"(", "metric", ")"}],
       FontColor->RGBColor[0.5, 0, 0.5]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        "\[Tau]T_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
       "Notice", " ", "that", " ", "now", " ", "we", " ", "accept", " ", "a", 
        " ", "scalar", " ", "or", " ", "tensor", " ", "as", " ", "Tensor", 
        " ", 
        RowBox[{"object", ".", " ", "There"}], " ", "is", " ", 
        StyleBox["no",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["scalar",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["check",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]T", ",", 
        RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"Check", " ", "for", " ", 
       StyleBox["downstair",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "\[Mu]TT", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "\[Sigma]", ",", "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",",
          "si", ",", "ii", ",", "invmetricM", ",", "\[CapitalSigma]", ",", 
         "indices", ",", "TensorMatrix", ",", "ChristT", ",", "partialT", ",",
          "output", ",", "out", ",", "outputindices", ",", 
         "FinalTensorType"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         StyleBox["output",
          FontColor->RGBColor[1, 0, 1]], " ", "Tensor", " ", "has", " ", 
         "the", " ", "following", " ", 
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox["Dimension",
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["\[Tau]T",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["components",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"(", "\[Tau]T", ")"}]}],
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
          StyleBox["matrix",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"(*", 
             RowBox[{"Recall", " ", 
              RowBox[{
              "\"\<\!\(\*StyleBox[\"Derivative\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\"for\
\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, \
0, 1]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[1, 0, 1]]\)\>\"", 
               "."}]}], "*)"}], 
            RowBox[{"PD", "[", 
             RowBox[{"\[Tau]T", ",", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "Start"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"!", 
              RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], ",", 
            RowBox[{"output", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"\[Tau]T", ",", 
                  RowBox[{
                  "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
                   "\[RightDoubleBracket]"}]}], "]"}], "//", 
                "TensorComponents"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], 
              RowBox[{"(*", 
               RowBox[{",", 
                RowBox[{"Evaluate", "[", 
                 RowBox[{"Sequence", "@@", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "si", ",", 
                    RowBox[{"si", "+", "lgth", "-", "1"}]}], "}"}], "&"}], "/@", 
                    RowBox[{
                    "RemoveUnderBarredIndices", "[", "indices", "]"}]}], 
                   ")"}]}], "]"}]}], "*)"}], "]"}]}], ",", "True", ",", 
            RowBox[{"output", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{"\[Tau]T", ",", 
                  RowBox[{
                  "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
                   "\[RightDoubleBracket]"}]}], "]"}], "//", 
                "TensorComponents"}], ",", "\[IndentingNewLine]", 
               RowBox[{"{", 
                RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], 
              "]"}]}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"output", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"\[Tau]T", ",", 
               RowBox[{
               "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
                "\[RightDoubleBracket]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "si", ",", 
                    RowBox[{"si", "+", "lgth", "-", "1"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"RemoveUnderBarredIndices", "[", "indices", "]"}]}], 
                ")"}]}], "]"}]}], "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"\[Tau]T", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                 "tt"}]}], "]"}], "===", 
              RowBox[{"{", "\"\<Metric\>\"", "}"}]}], "||", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"\[Tau]T", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                 "tt"}]}], "]"}], "===", 
              RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}]}], ",", 
            RowBox[{"FinalTensorType", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"\[Tau]T", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                 "tt"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "True", ",", 
            RowBox[{
            "FinalTensorType", "=", "\"\<PartialDerivative(s)\>\""}]}], "]"}],
           ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "End"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
          RowBox[{
          "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", "in",
            " ", "front", " ", "of", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"and", " ", "update", " ", "the", " ", 
           StyleBox[
            RowBox[{"TensorComponents", "."}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           StyleBox["(*",
            FontColor->RGBColor[0.6, 0.4, 0.2]], 
           StyleBox[
            RowBox[{"Abondoned", " ", 
             RowBox[{"code", ":", " ", "Start"}]}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["*)",
            FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "change", " ", "the", " ", "TensorType", " ", "so", " ",
             "that", " ", "even", " ", "the", " ", "CovariantD", " ", "of", 
            " ", "a", " ", "Metric", " ", "will", " ", "be", " ", "displayed",
             " ", "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{
            "Delete", " ", "TensorType", " ", 
             "\"\<PartialDerivative(s)\>\""}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "ttt_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "FinalTensorType"}], ")"}]}], 
            ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           StyleBox["(*",
            FontColor->RGBColor[0.6, 0.4, 0.2]], 
           StyleBox[
            RowBox[{"Abondoned", " ", 
             RowBox[{"code", ":", " ", "End"}]}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["*)",
            FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
          StyleBox["\[IndentingNewLine]",
           FontColor->RGBColor[0.6, 0.4, 0.2]], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Partial", " ", "derivative", " ", 
     StyleBox[
      RowBox[{
       SubscriptBox["\[PartialD]", "\[Mu]"], "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
     "metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"PartialD", " ", "for", " ", 
      StyleBox["given",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["Metric",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "or", " ", 
      StyleBox["Coordinates",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["list",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", "Tensor", " ", "as",
       " ", "the", " ", "third", " ", "argument", " ", 
      RowBox[{"(", "Optional", ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         StyleBox["downstair",
          FontColor->RGBColor[0.5, 0, 0.5]], " ", 
         StyleBox["PartialD",
          FontColor->RGBColor[0.5, 0, 0.5]]}], ")"}], "."}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "\[Tau]T_Tensor",
         ",", 
        RowBox[{"(", 
         RowBox[{"m_Tensor", "|", 
          RowBox[{"(", 
           RowBox[{"CoordinateSystem", "\[Rule]", "coordslist_List"}], 
           ")"}]}], ")"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"Given", " ", "m", " ", "is", " ", "a", " ", 
          StyleBox["Metric",
           FontColor->RGBColor[1, 0, 1]]}], ",", 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         RowBox[{"coordslist", " ", "is", " ", 
          RowBox[{"Null", "."}]}]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TestMetricTensor", "[", "m", "]"}], "===", "True"}], 
             ")"}], "&&", 
            RowBox[{"(", 
             RowBox[{"coordslist", "===", "Null"}], ")"}]}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Given", " ", 
             StyleBox["coordslist",
              FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
            RowBox[{"m", " ", "is", " ", "Null"}]}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"m", "===", "Null"}], ")"}], "&&", 
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{"coordslist", "===", "Null"}], ")"}]}]}], ")"}]}], 
         ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"\[Mu]T", " ", "is", " ", 
          StyleBox["downstair",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "\[Mu]TT", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "\[Sigma]", ",", "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",",
          "si", ",", "ii", ",", "invmetricM", ",", "\[CapitalSigma]", ",", 
         "indices", ",", "TensorMatrix", ",", "ChristT", ",", "partialT", ",",
          "output", ",", "out", ",", "outputindices", ",", 
         "FinalTensorType"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "output", " ", "Tensor", " ", "has", " ", "the", " ", "following", 
         " ", 
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"m", "===", "Null"}], ",", 
          RowBox[{"coords", "=", "coordslist"}], ",", "True", ",", 
          RowBox[{"coords", "=", 
           RowBox[{"Coordinates", "[", "m", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["\[Tau]T",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["components",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"(", "\[Tau]T", ")"}]}],
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
          StyleBox["matrix",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"PD", "[", 
             RowBox[{"\[Tau]T", ",", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "Start"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"output", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"\[Tau]T", ",", 
               RowBox[{
               "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
                "\[RightDoubleBracket]"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"{", 
              RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "si", ",", 
                    RowBox[{"si", "+", "lgth", "-", "1"}]}], "}"}], "&"}], "/@", 
                 RowBox[{"RemoveUnderBarredIndices", "[", "indices", "]"}]}], 
                ")"}]}], "]"}]}], "]"}]}], ";"}], "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"\[Tau]T", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                "tt"}]}], "]"}], "===", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "\"\<Metric\>\"", "}"}], "|", 
               RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}], ")"}]}], 
            ",", 
            RowBox[{"FinalTensorType", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"\[Tau]T", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                 "tt"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "True", ",", 
            RowBox[{
            "FinalTensorType", "=", "\"\<PartialDerivative(s)\>\""}]}], "]"}],
           ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "End"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
          RowBox[{
          "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", "in",
            " ", "front", " ", "of", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"and", " ", "update", " ", "the", " ", 
           StyleBox[
            RowBox[{"TensorComponents", "."}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           StyleBox["(*",
            FontColor->RGBColor[0.6, 0.4, 0.2]], 
           StyleBox[
            RowBox[{"Abondoned", " ", 
             RowBox[{"code", ":", " ", "Start"}]}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["*)",
            FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "change", " ", "the", " ", "TensorType", " ", "so", " ",
             "that", " ", "even", " ", "the", " ", "CovariantD", " ", "of", 
            " ", "a", " ", "Metric", " ", "will", " ", "be", " ", "displayed",
             " ", "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{
            "Delete", " ", "TensorType", " ", 
             "\"\<PartialDerivative(s)\>\""}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "ttt_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "FinalTensorType"}], ")"}]}], 
            ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           StyleBox["(*",
            FontColor->RGBColor[0.6, 0.4, 0.2]], 
           StyleBox[
            RowBox[{"Abondoned", " ", 
             RowBox[{"code", ":", " ", "End"}]}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["*)",
            FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Covariant", " ", "derivative", " ", 
     StyleBox[
      RowBox[{
       SuperscriptBox["\[PartialD]", "\[Mu]"], "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
     StyleBox["metric",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["m",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", 
     RowBox[{"(", 
      StyleBox[
       RowBox[{"upper", " ", "index"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "\[Tau]T_Tensor",
         ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
         "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
          "scalars"}], ",", " ", 
         RowBox[{"to", " ", "not", " ", "conflict", " ", 
          RowBox[{"w", "/", " ", "previous"}], " ", 
          RowBox[{"code", ".", " ", "Check"}], " ", "\[Tau]T", " ", "is", " ", 
          StyleBox["not",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["a",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["scalar",
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", 
          StyleBox["Metric",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"upper", " ", "index"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\[Sigma]", ",", "\[Mu]TT", ",", "tempT", ",", "FinalTensorType"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempT", "=", 
         RowBox[{"PartialD", "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "-"], ",", "\[Tau]T", ",", "m"}], "]"}]}],
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "Start"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"\[Tau]T", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                "tt"}]}], "]"}], "===", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"{", "\"\<Metric\>\"", "}"}], "|", 
               RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}], ")"}]}], 
            ",", 
            RowBox[{"FinalTensorType", "=", 
             RowBox[{
              RowBox[{"Cases", "[", 
               RowBox[{"\[Tau]T", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
                 "tt"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], ",", "True", ",", 
            RowBox[{
            "FinalTensorType", "=", "\"\<PartialDerivative(s)\>\""}]}], "]"}],
           ";"}], "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "End"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", "\[IndentingNewLine]", 
          RowBox[{
           StyleBox["(*",
            FontColor->RGBColor[0.6, 0.4, 0.2]], 
           StyleBox[
            RowBox[{"Abondoned", " ", 
             RowBox[{"code", ":", " ", "Start"}]}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["*)",
            FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "change", " ", "the", " ", "TensorType", " ", "so", " ",
             "that", " ", "even", " ", "the", " ", "CovariantD", " ", "of", 
            " ", "a", " ", "Metric", " ", "will", " ", "be", " ", "displayed",
             " ", "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{
            "Delete", " ", "TensorType", " ", 
             "\"\<PartialDerivative(s)\>\""}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "ttt_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "FinalTensorType"}], ")"}]}], 
            ","}], "*)"}], 
          StyleBox["\[IndentingNewLine]",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          RowBox[{
           StyleBox["(*",
            FontColor->RGBColor[0.6, 0.4, 0.2]], 
           StyleBox[
            RowBox[{"Abondoned", " ", 
             RowBox[{"code", ":", " ", "End"}]}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["*)",
            FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
            "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
             StyleBox["Indices",
              FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
            RowBox[{
            "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", 
             "in", " ", "front", " ", "of", " ", 
             StyleBox["TensorName",
              FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
            RowBox[{"and", " ", "update", " ", "the", " ", 
             StyleBox[
              RowBox[{"TensorComponents", "."}],
              FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"TensorContract", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"(*", 
                  StyleBox[
                   RowBox[{"Matrix", " ", "multiplication", " ", 
                    RowBox[{"w", "/", " ", "inverse"}], " ", "metric"}],
                   FontColor->RGBColor[1, 0, 1]], "*)"}], 
                 RowBox[{
                  RowBox[{"TensorComponents", "[", 
                   RowBox[{"Metric", "[", 
                    RowBox[{
                    SuperscriptBox["\[Mu]TT", "-"], ",", 
                    SuperscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"TensorComponents", "[", "tempT", "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "}"}]}], "]"}]}], ")"}]}]}],
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "This", " ", "allow", " ", "us", " ", "not", " ", "to", " ", 
      "derivative", " ", 
      RowBox[{"w", "/", " ", 
       RowBox[{"coord", ".", " ", "list", ".", " ", "For"}]}], " ", 
      RowBox[{"e", ".", "g", "."}]}], ",", " ", 
     RowBox[{"if", " ", "the", " ", 
      RowBox[{"coord", ".", " ", "list"}], " ", "is", " ", 
      RowBox[{"{", 
       RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ",", " ", 
     RowBox[{"we", " ", "can", " ", 
      StyleBox["derivative",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"w", ".", "r", ".", "t"}],
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[
       RowBox[{"{", 
        RowBox[{
         OverscriptBox["x", "."], ",", 
         OverscriptBox["y", "."], ",", 
         OverscriptBox["z", "."]}], "}"}],
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "by", " ", "inputting", " ", 
      "as", " ", "the", " ", "third", " ", 
      RowBox[{"argument", ".", " ", "Right"}], " ", "now", " ", 
      RowBox[{"it", "'"}], "s", " ", "supposed", " ", "not", " ", "to", " ", 
      "be", " ", "a", " ", "offical", " ", 
      RowBox[{"code", ".", " ", "So"}], " ", "I", " ", "named", " ", "it", 
      " ", "as", " ", 
      StyleBox[
       RowBox[{"PartialDWeiHao", "."}],
       FontColor->RGBColor[0.5, 0, 0.5]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"PartialDWeiHao", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "\[Tau]T_Tensor",
         ",", "Dlist_List"}], "]"}], "/;", 
      RowBox[{"MatchQ", "[", 
       RowBox[{"\[Mu]T", ",", 
        RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], 
     RowBox[{"(*", 
      RowBox[{"Check", " ", "for", " ", 
       StyleBox["downstair",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "\[Mu]TT", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", 
         ",", "\[Sigma]", ",", "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",",
          "si", ",", "ii", ",", "invmetricM", ",", "\[CapitalSigma]", ",", 
         "indices", ",", "TensorMatrix", ",", "ChristT", ",", "partialT", ",",
          "output", ",", "out", ",", "outputindices", ",", 
         "FinalTensorType"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         StyleBox["output",
          FontColor->RGBColor[1, 0, 1]], " ", "Tensor", " ", "has", " ", 
         "the", " ", "following", " ", 
         StyleBox["indices",
          FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["\[Tau]T",
           FontColor->RGBColor[1, 0, 1]]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"Indices", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", 
          StyleBox["components",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["of",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"\[PartialD]", 
            RowBox[{"(", "\[Tau]T", ")"}]}],
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
          "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"(*", 
             RowBox[{"Recall", " ", 
              RowBox[{
              "\"\<\!\(\*StyleBox[\"Derivative\",FontColor->RGBColor[1, 0, \
1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\"for\
\",FontColor->RGBColor[1, 0, 1]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[1, \
0, 1]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[1, 0, 1]]\)\>\"", 
               "."}]}], "*)"}], 
            RowBox[{"PD", "[", 
             RowBox[{"\[Tau]T", ",", 
              RowBox[{"(*", 
               RowBox[{"Note", " ", "that", " ", 
                RowBox[{"it", "'"}], "s", " ", 
                StyleBox["Dlist",
                 FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
              RowBox[{
              "Dlist", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Prepend", " ", "\[Mu]T", " ", "in", " ", "to", " ", "new", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]], " ", "list"}], ",", " ", 
          RowBox[{
          "add", " ", "a", " ", "\"\<\[PartialD]\>\"", " ", "mark", " ", "in",
            " ", "front", " ", "of", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"and", " ", "update", " ", "the", " ", 
           StyleBox[
            RowBox[{"TensorComponents", "."}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"\"\<\[PartialD]\>\"", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
      StyleBox["Short",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["-",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      RowBox[{
       StyleBox["hand",
        FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "PartialD"}]}]}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"See", " ", 
     RowBox[{"also", ":", " ", 
      StyleBox[
       RowBox[{"Derivative", " ", "for", " ", "Tensor"}],
       FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Tensor", "/:", 
    RowBox[{"D", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"SubMinus", "[", "\[Mu]T_Symbol", "]"}]}], "]"}], ":=", 
    RowBox[{"PartialD", "[", 
     RowBox[{
      SubscriptBox["\[Mu]T", "-"], ",", "t"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Tensor", "/:", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"Tensor", "[", "stuff___", "]"}], ",", 
       RowBox[{"SubMinus", "[", "\[Mu]T_Symbol", "]"}]}], "]"}], ":=", 
     RowBox[{"PartialD", "[", 
      RowBox[{
       SubscriptBox["\[Mu]T", "-"], ",", 
       RowBox[{"Tensor", "[", "stuff", "]"}]}], "]"}]}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.629909176889841*^9, 3.6299091975004773`*^9}, 
   3.629913789766417*^9, {3.6299138340045967`*^9, 3.62991395336893*^9}, {
   3.6299140417827883`*^9, 3.62991407057073*^9}, {3.629914105261263*^9, 
   3.6299141170914445`*^9}, {3.62991463043447*^9, 3.629914631089671*^9}, {
   3.6299146885963717`*^9, 3.6299146937131815`*^9}, {3.629915088830967*^9, 
   3.6299153407597475`*^9}, {3.6299158092601366`*^9, 
   3.6299158115221405`*^9}, {3.629915927193079*^9, 3.62991594200121*^9}, {
   3.629915992793312*^9, 3.629916008839244*^9}, {3.6299175161541896`*^9, 
   3.629917520155297*^9}, {3.8352604732219753`*^9, 3.8352604820549183`*^9}, {
   3.8352605560487156`*^9, 3.8352605661361046`*^9}, {3.8352606134635315`*^9, 
   3.835260705039947*^9}, {3.835260944287466*^9, 3.835260981278107*^9}, {
   3.8352648500877113`*^9, 3.835264945400612*^9}, 3.835265138891713*^9, 
   3.835265250326704*^9, {3.8352654302317057`*^9, 3.835265468734707*^9}, {
   3.8352655060487137`*^9, 3.8352655385707192`*^9}, 3.8352655851567087`*^9, {
   3.8352656489007072`*^9, 3.8352656525567055`*^9}, {3.835265786824703*^9, 
   3.835265797340705*^9}, {3.8352658960417137`*^9, 3.835265912952714*^9}, {
   3.8358344604663134`*^9, 3.8358345415951815`*^9}, {3.835834660938274*^9, 
   3.8358346826122007`*^9}, 3.8358347516523027`*^9, {3.8358347824806023`*^9, 
   3.8358347897211666`*^9}, {3.835835027221261*^9, 3.83583504546306*^9}, 
   3.8358355241242986`*^9, {3.8358537209622617`*^9, 3.8358537218619366`*^9}, {
   3.835853860567198*^9, 3.8358538736692047`*^9}, {3.835853980327199*^9, 
   3.835854096390462*^9}, {3.835854154295315*^9, 3.8358542191043854`*^9}, 
   3.8358543188331223`*^9, 3.8358544858413568`*^9, {3.8358545448720794`*^9, 
   3.835854618507143*^9}, 3.835854670120367*^9, {3.8358550024069624`*^9, 
   3.8358550347031765`*^9}, {3.835855071842867*^9, 3.8358550737479362`*^9}, {
   3.8358554434619637`*^9, 3.835855447220962*^9}, {3.8358554908449535`*^9, 
   3.835855547995963*^9}, {3.8358555928489633`*^9, 3.8358556857759504`*^9}, 
   3.8358608694734063`*^9, {3.835861218022401*^9, 3.835861222666402*^9}, 
   3.8359204809663844`*^9, {3.835922515828598*^9, 3.8359225278335958`*^9}, {
   3.835922952245639*^9, 3.835922965302247*^9}, {3.8359229990234833`*^9, 
   3.835923000831025*^9}, {3.836445921150355*^9, 3.836445927413431*^9}, {
   3.8365264813084908`*^9, 3.836526505542826*^9}, {3.8365274865371704`*^9, 
   3.8365274874911737`*^9}, {3.8374039957093225`*^9, 3.837404033976358*^9}, {
   3.8374042086242533`*^9, 3.8374042355055265`*^9}, {3.8374043572113156`*^9, 
   3.8374043831501446`*^9}, {3.837404437456546*^9, 3.8374044624903917`*^9}, {
   3.83740449461442*^9, 3.8374045284836416`*^9}, {3.8374295136883783`*^9, 
   3.837429532989379*^9}, {3.837429592547739*^9, 3.837429623021738*^9}, {
   3.837429748577462*^9, 3.83742977871146*^9}, {3.8376093050331783`*^9, 
   3.837609322988505*^9}, {3.8376402802354355`*^9, 3.8376402992055955`*^9}, {
   3.8376420561552305`*^9, 3.837642073760215*^9}, {3.8376519822422276`*^9, 
   3.837652028610064*^9}, {3.837652062236641*^9, 3.837652085651631*^9}, {
   3.8381944240614862`*^9, 3.8381944631469693`*^9}, {3.8381945747683415`*^9, 
   3.8381945762084007`*^9}, {3.8381946413935595`*^9, 
   3.8381946436989913`*^9}, {3.838194687583386*^9, 3.838194700899796*^9}, {
   3.838194779023388*^9, 3.8381948081002626`*^9}, {3.838194905251423*^9, 
   3.838194956058038*^9}, {3.838194986065569*^9, 3.8381949953028364`*^9}, {
   3.8381950899579177`*^9, 3.8381950995470543`*^9}, {3.838195158198583*^9, 
   3.838195174793747*^9}, {3.8381952508727427`*^9, 3.8381952736796026`*^9}, {
   3.8381953500940866`*^9, 3.8381953820097623`*^9}, {3.838195468501559*^9, 
   3.8381954918887043`*^9}, {3.8381955357781076`*^9, 
   3.8381955716109304`*^9}, {3.8381956070075502`*^9, 
   3.8381956350348434`*^9}, {3.8381957049801264`*^9, 3.83819570533545*^9}, {
   3.838195738157835*^9, 3.8381957473195305`*^9}, {3.849142632114067*^9, 
   3.8491426394269037`*^9}, 3.849142708162401*^9, {3.8491427388238144`*^9, 
   3.8491427501078568`*^9}, 3.8491428033864927`*^9, {3.8491428399560757`*^9, 
   3.849142853693881*^9}, {3.8491430072324824`*^9, 3.8491430589945354`*^9}, {
   3.8520207815223293`*^9, 3.852020794214577*^9}, 3.852020882371525*^9, 
   3.8520217579551954`*^9, 3.8520221966372747`*^9, {3.852022681788927*^9, 
   3.852022725178568*^9}, {3.8525340608051767`*^9, 3.8525340959228477`*^9}, {
   3.8531556681227303`*^9, 3.853155714968808*^9}, {3.8531558584215193`*^9, 
   3.8531558626451344`*^9}, 3.853155946098933*^9, {3.853156015349465*^9, 
   3.853156079897089*^9}, {3.853156309476976*^9, 3.8531563680191135`*^9}, 
   3.853156406761874*^9, 3.8531585460260243`*^9, 3.8531587458137674`*^9, 
   3.8532178823902283`*^9, {3.8532228573635035`*^9, 3.8532228872647552`*^9}, {
   3.8532230983514853`*^9, 3.8532231012563567`*^9}, {3.853230248504196*^9, 
   3.8532303507137847`*^9}, {3.8532303913221235`*^9, 3.853230461418183*^9}, {
   3.8532305020066743`*^9, 3.853230503125723*^9}, {3.8532305775230026`*^9, 
   3.8532306519056935`*^9}, {3.8532306924291916`*^9, 
   3.8532306933319244`*^9}, {3.853230727251824*^9, 3.8532307325367765`*^9}, {
   3.8532308346337557`*^9, 3.8532308365551767`*^9}, {3.8532308741204085`*^9, 
   3.8532310994102716`*^9}, {3.853231137803812*^9, 3.853231187805028*^9}, {
   3.8532312741506944`*^9, 3.8532313574697685`*^9}, {3.853231971919577*^9, 
   3.85323201861742*^9}, 3.8532320531281724`*^9, {3.853232433017573*^9, 
   3.8532324365239716`*^9}, {3.8532324670455475`*^9, 
   3.8532324949373937`*^9}, {3.85323254104211*^9, 3.8532326562514563`*^9}, {
   3.853232805359167*^9, 3.8532330849647903`*^9}, {3.853289149458395*^9, 
   3.853289154964405*^9}, {3.854582578096811*^9, 3.854582622246666*^9}, {
   3.8545831374253197`*^9, 3.854583160233822*^9}, {3.854583331176526*^9, 
   3.854583333993795*^9}, {3.8655602082154684`*^9, 3.8655602268156233`*^9}, {
   3.8691007566078634`*^9, 3.8691007683241515`*^9}, {3.8692873573461623`*^9, 
   3.869287364205019*^9}, {3.869287420406159*^9, 3.8692874237740936`*^9}, {
   3.873253070036314*^9, 3.8732530816434774`*^9}, {3.8745455353983445`*^9, 
   3.87454553588105*^9}, {3.874545620733197*^9, 3.874545699425254*^9}, {
   3.874545856812318*^9, 3.874545857803713*^9}, {3.875756153573864*^9, 
   3.8757563363726687`*^9}, {3.8757563678185406`*^9, 3.875756383884798*^9}, {
   3.893289124404459*^9, 3.8932891244284444`*^9}, 3.895063697530863*^9, 
   3.8950638548382034`*^9, {3.895554774687979*^9, 3.895554774752987*^9}, {
   3.8955551723276367`*^9, 3.895555172352625*^9}, {3.8955553398572607`*^9, 
   3.895555339893238*^9}, {3.895555838379516*^9, 3.8955558384264536`*^9}, {
   3.8966173071091475`*^9, 3.8966173125272737`*^9}, {3.8966174280562415`*^9, 
   3.896617434799738*^9}, {3.8966175417546673`*^9, 3.8966175744099636`*^9}, {
   3.8966178055461483`*^9, 3.8966178062961226`*^9}, {3.897169720332014*^9, 
   3.8971697382497573`*^9}},ExpressionUUID->"60c56988-1c9a-4dd3-bdf9-\
66b8da5c2652"]
}, Closed]],

Cell[CellGroupData[{

Cell["CovariantD", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}},ExpressionUUID->"068f7a26-195b-4784-ab30-\
cc18cb7a08c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivative", " ", "on", " ", "a", " ", 
    RowBox[{
     StyleBox["scalar",
      FontColor->RGBColor[1, 0, 0]], ":", " ", 
     RowBox[{
      StyleBox[
       RowBox[{
        SubscriptBox["\[Del]", "\[Mu]"], "stuff"}],
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
      "metric", " ", "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"stuff", " ", "with", " ", "no", " ", "Tensor", " ", "Head"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "stuff_", ",", 
        "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "output", ",", "outputt"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"stuff", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Delete", " ", "TensorType", " ", "\"\<Gradient\>\""}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{"Del", "[", "stuff", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", "\[Mu]T", "}"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", "idx"}], ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{
            "Comment", " ", "out", " ", "TooltipDisplay", " ", "in", " ", 
             "CovariantD"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"TooltipDisplay", "\[Rule]", "output"}], ","}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "output"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stuff", " ", 
     RowBox[{"w", "/", " ", "Tensor"}], " ", "head"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "stuff_Tensor", 
        ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "stuff", " ", "is", " ", "indeed", " ", "a", " ", 
         "scalar"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "contents", ",", "output", 
         ",", "outputt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"contents", " ", "of", " ", "stuff"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"contents", "=", 
         RowBox[{"TensorComponents", "[", "stuff", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"contents", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
          ")"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", "stuff"}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"TensorName", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"Del", "[", 
            RowBox[{"TensorName", "[", "stuff", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Indices", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"{", "\[Mu]T", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"StartIndex", "[", 
          RowBox[{"outputt", ",", "idx"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Coordinates", "[", 
          RowBox[{"outputt", ",", "coords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{"outputt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", " ", "tc_"}], ")"}], 
            "\[Rule]", "  ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}], 
           "}"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Covariant", " ", "derivative", " ", "on", " ", "a", " ", 
     RowBox[{
      StyleBox["scalar",
       FontColor->RGBColor[1, 0, 0]], ":", " ", 
      RowBox[{
       StyleBox[
        RowBox[{
         SuperscriptBox["\[Del]", "\[Mu]"], "stuff"}],
        FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
       "metric", " ", "m"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stuff", " ", "with", " ", "no", " ", "Tensor", " ", "Head"}], 
    " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "stuff_", ",", 
        "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TestExpressionForm", "[", "stuff", "]"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "invmetricM", ",", "output",
          ",", "outputt"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "inverse", " ", "metric", " ", "as", " ", "a", " ", 
          "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"invmetricM", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"invmetricM", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"stuff", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Delete", " ", "TensorType", " ", "\"\<Gradient\>\""}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ","}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{"Del", "[", "stuff", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", "\[Mu]T", "}"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", "idx"}], ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{
            "Comment", " ", "out", " ", "TooltipDisplay", " ", "in", " ", 
             "CovariantD"}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"TooltipDisplay", "\[Rule]", "output"}], ","}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "output"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "\[IndentingNewLine]",
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"stuff", " ", 
     RowBox[{"w", "/", " ", "Tensor"}], " ", "head"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "stuff_Tensor", 
        ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "check", " ", "stuff", " ", "is", " ", "indeed", " ", "a", " ", 
         "scalar"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"TestScalarTensor", "[", "stuff", "]"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii", ",", "contents", ",", 
         "invmetricM", ",", "output", ",", "outputt"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"contents", " ", "of", " ", "stuff"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"contents", "=", 
         RowBox[{"TensorComponents", "[", "stuff", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "inverse", " ", "metric", " ", "as", " ", "a", " ", 
          "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"invmetricM", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"return", " ", "Tensor"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"invmetricM", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"contents", ",", "#"}], "]"}], "&"}], "/@", "coords"}], 
           ")"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", "stuff"}], ";", "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"TensorName", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"Del", "[", 
            RowBox[{"TensorName", "[", "stuff", "]"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Indices", "[", 
          RowBox[{"outputt", ",", 
           RowBox[{"{", "\[Mu]T", "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"StartIndex", "[", 
          RowBox[{"outputt", ",", "idx"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"outputt", "=", 
         RowBox[{"Coordinates", "[", 
          RowBox[{"outputt", ",", "coords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{"outputt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", " ", "tc_"}], ")"}], 
            "\[Rule]", "  ", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}], 
           "}"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.6299139619990625`*^9, 3.6299139692841744`*^9}, 
   3.671908904118229*^9, 3.6727825694188104`*^9, 3.8365296985952315`*^9, {
   3.836529780268464*^9, 3.836529785787463*^9}, {3.8478330966224947`*^9, 
   3.8478331218596563`*^9}, {3.8478333640821037`*^9, 
   3.8478334148209677`*^9}, {3.847837802630602*^9, 3.8478378100528536`*^9}, {
   3.853158364986801*^9, 3.853158375141774*^9}, {3.853158407466922*^9, 
   3.8531584399119463`*^9}, {3.8531588400495267`*^9, 3.853158848835021*^9}, {
   3.853217947080208*^9, 3.853217982339759*^9}, 3.8532180597443943`*^9, {
   3.8532191023917933`*^9, 3.8532191064217005`*^9}, {3.8532191563803186`*^9, 
   3.8532191602107606`*^9}, {3.853219192860713*^9, 3.8532191942308292`*^9}, {
   3.8532197812162285`*^9, 3.853219821385949*^9}, 3.853221625432823*^9, {
   3.853221669202771*^9, 3.853221669592552*^9}, 3.8532896637820015`*^9, 
   3.8532897881868176`*^9, {3.8691007718439856`*^9, 3.869100773610896*^9}, {
   3.8692873719952464`*^9, 3.86928737644211*^9}, {3.8692874133127785`*^9, 
   3.869287416105071*^9}, {3.875756392464123*^9, 3.8757565952159033`*^9}, {
   3.8932891244534283`*^9, 3.893289124457427*^9}, {3.895554774778982*^9, 
   3.8955547747919908`*^9}, {3.8955551723606186`*^9, 
   3.8955551723756094`*^9}, {3.89555533990523*^9, 3.895555339910228*^9}, {
   3.8955558384334493`*^9, 3.895555838448442*^9}, {3.896677035045806*^9, 
   3.896677098794981*^9}, 3.8966772916050014`*^9, {3.8971697953857107`*^9, 
   3.897170033976923*^9}, 3.8971700718641043`*^9, {3.8971701046051807`*^9, 
   3.897170179787458*^9}, {3.8971703834686804`*^9, 3.8971704174491158`*^9}, 
   3.897204439249395*^9, {3.89720469403481*^9, 
   3.897204696326358*^9}},ExpressionUUID->"c62c2130-ec1c-4ac0-8992-\
b3ffe500d352"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Covariant", " ", "derivative", " ", 
    StyleBox[
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], "Tensor"}],
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
    "metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", " ", 
     RowBox[{"I", ".", " ", "If"}], " ", "\[Tau]T", " ", "contains", " ", 
     "non"}], "-", 
    RowBox[{
    "repeated", " ", "UnderBarred", " ", "indices", " ", "then", " ", "we", 
     " ", "cannot", " ", "take", " ", "its", " ", "CovariantD", " ", 
     "because", " ", "there", " ", 
     RowBox[{"isn", "'"}], "t", " ", "enough", " ", "info", " ", "since", " ", 
     RowBox[{"we", "'"}], "d", " ", "have", " ", "to", " ", "sum", " ", 
     "over", " ", "other", " ", "components", " ", "of", " ", "the", " ", 
     "Tensor", " ", "that", " ", "are", " ", "not", " ", 
     RowBox[{"avai", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Note", " ", 
    RowBox[{"II", ".", " ", "If"}], " ", "\[Tau]T", " ", "contains", " ", 
    "repeated", " ", "UnderBarred", " ", "indices", " ", "___", " ", 
    RowBox[{"SubMinus", "[", 
     RowBox[{"UnderBar", "[", "\[Mu]", "]"}], "]"}], " ", "___", " ", 
    RowBox[{"SuperMinus", "[", 
     RowBox[{"UnderBar", "[", "\[Mu]", "]"}], "]"}], " ", "___", " ", "then", 
    " ", "these", " ", "indices", " ", "are", " ", "\"\<scalars\>\"", " ", 
    "and", " ", "do", " ", "not", " ", "take", " ", "part", " ", "in", " ", 
    "the", " ", "CovariantD", " ", "process"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Note", " ", 
     RowBox[{"III", ".", " ", "Internally"}], " ", "we", " ", "build", " ", 
     "the", " ", "CovariantD", " ", "as", " ", "a", " ", "Tensor", " ", 
     "with", " ", "abstract", " ", "indices", " ", "then", " ", "replace", 
     " ", "the", " ", "Del"}], "-", 
    RowBox[{"index", " ", "with", " ", "\[Mu]T"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "\[Tau]T_Tensor",
         ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
         "scalars"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], " ",
          "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Del]", " ", "on"}], " ", "\[CapitalGamma]", " ", "is", 
          " ", "not", " ", "a", " ", "correct", " ", 
          RowBox[{"definition", "."}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{
          "Do", " ", "not", " ", "allow", " ", "CovariantD", " ", "operator", 
           " ", "on", " ", "a", " ", "Christoffel"}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", "\[Tau]T", "]"}], "=!=", 
          RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SubMinus", "[", "_", "]"}]}], "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"check", " ", "for", " ", "non"}], "-", 
           RowBox[{"repeating", " ", "UnderBarred", " ", "Indices"}]}], " ", 
          "*)"}], 
         RowBox[{
          RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
           RowBox[{"Union", "[", 
            RowBox[{"Flatten", "[", 
             RowBox[{"Cases", "[", 
              RowBox[{
               RowBox[{"Indices", "[", "\[Tau]T", "]"}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"SuperMinus", "|", "SubMinus"}], ")"}], "[", 
                RowBox[{"UnderBar", "[", "_", "]"}], "]"}], ",", 
               "\[Infinity]"}], "]"}], "]"}], "]"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"\[Del]", "g"}]}], "=", "0"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{"\[Tau]T", "=!=", "m"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "ttM", ",", "\[Mu]TT", ",", "\[CapitalGamma]M", ",", 
         "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Sigma]", ",", 
         "\[Lambda]", ",", "\[Kappa]", ",", "lgth", ",", "idx", ",", "ii", 
         ",", "invmetricM", ",", "\[CapitalSigma]", ",", "indices", ",", 
         "TensorMatrix", ",", "ChristT", ",", "partialT", ",", "output", ",", 
         "out", ",", "outputindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Christoffel", " ", "symbol"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[CapitalGamma]M", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Christoffel", "[", 
           RowBox[{
            SuperscriptBox["\[Mu]", "-"], ",", 
            SubscriptBox["\[Nu]", "-"], ",", 
            SubscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "Tensor", " ", "has", " ", "the", " ", "following", 
          " ", "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"outputindices", "=", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "indices", " ", "of", " ", "\[Tau]T"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "remove", " ", "repeated", " ", "UnderBarred", " ", "indices", " ", 
          "because", " ", "they", " ", "are", " ", "irrelevant", " ", "as", 
          " ", "far", " ", "as", " ", "CovariantD", " ", "is", " ", 
          "concerned"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "\[Tau]T", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "components", " ", "of", " ", "\[Tau]T", " ", "as", 
          " ", "a", " ", "matrix"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"TensorMatrix", "=", 
         RowBox[{"TensorComponents", "[", "\[Tau]T", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"prepare", " ", "summation", " ", "indices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "...", " ", "first", " ", "prepare", " ", "summation", " ", 
          "indices"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"redundent", " ", "symbols"}], ":", " ", 
           "\[CapitalSigma]"}], ",", " ", "\[Lambda]", ",", " ", "\[Kappa]"}],
          "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[CapitalSigma]", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], "&"}], "/@", 
            RowBox[{"Range", "[", 
             RowBox[{"1", ",", 
              RowBox[{"Length", "[", "indices", "]"}]}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
             "...", " ", "then", " ", "prepare", " ", "summation", " ", 
              "indices", " ", "and", " ", "their", " ", "summation", " ", 
              "range", " ", "1"}], "..."}], "d"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"\[Lambda]", "=", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\[CapitalSigma]", ",", "1", ",", 
              RowBox[{"Dimensions", "[", "TensorMatrix", "]"}]}], "}"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"\[Kappa]", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "&"}], "/@", "\[Lambda]"}], ")"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"partial", " ", "derivative", " ", "terms"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"partialT", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{"TensorMatrix", ",", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "\[Sigma]", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Sigma]", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"(", 
              RowBox[{"Sequence", "@@", "\[Lambda]"}], ")"}], "]"}]}], "*)"}],
           "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Christoffel", " ", "terms"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"be", " ", "careful", " ", 
          RowBox[{"re", ".", " ", "ordering"}], " ", "of", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "We", " ", "contract", " ", "Christoffel", " ", "with", " ", 
           "Tensor", " ", 
           RowBox[{"(", 
            RowBox[{"wrt", " ", "to", " ", "appropriate", " ", "slot"}], 
            ")"}], " ", "term"}], "-", "by", "-", "term"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"ChristT", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], ",", 
                RowBox[{"(*", " ", 
                 RowBox[{
                 "make", " ", "sure", " ", "the", " ", "ordering", " ", "of", 
                  " ", "indices", " ", "is", " ", "correct"}], " ", "*)"}], 
                RowBox[{"SwapIndices", "[", 
                 RowBox[{
                  RowBox[{"Which", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "===", "1"}], ",", 
                    RowBox[{"TensorsProduct", "[", 
                    RowBox[{
                    RowBox[{"Christoffel", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["\[Mu]TT", "-"], ",", 
                    SubscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Tau]T", "/.", 
                    RowBox[{"#", "\[Rule]", 
                    SuperscriptBox["\[Sigma]", "-"]}]}], ")"}]}], "]"}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "===", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{"TensorsProduct", "[", 
                    RowBox[{
                    RowBox[{"Christoffel", "[", 
                    RowBox[{
                    SuperscriptBox["\[Sigma]", "-"], ",", 
                    SubscriptBox["\[Mu]TT", "-"], ",", "#", ",", "m"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Tau]T", "/.", 
                    RowBox[{"#", "\[Rule]", 
                    SubscriptBox["\[Sigma]", "-"]}]}], ")"}]}], "]"}]}], 
                   "]"}], ",", "\[IndentingNewLine]", "\t\t", 
                  RowBox[{"RemoveRepeatedUnderBarredIndices", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    SubscriptBox["\[Mu]TT", "-"], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Indices", "[", "\[Tau]T", "]"}]}]}], "}"}], 
                   "]"}]}], "]"}]}], "}"}], "&"}], "/@", "indices"}], ")"}]}],
           ";"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "commented", " ", "out", " ", "code", " ", "is", " ", "a", " ", 
          "bit", " ", "cryptic", " ", "so", " ", 
          RowBox[{"let", "'"}], "s", " ", "do", " ", "it", " ", "slightly", 
          " ", "more", " ", 
          RowBox[{"directly", "?"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           SubscriptBox["\[Del]", "\[Mu]"], " ", 
           SubscriptBox[
            SuperscriptBox["T", 
             RowBox[{
              RowBox[{"...", " ", "\[Alpha]"}], " ", "..."}]], 
            RowBox[{
             RowBox[{"...", " ", "\[Beta]"}], " ", "..."}]]}], " ", "=", " ", 
          RowBox[{"...", " ", "+", " ", 
           RowBox[{
            SubscriptBox[
             SuperscriptBox["\[CapitalGamma]", "\[Alpha]"], "\[Mu]\[Sigma]"], 
            " ", 
            SubscriptBox[
             SuperscriptBox["T", 
              RowBox[{
               RowBox[{"...", " ", "\[Sigma]"}], " ", "..."}]], 
             RowBox[{
              RowBox[{"...", " ", "\[Beta]"}], " ", "..."}]]}], " ", "-", " ", 
           RowBox[{
            SubscriptBox[
             SuperscriptBox["\[CapitalGamma]", "\[Sigma]"], "\[Mu]\[Beta]"], 
            " ", 
            SubscriptBox[
             SuperscriptBox["T", 
              RowBox[{
               RowBox[{"...", " ", "\[Alpha]"}], " ", "..."}]], 
             RowBox[{
              RowBox[{"...", " ", "\[Sigma]"}], " ", "..."}]]}]}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"old", " ", "code", "\[IndentingNewLine]", "\[Lambda]"}], 
           "=", 
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{"\[CapitalSigma]", ",", "idx", ",", 
              RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"ChristT", "=", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], " ", 
                RowBox[{"Which", "[", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", "#", "]"}], "===", "1"}], ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Christoffel", "[", 
                    RowBox[{"#", ",", 
                    SubscriptBox["\[Mu]TT", "-"], ",", 
                    SubscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Tau]T", "/.", 
                    RowBox[{"#", "\[Rule]", 
                    SuperscriptBox["\[Sigma]", "-"]}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "idx", ",", 
                    RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], 
                  ",", "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"Sgn", "[", "#", "]"}], "===", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"Sum", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Christoffel", "[", 
                    RowBox[{
                    SuperscriptBox["\[Sigma]", "-"], ",", 
                    SubscriptBox["\[Mu]TT", "-"], ",", "#", ",", "m"}], "]"}], 
                    RowBox[{"(", 
                    RowBox[{"\[Tau]T", "/.", 
                    RowBox[{"#", "\[Rule]", 
                    SubscriptBox["\[Sigma]", "-"]}]}], ")"}]}], ",", 
                    RowBox[{"{", 
                    RowBox[{"\[Sigma]", ",", "idx", ",", 
                    RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], 
                   "]"}]}], "]"}]}], ")"}], "&"}], "/@", "indices"}], ")"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"ChristT", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Plus", "@@", 
              RowBox[{"(", 
               RowBox[{"ChristT", "/.", 
                RowBox[{"Thread", "[", 
                 RowBox[{"Rule", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "&"}], "/@", "indices"}], 
                    ")"}], ",", "\[CapitalSigma]"}], "]"}], "]"}]}], ")"}]}], 
             ",", 
             RowBox[{"{", 
              RowBox[{"\[Mu]TT", ",", "idx", ",", 
               RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"(", 
               RowBox[{"Sequence", "@@", "\[Lambda]"}], ")"}], "]"}]}], 
            "]"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"new", " ", "code", " ", "May", " ", "2016"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ChristT", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"ChristT", "=", 
           RowBox[{"Append", "[", 
            RowBox[{"ChristT", ",", 
             RowBox[{
              RowBox[{"Sgn", "[", 
               RowBox[{
               "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                "\[RightDoubleBracket]"}], "]"}], 
              RowBox[{"Transpose", "[", 
               RowBox[{
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"\[CapitalGamma]M", ",", "TensorMatrix"}], "]"}], 
                  ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Which", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "1"}], ",", 
                    "3", ",", 
                    RowBox[{
                    RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", 
                    RowBox[{"-", "1"}]}], ",", "1"}], "]"}], ",", 
                    RowBox[{"3", "+", "\[Sigma]"}]}], "}"}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"\[Sigma]", "+", "1"}], ",", "1", ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "\[Sigma]"}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "indices", "]"}], "+", "1"}]}], 
                    "]"}]}]}], "}"}], ",", 
                  RowBox[{
                   RowBox[{"Sgn", "[", 
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "\[Sigma]", 
                    "\[RightDoubleBracket]"}], "]"}], "\[Equal]", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", 
                    RowBox[{"\[Sigma]", "+", "1"}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"2", ",", "\[Sigma]"}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"\[Sigma]", "+", "2"}], ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "indices", "]"}], "+", "1"}]}], 
                    "]"}]}]}], "}"}]}], "]"}]}], "]"}]}]}], "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Sigma]", ",", "1", ",", 
            RowBox[{"Length", "[", "indices", "]"}]}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ChristT", "=", 
         RowBox[{"Plus", "@@", "ChristT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"ChristT", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               RowBox[{"TensorComponents", "[", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
                "]"}]}], ")"}], "&"}], "/@", "ChristT"}]}], ";"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "combine", " ", "the", " ", "terms", " ", "and", " ", "sum", " ", 
          "them"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"output", "=", 
           RowBox[{"Prepend", "[", 
            RowBox[{"ChristT", ",", "partialT"}], "]"}]}], ";", 
          RowBox[{"output", "=", 
           RowBox[{"Plus", "@@", "output"}]}], ";"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"partialT", "+", "ChristT"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "return", " ", "Tensor", " ", "by", " ", "prepending", " ", "Del"}],
           "-", 
          RowBox[{
          "index", " ", "\[Mu]T", " ", "and", " ", "Applying", " ", "Del", 
           " ", "to", " ", "TensorName", " ", "and", " ", "replacing", " ", 
           "TensorComponents"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "change", " ", "the", " ", "TensorType", " ", "so", " ",
             "that", " ", "even", " ", "the", " ", "CovariantD", " ", "of", 
            " ", "a", " ", "Metric", " ", "will", " ", "be", " ", "displayed",
             " ", "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{"Delete", " ", "TensorType"}], ":", 
            "\"\<CovariantDerivative(s)\>\""}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "ttt_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
              "TensorType", "\[Rule]", "\"\<CovariantDerivative(s)\>\""}], 
              ")"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Del", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "output"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Covariant", " ", "derivative", " ", 
     StyleBox[
      RowBox[{
       SuperscriptBox["\[Del]", "\[Mu]"], "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "using", " ", "the", " ", 
     "metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "\[Tau]T_Tensor",
         ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
         "scalars"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]T", "]"}]}], ")"}], "&&", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], " ",
          "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"\[Del]", " ", "on"}], " ", "\[CapitalGamma]", " ", "is", 
          " ", "not", " ", "a", " ", "correct", " ", 
          RowBox[{"definition", "."}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{
          "Do", " ", "not", " ", "allow", " ", "CovariantD", " ", "operator", 
           " ", "on", " ", "a", " ", "Christoffel"}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorTypeNoPart", "[", "\[Tau]T", "]"}], "=!=", 
          RowBox[{"{", "\"\<ChristoffelSymbols\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"\[Mu]T", ",", 
          RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"\[Del]", "g"}]}], "=", "0"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{"\[Tau]T", "=!=", "m"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Sigma]", ",", "\[Mu]TT", ",", "tempT"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempT", "=", 
         RowBox[{"CovariantD", "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "-"], ",", "\[Tau]T", ",", "m"}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Tau]T", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "We", " ", "change", " ", "the", " ", "TensorType", " ", "so", " ",
             "that", " ", "even", " ", "the", " ", "CovariantD", " ", "of", 
            " ", "a", " ", "Metric", " ", "will", " ", "be", " ", "displayed",
             " ", "properly"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"NewCode", ":", " ", 
            RowBox[{"Delete", " ", "TensorType"}], ":", 
            "\"\<CovariantDerivative(s)\>\""}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "ttt_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
              "TensorType", "\[Rule]", "\"\<CovariantDerivative(s)\>\""}], 
              ")"}]}], ","}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Del", "[", 
               RowBox[{"TensorName", "[", "\[Tau]T", "]"}], "]"}]}], ")"}]}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"TensorContract", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{
                  RowBox[{"TensorComponents", "[", 
                   RowBox[{"Metric", "[", 
                    RowBox[{
                    SuperscriptBox["\[Mu]TT", "-"], ",", 
                    SuperscriptBox["\[Sigma]", "-"], ",", "m"}], "]"}], "]"}],
                   ",", 
                  RowBox[{"TensorComponents", "[", "tempT", "]"}]}], "]"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"{", 
                  RowBox[{"2", ",", "3"}], "}"}], "}"}]}], "]"}]}], ")"}]}]}],
           "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}],
     ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"NewCode", ":", " ", 
      StyleBox[
       RowBox[{"\[Del]", "g"}],
       FontColor->RGBColor[0.5, 0, 0.5]]}], 
     StyleBox["=",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["0",
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "m_Tensor", ",", 
        "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{
        "We", " ", "have", " ", "already", " ", "dealt", " ", "with", " ", 
         "scalars"}], " ", "*)"}], 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "m", " ", "is", " ", "a", " ", "Metric"}], " ", 
        "*)"}], 
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], ")"}]}], ":=", 
     "0"}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.6299139619990625`*^9, 3.6299139692841744`*^9}, 
   3.671908904118229*^9, 3.6727825694188104`*^9, 3.8369896805153723`*^9, {
   3.83764986288929*^9, 3.8376498671872916`*^9}, {3.837838656273379*^9, 
   3.8378387039192147`*^9}, 3.8472499200590096`*^9, 3.8532237132671375`*^9, 
   3.853223744107195*^9, {3.869790046313202*^9, 3.8697900466362724`*^9}, {
   3.869790100943827*^9, 3.8697901116435556`*^9}, {3.869808600445554*^9, 
   3.8698086072607145`*^9}, {3.870379759221089*^9, 3.870379769386881*^9}, {
   3.870379800772721*^9, 3.870379878527249*^9}, {3.8715995119537926`*^9, 
   3.8715995408576403`*^9}, {3.871599802259035*^9, 3.8715998052356873`*^9}, {
   3.871601058687648*^9, 3.8716011337588415`*^9}, {3.871601315154941*^9, 
   3.8716013639269595`*^9}, 3.8720517480861735`*^9, {3.873342406760987*^9, 
   3.8733424154046345`*^9}, {3.8733424556973977`*^9, 
   3.8733424768360386`*^9}, {3.8757566002331114`*^9, 3.875756751202136*^9}, {
   3.892619954585307*^9, 3.8926199799615965`*^9}, {3.8926200982950354`*^9, 
   3.892620099156139*^9}, {3.8932891244954023`*^9, 3.893289124501398*^9}, {
   3.8950732615688725`*^9, 3.8950732615688725`*^9}, {3.8955490515387244`*^9, 
   3.895549051548718*^9}, {3.895554774826993*^9, 3.8955547748379946`*^9}, {
   3.895555172385603*^9, 3.8955551723955975`*^9}, {3.89555533992622*^9, 
   3.8955553399322157`*^9}},ExpressionUUID->"7307a0e2-ee1d-4d18-b16b-\
642b8bd73765"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"See", ":", " ", 
       RowBox[{"Operator", " ", "Linearity"}]}], " ", "&"}], " ", "Operator", 
     " ", "ProductRule"}],
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Thread", " ", "over", " ", "Plus", " ", "automatically"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"Redundant", " ", "TagSetDelay"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantD", "[", 
      RowBox[{"\[Mu]T_", ",", "tt_Plus", ",", "m_"}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"CovariantD", "[", 
         RowBox[{"\[Mu]T", ",", "#", ",", "m"}], "]"}], "&"}], "/@", "tt"}], 
      ")"}]}], ";", " ", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Implement", " ", "product", " ", "rule"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CovariantD", "[", 
      RowBox[{"\[Mu]T_", ",", "tt_", ",", "m_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"allTensors", ",", "therest"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"allTensors", "=", 
          RowBox[{"Times", "@@", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"List", "@@", "tt"}], ")"}], ",", "_Tensor"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"therest", "=", 
          RowBox[{"Times", "@@", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"List", "@@", "tt"}], ")"}], ",", "_Tensor"}], 
            "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"therest", " ", 
           RowBox[{"CovariantD", "[", 
            RowBox[{"\[Mu]T", ",", "allTensors", ",", "m"}], "]"}]}], "+", 
          RowBox[{"allTensors", " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"TensorIsZero", "[", 
              RowBox[{"CovariantD", "[", 
               RowBox[{"\[Mu]T", ",", "therest", ",", "m"}], "]"}], "]"}], 
             ",", "0", ",", "True", ",", 
             RowBox[{"CovariantD", "[", 
              RowBox[{"\[Mu]T", ",", "therest", ",", "m"}], "]"}]}], 
            "]"}]}]}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Head", "[", "tt", "]"}], "===", "Times"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"(", 
           RowBox[{"Head", "/@", 
            RowBox[{"(", 
             RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}], "]"}], "=!=", 
         RowBox[{"{", "Tensor", "}"}]}], ")"}]}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Use", " ", "TensorsProduct", " ", "to", " ", "take", " ", "care", " ", 
      "of", " ", 
      RowBox[{"TensorProduct", "'"}], "s", " ", "of", " ", "Tensors"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"CovariantD", "[", 
      RowBox[{"\[Mu]T_", ",", "tt_", ",", "m_"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"CovariantD", "[", 
       RowBox[{"\[Mu]T", ",", 
        RowBox[{"TensorsProduct", "[", "tt", "]"}], ",", "m"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Head", "[", "tt", "]"}], "===", "Times"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"(", 
            RowBox[{"Head", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "tt"}], ")"}]}], ")"}], "]"}], "===", 
          RowBox[{"{", "Tensor", "}"}]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQzRGhtOlFzGvHFnm7HSA6TfzESRD9odzrFoj2iOZ6
AKJXfix4D6JFGaW+g+icOgUwPWtVqOVLIF2z4401iOb6e8UVRE+wEXMD0Ul5
FwJB9BVuyWAQPTH/djiIbqh9CKabXr/5B6LbSg8yvgKZy/PyU2oc0P7zWz6D
6GMLXk1MA9Ir44xmgGgN3aD5IPraiT4w/UdSdSfXlTeOt/Lkd4HoRSs2nwLR
gfU8p0H0lahCEa6rbxz7vsuIgugrS98/EQTSIrHnnoPpsJN6QkA6y4dbH0Rb
mQbngWjT2GOlIPrUjhkzQXT9knlg2mDLJltn1rdwetaFwn5ttreOWi8hNACW
abFv
  "],ExpressionUUID->"a7e03333-566f-4964-af73-74f7ba21abcc"]
}, Closed]],

Cell[CellGroupData[{

Cell["CovariantBox", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 
   3.5760890111890397`*^9}},ExpressionUUID->"0e73ee14-ddc6-4094-897f-\
e020160790d0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Box", " ", "on", " ", "scalar", " ", "function", " ", "f"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{"g", "^", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}], "}"}]}], " ", 
     RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
     RowBox[{"(", " ", 
      RowBox[{
       RowBox[{"g", "^", 
        RowBox[{"{", 
         RowBox[{"1", "/", "2"}], "}"}]}], " ", 
       RowBox[{"g", "^", 
        RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
       RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}], " ", ")"}]}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"g", "^", 
         RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
        RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}], " ", ")"}]}], " ", "+",
      " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"\[PartialD]", "_\[Mu]"}], " ", "ln", " ", 
        RowBox[{"g", "^", 
         RowBox[{"{", 
          RowBox[{"1", "/", "2"}], "}"}]}]}], ")"}], " ", 
      RowBox[{"g", "^", 
       RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
      RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
      RowBox[{"(", " ", 
       RowBox[{
        RowBox[{"g", "^", 
         RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
        RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}], " ", ")"}]}], " ", "+",
      " ", 
     RowBox[{
      RowBox[{"\[CapitalGamma]", "^", "\[Mu]_"}], 
      RowBox[{"{", "\[Mu]\[Lambda]", "}"}], " ", 
      RowBox[{"g", "^", 
       RowBox[{"{", "\[Lambda]\[Nu]", "}"}]}], " ", 
      RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "f"}]}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantBox", "[", 
       RowBox[{"stuff_", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "grad", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Lambda]", 
         ",", "lgth", ",", "idx", ",", "ii"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idx", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"g", "^", 
           RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
          RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "stuff"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"grad", "=", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Metric", "[", 
               RowBox[{
                SuperscriptBox["\[Mu]", "-"], ",", 
                SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], 
              RowBox[{"D", "[", 
               RowBox[{"stuff", ",", 
                RowBox[{"coords", "\[LeftDoubleBracket]", 
                 RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
                 "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "idx", ",", 
               RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "idx", ",", 
             RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"\[PartialD]", "_\[Mu]"}], " ", 
           RowBox[{"grad", "^", "\[Mu]"}]}], " ", "+", " ", 
          RowBox[{
           RowBox[{"\[CapitalGamma]", "^", "\[Mu]_"}], 
           RowBox[{"{", "\[Mu]\[Nu]", "}"}], " ", 
           RowBox[{"grad", "^", "\[Nu]"}]}]}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{"grad", "\[LeftDoubleBracket]", 
              RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{"coords", "\[LeftDoubleBracket]", 
              RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
              "\[RightDoubleBracket]"}]}], "]"}], "+", 
           RowBox[{
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Christoffel", "[", 
               RowBox[{
                SuperscriptBox["\[Mu]", "-"], ",", 
                SubscriptBox["\[Mu]", "-"], ",", 
                SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"\[Mu]", ",", "idx", ",", 
                RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], 
            RowBox[{"grad", "\[LeftDoubleBracket]", 
             RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
             "\[RightDoubleBracket]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "idx", ",", 
            RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[
      RowBox[{"CovariantBox", " ", "on", " ", "Tensor"}],
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CovariantBox", "[", 
       RowBox[{"t_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"m", " ", "is", " ", "a", " ", 
        StyleBox["metric",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
         StyleBox["CoordinateSystem",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], "should", " ", "be", " ", "the", " ", 
         RowBox[{"same", "."}]}], "*)"}], 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Coordinates", "[", "t", "]"}], "===", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "tempname", ",", "output", ",", "resumeindices", ",", "\[Mu]"}], 
        "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["TensorName",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tempname", "=", 
         RowBox[{"TensorNameNoPart", "[", "t", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", "the", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"resumeindices", "=", 
         RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Operate", " ", "\[Square]"}], "\[Congruent]", 
          RowBox[{
           RowBox[{
            StyleBox[
             SubscriptBox["\[Del]", "\[Mu]"],
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox[
              SuperscriptBox["\[Del]", "\[Mu]"],
              FontColor->RGBColor[1, 0, 1]], " ", "on"}]}], " ", "t", " ", 
           "to", " ", "get", " ", 
           StyleBox[
            RowBox[{"\[Square]", "t"}],
            FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"CovariantD", "[", 
          RowBox[{
           RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"CovariantD", "[", 
            RowBox[{
             RowBox[{"SuperMinus", "[", "\[Mu]", "]"}], ",", "t", ",", "m"}], 
            "]"}], ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"TestExpressionForm", "[", "output", "]"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"t", "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", " ", "tc___"}], ")"}], 
              "\[Rule]", " ", 
              RowBox[{"TensorComponents", "\[Rule]", " ", "output"}]}], 
             "}"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rename",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
          StyleBox[
           RowBox[{"\[Square]", "t"}],
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "recover", " ", 
          "the", " ", "original", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["indices",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "name_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Square", "@@", "tempname"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "resumeindices"}], ")"}]}]}], 
          "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "CovariantBox", ":", " ", 
     RowBox[{"calculate", " ", "with", " ", "CovariantD"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"CovariantBox", "[", 
       RowBox[{"stuff_", ",", "m_Tensor", ",", "CovariantD"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
        RowBox[{"(", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"CovariantBox", "[", 
      RowBox[{"stuff", ",", "m"}], "]"}]}], "*)"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "CovariantBox", ":", " ", 
     RowBox[{"calculate", " ", "with", " ", "Determinant"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"CovariantBox", "[", 
        RowBox[{"stuff_", ",", "m_Tensor", ",", "Determinant"}], "]"}], "/;", 
       RowBox[{"(", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}], "&&", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
         RowBox[{"(", 
          RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"SqrtDet", ",", "\[Mu]", ",", "\[Nu]"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"SqrtDet", "=", 
          SuperscriptBox[
           RowBox[{"Determinant", "[", "m", "]"}], 
           FractionBox["1", "2"]]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          FractionBox["1", "SqrtDet"], 
          RowBox[{"(", 
           RowBox[{"PartialD", "[", 
            RowBox[{
             SubscriptBox["\[Mu]", "-"], ",", 
             RowBox[{"(", 
              RowBox[{"SqrtDet", " ", 
               RowBox[{"Metric", "[", 
                RowBox[{
                 SuperscriptBox["\[Mu]", "-"], ",", 
                 SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], " ", 
               RowBox[{"PartialD", "[", 
                RowBox[{
                 SubscriptBox["\[Nu]", "-"], ",", " ", "stuff", ",", 
                 RowBox[{"Coordinates", "[", "m", "]"}]}], "]"}]}], ")"}], 
             ",", "m"}], "]"}], ")"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
     ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, 3.8273802153389373`*^9, {
   3.8369804274373302`*^9, 3.836980427917673*^9}, {3.836980657173845*^9, 
   3.8369806793575926`*^9}, {3.8369919209732704`*^9, 3.836991954087078*^9}, {
   3.836992939414033*^9, 3.8369930534605656`*^9}, {3.8369931017089777`*^9, 
   3.8369931884849405`*^9}, {3.8369938163772287`*^9, 
   3.8369938464879155`*^9}, {3.8369938942200313`*^9, 3.83699389605641*^9}, {
   3.836994027293441*^9, 3.8369941805586343`*^9}, {3.836995940800383*^9, 
   3.836995975324904*^9}, {3.836996061832777*^9, 3.836996071359956*^9}, {
   3.8369961112260375`*^9, 3.836996116834282*^9}, {3.8369973775029235`*^9, 
   3.836997406334116*^9}, {3.836997533191107*^9, 3.836997537603136*^9}, {
   3.836997586572756*^9, 3.8369976039999657`*^9}, {3.8369976686476393`*^9, 
   3.836997673840048*^9}, {3.83699797920352*^9, 3.8369979902878876`*^9}, {
   3.836998037243683*^9, 3.836998041640744*^9}, {3.8370445404093733`*^9, 
   3.837044546384368*^9}, 3.8370445916947784`*^9, {3.837044690794423*^9, 
   3.837044691844432*^9}, 3.837044730584547*^9, {3.8370454014643717`*^9, 
   3.8370454131147184`*^9}, {3.837649164887122*^9, 3.8376491678951263`*^9}, {
   3.8376493367901144`*^9, 3.8376493478971095`*^9}, {3.837649605271124*^9, 
   3.8376496213861237`*^9}, {3.8381958307244577`*^9, 3.838195846275453*^9}, {
   3.8381958990439453`*^9, 3.8381959101769915`*^9}, {3.8534718775054874`*^9, 
   3.8534719368883*^9}, {3.8534721047050543`*^9, 3.853472109367186*^9}, {
   3.853472147550696*^9, 3.8534721566470985`*^9}, {3.8534721972461205`*^9, 
   3.8534723414449654`*^9}, {3.8534730965719347`*^9, 
   3.8534730997689667`*^9}, {3.853473565466111*^9, 3.8534737045376873`*^9}, {
   3.875756884422923*^9, 3.875757044480401*^9}, {3.8757570781593757`*^9, 
   3.8757571243975334`*^9}, 3.887027305718476*^9, {3.887120676700593*^9, 
   3.887120684045255*^9}, {3.8871208700018797`*^9, 3.8871209649401693`*^9}, {
   3.8926213630353355`*^9, 3.892621490438792*^9}, {3.8926215282388554`*^9, 
   3.8926215889698863`*^9}, {3.892866984651885*^9, 3.8928669882536697`*^9}, {
   3.8955551724025908`*^9, 3.8955551724125843`*^9}, {3.895555838456438*^9, 
   3.8955558384774237`*^9}},ExpressionUUID->"2530e695-ff6a-4bf8-a014-\
8709536a94b3"],

Cell[BoxData[""], "Input",ExpressionUUID->"74ccdc3f-0172-4103-b65e-b4fc62e0d23f"]
}, Closed]],

Cell[CellGroupData[{

Cell["GradientSquared", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.583789536600904*^9, 
   3.583789562445382*^9}, {3.583789592737115*^9, 
   3.583789617611538*^9}},ExpressionUUID->"c6e974b4-db8f-43a6-b870-\
4241d0d1698a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Del]", "f"}], ")"}], "^", "2"}], " ", "for", " ", "scalar", 
    " ", "function", " ", "f"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "this", " ", "code", " ", "is", " ", "borrowed", " ", "from", " ", 
    "CovariantBox"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GradientSquared", "[", 
     RowBox[{"stuff_", ",", "m_Tensor"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "TestExpressionForm"}], "*)"}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}], ")"}], "&&", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"TestMetricTensor", "[", "m", "]"}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "coords", ",", "gradu", ",", "gradd", ",", "\[Mu]", ",", "\[Nu]", ",", 
       "\[Lambda]", ",", "lgth", ",", "idx", ",", "ii"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"coords", "=", 
       RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
      RowBox[{"lgth", "=", 
       RowBox[{"Length", "[", "coords", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"extract", " ", "StartIndex"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"idx", "=", 
       RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"g", "^", 
         RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
        RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "stuff"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gradu", "=", 
       RowBox[{"Table", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Metric", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]", "-"], ",", 
              SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], 
            RowBox[{"D", "[", 
             RowBox[{"stuff", ",", 
              RowBox[{"coords", "\[LeftDoubleBracket]", 
               RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
               "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "idx", ",", 
             RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"\[Mu]", ",", "idx", ",", 
           RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], 
        "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"\[PartialD]", "_\[Mu]"}], " ", "stuff"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"gradd", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"stuff", ",", 
           RowBox[{"coords", "\[LeftDoubleBracket]", 
            RowBox[{"\[Nu]", "-", "idx", "+", "1"}], 
            "\[RightDoubleBracket]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Nu]", ",", "idx", ",", 
           RowBox[{"idx", "+", "lgth", "-", "1"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"\[PartialD]", "_\[Mu]"}], " ", "stuff", " ", 
         RowBox[{"g", "^", 
          RowBox[{"{", "\[Mu]\[Nu]", "}"}]}], " ", 
         RowBox[{"\[PartialD]", "_\[Nu]"}], " ", "stuff"}], " ", "=", " ", 
        RowBox[{"gradd", ".", "gradu"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"gradu", ".", "gradd"}]}]}], "\[IndentingNewLine]", 
    "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.5837895835345883`*^9, 
   3.5837896999162455`*^9}, {3.583789732961135*^9, 3.5837897641899214`*^9}, {
   3.5837898029911404`*^9, 3.583789812347676*^9}, {3.5837898853688526`*^9, 
   3.583789939647957*^9}, {3.875757855060691*^9, 3.87575791548322*^9}, 
   3.895555172416582*^9, {3.895555838481423*^9, 
   3.895555838483421*^9}},ExpressionUUID->"c167f52d-6b5f-45f9-88cc-\
e47f81b96e71"]
}, Closed]],

Cell[CellGroupData[{

Cell["InteriorProduct", "Subsection",
 CellChangeTimes->{{3.8901931809672127`*^9, 
  3.8901932130070333`*^9}},ExpressionUUID->"64fc49b5-8c00-4eb5-9ab2-\
6332caaddfbb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "InteriorProduct"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"InteriorProduct", "[", 
       RowBox[{
        RowBox[{"X_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RankNumber", "[", "X", "]"}], ">", "0"}], ")"}]}], 
        RowBox[{"(*", 
         RowBox[{"&&", 
          RowBox[{"(", 
           RowBox[{"TestDifferentialVector", "[", "X", "]"}], ")"}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"TestOneVector", "[", "X", "]"}], "*)"}], ",", 
        "\[Omega]_Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"TestDifferentialForm", "[", "\[Omega]", "]"}], "&&"}], 
        "*)"}], 
       RowBox[{
        RowBox[{"RankNumber", "[", "\[Omega]", "]"}], ">", "0"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "originalXindices", ",", "original\[Omega]indices", ",", "Xindices", 
         ",", "\[Omega]indices", ",", "length", ",", "length2", ",", 
         "finallength", ",", "newIndicesrep", ",", "newIndices", ",", "i", 
         ",", "output", ",", "newTensorName"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "\[Omega]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"TestDifferentialVector", "[", "X", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"originalXindices", "=", 
         RowBox[{"Indices", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"original\[Omega]indices", "=", 
         RowBox[{"Indices", "[", "\[Omega]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Xindices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", "originalXindices", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Omega]indices", "=", 
         RowBox[{
         "RemoveUnderBarredIndices", "[", "original\[Omega]indices", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"length", "=", 
         RowBox[{"RankNumber", "[", "Xindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"length2", "=", 
         RowBox[{"RankNumber", "[", "\[Omega]indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"finallength", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"length", ",", "length2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newIndicesrep", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Xindices", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{"\[Omega]indices", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
            ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "finallength"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"newIndices", "=", 
         RowBox[{"originalXindices", "/.", "newIndicesrep"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"(", 
            RowBox[{"length", "===", "length2"}], ")"}], 
           RowBox[{"(*", 
            RowBox[{"||", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{"length", "-", "length2"}], "]"}], "===", "1"}], 
              ")"}]}], "*)"}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{
            FractionBox["1", 
             RowBox[{"finallength", "!"}]], " ", 
            RowBox[{"TensorsProduct", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Indices", "[", 
                RowBox[{"X", ",", "newIndices"}], "]"}], ",", "\[Omega]"}], 
              "}"}], "]"}]}]}], ",", "True", ",", 
          RowBox[{
           RowBox[{"output", "=", 
            RowBox[{"TensorsProduct", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Indices", "[", 
                RowBox[{"X", ",", "newIndices"}], "]"}], ",", "\[Omega]"}], 
              "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"output", "=", 
            RowBox[{"TensorsProduct", "[", 
             RowBox[{
              RowBox[{
               FractionBox["1", 
                RowBox[{"finallength", "!"}]], " ", "output"}], ",", 
              "Tensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"output", "=", 
            RowBox[{"TensorName", "[", 
             RowBox[{"output", ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["\"\<\[Iota]\>\"", 
                  RowBox[{"TensorName", "[", "X", "]"}]], ",", 
                 RowBox[{"TensorName", "[", "\[Omega]", "]"}]}], "}"}], 
               "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"output", "=", 
            RowBox[{
            "RemoveRepeatedUnderBarredIndices", "[", "output", "]"}]}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"InteriorProduct", "[", 
       RowBox[{
        RowBox[{"X_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"RankNumber", "[", "X", "]"}], ">", "0"}], ")"}]}], 
        RowBox[{"(*", 
         RowBox[{"&&", 
          RowBox[{"(", 
           RowBox[{"TestDifferentialVector", "[", "X", "]"}], ")"}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"TestOneVector", "[", "X", "]"}], "*)"}], ",", 
        "\[Omega]_Tensor", ",", "Tensor"}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"TestDifferentialForm", "[", "\[Omega]", "]"}], "&&"}], 
        "*)"}], 
       RowBox[{
        RowBox[{"RankNumber", "[", "\[Omega]", "]"}], ">", "0"}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "originalXindices", ",", "original\[Omega]indices", ",", "Xindices", 
         ",", "\[Omega]indices", ",", "length", ",", "length2", ",", 
         "finallength", ",", "newIndicesrep", ",", "newIndices", ",", "i", 
         ",", "output", ",", "newTensorName"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "\[Omega]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"TestDifferentialVector", "[", "X", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"originalXindices", "=", 
         RowBox[{"Indices", "[", "X", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"original\[Omega]indices", "=", 
         RowBox[{"Indices", "[", "\[Omega]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Xindices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", "originalXindices", "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Omega]indices", "=", 
         RowBox[{
         "RemoveUnderBarredIndices", "[", "original\[Omega]indices", "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"length", "=", 
         RowBox[{"RankNumber", "[", "Xindices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"length2", "=", 
         RowBox[{"RankNumber", "[", "\[Omega]indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"finallength", "=", 
         RowBox[{"Min", "[", 
          RowBox[{"length", ",", "length2"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newIndicesrep", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Xindices", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{"\[Omega]indices", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], " ", 
            ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", "finallength"}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"newIndices", "=", 
         RowBox[{"originalXindices", "/.", "newIndicesrep"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"TensorsProduct", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"Indices", "[", 
              RowBox[{"X", ",", "newIndices"}], "]"}], ",", "\[Omega]"}], 
            "}"}], ",", "Tensor"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"TensorsProduct", "[", 
          RowBox[{
           RowBox[{
            FractionBox["1", 
             RowBox[{"finallength", "!"}]], " ", "output"}], ",", "Tensor"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"TensorName", "[", 
          RowBox[{"output", ",", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["\"\<\[Iota]\>\"", 
               RowBox[{"TensorName", "[", "X", "]"}]], ",", 
              RowBox[{"TensorName", "[", "\[Omega]", "]"}]}], "}"}], "]"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{
         "RemoveRepeatedUnderBarredIndices", "[", "output", "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"Subscript", "[", 
      RowBox[{"Global`\[Iota]", ",", "a_Tensor"}], "]"}], "[", "b_Tensor", 
     "]"}], ":=", 
    RowBox[{"InteriorProduct", "[", 
     RowBox[{"a", ",", "b"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.89019329434483*^9, 3.8901933499660873`*^9}, {
   3.890193525069709*^9, 3.8901935325654325`*^9}, {3.890193757436674*^9, 
   3.890193804003336*^9}, 3.8901944875937843`*^9, {3.8901980199523973`*^9, 
   3.8901980214987545`*^9}, 3.890198202201866*^9, {3.8901982579540644`*^9, 
   3.8901982726732492`*^9}, {3.890198425520746*^9, 3.890198469609847*^9}, {
   3.890198518463782*^9, 3.890198532807666*^9}, 3.8901985631927247`*^9, {
   3.8901991230120907`*^9, 3.890199141179894*^9}, {3.89139980393928*^9, 
   3.891399822484338*^9}, {3.891399945938776*^9, 3.891399992554781*^9}, {
   3.8915672456428695`*^9, 3.891567279438905*^9}, {3.891570437902934*^9, 
   3.8915704760597534`*^9}, {3.891570526577862*^9, 3.891570570141715*^9}, {
   3.8915706028235064`*^9, 3.891570613308096*^9}, {3.891570772260191*^9, 
   3.89157082694309*^9}, {3.8915712791162643`*^9, 3.891571320330065*^9}, {
   3.891571393714176*^9, 3.8915714215221715`*^9}, {3.891571476346086*^9, 
   3.891571476496993*^9}, {3.8915724186152287`*^9, 3.8915724219582124`*^9}, {
   3.891572512785328*^9, 3.89157251417048*^9}, {3.8915734272266245`*^9, 
   3.89157343058657*^9}, 3.8915761008732595`*^9, 3.891579747703946*^9, {
   3.8915798129675255`*^9, 3.891579815823778*^9}, {3.891579900189654*^9, 
   3.891579901709725*^9}, {3.891580054861144*^9, 3.8915800708374147`*^9}, {
   3.8915801861404696`*^9, 3.8915802142703133`*^9}, 3.8915804049180355`*^9, {
   3.8915804407164493`*^9, 3.8915804553724856`*^9}, 3.8915804872295837`*^9, {
   3.891580593806221*^9, 3.8915806080355167`*^9}, {3.891580641572157*^9, 
   3.8915806438357735`*^9}, 3.8915831145139112`*^9, {3.891583153492566*^9, 
   3.891583156356344*^9}, {3.8915842758102317`*^9, 3.8915842776561623`*^9}, {
   3.8915844301763067`*^9, 3.8915845478719893`*^9}, 3.8920073723666143`*^9, {
   3.8920079855825386`*^9, 3.8920079968665285`*^9}, 3.8920118762668285`*^9, {
   3.8920126695782213`*^9, 3.8920127056330276`*^9}, {3.8920127379462166`*^9, 
   3.8920127771773725`*^9}, {3.892013137694544*^9, 3.8920131378964195`*^9}, {
   3.8920132346707582`*^9, 3.8920132371022587`*^9}, 3.892083182192808*^9, {
   3.8920834592048116`*^9, 3.892083571995708*^9}, {3.8920836605630856`*^9, 
   3.892083682284641*^9}, {3.892083725681777*^9, 3.8920837471295004`*^9}, 
   3.8920838094103913`*^9, {3.89315952321809*^9, 3.893159539434247*^9}, {
   3.8931596757225313`*^9, 3.893159690491088*^9}, {3.893159931002372*^9, 
   3.8931599374243093`*^9}, 3.8931599845389404`*^9, 3.893160029193654*^9, {
   3.8931600663140893`*^9, 3.89316012527291*^9}, {3.893160157360823*^9, 
   3.8931601600168715`*^9}, {3.8931602290319495`*^9, 3.893160240120569*^9}, 
   3.893160336917816*^9, {3.8950732615844955`*^9, 3.8950732615844955`*^9}, {
   3.8955490515796995`*^9, 3.895549051586695*^9}, {3.8955556351535015`*^9, 
   3.895555635156499*^9}, {3.895555716323923*^9, 3.895555716327921*^9}, 
   3.89555601947795*^9, {3.8984042359503117`*^9, 3.898404243305689*^9}, {
   3.898404286175402*^9, 3.8984042923798466`*^9}, {3.898404363527941*^9, 
   3.898404365166727*^9}, {3.8984044219436007`*^9, 3.8984044222873135`*^9}, 
   3.8984045013110514`*^9, {3.8984045395969243`*^9, 3.8984045643806753`*^9}, {
   3.898404757046847*^9, 3.8984048603118515`*^9}, 3.898404931130731*^9, {
   3.955770481629141*^9, 3.955770489569879*^9}, 
   3.955770657300984*^9},ExpressionUUID->"5a646ee0-bb50-4ec4-a619-\
8d4711fa672e"]
}, Closed]],

Cell[CellGroupData[{

Cell["ExteriorD", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.6061493485872273`*^9, 
   3.6061493494062743`*^9}, {3.6299087800753407`*^9, 
   3.6299087836165466`*^9}, {3.848441886542853*^9, 
   3.848441901542859*^9}},ExpressionUUID->"7503329c-2ee4-4851-b1a9-\
d38c3a66c1d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["ExteriorD",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Input", " ", "a", " ", 
    StyleBox["new",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[" ",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox["specified",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox[" ",
     FontColor->RGBColor[0.5, 0, 0.5]], 
    StyleBox["index",
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "and", " ", "tensor", " ", "t"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "t_Tensor"}], 
       "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"index", " ", "for", " ", 
        StyleBox["PartialD",
         FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
        StyleBox["lower",
         FontColor->RGBColor[1, 0, 1]], " ", "one"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sgn", "[", "\[Mu]T", "]"}], "===", 
        RowBox[{"-", "1"}]}], ")"}]}], 
     RowBox[{"(*", 
      RowBox[{"&&", 
       RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], 
     RowBox[{"(*", 
      RowBox[{"&&", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"TestDifferentialForm", "[", "t", "]"}], ",", "True", ",", 
         RowBox[{
          RowBox[{"Message", "[", 
           RowBox[{
            RowBox[{
            "TestDifferentialForm", "::", "TestDifferentialFormFalse"}], ",", 
            "t"}], "]"}], ";", "False"}]}], "]"}]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dF", ",", "ddFm", ",", 
         RowBox[{"\[Mu]Ttemp", "=", 
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Alpha]", "]"}], "-"]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "t", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["PartialD",
           FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "t"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"dF", "=", 
         RowBox[{"PartialD", "[", 
          RowBox[{"\[Mu]Ttemp", ",", "t"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["AntiSymmetrizeIndices",
           FontColor->RGBColor[1, 0, 1]], " ", "dF"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ddFm", "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "!"}]], 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"AntiSymmetrizeIndices", "[", "dF", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Add", " ", "a", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "the", " ", 
          "TensorName", " ", "and", " ", "change", " ", "the", " ", 
          RowBox[{"TensorComponents", ".", " ", "Prepend"}], " ", "a", " ", 
          "new", " ", 
          RowBox[{"index", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                 RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ddFm"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "t_Tensor", ",", 
        RowBox[{"m_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"index", " ", "for", " ", 
        StyleBox["PartialD",
         FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
        StyleBox["lower",
         FontColor->RGBColor[1, 0, 1]], " ", "one"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sgn", "[", "\[Mu]T", "]"}], "===", 
           RowBox[{"-", "1"}]}], ")"}], 
         RowBox[{"(*", 
          RowBox[{"&&", 
           RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Sgn", "[", "\[Mu]T", "]"}], "===", "1"}], ")"}], 
         RowBox[{"(*", 
          RowBox[{"&&", 
           RowBox[{"TestDifferentialVector", "[", "t", "]"}]}], "*)"}], 
         ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"dF", ",", "ddFm", ",", 
         RowBox[{"\[Mu]Ttemp", "=", 
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Alpha]", "]"}], "-"]}], ",", 
         RowBox[{"\[Mu]Ttemp2", "=", 
          SuperscriptBox[
           RowBox[{"Unique", "[", "\[Alpha]", "]"}], "-"]}]}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         StyleBox["PartialD",
          FontColor->RGBColor[1, 0, 1]], " ", "on", " ", "t"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"dF", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Mu]T", "]"}], "===", 
             RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TestDifferentialForm", "[", "t", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"CovariantD", "[", 
             RowBox[{"\[Mu]Ttemp", ",", "t", ",", "m"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sgn", "[", "\[Mu]T", "]"}], "===", "1"}], ")"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TestDifferentialVector", "[", "t", "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"CovariantD", "[", 
             RowBox[{"\[Mu]Ttemp2", ",", "t", ",", "m"}], "]"}]}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["AntiSymmetrizeIndices",
           FontColor->RGBColor[1, 0, 1]], " ", "dF"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ddFm", "=", 
         RowBox[{
          FractionBox["1", 
           RowBox[{
            RowBox[{"RankNumber", "[", "t", "]"}], "!"}]], 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"AntiSymmetrizeIndices", "[", "dF", "]"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Add", " ", "a", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "the", " ", 
          "TensorName", " ", "and", " ", "change", " ", "the", " ", 
          RowBox[{"TensorComponents", ".", " ", "Prepend"}], " ", "a", " ", 
          "new", " ", 
          RowBox[{"index", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"t", "/.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "iii_"}], ")"}], "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Prepend", "[", 
               RowBox[{"iii", ",", "\[Mu]T"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "nnn_"}], ")"}], 
            "\[RuleDelayed]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                 RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ccc_"}], ")"}], 
            "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "ddFm"}], ")"}]}]}], 
          "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Rename",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "the", " ", "whole", " ", 
     "bunch", " ", "of", " ", 
     RowBox[{
      StyleBox["indices",
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{"\[Mu]List_List", ",", "t_Tensor"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"The", " ", 
         StyleBox["length",
          FontColor->RGBColor[1, 0, 1]], " ", "of", " ", 
         StyleBox["\[Mu]List",
          FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
         StyleBox["rank",
          FontColor->RGBColor[1, 0, 1]]}], 
        StyleBox["+",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "\[Mu]List", "]"}], "===", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], "+", "1"}]}], ")"}], 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"Also", ",", " ", 
         RowBox[{
         "we", " ", "want", " ", "to", " ", "check", " ", "all", " ", 
          "indices", " ", "in", " ", 
          StyleBox["\[Mu]List",
           FontColor->RGBColor[1, 0, 1]], " ", "are", " ", "OK", " ", "and", 
          " ", 
          StyleBox[
           RowBox[{"lower", "."}],
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
            "\[Mu]List"}], "]"}], ")"}], ",", 
         RowBox[{"{", "True", "}"}]}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Union", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "\[Mu]List"}], 
            "]"}], ")"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "1"}], "}"}]}], "]"}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
        "Check", " ", "all", " ", "indices", " ", "in", " ", "\[Mu]List", " ",
          "are", " ", 
         RowBox[{
          StyleBox["abstract",
           FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotAbstractIndex", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Coordinates", "[", "t", "]"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"StartIndexNoPart", "[", "t", "]"}]}]}], "]"}], "&"}], 
           "/@", "\[Mu]List"}], "]"}], ",", 
         RowBox[{"{", "False", "}"}]}], "]"}]}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["ExteriorD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Part",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], "of", " ", 
        StyleBox["\[Mu]List",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{
       "\[Mu]List", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "/", " ", 
               StyleBox["Drop",
                FontColor->RGBColor[1, 0, 1]]}], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["1",
               FontColor->RGBColor[1, 0, 1]]}], ",", 
             RowBox[{
             "we", " ", "can", " ", "get", " ", "the", " ", "new", " ", 
              "indices", " ", "for", " ", "t"}]}], "*)"}], 
           RowBox[{"Drop", "[", 
            RowBox[{"\[Mu]List", ",", "1"}], "]"}]}], ")"}]}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Rename",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "the", " ", "whole", " ", 
     "bunch", " ", "of", " ", 
     RowBox[{
      StyleBox["indices",
       FontColor->RGBColor[0.5, 0, 0.5]], "."}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ExteriorD", "[", 
       RowBox[{"\[Mu]List_List", ",", "t_Tensor", ",", 
        RowBox[{"m_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "m", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"The", " ", 
         StyleBox["length",
          FontColor->RGBColor[1, 0, 1]], " ", "of", " ", 
         StyleBox["\[Mu]List",
          FontColor->RGBColor[1, 0, 1]], " ", "should", " ", "be", " ", 
         StyleBox["rank",
          FontColor->RGBColor[1, 0, 1]]}], 
        StyleBox["+",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", "\[Mu]List", "]"}], "===", 
         RowBox[{
          RowBox[{"RankNumber", "[", "t", "]"}], "+", "1"}]}], ")"}], 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"check", " ", "t", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
            StyleBox["fully",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["anti",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox["-",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"symm", " ", "tensor"}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
         RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"Also", ",", " ", 
         RowBox[{
         "we", " ", "want", " ", "to", " ", "check", " ", "all", " ", 
          "indices", " ", "in", " ", 
          StyleBox["\[Mu]List",
           FontColor->RGBColor[1, 0, 1]], " ", "are", " ", "OK", " ", "and", 
          " ", 
          StyleBox[
           RowBox[{"lower", "."}],
           FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"TestIndices", "[", "#", "]"}], "&"}], "/@", 
            "\[Mu]List"}], "]"}], ")"}], ",", 
         RowBox[{"{", "True", "}"}]}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "\[Mu]List"}], 
             "]"}], ")"}], ",", 
           RowBox[{"{", 
            RowBox[{"-", "1"}], "}"}]}], "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "\[Mu]List"}], 
             "]"}], ")"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
        "Check", " ", "all", " ", "indices", " ", "in", " ", "\[Mu]List", " ",
          "are", " ", 
         RowBox[{
          StyleBox["abstract",
           FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"NotAbstractIndex", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Coordinates", "[", "t", "]"}], ",", 
              RowBox[{"Sequence", "@@", 
               RowBox[{"StartIndexNoPart", "[", "t", "]"}]}]}], "]"}], "&"}], 
           "/@", "\[Mu]List"}], "]"}], ",", 
         RowBox[{"{", "False", "}"}]}], "]"}]}]}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["ExteriorD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"(*", 
       RowBox[{
        StyleBox["Part",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["1",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], "of", " ", 
        StyleBox["\[Mu]List",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
      RowBox[{
       RowBox[{
       "\[Mu]List", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"t", "/.", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
         RowBox[{"(", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
              RowBox[{"W", "/", " ", 
               StyleBox["Drop",
                FontColor->RGBColor[1, 0, 1]]}], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["1",
               FontColor->RGBColor[1, 0, 1]]}], ",", 
             RowBox[{
             "we", " ", "can", " ", "get", " ", "the", " ", "new", " ", 
              "indices", " ", "for", " ", "t"}]}], "*)"}], 
           RowBox[{"Drop", "[", 
            RowBox[{"\[Mu]List", ",", "1"}], "]"}]}], ")"}]}]}], ",", "m"}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"ExteriorD", " ", 
     StyleBox[
      RowBox[{"w", "/", "o"}],
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "given", " ", "a", " ", 
     StyleBox["specified",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{
      StyleBox["index",
       FontColor->RGBColor[0.5, 0, 0.5]], ".", "We"}], " ", "will", " ", 
     "generate", " ", "one", " ", 
     StyleBox["Unique",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["index",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", 
     RowBox[{"user", "."}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"ExteriorD", "[", "t_Tensor", "]"}], 
     RowBox[{"(*", 
      RowBox[{"/;", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"check", " ", "t", 
          StyleBox[" ",
           FontColor->RGBColor[1, 0.5, 0.5]], "is", " ", "a", " ", 
          StyleBox["fully",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["anti",
           FontColor->RGBColor[1, 0, 1]]}], 
         StyleBox["-",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{"symm", " ", "tensor"}],
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
       RowBox[{"TestDifferentialForm", "[", "t", "]"}]}], "*)"}], ":=", 
     RowBox[{"(*", 
      RowBox[{"Recall", " ", 
       StyleBox["ExteriorD",
        FontColor->RGBColor[1, 0, 1]]}], "*)"}], 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"(*", 
       RowBox[{"Generate", " ", 
        StyleBox["unique",
         FontColor->RGBColor[1, 0, 1]], " ", "index"}], "*)"}], 
      RowBox[{
       SubscriptBox[
        RowBox[{"Unique", "[", "\[Mu]", "]"}], "-"], ",", "t"}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Shorthand",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "ExteriorD", " ", 
     RowBox[{"(", 
      RowBox[{"\[DifferentialD]", "Tensor"}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"\[DifferentialD]", "t_Tensor"}], ":=", 
     RowBox[{"ExteriorD", "[", "t", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Shorthand",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "ExteriorD", " ", 
     RowBox[{"w", "/", " ", 
      StyleBox["a",
       FontColor->RGBColor[0.5, 0, 0.5]]}], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["new",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["index",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["for",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["PartialD",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{"(", 
      StyleBox[
       RowBox[{
        SubscriptBox["\[DifferentialD]", 
         SubscriptBox["\[Mu]T", "-"]], "Tensor"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Tensor", "/:", 
    RowBox[{"Dt", "[", 
     RowBox[{"t_Tensor", ",", 
      RowBox[{"SubMinus", "[", "\[Mu]T_Symbol", "]"}]}], "]"}], ":=", 
    RowBox[{"ExteriorD", "[", 
     RowBox[{
      SubscriptBox["\[Mu]T", "-"], ",", "t"}], "]"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["Shorthand",
      FontColor->RGBColor[0.5, 0, 0.5]], " ", "for", " ", "ExteriorD", " ", 
     RowBox[{"w", "/", " ", 
      StyleBox["a",
       FontColor->RGBColor[0.5, 0, 0.5]]}], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["new",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["indices",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["List",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["for",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox["PartialD",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     StyleBox[" ",
      FontColor->RGBColor[0.5, 0, 0.5]], 
     RowBox[{"(", 
      StyleBox[
       RowBox[{
        SubscriptBox["\[DifferentialD]", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[Mu]T", "-"], ",", 
           SubscriptBox["a1", "-"], ",", 
           SubscriptBox["a2", "-"], ",", "..."}], "}"}]], "Tensor"}],
       FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Tensor", "/:", 
     RowBox[{"Dt", "[", 
      RowBox[{"t_Tensor", ",", "list_List"}], "]"}], ":=", 
     RowBox[{"ExteriorD", "[", 
      RowBox[{"list", ",", "t"}], "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.605905899085953*^9, 
   3.6059059169323845`*^9}, {3.605907375690477*^9, 3.605907376732993*^9}, {
   3.6059074214866805`*^9, 3.605907435022888*^9}, {3.6059074983508615`*^9, 
   3.605907502648427*^9}, {3.6059106918570814`*^9, 3.6059107179519825`*^9}, {
   3.6059108386183357`*^9, 3.605910859590658*^9}, {3.6059116367090964`*^9, 
   3.605911650068802*^9}, {3.605911842169753*^9, 3.605911895881578*^9}, {
   3.6059120020907097`*^9, 3.605912034981715*^9}, 3.6059120952461405`*^9, {
   3.605912172252824*^9, 3.605912231088728*^9}, {3.605912379985015*^9, 
   3.6059124141760397`*^9}, {3.605912547647091*^9, 3.6059125726254745`*^9}, 
   3.605912640557518*^9, {3.6059126921018095`*^9, 3.6059126993344207`*^9}, {
   3.606149316082368*^9, 3.6061493231657734`*^9}, {3.606149361203949*^9, 
   3.6061493833582163`*^9}, {3.6061495021670113`*^9, 
   3.6061496018337126`*^9}, {3.606149696681137*^9, 3.6061496971501637`*^9}, {
   3.6061497349753275`*^9, 3.6061497839071264`*^9}, {3.606149914846616*^9, 
   3.606149946487425*^9}, {3.6061501075506372`*^9, 3.6061501127199335`*^9}, {
   3.6061502607564*^9, 3.606150297869523*^9}, {3.6061503439731603`*^9, 
   3.606150399802354*^9}, {3.606150444232895*^9, 3.6061504505792575`*^9}, {
   3.6061506412691646`*^9, 3.60615079783912*^9}, {3.60615087215137*^9, 
   3.6061509190810547`*^9}, {3.6061510026398335`*^9, 
   3.6061510695636616`*^9}, {3.6061511012804756`*^9, 
   3.6061511022065287`*^9}, {3.606151174042638*^9, 3.6061511979290037`*^9}, {
   3.606151255141276*^9, 3.6061512782155957`*^9}, {3.6061517274972935`*^9, 
   3.606151749276539*^9}, {3.6061517850545855`*^9, 3.606151830330175*^9}, {
   3.606152246977006*^9, 3.6061522732695093`*^9}, 3.6061523568362894`*^9, {
   3.6061619084720783`*^9, 3.6061619096576805`*^9}, {3.606163263240858*^9, 
   3.606163263958459*^9}, {3.606163314471348*^9, 3.6061633160781507`*^9}, {
   3.606163378774661*^9, 3.606163413422322*^9}, 3.6061634632956095`*^9, {
   3.6061634941836634`*^9, 3.6061634946204643`*^9}, {3.6061635412957463`*^9, 
   3.6061636943476152`*^9}, {3.606163895151168*^9, 3.606163937037242*^9}, {
   3.6061640041329594`*^9, 3.606164018765785*^9}, {3.6061643337615385`*^9, 
   3.606164422744095*^9}, {3.6061645384026976`*^9, 3.6061645529731236`*^9}, {
   3.6061654490542974`*^9, 3.6061654690691323`*^9}, {3.6061656900123205`*^9, 
   3.6061657122579594`*^9}, {3.6061657561408367`*^9, 3.606165776280472*^9}, {
   3.6061659695336113`*^9, 3.6061659923564515`*^9}, {3.606166075114597*^9, 
   3.606166187918395*^9}, {3.6061662676657352`*^9, 3.6061662925945787`*^9}, {
   3.606166335837855*^9, 3.6061664592808714`*^9}, {3.6061665321329994`*^9, 
   3.6061665641286554`*^9}, {3.6061666252651634`*^9, 3.606166626559965*^9}, {
   3.6063210736379833`*^9, 3.6063210791355677`*^9}, 3.6063211492396445`*^9, {
   3.6063214202253075`*^9, 3.6063214618209467`*^9}, {3.606321625917968*^9, 
   3.6063216294880223`*^9}, {3.606321667340104*^9, 3.6063217452043004`*^9}, {
   3.6063218135733504`*^9, 3.6063218276655664`*^9}, {3.6063219714327755`*^9, 
   3.6063219994062057`*^9}, {3.606322158748153*^9, 3.6063222015913115`*^9}, {
   3.6063222598307066`*^9, 3.6063223402784424`*^9}, 3.606322462443319*^9, {
   3.6063226653409357`*^9, 3.6063227108891354`*^9}, {3.6063228320104966`*^9, 
   3.606322832784009*^9}, {3.6063229617499895`*^9, 3.606322969966116*^9}, {
   3.6063230880534306`*^9, 3.60632308867344*^9}, {3.606323326792098*^9, 
   3.606323351907984*^9}, {3.6063241585333757`*^9, 3.606324176213147*^9}, {
   3.6063242390986137`*^9, 3.606324282976787*^9}, {3.6063252896207523`*^9, 
   3.606325335455456*^9}, {3.606325382408677*^9, 3.6063254796761713`*^9}, 
   3.6063255205958004`*^9, {3.6063256422796693`*^9, 3.6063256443697014`*^9}, {
   3.6063257654995623`*^9, 3.6063257718131595`*^9}, {3.6063259134153347`*^9, 
   3.6063259413512635`*^9}, {3.6063641741698074`*^9, 3.606364192141835*^9}, {
   3.6063962921905727`*^9, 3.606396292923774*^9}, {3.606397566017028*^9, 
   3.606397636689613*^9}, {3.6063987641059313`*^9, 3.6063987870742846`*^9}, {
   3.6063993176404343`*^9, 3.6063993563175287`*^9}, 3.606399599800769*^9, {
   3.6063996475075016`*^9, 3.6063996743244133`*^9}, {3.606400359189934*^9, 
   3.606400359405937*^9}, {3.6064147318617353`*^9, 3.606414780243503*^9}, {
   3.606414942771799*^9, 3.606414968356262*^9}, {3.606415002285203*^9, 
   3.6064150066924553`*^9}, {3.606415050503961*^9, 3.6064150561282825`*^9}, {
   3.60641510398302*^9, 3.606415107171202*^9}, {3.606415149653632*^9, 
   3.606415271963628*^9}, {3.606415318698301*^9, 3.6064153496960735`*^9}, {
   3.606415439297199*^9, 3.6064154439654655`*^9}, {3.6064155734418716`*^9, 
   3.606415614767235*^9}, {3.606416011403921*^9, 3.6064160367773724`*^9}, {
   3.6064160876492825`*^9, 3.606416106172342*^9}, {3.6064161413863564`*^9, 
   3.606416153926073*^9}, {3.606416201531796*^9, 3.6064162124114184`*^9}, {
   3.6064164226034403`*^9, 3.6064164262046466`*^9}, {3.606416461872687*^9, 
   3.606416519591988*^9}, {3.606416656556822*^9, 3.6064166609770746`*^9}, {
   3.6064168185180855`*^9, 3.6064168709460845`*^9}, {3.606416957848055*^9, 
   3.606416979023266*^9}, {3.6064171656359396`*^9, 3.606417188828266*^9}, {
   3.606417281174548*^9, 3.606417326051115*^9}, {3.6064173998823376`*^9, 
   3.606417433523262*^9}, {3.606417467458203*^9, 3.606417500314082*^9}, {
   3.606417563021669*^9, 3.606417603650993*^9}, {3.60641768716877*^9, 
   3.6064176935111322`*^9}, {3.6064177622060614`*^9, 
   3.6064178086767197`*^9}, {3.6064178503651037`*^9, 3.606417878485712*^9}, {
   3.6064179976875305`*^9, 3.6064180039158864`*^9}, {3.606418123197709*^9, 
   3.606418125106818*^9}, {3.6064182368102074`*^9, 3.606418260005534*^9}, {
   3.6064183038340406`*^9, 3.606418342140232*^9}, {3.606418430367278*^9, 
   3.6064184936949005`*^9}, {3.6064185644959497`*^9, 
   3.6064185666510735`*^9}, {3.606418677719426*^9, 3.606418679805545*^9}, {
   3.606436543470795*^9, 3.6064365573235874`*^9}, {3.6064365990219727`*^9, 
   3.606436622187298*^9}, {3.606436806983867*^9, 3.6064368072418823`*^9}, {
   3.6064369956476583`*^9, 3.6064369958616705`*^9}, {3.6064371207458134`*^9, 
   3.6064371247680435`*^9}, {3.606437206666728*^9, 3.606437213891141*^9}, {
   3.6064373010921288`*^9, 3.606437333845002*^9}, {3.606437504073738*^9, 
   3.606437504289751*^9}, {3.6064379454409833`*^9, 3.606437960092821*^9}, {
   3.60643800237824*^9, 3.6064380077955494`*^9}, 3.606438145670436*^9, {
   3.606438258982917*^9, 3.6064382599669733`*^9}, {3.6064386627170095`*^9, 
   3.6064386728355875`*^9}, 3.6064387767465315`*^9, {3.6064388356599007`*^9, 
   3.606438842335283*^9}, {3.606438893568213*^9, 3.6064389037777967`*^9}, {
   3.6064390608037786`*^9, 3.606439094682716*^9}, {3.60643915822235*^9, 
   3.606439168216922*^9}, {3.60643921800677*^9, 3.6064392821324377`*^9}, {
   3.6064393296501555`*^9, 3.6064393487792497`*^9}, {3.606439485563073*^9, 
   3.6064395051461935`*^9}, {3.6064399730149536`*^9, 
   3.6064399878037996`*^9}, {3.6064400590218735`*^9, 3.606440076553876*^9}, {
   3.606440176433589*^9, 3.606440197594799*^9}, {3.6064402464825954`*^9, 
   3.606440253792013*^9}, {3.606440304795931*^9, 3.6064403077140975`*^9}, {
   3.606440524532499*^9, 3.60644052752067*^9}, {3.6064406171897984`*^9, 
   3.6064406209470134`*^9}, {3.6064407805891447`*^9, 3.606440787295528*^9}, {
   3.6064408236496077`*^9, 3.606440826737784*^9}, {3.606440856834505*^9, 
   3.606440861141752*^9}, {3.606440938633184*^9, 3.6064409772093906`*^9}, {
   3.606441053326744*^9, 3.606441106262772*^9}, 3.606444049039694*^9, 
   3.6064453186513114`*^9, {3.606445356832495*^9, 3.6064453903224106`*^9}, {
   3.6064460612407846`*^9, 3.606446065857049*^9}, {3.6064472620654683`*^9, 
   3.6064472653066535`*^9}, {3.6064473773500624`*^9, 3.60644741524823*^9}, {
   3.6064479502198286`*^9, 3.606447954931098*^9}, {3.6064484225688453`*^9, 
   3.606448439300802*^9}, {3.6064485513762126`*^9, 3.6064485981438875`*^9}, {
   3.6064491456562033`*^9, 3.606449146282239*^9}, {3.6064500206902523`*^9, 
   3.6064500424354963`*^9}, {3.6064501861307154`*^9, 
   3.6064502041757474`*^9}, {3.6064503561234384`*^9, 3.606450386525177*^9}, {
   3.606450434761936*^9, 3.606450439513208*^9}, {3.606451475026436*^9, 
   3.6064514993578277`*^9}, {3.6064516406889114`*^9, 3.606451641669967*^9}, {
   3.606451678449071*^9, 3.6064516793211207`*^9}, {3.6064517315281067`*^9, 
   3.606451759627714*^9}, {3.606451796842843*^9, 3.6064518143328433`*^9}, {
   3.6064519192058415`*^9, 3.6064519258752227`*^9}, {3.606452216699857*^9, 
   3.6064522186629696`*^9}, {3.6064522760802536`*^9, 
   3.6064522873698993`*^9}, {3.6064970666377306`*^9, 3.606497093791284*^9}, {
   3.6065038281633205`*^9, 3.606503840282014*^9}, 3.6065039166513815`*^9, {
   3.6065040202203054`*^9, 3.6065040491359596`*^9}, {3.6065040977297387`*^9, 
   3.606504108380348*^9}, {3.606504661197423*^9, 3.6065046902290745`*^9}, {
   3.6065048228917074`*^9, 3.6065048766026015`*^9}, {3.6065051618482494`*^9, 
   3.6065051665282574`*^9}, {3.6065053048849*^9, 3.6065053281289415`*^9}, {
   3.6065053664738083`*^9, 3.606505366676609*^9}, {3.6065058994799447`*^9, 
   3.606505899916745*^9}, {3.6065060448254004`*^9, 3.6065060450282*^9}, {
   3.606507180334243*^9, 3.606507190269811*^9}, {3.606507227590946*^9, 
   3.606507233061259*^9}, {3.6065075649162397`*^9, 3.60650759935421*^9}, {
   3.6065118524739714`*^9, 3.606511873380167*^9}, {3.6065119107953067`*^9, 
   3.60651192204195*^9}, {3.6065119620362377`*^9, 3.606512020667591*^9}, {
   3.6065120648481183`*^9, 3.6065120652151394`*^9}, {3.606512300743611*^9, 
   3.6065123180115986`*^9}, {3.606513025830083*^9, 3.60651306913056*^9}, {
   3.6065131466389933`*^9, 3.60651315585252*^9}, 3.606514109189048*^9, {
   3.6065143855958576`*^9, 3.6065143962424664`*^9}, {3.6065144404339943`*^9, 
   3.606514443546172*^9}, {3.606514516508345*^9, 3.606514606479491*^9}, {
   3.606514642402546*^9, 3.606514647298826*^9}, {3.60657601305414*^9, 
   3.606576025845872*^9}, {3.6294885962975087`*^9, 3.6294885968975096`*^9}, {
   3.6294887670077477`*^9, 3.6294887811277676`*^9}, 3.629488946017998*^9, 
   3.6294889762180405`*^9, {3.6296799808714633`*^9, 3.6296800186377373`*^9}, {
   3.6296800765780973`*^9, 3.6296800878709183`*^9}, {3.6296851347661448`*^9, 
   3.6296851379193497`*^9}, {3.629685349895347*^9, 3.6296853630081725`*^9}, {
   3.629687834535861*^9, 3.6296878493575363`*^9}, {3.629687948266225*^9, 
   3.629687974576489*^9}, {3.629688037883552*^9, 3.629688063712802*^9}, {
   3.6296883160957127`*^9, 3.629688343615058*^9}, {3.629688397209632*^9, 
   3.629688550367888*^9}, {3.6296886595640845`*^9, 3.6296887226079693`*^9}, {
   3.6296888438827596`*^9, 3.629688845144821*^9}, {3.6296892354808598`*^9, 
   3.629689305209598*^9}, {3.629689337167848*^9, 3.629689419362879*^9}, {
   3.6296919656916075`*^9, 3.6296919761680284`*^9}, {3.629693840199733*^9, 
   3.629693883066039*^9}, {3.629694123954773*^9, 3.629694194523058*^9}, {
   3.6296947833640385`*^9, 3.629694888216888*^9}, {3.629694974957252*^9, 
   3.6296949794912605`*^9}, {3.629695016853715*^9, 3.629695019568119*^9}, {
   3.629695068915369*^9, 3.629695070147771*^9}, {3.629695109662041*^9, 
   3.629695114045649*^9}, {3.629695201142003*^9, 3.629695257094702*^9}, {
   3.62969537974232*^9, 3.6296954018213587`*^9}, {3.629696180423136*^9, 
   3.6296961858685455`*^9}, {3.6296963162037787`*^9, 3.629696339169019*^9}, {
   3.629696377961688*^9, 3.6296963834996977`*^9}, {3.6296965025197077`*^9, 
   3.6296965251135483`*^9}, {3.629696620824117*^9, 3.629696632212137*^9}, {
   3.629696802275838*^9, 3.6296968542465296`*^9}, {3.629696951030902*^9, 
   3.6296970408562603`*^9}, {3.6296971532200594`*^9, 
   3.6296971742090964`*^9}, {3.6296972117497625`*^9, 
   3.6296972119681635`*^9}, {3.6296983718489113`*^9, 3.629698430922616*^9}, {
   3.6297274409048233`*^9, 3.629727464498066*^9}, {3.629727549906616*^9, 
   3.629727575325061*^9}, {3.6298456915444603`*^9, 3.629845701823281*^9}, {
   3.6298466291949453`*^9, 3.629846666829425*^9}, {3.6298469219078183`*^9, 
   3.629846938961754*^9}, {3.6298479732442703`*^9, 3.629847981134386*^9}, {
   3.6298483244007435`*^9, 3.6298483318414574`*^9}, {3.6298495776124363`*^9, 
   3.6298496207215223`*^9}, {3.6298535794568644`*^9, 
   3.6298536651670313`*^9}, {3.6298565207288785`*^9, 3.629856553513338*^9}, {
   3.629856638479088*^9, 3.629856659976926*^9}, {3.629857007221711*^9, 
   3.629857185623915*^9}, {3.629857221652976*^9, 3.6298572354907675`*^9}, {
   3.6298578357671013`*^9, 3.629857837127179*^9}, {3.6298579337247043`*^9, 
   3.6298579347447624`*^9}, {3.6298583272482123`*^9, 3.629858336241727*^9}, {
   3.62985863141861*^9, 3.629858633529731*^9}, {3.6298587849903936`*^9, 
   3.629858787928562*^9}, {3.6298588330311413`*^9, 3.629858860998741*^9}, {
   3.6298589360020313`*^9, 3.6298589428714237`*^9}, {3.629858986492919*^9, 
   3.6298589905491514`*^9}, 3.6298590768890896`*^9, {3.6298591288600616`*^9, 
   3.629859140505728*^9}, {3.6298591782148848`*^9, 3.6298591787819176`*^9}, {
   3.6298602983039503`*^9, 3.6298603530510817`*^9}, {3.6298662871976805`*^9, 
   3.6298662977812347`*^9}, {3.6298663995469913`*^9, 
   3.6298664025379076`*^9}, {3.629867805946912*^9, 3.629867863096182*^9}, {
   3.629867907431799*^9, 3.6298679076657996`*^9}, {3.629867938097679*^9, 
   3.629867942122688*^9}, {3.629909176889841*^9, 3.6299091975004773`*^9}, 
   3.629913789766417*^9, {3.6299138340045967`*^9, 3.62991395336893*^9}, {
   3.6299140417827883`*^9, 3.62991407057073*^9}, {3.629914105261263*^9, 
   3.6299141170914445`*^9}, {3.62991463043447*^9, 3.629914631089671*^9}, {
   3.6299146885963717`*^9, 3.6299146937131815`*^9}, {3.629915088830967*^9, 
   3.6299153407597475`*^9}, {3.6299158092601366`*^9, 
   3.6299158115221405`*^9}, {3.629915927193079*^9, 3.62991594200121*^9}, {
   3.629915992793312*^9, 3.629916008839244*^9}, {3.6299175161541896`*^9, 
   3.629917520155297*^9}, {3.8352604732219753`*^9, 3.8352604820549183`*^9}, {
   3.8352605560487156`*^9, 3.8352605661361046`*^9}, {3.8352606134635315`*^9, 
   3.835260705039947*^9}, {3.835260944287466*^9, 3.835260981278107*^9}, {
   3.8352648500877113`*^9, 3.835264945400612*^9}, 3.835265138891713*^9, 
   3.835265250326704*^9, {3.8352654302317057`*^9, 3.835265468734707*^9}, {
   3.8352655060487137`*^9, 3.8352655385707192`*^9}, 3.8352655851567087`*^9, {
   3.8352656489007072`*^9, 3.8352656525567055`*^9}, {3.835265786824703*^9, 
   3.835265797340705*^9}, {3.8352658960417137`*^9, 3.835265912952714*^9}, {
   3.8358344604663134`*^9, 3.8358345415951815`*^9}, {3.835834660938274*^9, 
   3.8358346826122007`*^9}, 3.8358347516523027`*^9, {3.8358347824806023`*^9, 
   3.8358347897211666`*^9}, {3.835835027221261*^9, 3.83583504546306*^9}, 
   3.8358355241242986`*^9, {3.8358537209622617`*^9, 3.8358537218619366`*^9}, {
   3.835853860567198*^9, 3.8358538736692047`*^9}, {3.835853980327199*^9, 
   3.835854096390462*^9}, {3.835854154295315*^9, 3.8358542191043854`*^9}, 
   3.8358543188331223`*^9, 3.8358544858413568`*^9, {3.8358545448720794`*^9, 
   3.835854618507143*^9}, 3.835854670120367*^9, {3.8358550024069624`*^9, 
   3.8358550347031765`*^9}, {3.835855071842867*^9, 3.8358550737479362`*^9}, {
   3.8358554434619637`*^9, 3.835855447220962*^9}, {3.8358554908449535`*^9, 
   3.835855547995963*^9}, {3.8358555928489633`*^9, 3.8358556857759504`*^9}, 
   3.8358608694734063`*^9, {3.835861218022401*^9, 3.835861222666402*^9}, 
   3.8359204809663844`*^9, {3.835922515828598*^9, 3.8359225278335958`*^9}, {
   3.835922952245639*^9, 3.835922965302247*^9}, {3.8359229990234833`*^9, 
   3.835923000831025*^9}, {3.836445921150355*^9, 3.836445927413431*^9}, {
   3.8365264813084908`*^9, 3.836526505542826*^9}, {3.8365274865371704`*^9, 
   3.8365274874911737`*^9}, {3.8374039957093225`*^9, 3.837404033976358*^9}, {
   3.8374042086242533`*^9, 3.8374042355055265`*^9}, {3.8374043572113156`*^9, 
   3.8374043831501446`*^9}, {3.837404437456546*^9, 3.8374044624903917`*^9}, {
   3.83740449461442*^9, 3.8374045284836416`*^9}, {3.8374295136883783`*^9, 
   3.837429532989379*^9}, {3.837429592547739*^9, 3.837429623021738*^9}, {
   3.837429748577462*^9, 3.83742977871146*^9}, {3.8376093050331783`*^9, 
   3.837609322988505*^9}, {3.8376402802354355`*^9, 3.8376402992055955`*^9}, {
   3.8376420561552305`*^9, 3.837642073760215*^9}, {3.8376519822422276`*^9, 
   3.837652028610064*^9}, {3.837652062236641*^9, 3.837652085651631*^9}, {
   3.8381944240614862`*^9, 3.8381944631469693`*^9}, {3.8381945747683415`*^9, 
   3.8381945762084007`*^9}, {3.8381946413935595`*^9, 
   3.8381946436989913`*^9}, {3.838194687583386*^9, 3.838194700899796*^9}, {
   3.838194779023388*^9, 3.8381948081002626`*^9}, {3.838194905251423*^9, 
   3.838194956058038*^9}, {3.838194986065569*^9, 3.8381949953028364`*^9}, {
   3.8381950899579177`*^9, 3.8381950995470543`*^9}, {3.838195158198583*^9, 
   3.838195174793747*^9}, {3.8381952508727427`*^9, 3.8381952736796026`*^9}, {
   3.8381953500940866`*^9, 3.8381953820097623`*^9}, {3.838195468501559*^9, 
   3.8381954918887043`*^9}, {3.8381955357781076`*^9, 
   3.8381955716109304`*^9}, {3.8381956070075502`*^9, 
   3.8381956350348434`*^9}, {3.8381957049801264`*^9, 3.83819570533545*^9}, {
   3.838195738157835*^9, 3.8381957473195305`*^9}, {3.8484419076604977`*^9, 
   3.8484419087386265`*^9}, {3.848442014397646*^9, 3.8484420157414036`*^9}, {
   3.8484425911568623`*^9, 3.848442664071447*^9}, {3.8484426989018383`*^9, 
   3.84844274030744*^9}, {3.8484427917398005`*^9, 3.848442815786748*^9}, 
   3.8484434228326845`*^9, {3.848443486111277*^9, 3.84844349231441*^9}, {
   3.848443601219737*^9, 3.8484436021997232`*^9}, {3.8484534136055975`*^9, 
   3.848453424901634*^9}, {3.848453480789186*^9, 3.8484535098278446`*^9}, {
   3.848453892722439*^9, 3.848453897000801*^9}, {3.8484539628244705`*^9, 
   3.848453965025116*^9}, {3.8484543128130603`*^9, 3.848454324733714*^9}, {
   3.8484544704381456`*^9, 3.848454481537304*^9}, {3.8489649824610057`*^9, 
   3.848965039115215*^9}, {3.84896561115292*^9, 3.8489656520891953`*^9}, {
   3.8489670374554462`*^9, 3.8489670773445735`*^9}, {3.8489671325833683`*^9, 
   3.848967154719345*^9}, 3.848967250273019*^9, {3.848967300592693*^9, 
   3.8489673258721857`*^9}, {3.848972425854159*^9, 3.848972456689865*^9}, {
   3.848972787251534*^9, 3.848972796692314*^9}, {3.8489729181805964`*^9, 
   3.8489729683662124`*^9}, 3.848974080493124*^9, {3.8489741507264996`*^9, 
   3.848974163700632*^9}, {3.8489958497178555`*^9, 3.848995878812834*^9}, {
   3.848995968709449*^9, 3.848995969196148*^9}, {3.848997910887697*^9, 
   3.8489979112684593`*^9}, {3.849521715994841*^9, 3.8495217442550726`*^9}, {
   3.8495220154749055`*^9, 3.8495220279534903`*^9}, {3.8495816418626146`*^9, 
   3.849581657198245*^9}, 3.8495817911661963`*^9, 3.849581824192073*^9, {
   3.855279768745489*^9, 3.8552797859758854`*^9}, {3.8552799614545107`*^9, 
   3.855280005108652*^9}, {3.855280389021513*^9, 3.8552803984856887`*^9}, {
   3.8552804546289988`*^9, 3.85528048605374*^9}, {3.855280549156173*^9, 
   3.8552807246729054`*^9}, 3.8552807602919903`*^9, {3.8552808009510202`*^9, 
   3.855280962198807*^9}, {3.855280996585648*^9, 3.8552810116903563`*^9}, 
   3.85528105797643*^9, {3.8552811079924135`*^9, 3.855281115298916*^9}, {
   3.8552840441236677`*^9, 3.855284105257519*^9}, {3.8552844819112463`*^9, 
   3.855284680846075*^9}, {3.8552847117816424`*^9, 3.85528475782931*^9}, {
   3.8673288038893433`*^9, 3.8673288335845213`*^9}, 3.867328884886866*^9, {
   3.87325321388341*^9, 3.873253217730117*^9}, 3.8732534882187333`*^9, {
   3.8732535669776907`*^9, 3.873253595523494*^9}, {3.8732537956131973`*^9, 
   3.8732537992535644`*^9}, {3.8732538594358497`*^9, 3.873253864003264*^9}, {
   3.875245028156578*^9, 3.8752450926390014`*^9}, {3.8752451380557566`*^9, 
   3.875245139040126*^9}, {3.87575716327925*^9, 3.875757185751695*^9}, {
   3.889602304915575*^9, 3.889602307209561*^9}, {3.889602471652562*^9, 
   3.8896024819295597`*^9}, {3.889602545491559*^9, 3.8896025806145687`*^9}, {
   3.8896026822315598`*^9, 3.889602685287563*^9}, {3.889602925274559*^9, 
   3.8896029372295666`*^9}, {3.8896029722415595`*^9, 
   3.8896030509595585`*^9}, {3.889603096071562*^9, 3.889603131508566*^9}, {
   3.88960318263556*^9, 3.8896031908885593`*^9}, {3.8896032545795593`*^9, 
   3.8896033360605593`*^9}, 3.8896034326115627`*^9, {3.889603536392559*^9, 
   3.8896035478725653`*^9}, {3.8896036003465643`*^9, 3.889603615736559*^9}, {
   3.8896036497715635`*^9, 3.8896036744905653`*^9}, 3.889603834222559*^9, {
   3.8896045386975594`*^9, 3.8896045473945603`*^9}, {3.88960488093356*^9, 
   3.889604967444567*^9}, 3.8896057212865644`*^9, {3.8896063804765596`*^9, 
   3.8896063885525646`*^9}, {3.8896064205655613`*^9, 
   3.8896064522945623`*^9}, {3.8896067030025597`*^9, 3.889606734647565*^9}, {
   3.8896073546055655`*^9, 3.8896074058985596`*^9}, 3.8896075351715603`*^9, {
   3.8902697174065456`*^9, 3.890269720045919*^9}, 3.890269827315936*^9, {
   3.891403834983887*^9, 3.89140385597395*^9}, 3.891406065272501*^9, {
   3.892209882330329*^9, 3.892209922365061*^9}, {3.893157340995318*^9, 
   3.8931573422570715`*^9}, {3.8955547748879995`*^9, 
   3.8955547749090014`*^9}, {3.8955551724265757`*^9, 
   3.8955551724325724`*^9}, {3.8955556351694913`*^9, 3.895555635243953*^9}, {
   3.895555716336913*^9, 
   3.895555716344909*^9}},ExpressionUUID->"4ea885f3-5b3b-40e6-892f-\
1255f61a94e7"]
}, Closed]],

Cell[CellGroupData[{

Cell["PotentialForm", "Subsection",
 CellChangeTimes->{{3.867328216488799*^9, 
  3.867328221648931*^9}},ExpressionUUID->"ee5698d3-2006-4985-94f3-\
ce90c4ed802b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "PotentialForm"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"PotentialForm", "[", 
      RowBox[{
       RowBox[{"\[Alpha]_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], "&&"}], 
          "*)"}], 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Alpha]", "]"}]}], ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "t", ",", "rep", ",", "xup", ",", "p", ",", "\[Mu]T", 
         ",", "\[Beta]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "\[Alpha]", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", " ", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xup", "=", 
         RowBox[{"NonMetricTensor", "[", 
          RowBox[{
           RowBox[{"{", 
            SuperscriptBox[
             RowBox[{"indices", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-"], "}"}],
            ",", 
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], ",", "\"\<x\>\"", 
           ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"RankNumber", "[", "\[Alpha]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]T", "=", 
         RowBox[{"TensorsProduct", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"mx", "/.", "rep"}], ")"}]}], ")"}]}]}], ")"}], " ", 
           "xup"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"p", "===", "1"}], ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ",", 
          "True", ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "\[Mu]T", "]"}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["t", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], 
               ",", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", "-", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "\[Alpha]", "]"}]}]}], "]"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"PotentialForm", "[", 
       RowBox[{
        RowBox[{"\[Alpha]_Tensor", "/;", 
         RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}]}], ",", 
        "t_Symbol"}], "]"}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rep", ",", "xup", ",", "p", ",", "\[Mu]T", ",", "\[Beta]"}],
          "}"}], ",", 
        RowBox[{
         RowBox[{"rep", "=", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"t", " ", "#"}], ")"}], "&"}], "/@", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ")"}]}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"xup", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             SuperscriptBox[
              RowBox[{
               RowBox[{"Indices", "[", "\[Alpha]", "]"}], 
               "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-"], 
             "}"}], ",", 
            RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], ",", "\"\<x\>\"", 
            ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", 
             RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"p", "=", 
          RowBox[{"RankNumber", "[", "\[Alpha]", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Mu]T", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"\[Alpha]", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"mx", "/.", "rep"}], ")"}]}], ")"}]}]}], ")"}], " ",
             "xup"}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"p", "===", "1"}], ",", 
           RowBox[{"\[Beta]", "=", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", "}"}], ",", 
              RowBox[{"Integrate", "[", 
               RowBox[{
                RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
              "\"\<\[Beta]\>\"", ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], 
           ",", "True", ",", 
           RowBox[{"\[Beta]", "=", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "\[Mu]T", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["t", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}]}], 
              ",", "\"\<\[Beta]\>\"", ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}]}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PotentialForm", "[", 
      RowBox[{
       RowBox[{"\[Alpha]_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], "&&"}], 
          "*)"}], 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Alpha]", "]"}]}], ")"}]}], ",", 
       "t_Symbol", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "rep", ",", "xup", ",", "p", ",", "\[Mu]T", ",", 
         "\[Beta]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "\[Alpha]", "]"}], "]"}]}], ";", 
        RowBox[{"rep", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", " ", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xup", "=", 
         RowBox[{"NonMetricTensor", "[", 
          RowBox[{
           RowBox[{"{", 
            SuperscriptBox[
             RowBox[{"indices", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-"], "}"}],
            ",", 
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], ",", "\"\<x\>\"", 
           ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"RankNumber", "[", "\[Alpha]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]T", "=", 
         RowBox[{"TensorsProduct", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"mx", "/.", "rep"}], ")"}]}], ")"}]}]}], ")"}], " ", 
           "xup"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"p", "===", "1"}], ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ",", 
          "True", ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "\[Mu]T", "]"}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["t", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], 
               ",", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", "-", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "\[Alpha]", "]"}]}]}], "]"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PotentialForm", "[", 
      RowBox[{
       RowBox[{"\[Alpha]_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], "&&"}], 
          "*)"}], 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Alpha]", "]"}]}], ")"}]}], ",", 
       "Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "t", ",", "rep", ",", "xup", ",", "p", ",", "\[Mu]T", 
         ",", "\[Beta]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "\[Alpha]", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rep", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", " ", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xup", "=", 
         RowBox[{"NonMetricTensor", "[", 
          RowBox[{
           RowBox[{"{", 
            SuperscriptBox[
             RowBox[{"indices", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-"], "}"}],
            ",", 
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], ",", "\"\<x\>\"", 
           ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"RankNumber", "[", "\[Alpha]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]T", "=", 
         RowBox[{"TensorsProduct", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"mx", "/.", "rep"}], ")"}]}], ")"}]}]}], ")"}], " ", 
           "xup"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"p", "===", "1"}], ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "\[Alpha]", "]"}]}]}], "]"}]}], 
          ",", "True", ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "\[Mu]T", "]"}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["t", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], 
               ",", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", "-", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "\[Alpha]", "]"}]}]}], "]"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"PotentialForm", "[", 
      RowBox[{
       RowBox[{"\[Alpha]_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], "&&"}], 
          "*)"}], 
         RowBox[{"!", 
          RowBox[{"TestScalarTensor", "[", "\[Alpha]", "]"}]}], ")"}]}], ",", 
       "t_Symbol", ",", "Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "indices", ",", "rep", ",", "xup", ",", "p", ",", "\[Mu]T", ",", 
         "\[Beta]"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TestDifferentialForm", "[", "\[Alpha]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "\[Alpha]", "]"}], "]"}]}], ";", 
        RowBox[{"rep", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"t", " ", "#"}], ")"}], "&"}], "/@", 
             RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ")"}]}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"xup", "=", 
         RowBox[{"NonMetricTensor", "[", 
          RowBox[{
           RowBox[{"{", 
            SuperscriptBox[
             RowBox[{"indices", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "-"], "}"}],
            ",", 
           RowBox[{"Coordinates", "[", "\[Alpha]", "]"}], ",", "\"\<x\>\"", 
           ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", 
            RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"p", "=", 
         RowBox[{"RankNumber", "[", "\[Alpha]", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"\[Mu]T", "=", 
         RowBox[{"TensorsProduct", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Alpha]", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[RuleDelayed]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"mx", "/.", "rep"}], ")"}]}], ")"}]}]}], ")"}], " ", 
           "xup"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"p", "===", "1"}], ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "\[Alpha]", "]"}]}]}], "]"}]}], 
          ",", "True", ",", 
          RowBox[{"\[Beta]", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "\[Mu]T", "]"}], "]"}], ",", 
             RowBox[{"Map", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{
                   SuperscriptBox["t", 
                    RowBox[{"(", 
                    RowBox[{"p", "-", "1"}], ")"}]], " ", "#"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"t", ",", "0", ",", "1"}], "}"}]}], "]"}], "&"}], 
               ",", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "[", "\[Mu]T", "]"}], ")"}], ",", 
               RowBox[{"{", 
                RowBox[{"p", "-", "1"}], "}"}]}], "]"}], ",", 
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"Coordinates", "[", "\[Alpha]", "]"}]}], ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "\[Alpha]", "]"}]}]}], "]"}]}]}], 
         "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8273977289769225`*^9, 3.8273977812329187`*^9}, 
   3.827397822806463*^9, {3.827397968537464*^9, 3.827397997394462*^9}, {
   3.827398147233434*^9, 3.827398149618436*^9}, {3.8273981980344453`*^9, 
   3.8273982176574335`*^9}, 3.827399388146923*^9, {3.8273994610173683`*^9, 
   3.8273996208470078`*^9}, {3.8273997447970066`*^9, 
   3.8273997674971094`*^9}, {3.827399945547058*^9, 3.8274000345474024`*^9}, {
   3.8274003204670353`*^9, 3.827400320617378*^9}, {3.8274018870534353`*^9, 
   3.8274019128304358`*^9}, {3.8274020115474353`*^9, 3.827402011746435*^9}, {
   3.827402555874447*^9, 3.827402560071436*^9}, {3.827402616403505*^9, 
   3.827402721026507*^9}, {3.8274027657955055`*^9, 3.827402766018505*^9}, {
   3.827402865315505*^9, 3.8274029211545057`*^9}, {3.8274032953502235`*^9, 
   3.8274032997042713`*^9}, 3.8279123514164157`*^9, {3.8293907518052874`*^9, 
   3.829390752908742*^9}, {3.8293909656440907`*^9, 3.829390988110962*^9}, {
   3.829391266781184*^9, 3.8293912737178097`*^9}, {3.83030063830005*^9, 
   3.8303006575925713`*^9}, {3.83030120221494*^9, 3.830301223956378*^9}, {
   3.830301358484892*^9, 3.830301376862209*^9}, {3.830301444355482*^9, 
   3.8303014456592965`*^9}, {3.8364759682785816`*^9, 3.836475971171385*^9}, {
   3.838195988519491*^9, 3.838195993465493*^9}, {3.8516596540964975`*^9, 
   3.8516596578373747`*^9}, {3.8673282336289883`*^9, 3.867328265302905*^9}, {
   3.867329078652602*^9, 3.867329118152673*^9}, {3.8673304344235315`*^9, 
   3.8673305122253447`*^9}, {3.8673305651426754`*^9, 3.867330579402545*^9}, {
   3.867331136774845*^9, 3.8673311960419235`*^9}, 3.867376105145117*^9, 
   3.8673765325427847`*^9, {3.869046352160098*^9, 3.8690463962400303`*^9}, {
   3.8690465078387933`*^9, 3.8690465130491276`*^9}, 3.8690465743585825`*^9, 
   3.8691003254665437`*^9, {3.8692697717517233`*^9, 3.8692697818722167`*^9}, 
   3.887082334919702*^9, {3.8870827317341256`*^9, 3.887082735538089*^9}, {
   3.8871791365292025`*^9, 3.8871791438931603`*^9}, {3.8871791794721327`*^9, 
   3.8871792480546722`*^9}, {3.887181567450526*^9, 3.887181597414977*^9}, {
   3.8871816316367865`*^9, 3.8871816384135933`*^9}, {3.889052479686715*^9, 
   3.8890525324532824`*^9}, {3.889662518444789*^9, 3.8896625389687915`*^9}, {
   3.8914039199506598`*^9, 3.8914039366637554`*^9}, {3.8932891245473714`*^9, 
   3.8932891245503693`*^9}, {3.895073261600118*^9, 3.895073261600118*^9}, {
   3.895549051620682*^9, 3.8955490516286774`*^9}, {3.8955553399432087`*^9, 
   3.895555339946207*^9}, {3.895555635250953*^9, 3.8955556352659416`*^9}, {
   3.898392273491191*^9, 3.8983922977144566`*^9}, {3.8983923649790697`*^9, 
   3.898392417322427*^9}, {3.89839313018328*^9, 
   3.8983931332642927`*^9}},ExpressionUUID->"227748a2-679c-45f6-b405-\
0147348e80ed"]
}, Closed]],

Cell[CellGroupData[{

Cell["LeviCivita", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
   3.669439370764881*^9, 3.669439374298902*^9}, 3.887015664199131*^9, 
   3.8870157934571705`*^9},ExpressionUUID->"131904c6-bd11-4ab3-96db-\
cf9c959fa90e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "LeviCivita"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LeviCivita", "[", 
       RowBox[{"\[Nu]I__", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "space", 
          RowBox[{"(", "time", ")"}], " ", "dimensions"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"TestIndices", "/@", 
           RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "mm", ",", "\[Sigma]", ",", "si", ",", "cooo", ",", "d", ",", 
         "LeviCivitaTemp"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"cooo", "=", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"d", "=", 
         RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"mm", "=", 
         RowBox[{
          RowBox[{"Power", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
            FractionBox["1", "2"]}], "]"}], 
          RowBox[{"LeviCivitaTensor", "[", "d", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"LeviCivita", " ", 
          RowBox[{"w", "/", " ", "lower"}], " ", "indices"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"LeviCivitaTemp", "=", 
         RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"TensorName", "\[Rule]", 
            RowBox[{"OverTilde", "[", "\"\<\[Epsilon]\>\"", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox[
                RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], "&"}], "/@", 
              RowBox[{"{", "\[Nu]I", "}"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"TooltipStyle", "\[Rule]", " ", 
            RowBox[{"TooltipStyle", "[", "m", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "TensorAssumption"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TensorAssumption", "\[Rule]", " ", 
            RowBox[{"TensorAssumption", "[", "m", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "TensorOperator"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"TensorOperator", "\[Rule]", 
            RowBox[{"TensorOperator", "[", "m", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"LeviCivitaTemp", ",", 
          RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LeviCivita", "[", 
       RowBox[{"\[Nu]I__", ",", "m_Tensor", ",", "Minus"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "space", 
          RowBox[{"(", "time", ")"}], " ", "dimensions"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"TestIndices", "/@", 
           RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Nu]I", ",", "m"}], "]"}], "/.", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
        "\[RuleDelayed]", 
        RowBox[{"(", 
         RowBox[{"TensorComponents", "\[Rule]", 
          RowBox[{"-", "mx"}]}], ")"}]}]}], ")"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"LeviCivita", "[", 
        RowBox[{"\[Nu]I__", ",", "m_Tensor"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "space", 
           RowBox[{"(", "time", ")"}], " ", "dimensions"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}]}]}], ":=", 
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Sigma]1", ",", "\[Sigma]2",
           ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]", ",", 
          "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", "\[Beta]1", ",", 
          "rl", ",", "si", ",", "s1", ",", "s2", ",", "\[CapitalSigma]1", ",",
           "\[CapitalSigma]2", ",", "cooo", ",", "disp", ",", "d", ",", "cc", 
          ",", "LeviCivitaTemp", ",", "RL", ",", "gDD", ",", "gUU", ",", 
          "K\[Delta]"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"cooo", "=", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"d", "=", 
          RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"StartIndex", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"prepare", " ", "summation", " ", "indices"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"\[CapitalSigma]1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Unique", "[", "\[Sigma]1", "]"}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "d"}], "]"}]}]}], ";", 
         RowBox[{"s1", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\[CapitalSigma]1", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}], ",", "1", ",", "d"}], "}"}], "&"}], 
           "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "d"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"mm", "=", 
          RowBox[{
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
             FractionBox["1", "2"]}], "]"}], 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"Signature", "[", "\[CapitalSigma]1", "]"}], ",", 
             RowBox[{"Evaluate", "[", 
              RowBox[{"Sequence", "@@", "s1"}], "]"}]}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"disp", "=", "\"\<Volume form\>\""}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"LeviCivita", " ", 
           RowBox[{"w", "/", " ", "lower"}], " ", "indices"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"LeviCivitaTemp", "=", 
          RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"Comment", " ", "out", " ", "VolumeForm"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"TensorType", "\[Rule]", "\"\<VolumeForm\>\""}], ","}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TensorName", "\[Rule]", 
             RowBox[{"OverTilde", "[", "\"\<\[Epsilon]\>\"", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"CoordinateSystem", "\[Rule]", "cooo"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TensorComponents", "\[Rule]", "mm"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Indices", "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SubscriptBox[
                 RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], "&"}], "/@", 
               RowBox[{"{", "\[Nu]I", "}"}]}], ")"}]}]}], 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"Comment", " ", "out", " ", "VolumeForm"}]}], "*)"}], 
           RowBox[{"(*", 
            RowBox[{",", "\[IndentingNewLine]", 
             RowBox[{"TooltipDisplay", "\[Rule]", "disp"}]}], "*)"}], 
           "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"LeviCivitaTemp", ",", 
           RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, 
   3.8745461255666103`*^9, {3.8751413121043615`*^9, 3.8751413393725834`*^9}, {
   3.8757579219918475`*^9, 3.8757579296393824`*^9}, {3.876444672112932*^9, 
   3.876444676274394*^9}, {3.8764447330637302`*^9, 3.8764447358020597`*^9}, {
   3.8764449405673943`*^9, 3.8764450435342684`*^9}, {3.8764450818708706`*^9, 
   3.8764450882886586`*^9}, {3.8764451262864656`*^9, 
   3.8764451363663144`*^9}, {3.876445230399045*^9, 3.876445242317768*^9}, {
   3.8764457029553137`*^9, 3.8764457166656876`*^9}, 3.8870158128732214`*^9, {
   3.895554774930004*^9, 3.8955547749360085`*^9}, {3.8955551724375687`*^9, 
   3.8955551724435654`*^9}, {3.898644319037445*^9, 
   3.8986443330452805`*^9}},ExpressionUUID->"0ca44d64-f283-412b-b161-\
9661e40c02ea"]
}, Closed]],

Cell[CellGroupData[{

Cell["CovariantHodgeDual", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.669531774745632*^9, 
  3.669531801052672*^9}},ExpressionUUID->"b2354afd-9df5-4147-9021-\
cf009b24b203"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Implement", " ", "the", " ", "covariant", " ", "Hodge", " ", "Dual", " ", 
    "of", " ", "Tensor", " ", "\[Tau]", " ", "using", " ", "the", " ", 
    "Metric", " ", "m"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "When", " ", "#", " ", "of", " ", "Indices", " ", "of", " ", "\[Tau]", " ",
     "is", " ", "less", " ", "than", " ", "the", " ", "#", " ", "of", " ", 
    "dimensions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "CovariantHodgeDual"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "[", 
      RowBox[{"\[Nu]I___", ",", 
       RowBox[{"(", 
        RowBox[{"\[Tau]_Tensor", "|", 
         RowBox[{"(", 
          RowBox[{"\[Tau]_", "/;", 
           RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], 
        ")"}], ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "\[Tau]", "]"}], "===", "Tensor"}], ")"}], 
         ",", 
         RowBox[{
          RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", "True", ",", 
         "True"}], "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}], 
       ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "n", ",", "\[CapitalSigma]", ",", "sF", ",", "\[Sigma]", ",",
         "ii"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"RankNumber", "[", "\[Tau]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalSigma]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"(", 
             RowBox[{"d", "-", "n"}], ")"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{"\[CapitalSigma]", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "n"}], ")"}]}]], " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
             FractionBox["1", "2"]}], "]"}], " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"n", "=!=", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RaiseAllIndices", "[", 
                 RowBox[{"\[Tau]", ",", "m"}], "]"}], "//", 
                "TensorComponents"}], ")"}], "]"}], ",", 
             RowBox[{"n", "===", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Tau]", "//", "TensorComponents"}], ")"}], ",", 
               "d"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
             RowBox[{"TensorName", "[", "\[Tau]", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", " ", 
           RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"sF", ",", 
          RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"TestScalarTensor", "[", "sF", "]"}], ",", 
         RowBox[{"TensorComponents", "[", "sF", "]"}], ",", "True", ",", 
         "sF"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"CovariantHodgeDual", " ", "Check", " ", "condition"}]}], "*)"}], 
   RowBox[{"(*", 
    RowBox[{"/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"Make", " ", "sure", " ", "\[Tau]", " ", 
        RowBox[{"(", 
         RowBox[{"Which", " ", "is", " ", "LowerAllIndices", " ", "one"}], 
         ")"}], " ", "is", " ", "fully", " ", 
        RowBox[{"antisymmetric", "."}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], ")"}],
            ",", 
           RowBox[{
            RowBox[{"{", "1", "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"-", "1"}], "}"}]}]}], "]"}], ",", 
         RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "\[Tau]", "]"}], ",", 
         "True", ",", 
         RowBox[{"TestTensorIsFullyAntiSymmetric", "[", 
          RowBox[{"\[Tau]", ",", "m"}], "]"}]}], "]"}], "||", 
       RowBox[{"TestScalarTensor", "[", "\[Tau]", "]"}], "||", 
       RowBox[{"(*", 
        RowBox[{"Or", " ", "scalar", " ", "and", " ", "vector"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}], "<", "2"}], 
        ")"}], "||", 
       RowBox[{"(*", 
        RowBox[{"Or", " ", "zero", " ", "Tensor"}], "*)"}], " ", 
       RowBox[{"TensorIsZero", "[", "\[Tau]", "]"}], "||", 
       RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "[", 
      RowBox[{"\[Nu]I___", ",", 
       RowBox[{"(", 
        RowBox[{"\[Tau]_Tensor", "|", 
         RowBox[{"(", 
          RowBox[{"\[Tau]_", "/;", 
           RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], 
        ")"}], ",", "m_Tensor", ",", "Tensor"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "\[Tau]", "]"}], "===", "Tensor"}], ")"}], 
         ",", 
         RowBox[{
          RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
          RowBox[{"Coordinates", "[", "m", "]"}]}], ",", "True", ",", 
         "True"}], "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Length", "[", 
         RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}], 
       ")"}]}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "d", ",", "n", ",", "\[CapitalSigma]", ",", "sF", ",", "\[Sigma]", ",",
         "ii"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"d", "=", 
        RowBox[{"CoordinatesDimension", "[", "m", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"n", "=", 
        RowBox[{"RankNumber", "[", "\[Tau]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"\[CapitalSigma]", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          SubscriptBox[
           RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
          RowBox[{"{", 
           RowBox[{"ii", ",", "1", ",", 
            RowBox[{"(", 
             RowBox[{"d", "-", "n"}], ")"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{"\[CapitalSigma]", ",", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"-", "1"}], ")"}], 
            RowBox[{"n", " ", 
             RowBox[{"(", 
              RowBox[{"d", "-", "n"}], ")"}]}]], " ", 
           RowBox[{"Power", "[", 
            RowBox[{
             RowBox[{"Abs", "[", 
              RowBox[{"Determinant", "[", "m", "]"}], "]"}], ",", 
             FractionBox["1", "2"]}], "]"}], " ", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"n", "=!=", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"RaiseAllIndices", "[", 
                 RowBox[{"\[Tau]", ",", "m"}], "]"}], "//", 
                "TensorComponents"}], ")"}], "]"}], ",", 
             RowBox[{"n", "===", "0"}], ",", 
             RowBox[{"HodgeDual", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"\[Tau]", "//", "TensorComponents"}], ")"}], ",", 
               "d"}], "]"}]}], "]"}]}], ",", 
          RowBox[{"Row", "[", 
           RowBox[{"{", 
            RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
             RowBox[{"TensorName", "[", "\[Tau]", "]"}]}], "}"}], "]"}], ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ",", 
          RowBox[{"StartIndex", "\[Rule]", " ", 
           RowBox[{"StartIndex", "[", "m", "]"}]}], ",", 
          RowBox[{"TooltipStyle", "\[Rule]", " ", 
           RowBox[{"TooltipStyle", "[", "m", "]"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"sF", "=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{"sF", ",", 
          RowBox[{"{", "\[Nu]I", "}"}], ",", "m"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", "CovariantHodgeDual", ":", " ", 
     RowBox[{"Automatically", " ", "generate", " ", "indices"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CovariantHodgeDual", "[", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Tau]_Tensor", "|", 
         RowBox[{"(", 
          RowBox[{"\[Tau]_", "/;", 
           RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}], 
        ")"}], ",", "m_Tensor"}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "\[Tau]", "]"}], "===", "Tensor"}], ")"}], 
          ",", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ",", "True", ",", 
          "True"}], "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "m", "]"}], "]"}], ">", 
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}], ")"}]}], 
      ")"}]}], ":=", 
    RowBox[{
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Nu]", ",", "l\[Nu]I", ",", "\[Nu]Ilist", ",", "i"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"l\[Nu]I", "=", 
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
           RowBox[{"Length", "[", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"\[Nu]Ilist", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Indices", "[", "\[Tau]", "]"}], "===", 
             RowBox[{"{", "}"}]}], ")"}], ",", 
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox[
              RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}], ",", 
           "True", ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", 
                RowBox[{
                 RowBox[{"Indices", "[", "\[Tau]", "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "]"}], "===", "SuperMinus"}], ")"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"!", 
                 RowBox[{"MatchQ", "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], 
                    ")"}], ",", 
                   RowBox[{
                    RowBox[{"{", "1", "}"}], "|", 
                    RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}]}], "]"}]}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{
                   RowBox[{"Indices", "[", "\[Tau]", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "]"}], "===", "SubMinus"}], ")"}]}], ")"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"MatchQ", "[", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], 
                   ")"}], ",", 
                  RowBox[{
                   RowBox[{"{", "1", "}"}], "|", 
                   RowBox[{"{", 
                    RowBox[{"-", "1"}], "}"}]}]}], "]"}], ")"}], "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Head", "[", 
                  RowBox[{
                   RowBox[{"Indices", "[", "\[Tau]", "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "]"}], "===", "SubMinus"}], ")"}]}], ")"}], ",", 
             RowBox[{"Table", "[", 
              RowBox[{
               SuperscriptBox[
                RowBox[{"Unique", "[", "\[Nu]", "]"}], "-"], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "l\[Nu]I"}], "}"}]}], "]"}]}], 
            "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"CovariantHodgeDual", "[", 
         RowBox[{
          RowBox[{"Sequence", "@@", "\[Nu]Ilist"}], ",", "\[Tau]", ",", "m"}],
          "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{"(*", " ", 
       RowBox[{"Make", " ", "sure", " ", "\[Tau]", " ", 
        RowBox[{"(", 
         RowBox[{"Which", " ", "is", " ", "LowerAllIndices", " ", "one"}], 
         ")"}], " ", "is", " ", "fully", " ", 
        RowBox[{"antisymmetric", "."}]}], " ", "*)"}], 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"Union", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], ")"}],
            ",", 
           RowBox[{
            RowBox[{"{", "1", "}"}], "|", 
            RowBox[{"{", 
             RowBox[{"-", "1"}], "}"}]}]}], "]"}], ",", 
         RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "\[Tau]", "]"}], ",", 
         "True", ",", 
         RowBox[{"TestTensorIsFullyAntiSymmetric", "[", 
          RowBox[{"\[Tau]", ",", "m"}], "]"}]}], "]"}], "||", 
       RowBox[{"TestScalarTensor", "[", "\[Tau]", "]"}], "||", 
       RowBox[{"(*", 
        RowBox[{"Or", " ", "scalar", " ", "and", " ", "vector"}], "*)"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}], "<", "2"}], 
        ")"}], "||", 
       RowBox[{"(*", 
        RowBox[{"Or", " ", "zero", " ", "Tensor"}], "*)"}], " ", 
       RowBox[{"TensorIsZero", "[", "\[Tau]", "]"}], "||", 
       RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"CovariantHodgeDual", "[", 
       RowBox[{"\[Nu]I__", ",", "\[Tau]_Tensor", ",", "m_Tensor"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Union", "[", 
          RowBox[{"TestIndices", "/@", 
           RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
         RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "-", 
          RowBox[{"Length", "[", 
           RowBox[{"RemoveUnderBarredIndices", "[", 
            RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}], 
        ")"}]}]}], ":=", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "mm", ",", "LCT", ",", "\[Sigma]", ",", "\[Sigma]1", ",", 
            "\[Sigma]2", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", 
            "\[Beta]", ",", "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "rl", ",", "s", ",", "si", ",", "s1", ",", "s2", 
            ",", "\[CapitalSigma]", ",", "\[CapitalSigma]1", ",", 
            "\[CapitalSigma]2", ",", "cooo", ",", "disp", ",", "d", ",", "cc",
             ",", "LeviCivitaTemp", ",", "RL", ",", "gDD", ",", "gUU", ",", 
            "K\[Delta]"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"strategy", ":", " ", 
            RowBox[{
            "construct", " ", "appropriate", " ", "LeviCivita", " ", "and", 
             " ", "then", " ", "contract", " ", "it", " ", "with", " ", "the",
              " ", "Tensor", " ", "\[Tau]"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "first", " ", "construct", " ", "dummy", " ", "indices", " ", 
            "from", " ", "the", " ", "Indices", " ", "of", " ", "\[Tau]"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "remember", " ", "to", " ", "removeunderbarred", " ", "indices"}], 
           " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"\[CapitalSigma]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Unique", "[", "\[Sigma]", "]"}], "&"}], "/@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "&"}], "/@", 
               RowBox[{"RemoveUnderBarredIndices", "[", 
                RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], ")"}]}]}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Levi", "-", 
             RowBox[{
             "Civita", " ", "tensor", " ", "with", " ", "the", " ", "indices",
               " ", "\[Nu]I", " ", "appended", " ", "with", " ", "all", " ", 
              "lower", " ", "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"LCT", "=", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"LeviCivita", "[", 
                RowBox[{"\[Nu]I", ",", 
                 RowBox[{"(", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{"SubMinus", "/@", "\[CapitalSigma]"}], ")"}]}], 
                  ")"}], ",", "m"}], "]"}], "]"}], "/", 
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{"RemoveUnderBarredIndices", "[", 
                 RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}], 
               "!"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "now", " ", "tensor", " ", "it", " ", "with", " ", "\[Tau]", " ", 
             "and", " ", "then", " ", "contract"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"s", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"{", "\[Nu]I", "}"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"LCT", "=", 
              RowBox[{"TensorContract", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"LCT", ",", 
                  RowBox[{"TensorComponents", "[", 
                   RowBox[{"RaiseAllIndices", "[", 
                    RowBox[{"\[Tau]", ",", "m"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"s", "+", "si"}], ",", 
                    RowBox[{"s", "+", "si", "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}],
                    "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"si", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}], 
                   "}"}]}], "]"}]}], "]"}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"CovariantHodgeDual", " ", "for", " ", "scalar"}]}], 
            "*)"}], 
           RowBox[{"LCT", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"TestScalarTensor", "[", "\[Tau]", "]"}]}], ",", 
              RowBox[{"TensorContract", "[", 
               RowBox[{
                RowBox[{"TensorProduct", "[", 
                 RowBox[{"LCT", ",", 
                  RowBox[{"TensorComponents", "[", 
                   RowBox[{"RaiseAllIndices", "[", 
                    RowBox[{"\[Tau]", ",", "m"}], "]"}], "]"}]}], "]"}], ",", 
                RowBox[{"Table", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"s", "+", "si"}], ",", 
                    RowBox[{"s", "+", "si", "+", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}]}],
                    "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"si", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"RemoveUnderBarredIndices", "[", 
                    RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}]}], 
                   "}"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"TestScalarTensor", "[", "\[Tau]", "]"}], ",", 
              RowBox[{
               RowBox[{"TensorComponents", "[", "\[Tau]", "]"}], " ", 
               "LCT"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"\[Tau]", "/.", 
            RowBox[{"{", 
             RowBox[{"(*", " ", 
              RowBox[{"replace", " ", "name"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorName", "\[Rule]", "s1_"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorName", "\[Rule]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[FivePointedStar]\>\"", ",", "s1"}], "}"}], 
                  "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"replace", " ", "tensorcomponents"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "s2_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "LCT"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"replace", " ", "Indices"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "s2_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"{", "\[Nu]I", "}"}]}], ")"}]}]}], 
             "\[IndentingNewLine]", "}"}]}]}]}], "\[IndentingNewLine]", "]"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"CovariantHodgeDual", " ", "Check", " ", "condition"}]}], 
         "*)"}], "/;", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"Make", " ", "sure", " ", "\[Tau]", " ", 
            RowBox[{"(", 
             RowBox[{"Which", " ", "is", " ", "LowerAllIndices", " ", "one"}],
              ")"}], " ", "is", " ", "fully", " ", 
            RowBox[{"antisymmetric", "."}]}], " ", "*)"}], 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Union", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                  RowBox[{"RemoveUnderBarredIndices", "[", 
                   RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], 
                ")"}], ",", 
               RowBox[{
                RowBox[{"{", "1", "}"}], "|", 
                RowBox[{"{", 
                 RowBox[{"-", "1"}], "}"}]}]}], "]"}], ",", 
             RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "\[Tau]", "]"}], 
             ",", "True", ",", 
             RowBox[{"TestTensorIsFullyAntiSymmetric", "[", 
              RowBox[{"\[Tau]", ",", "m"}], "]"}]}], "]"}], "||", 
           RowBox[{"TestScalarTensor", "[", "\[Tau]", "]"}], "||", 
           RowBox[{"(*", 
            RowBox[{"Or", " ", "scalar", " ", "and", " ", "vector"}], "*)"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"RemoveUnderBarredIndices", "[", 
               RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}], "<", 
             "2"}], ")"}], "||", 
           RowBox[{"(*", 
            RowBox[{"Or", " ", "zero", " ", "Tensor"}], "*)"}], " ", 
           RowBox[{"TensorIsZero", "[", "\[Tau]", "]"}]}], ")"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"CovariantHodgeDual", " ", "for", " ", "scalar"}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"CovariantHodgeDual", "[", 
          RowBox[{"\[Nu]I__", ",", 
           RowBox[{"\[Tau]_", "/;", 
            RowBox[{"TestExpressionForm", "[", "\[Tau]", "]"}]}], ",", 
           "m_Tensor"}], "]"}]}]}], "/;", 
       RowBox[{
        RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"TestIndices", "/@", 
            RowBox[{"{", "\[Nu]I", "}"}]}], "]"}], "===", 
          RowBox[{"{", "True", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"{", "\[Nu]I", "}"}], "]"}], "===", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}]}]}], ":=", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Module", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
            "mm", ",", "LCT", ",", "\[Sigma]", ",", "\[Sigma]1", ",", 
             "\[Sigma]2", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", 
             "\[Beta]", ",", "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", 
             "\[Beta]1", ",", "rl", ",", "s", ",", "si", ",", "s1", ",", "s2",
              ",", "\[CapitalSigma]", ",", "\[CapitalSigma]1", ",", 
             "\[CapitalSigma]2", ",", "cooo", ",", "disp", ",", "d", ",", 
             "cc", ",", "LeviCivitaTemp", ",", "RL", ",", "gDD", ",", "gUU", 
             ",", "K\[Delta]"}], "}"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"strategy", ":", " ", 
             RowBox[{
             "construct", " ", "appropriate", " ", "LeviCivita", " ", "and", 
              " ", "then", " ", "contract", " ", "it", " ", "with", " ", 
              "the", " ", "Tensor", " ", "\[Tau]"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "first", " ", "construct", " ", "dummy", " ", "indices", " ", 
             "from", " ", "the", " ", "Indices", " ", "of", " ", "\[Tau]"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "remember", " ", "to", " ", "removeunderbarred", " ", "indices"}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "now", " ", "tensor", " ", "it", " ", "with", " ", "\[Tau]", " ", 
             "and", " ", "then", " ", "contract"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"LCT", "=", 
             RowBox[{"\[Tau]", "  ", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "[", 
                RowBox[{"LeviCivita", "[", 
                 RowBox[{"\[Nu]I", ",", "m"}], "]"}], "]"}], ")"}]}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", "\[Nu]I", "}"}], ",", "LCT", ",", 
              RowBox[{"\"\<\[FivePointedStar]\>\"", "<>", 
               RowBox[{"ToString", "[", 
                RowBox[{"\[Tau]", ",", "InputForm"}], "]"}]}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"Coordinates", "[", "m", "]"}]}]}], "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "When", " ", "#", " ", "of", " ", "Indices", " ", "of", " ", 
           "\[Tau]", " ", "equal", " ", "to", " ", "#", " ", "of", " ", 
           "dimensions"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"CovariantHodgeDual", "[", 
          RowBox[{"\[Tau]_Tensor", ",", "m_Tensor"}], "]"}]}], "/;", 
        RowBox[{
         RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Coordinates", "[", "\[Tau]", "]"}], "===", 
           RowBox[{"Coordinates", "[", "m", "]"}]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}], "===", 
           RowBox[{"Length", "[", 
            RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}]}]}], ":=", 
       RowBox[{
        RowBox[{"Module", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "mm", ",", "LCT", ",", "\[Sigma]", ",", "\[Sigma]1", ",", 
            "\[Sigma]2", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", 
            "\[Beta]", ",", "\[Mu]1", ",", "\[Nu]1", ",", "\[Alpha]1", ",", 
            "\[Beta]1", ",", "rl", ",", "s", ",", "si", ",", "s1", ",", "s2", 
            ",", "\[CapitalSigma]", ",", "\[CapitalSigma]1", ",", 
            "\[CapitalSigma]2", ",", "cooo", ",", "disp", ",", "d", ",", "cc",
             ",", "LeviCivitaTemp", ",", "RL", ",", "gDD", ",", "gUU", ",", 
            "K\[Delta]"}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", "dimension", " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"d", "=", 
            RowBox[{"Length", "[", 
             RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"strategy", ":", " ", 
             RowBox[{
             "construct", " ", "appropriate", " ", "LeviCivita", " ", "and", 
              " ", "then", " ", "contract", " ", "it", " ", "with", " ", 
              "the", " ", "Tensor", " ", "\[Tau]"}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "first", " ", "construct", " ", "dummy", " ", "indices", " ", 
             "from", " ", "the", " ", "Indices", " ", "of", " ", "\[Tau]"}], 
            " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "remember", " ", "to", " ", "removeunderbarred", " ", "indices"}],
             " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"\[CapitalSigma]", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Unique", "[", "\[Sigma]", "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "d"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"Levi", "-", 
             RowBox[{
             "Civita", " ", "tensor", " ", "with", " ", "all", " ", "lower", 
              " ", "indices"}]}], " ", "*)"}], "\[IndentingNewLine]", 
           RowBox[{"LCT", "=", 
            RowBox[{"(", 
             RowBox[{
              FractionBox["1", 
               RowBox[{"d", "!"}]], 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"LeviCivita", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"Sequence", "@@", 
                   RowBox[{"(", 
                    RowBox[{"SubMinus", "/@", "\[CapitalSigma]"}], ")"}]}], 
                  ")"}], ",", "m"}], "]"}], "]"}]}], ")"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{
            "now", " ", "tensor", " ", "it", " ", "with", " ", "\[Tau]", " ", 
             "and", " ", "then", " ", "contract"}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", 
             RowBox[{"Scalar", " ", "after", " ", "CovariantHodgeDual"}], ":",
              " ", 
             RowBox[{"display", " ", "ExpressionForm"}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"LCT", "=", 
            RowBox[{"TensorContract", "[", 
             RowBox[{
              RowBox[{"TensorProduct", "[", 
               RowBox[{"LCT", ",", 
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"RaiseAllIndices", "[", 
                  RowBox[{"\[Tau]", ",", "m"}], "]"}], "]"}]}], "]"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"si", ",", 
                  RowBox[{"d", "+", "si"}]}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"si", ",", "1", ",", "d"}], "}"}]}], "]"}]}], 
             "]"}]}]}]}], 
         RowBox[{"(*", 
          RowBox[{";", "\[IndentingNewLine]", 
           RowBox[{"\[Tau]", "/.", 
            RowBox[{"{", 
             RowBox[{"(*", " ", 
              RowBox[{"replace", " ", "name"}], " ", "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorName", "\[Rule]", "s1_"}], ")"}], 
               "\[RuleDelayed]", 
               RowBox[{"(", 
                RowBox[{"TensorName", "\[Rule]", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[FivePointedStar]\>\"", ",", "s1"}], "}"}], 
                  "]"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"replace", " ", "tensorcomponents"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "s2_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "LCT"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", " ", 
               RowBox[{"replace", " ", "Indices"}], " ", "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "s2_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", 
                 RowBox[{"{", "}"}]}], ")"}]}]}], "\[IndentingNewLine]", 
             "}"}]}]}], "*)"}], "\[IndentingNewLine]", "]"}], 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"CovariantHodgeDual", " ", "Check", " ", "condition"}]}], 
         "*)"}], "/;", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"Make", " ", "sure", " ", "\[Tau]", " ", 
           RowBox[{"(", 
            RowBox[{"Which", " ", "is", " ", "LowerAllIndices", " ", "one"}], 
            ")"}], " ", "is", " ", "fully", " ", 
           RowBox[{"antisymmetric", "."}]}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Union", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"RemoveUnderBarredIndices", "[", 
                  RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}]}], "]"}], 
               ")"}], ",", 
              RowBox[{
               RowBox[{"{", "1", "}"}], "|", 
               RowBox[{"{", 
                RowBox[{"-", "1"}], "}"}]}]}], "]"}], ",", 
            RowBox[{"TestTensorIsFullyAntiSymmetric", "[", "\[Tau]", "]"}], 
            ",", "True", ",", 
            RowBox[{"TestTensorIsFullyAntiSymmetric", "[", 
             RowBox[{"\[Tau]", ",", "m"}], "]"}]}], "]"}], "||", 
          RowBox[{"TestScalarTensor", "[", "\[Tau]", "]"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "scalar", " ", "and", " ", "vector"}], "*)"}], 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"RemoveUnderBarredIndices", "[", 
              RowBox[{"Indices", "[", "\[Tau]", "]"}], "]"}], "]"}], "<", 
            "2"}], ")"}], "||", 
          RowBox[{"(*", 
           RowBox[{"Or", " ", "zero", " ", "Tensor"}], "*)"}], " ", 
          RowBox[{"TensorIsZero", "[", "\[Tau]", "]"}]}], ")"}]}]}]}]}], 
    "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"CovariantHodgeDual", " ", "shortcut"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"\[FivePointedStar]", "[", "\[Tau]_Tensor", "]"}], ":=", 
      RowBox[{"CovariantHodgeDual", "[", 
       RowBox[{"\[Tau]", ",", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"\[Tau]", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Metric", "\[Rule]", "metric_"}], ")"}], "\[Rule]", 
            "metric"}]}], "]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], "]"}]}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, {
   3.6695318058226805`*^9, 3.669531823131707*^9}, {3.669533835456415*^9, 
   3.6695339005397296`*^9}, {3.669533936684993*^9, 3.66953396919545*^9}, {
   3.6695340091783204`*^9, 3.6695340285067544`*^9}, {3.669830741771064*^9, 
   3.6698307994651723`*^9}, {3.6698309344389105`*^9, 
   3.6698309378351173`*^9}, {3.6698314082453895`*^9, 3.669831435127659*^9}, {
   3.6698315347657585`*^9, 3.669831575556843*^9}, {3.669831730282789*^9, 
   3.6698317690588665`*^9}, {3.669831990722851*^9, 3.669831992423254*^9}, {
   3.6698321001373096`*^9, 3.6698322099587264`*^9}, {3.66983412902682*^9, 
   3.6698341325280285`*^9}, {3.669834177201524*^9, 3.669834198268363*^9}, {
   3.66983457587679*^9, 3.669834586532812*^9}, {3.669834632493704*^9, 
   3.6698346343355074`*^9}, {3.669834842715554*^9, 3.669834880242836*^9}, {
   3.669835317658337*^9, 3.669835373984644*^9}, {3.6698354575753965`*^9, 
   3.66983553262634*^9}, {3.669835615746691*^9, 3.669835678017203*^9}, {
   3.669835764929559*^9, 3.6698358033660307`*^9}, {3.6698359464610915`*^9, 
   3.6698359875119667`*^9}, {3.669836118429405*^9, 3.669836123454015*^9}, {
   3.669836320279518*^9, 3.6698363521483784`*^9}, {3.6698364154788256`*^9, 
   3.6698364507054896`*^9}, 3.6698365488940754`*^9, {3.669836759648582*^9, 
   3.6698367884898343`*^9}, 3.669836823466699*^9, {3.6698369448449173`*^9, 
   3.669837020454655*^9}, {3.669837130225453*^9, 3.669837132565457*^9}, {
   3.669837170736327*^9, 3.669837179971345*^9}, {3.6698372138856063`*^9, 
   3.669837242558258*^9}, {3.669838228307787*^9, 3.6698382743917255`*^9}, {
   3.669838321649411*^9, 3.669838363536687*^9}, {3.6698384048559656`*^9, 
   3.669838461111074*^9}, {3.669843664014793*^9, 3.66984368756914*^9}, {
   3.6698437242762394`*^9, 3.6698437454114485`*^9}, {3.669843781852533*^9, 
   3.669843785200724*^9}, {3.6698439971008444`*^9, 3.6698440027311664`*^9}, {
   3.6698447778700247`*^9, 3.669844789638446*^9}, {3.6698452379616766`*^9, 
   3.669845331539051*^9}, {3.669845374661928*^9, 3.6698453835139456`*^9}, {
   3.6698454362014413`*^9, 3.669845468101299*^9}, 3.669845516344386*^9, {
   3.669845639147397*^9, 3.6698456438294096`*^9}, 3.6698456760996675`*^9, {
   3.6698457134785357`*^9, 3.669845750385002*^9}, 3.66984578471527*^9, {
   3.6698459653337984`*^9, 3.6698459931238613`*^9}, {3.6698460608354034`*^9, 
   3.669846089172859*^9}, {3.672936639578724*^9, 3.6729366842932134`*^9}, {
   3.672936719562086*^9, 3.672936784995222*^9}, {3.82099666852608*^9, 
   3.8209967021311235`*^9}, {3.8209967381592503`*^9, 3.820996754287758*^9}, {
   3.820996980281063*^9, 3.8209970385749607`*^9}, {3.82099706905573*^9, 
   3.8209971059159937`*^9}, {3.8558267305457153`*^9, 
   3.8558267430936337`*^9}, {3.8564785758827395`*^9, 3.856478595744508*^9}, {
   3.8733429336039886`*^9, 3.8733429476352377`*^9}, {3.8733430304806547`*^9, 
   3.8733430420431623`*^9}, {3.8750898578455973`*^9, 
   3.8750898911335325`*^9}, {3.8750899996407146`*^9, 3.875090160030515*^9}, {
   3.8750902078360767`*^9, 3.87509032765077*^9}, {3.875090368047159*^9, 
   3.875090402689825*^9}, {3.8750909090960298`*^9, 3.875090916646381*^9}, {
   3.8750913086502256`*^9, 3.875091354912972*^9}, {3.8750916700618725`*^9, 
   3.8750916790143576`*^9}, {3.8750917157097626`*^9, 3.87509173604652*^9}, {
   3.8750918181189804`*^9, 3.8750918290228524`*^9}, {3.8750918672772937`*^9, 
   3.875091869855706*^9}, 3.875092035782336*^9, {3.8750976732153225`*^9, 
   3.875097674273671*^9}, {3.8750977843538675`*^9, 3.8750977942055855`*^9}, 
   3.8750978662078843`*^9, {3.875097963559353*^9, 3.875097976615369*^9}, {
   3.8750980556155033`*^9, 3.875098059121346*^9}, {3.8750980934945436`*^9, 
   3.875098095454336*^9}, {3.8750981693842716`*^9, 3.8750981771574855`*^9}, {
   3.8750986185725527`*^9, 3.8750986196468897`*^9}, {3.8750986554588394`*^9, 
   3.875098681418127*^9}, {3.875098790741496*^9, 3.8750988158741293`*^9}, 
   3.8750988555464277`*^9, {3.875098890027195*^9, 3.8750989316653605`*^9}, {
   3.8750989921378555`*^9, 3.8750990130899525`*^9}, {3.875099357331004*^9, 
   3.8750993582854176`*^9}, {3.875099590740688*^9, 3.875099611405962*^9}, 
   3.8751007033571963`*^9, 3.87510156681886*^9, 3.8752339386892943`*^9, {
   3.8752426749486947`*^9, 3.8752427092464924`*^9}, {3.875242755398812*^9, 
   3.8752427988096657`*^9}, {3.875242839673733*^9, 3.875242982199119*^9}, {
   3.875243905206646*^9, 3.8752439062222404`*^9}, {3.8752439749695187`*^9, 
   3.875244010885275*^9}, {3.8752440461125264`*^9, 3.87524404790934*^9}, 
   3.875244078184433*^9, {3.8752441119110527`*^9, 3.875244123788869*^9}, {
   3.8752441706751184`*^9, 3.8752442200602813`*^9}, {3.875244257334468*^9, 
   3.875244333388133*^9}, 3.875244587010468*^9, {3.8763633301280813`*^9, 
   3.876363360792363*^9}, {3.87636498410907*^9, 3.8763650355613704`*^9}, {
   3.876365137569307*^9, 3.87636516595022*^9}, {3.8763654477796392`*^9, 
   3.8763654732398715`*^9}, {3.8763655042678623`*^9, 3.876365514817235*^9}, {
   3.8763656982043405`*^9, 3.8763658330870194`*^9}, 3.876366154791814*^9, {
   3.876371325557494*^9, 3.876371353530436*^9}, {3.876541160097032*^9, 
   3.876541162840352*^9}, {3.8765412247734566`*^9, 3.8765412380133543`*^9}, {
   3.8765413631178026`*^9, 3.876541367678012*^9}, {3.876541401277587*^9, 
   3.876541432589427*^9}, {3.8765421866291413`*^9, 3.8765421946618524`*^9}, {
   3.876542309203165*^9, 3.8765423495723777`*^9}, {3.876542410014027*^9, 
   3.876542447821722*^9}, {3.876542489424137*^9, 3.8765424962055063`*^9}, {
   3.876542649247613*^9, 3.8765426556091404`*^9}, {3.876542693226633*^9, 
   3.8765427225787315`*^9}, 3.876542946943364*^9, {3.876972375548497*^9, 
   3.876972402459983*^9}, {3.876973744771781*^9, 3.876973749815794*^9}, 
   3.8769740250454345`*^9, 3.8769758614404745`*^9, {3.876976156465439*^9, 
   3.876976159695912*^9}, {3.876977578825599*^9, 3.876977644684276*^9}, {
   3.8769778761796427`*^9, 3.876977877153044*^9}, 3.876978019278208*^9, {
   3.8781707400509567`*^9, 3.878170754630989*^9}, {3.884775005912468*^9, 
   3.8847750324214735`*^9}, {3.8896624402277856`*^9, 
   3.8896624691057873`*^9}, {3.893289124590345*^9, 3.8932891246283226`*^9}, {
   3.8955547749750104`*^9, 3.8955547749930162`*^9}, {3.8955551724525614`*^9, 
   3.895555172474547*^9}, {3.895555339966194*^9, 3.895555340016163*^9}, {
   3.895555776195301*^9, 3.8955557872407255`*^9}, {3.8955558384934144`*^9, 
   3.895555838522397*^9}, 3.8977358917865224`*^9, 3.8983978026564016`*^9, {
   3.8983980162605467`*^9, 3.8983980407681103`*^9}, {3.8983980832369213`*^9, 
   3.8983980847889647`*^9}, {3.8988306197814336`*^9, 
   3.8988306265370913`*^9}, {3.8988306607013493`*^9, 
   3.8988306620098305`*^9}},ExpressionUUID->"77ee29de-9d0f-4973-bc71-\
a9732e80b77a"]
}, Closed]],

Cell[CellGroupData[{

Cell["LieDerivative", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
  3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
  3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
  3.7277792645777283`*^9}, {3.891519169148469*^9, 
  3.8915191708686686`*^9}},ExpressionUUID->"516e681d-1beb-42c7-806f-\
b844a71db486"],

Cell[TextData[{
 "LieDerivative takes the Lie Derivative of a tensor along a vector field \
\[Xi].\nRight now, it only takes the Lie Derivative of a metric: ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Subscript", "[", 
       RowBox[{"\[Sterling]", ",", " ", "\[Xi]"}], "]"}], " ", "g"}], ")"}], 
    "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "91c6fbcd-3c4e-46fd-833c-7ebfdca2d780"]
}], "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 3.7181753757743816`*^9}, {
  3.727779196807187*^9, 3.7277792331568756`*^9}, {3.727779273802723*^9, 
  3.727779325513347*^9}, {3.727787561066987*^9, 3.7277875629627943`*^9}, {
  3.7277878087273006`*^9, 3.727787832905507*^9}, {3.727787941322445*^9, 
  3.7277879597307673`*^9}},ExpressionUUID->"393f2f94-1803-4e23-b0dd-\
9cd1deb87029"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]_Tensor", ",", "m_Tensor", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"LieDerivative", " ", "OptionValue"}]}], "*)"}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Quiet", "[", 
        RowBox[{"TestMetricTensor", "[", "m", "]"}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"TensorComponents", "[", "\[Xi]", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "\[Xi]", "]"}], "]"}], "}"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StartIndex", "[", "\[Xi]", "]"}], "===", 
         RowBox[{"StartIndex", "[", "m", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
         "either", " ", "both", " ", "upper", " ", "or", " ", "lower", " ", 
          "indices"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "m", "]"}]}], ")"}]}], "===", "1"}], 
        ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"LieDerivative", " ", "Check", " ", "Vector"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "TestOneVector"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"TestOneVector", "[", "\[Xi]", "]"}], 
        RowBox[{"(*", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Indices", "[", "\[Xi]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}], "*)"}], 
        ")"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "Vec", ",", "\[Alpha]", ",", "\[Mu]", ",", "\[Nu]", ",", "pd\[Xi]", 
        ",", "pdg", ",", "g\[Mu]\[Nu]", ",", "g\[Mu]\[Nu]T", ",", "L1", ",", 
        "L2", ",", "temp", ",", "idxl"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "make", " ", "sure", " ", "we", " ", "have", " ", "a", " ", "vector"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Vec", "=", 
        RowBox[{"RaiseAllIndices", "[", 
         RowBox[{"\[Xi]", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "make", " ", "sure", " ", "we", " ", "lowered", " ", "the", " ", 
         "indices", " ", "on", " ", "g"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"g\[Mu]\[Nu]", "=", 
        RowBox[{"Metric", "[", 
         RowBox[{
          SubscriptBox["\[Mu]", "-"], ",", 
          SubscriptBox["\[Nu]", "-"], ",", "m"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"g\[Mu]\[Nu]T", "=", 
        RowBox[{"TensorComponents", "[", "g\[Mu]\[Nu]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Construct", " ", "Partial", " ", "Derivative", " ", "of", " ", 
         "\[Xi]"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pd\[Xi]", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"PartialD", "[", 
          RowBox[{
           SubscriptBox["\[Mu]", "-"], ",", "Vec", ",", "m"}], "]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Construct", " ", "Partial", " ", "Derivative", " ", "of", " ", 
         SubscriptBox["g", "\[Mu]\[Nu]"]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"pdg", "=", 
        RowBox[{"TensorComponents", "[", 
         RowBox[{"PartialD", "[", 
          RowBox[{
           SubscriptBox["\[Alpha]", "-"], ",", "g\[Mu]\[Nu]", ",", "m"}], 
          "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         SuperscriptBox["\[Xi]", "\[Sigma]"], 
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Sigma]"], 
          SubscriptBox["g", "\[Mu]\[Nu]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"L1", "=", 
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "Vec", "]"}], ",", "pdg"}], 
           "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", 
           RowBox[{"{", "\[Mu]"}]], 
          SuperscriptBox["\[Xi]", "\[Sigma]"]}], 
         SubscriptBox["g", 
          RowBox[{
           RowBox[{"\[Nu]", "}"}], "\[Sigma]"}]]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"L2", "=", 
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{"pd\[Xi]", ",", "g\[Mu]\[Nu]T"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"2", ",", "4"}], "}"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"...", " ", "remember", " ", "to", " ", "symmetrize"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"L2", "=", 
        RowBox[{
         RowBox[{"Transpose", "[", "L2", "]"}], "+", "L2"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"temp", "=", 
          RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"TensorType", "\[Rule]", "\"\<LieDerivative\>\""}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TensorName", "\[Rule]", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<\[Sterling]\>\"", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"Null", ",", 
                   RowBox[{"TensorName", "[", "\[Xi]", "]"}]}], "}"}], "]"}], 
                ",", 
                RowBox[{"TensorName", "[", "m", "]"}]}], "}"}], "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"Indices", "\[Rule]", 
             RowBox[{"Indices", "[", "g\[Mu]\[Nu]", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"StartIndex", "\[Rule]", 
             RowBox[{"StartIndex", "[", "\[Xi]", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"CoordinateSystem", "\[Rule]", 
             RowBox[{"Coordinates", "[", "\[Xi]", "]"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"TensorComponents", "\[Rule]", 
             RowBox[{"(*", 
              RowBox[{"NewCode", ":", " ", 
               RowBox[{"LieDerivative", " ", "OptionValue"}]}], "*)"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"L1", "+", "L2"}], ")"}], "//", 
               RowBox[{"OptionValue", "[", "LieDerivativeOperator", "]"}]}], 
              ")"}]}]}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"LieDerivative", " ", "Inherit"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"temp", "=", 
        RowBox[{"m", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Sterling]\>\"", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{"Null", ",", 
                    RowBox[{"TensorName", "[", "\[Xi]", "]"}]}], "}"}], "]"}],
                  ",", 
                 RowBox[{"TensorName", "[", "m", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "\"\<LieDerivative\>\""}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"L1", "+", "L2"}], ")"}], "//", 
                RowBox[{"OptionValue", "[", "LieDerivativeOperator", "]"}]}], 
               ")"}]}], ")"}]}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ")"}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ")"}]}]}],
            "*)"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ")"}], ",", 
         RowBox[{"temp", "=", 
          RowBox[{"TooltipDisplay", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"temp", "=", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", 
         RowBox[{"LieDerivative", " ", "NewIndices"}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "Indices", "]"}], "=!=", "Null"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
               RowBox[{"Indices", "[", "m", "]"}]}], ")"}]}], ")"}]}], ")"}], 
         ",", 
         RowBox[{"temp", "=", 
          RowBox[{"MoveIndices", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"OptionValue", "[", "Indices", "]"}], ",", "m"}], "]"}]}],
          ",", "True", ",", 
         RowBox[{"temp", "=", 
          RowBox[{"MoveIndices", "[", 
           RowBox[{"temp", ",", 
            RowBox[{"Indices", "[", "m", "]"}], ",", "m"}], "]"}]}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox[
     RowBox[{"LieDerivative", " ", "on", " ", "General", " ", "Tensor"}],
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", "t_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"Quiet", "[", 
         RowBox[{"TestMetricTensor", "[", "t", "]"}], "]"}]}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "t", "]"}], "]"}], "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"StartIndex", "[", "\[Xi]1", "]"}], "===", 
         RowBox[{"StartIndex", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{
            "We", " ", "have", " ", "already", " ", "cover", " ", "the", " ", 
             "Metric", " ", "one", " ", "and", " ", "Christoffel", " ", "is", 
             " ", "not", " ", "a", " ", 
             RowBox[{"Tensor", ".", " ", "Check"}], " ", "if", " ", "t", " ", 
             "is", " ", 
             StyleBox["not",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["\"\<Metric\>\"",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["or",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             RowBox[{
              StyleBox["\"\<ChristoffelSymbols\>\"",
               FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
           RowBox[{"(", 
            RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
            ")"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Since", " ", "user", " ", 
          RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", 
          "metric"}], ",", " ", 
         RowBox[{
         "we", " ", "only", " ", "allow", " ", "them", " ", "to", " ", "be", 
          " ", "vector", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"w", "/", " ", 
              StyleBox["upper",
               FontColor->RGBColor[1, 0, 1]]}], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["index",
              FontColor->RGBColor[1, 0, 1]]}], ")"}], "."}]}]}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"TestOneVector", "[", "\[Xi]1", "]"}], ")"}]}], ")"}]}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "\[Xi]", ",", "name", ",", "cs", ",", "si", ",", "indices", ",", 
        "rank", ",", "pdT", ",", "\[Sigma]", ",", "pd\[Xi]\[Sigma]down", ",", 
        "pd\[Xi]\[Sigma]up", ",", "Tpd\[Xi]\[Sigma]down", ",", 
        "Tpd\[Xi]\[Sigma]up", ",", "LieDT", ",", "tempT", ",", "i", ",", 
        "\[Gamma]", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Extract", " ", "the", " ", 
        StyleBox["TensorName",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"name", "=", 
        RowBox[{"TensorName", "[", "\[Xi]1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["Coordinates",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"cs", "=", 
        RowBox[{"Coordinates", "[", "\[Xi]1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["StartIndex",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "\[Xi]1", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "Declare", " ", "a", " ", "function", " ", "we", " ", "can", " ", 
         "change", " ", "the", " ", "name", " ", "of", " ", "Killing", " ", 
         RowBox[{"vector", "'"}], "s", " ", 
         RowBox[{"index", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Xi]", "[", "\[Gamma]_", "]"}], ":=", 
        RowBox[{"NonMetricTensor", "[", 
         RowBox[{
          RowBox[{"{", "\[Gamma]", "}"}], ",", 
          RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], ",", "name", ",", 
          RowBox[{"CoordinateSystem", "\[Rule]", "cs"}], ",", 
          RowBox[{"StartIndex", "\[Rule]", "si"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Extract", " ", "the", " ", 
         StyleBox["Indices",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["list",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["of",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[" ",
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox["t",
          FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"indices", "=", 
        RowBox[{"Indices", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox["RankNumber",
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"rank", "=", 
        RowBox[{"RankNumber", "[", "t", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         FormBox[
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Sigma]"], 
           SubscriptBox[
            SuperscriptBox["T", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Mu]", "1"], "..."}], 
              SubscriptBox["\[Mu]", "N"]}]], 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Nu]", "1"], "..."}], 
             SubscriptBox["\[Nu]", "M"]}]]}],
          TraditionalForm],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pdT", "=", 
        RowBox[{"PartialD", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "-"], ",", "t"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Sigma]"], 
          SuperscriptBox["\[Xi]", "\[Gamma]"]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pd\[Xi]\[Sigma]down", "=", 
        RowBox[{"PartialD", "[", 
         RowBox[{
          SubscriptBox["\[Sigma]", "-"], ",", 
          RowBox[{"\[Xi]", "[", 
           SuperscriptBox["\[Gamma]", "-"], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox["\[PartialD]", "\[Gamma]"], 
          SuperscriptBox["\[Xi]", "\[Sigma]"]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"pd\[Xi]\[Sigma]up", "=", 
        RowBox[{"PartialD", "[", 
         RowBox[{
          SubscriptBox["\[Gamma]", "-"], ",", 
          RowBox[{"\[Xi]", "[", 
           SuperscriptBox["\[Sigma]", "-"], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox[
           SuperscriptBox["T", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Mu]", "1"], "..."}], 
             SubscriptBox["\[Mu]", "N"]}]], 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "1"], "..."}], 
            SubscriptBox["\[Nu]", "M"]}]], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Sigma]"], 
           SuperscriptBox["\[Xi]", "\[Gamma]"]}]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tpd\[Xi]\[Sigma]down", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", "pd\[Xi]\[Sigma]down"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        StyleBox[
         RowBox[{
          SubscriptBox[
           SuperscriptBox["T", 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Mu]", "1"], "..."}], 
             SubscriptBox["\[Mu]", "N"]}]], 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Nu]", "1"], "..."}], 
            SubscriptBox["\[Nu]", "M"]}]], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Gamma]"], 
           SuperscriptBox["\[Xi]", "\[Sigma]"]}]}],
         FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Tpd\[Xi]\[Sigma]up", "=", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{"{", 
          RowBox[{"t", ",", "pd\[Xi]\[Sigma]up"}], "}"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Sum", " ", "the", " ", 
         StyleBox[
          SuperscriptBox["\[Xi]", "\[Sigma]"],
          FontColor->RGBColor[1, 0, 1]], 
         StyleBox[
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Sigma]"], 
           SubscriptBox[
            SuperscriptBox["T", 
             RowBox[{
              RowBox[{
               SubscriptBox["\[Mu]", "1"], "..."}], 
              SubscriptBox["\[Mu]", "N"]}]], 
            RowBox[{
             RowBox[{
              SubscriptBox["\[Nu]", "1"], "..."}], 
             SubscriptBox["\[Nu]", "M"]}]]}],
          FontColor->RGBColor[1, 0, 1]], " ", 
         RowBox[{"first", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"LieDT", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TensorsProduct", "[", 
           RowBox[{
            RowBox[{"\[Xi]", "[", 
             SuperscriptBox["\[Sigma]", "-"], "]"}], " ", "pdT"}], "]"}], "//",
           "TensorComponents"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Sum", " ", "the", " ", "rest", " ", "of", " ", 
         RowBox[{"terms", "."}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"Which", "[", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"If", " ", "i"}], "-", 
            RowBox[{
            "th", " ", "index", " ", "of", " ", "\"\<T's\>\"", " ", "indices",
              " ", "list", " ", "is", " ", "an", " ", 
             StyleBox["upper",
              FontColor->RGBColor[1, 0, 1]], " ", 
             RowBox[{"index", "."}]}]}], "*)"}], 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", 
             RowBox[{
             "indices", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"replace", " ", "the", " ", "i"}], "-", 
             RowBox[{"th", " ", "index", " ", 
              RowBox[{"w", "/", " ", "\[Sigma]"}], " ", "and", " ", "replace",
               " ", "\[Gamma]", " ", 
              RowBox[{"w", "/", "the"}], " ", "i"}], "-", 
             RowBox[{"th", " ", "index"}]}], "*)"}], 
           RowBox[{
            RowBox[{"tempT", "=", 
             RowBox[{"Tpd\[Xi]\[Sigma]down", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
                 "\[Rule]", "\[Sigma]"}], ",", 
                RowBox[{"\[Gamma]", "\[Rule]", 
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{
              "Since", " ", "we", " ", "will", " ", "operate", " ", 
               "TensorComponents", " ", "at", " ", "the", " ", "end"}], ",", 
              " ", 
              RowBox[{
              "we", " ", "should", " ", "make", " ", "sure", " ", "the", " ", 
               "indices", " ", "order", " ", "are", " ", "consistent", " ", 
               "for", " ", "every", " ", 
               RowBox[{"term", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"tempT", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SwapIndices", "[", 
                RowBox[{"tempT", ",", "indices"}], "]"}], "//", 
               "TensorComponents"}], ")"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"For", " ", "upper", " ", "index"}], ",", " ", 
              RowBox[{"we", " ", "should", " ", 
               StyleBox["subtract",
                FontColor->RGBColor[1, 0, 1]], " ", 
               RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"LieDT", "=", 
             RowBox[{"LieDT", "-", "tempT"}]}]}], ",", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "i"}], "-", 
             RowBox[{
             "th", " ", "index", " ", "of", " ", "\"\<T's\>\"", " ", 
              "indices", " ", "list", " ", "is", " ", "an", " ", 
              StyleBox["lower",
               FontColor->RGBColor[1, 0, 1]], " ", 
              RowBox[{"index", "."}]}]}], "*)"}], 
           RowBox[{
            RowBox[{"Sgn", "[", 
             RowBox[{
             "indices", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}], "]"}], "===", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{
            RowBox[{"tempT", "=", 
             RowBox[{"Tpd\[Xi]\[Sigma]up", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], 
                 "\[Rule]", "\[Sigma]"}], ",", 
                RowBox[{"\[Gamma]", "\[Rule]", 
                 RowBox[{"indices", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}]}], 
               "}"}]}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tempT", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"SwapIndices", "[", 
                RowBox[{"tempT", ",", "indices"}], "]"}], "//", 
               "TensorComponents"}], ")"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"For", " ", "upper", " ", "index"}], ",", " ", 
              RowBox[{"we", " ", "should", " ", "do", " ", 
               StyleBox["plus",
                FontColor->RGBColor[1, 0, 1]], 
               StyleBox[" ",
                FontColor->RGBColor[1, 0, 1]], 
               RowBox[{"w", "/", " ", 
                RowBox[{"it", "."}]}]}]}], "*)"}], 
            RowBox[{"LieDT", "=", 
             RowBox[{"LieDT", "+", "tempT"}]}]}]}], "]"}], ",", 
         RowBox[{"(*", 
          RowBox[{
          "Run", " ", "through", " ", "all", " ", "the", " ", "indices"}], 
          "*)"}], 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "rank"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Change", " ", 
           StyleBox["TensorType",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<LieDerivative\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Add", " ", "a", " ", 
            StyleBox[
             SubscriptBox[
              StyleBox["\[Sterling]",
               FontColor->RGBColor[1, 0, 1]], "\[Xi]"],
             FontColor->RGBColor[1, 0, 1]], " ", "before", " ", "the", " ", 
            "tensor", " ", 
            RowBox[{"t", ".", " ", "\[Xi]"}], " ", "here", " ", "is", " ", 
            "the", " ", "TensorName", " ", "of", " ", 
            RowBox[{"\[Xi]1", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"TensorName", "\[Rule]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<\[Sterling]\>\"", ",", 
              RowBox[{"Column", "[", 
               RowBox[{"{", 
                RowBox[{"Null", ",", 
                 RowBox[{"TensorName", "[", "\[Xi]1", "]"}]}], "}"}], "]"}], 
              ",", 
              RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Inherit", " ", "old", " ", 
             StyleBox["indices",
              FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
            RowBox[{
             StyleBox["StartIndex",
              FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
             RowBox[{
              StyleBox["CoordinateSystem",
               FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"OptionValue", "[", "Indices", "]"}], "=!=", "Null"}],
                "&&", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                   RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                   RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}]}], 
              ")"}], ",", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], ",", "True", ",", 
             "indices"}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "cs"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            StyleBox["Sum",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["up",
             FontColor->RGBColor[1, 0, 1]], " ", "all", " ", "the", " ", 
            "terms", " ", 
            RowBox[{"w", "/", " ", 
             StyleBox["TensorComponents",
              FontColor->RGBColor[1, 0, 1]]}], " ", "and", " ", "replace", 
            " ", 
            RowBox[{"w", "/", " ", "new"}], " ", 
            StyleBox["TensorComponents",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{"LieDT", "//", 
             RowBox[{"OptionValue", "[", "LieDerivativeOperator", "]"}]}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"TooltipStyle", "\[Rule]", 
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TooltipDisplay", "\[Rule]", 
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], "]"}], 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"output", "=", 
        RowBox[{"t", "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorName", "\[Rule]", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[Sterling]\>\"", ",", 
                 RowBox[{"Column", "[", 
                  RowBox[{"{", 
                   RowBox[{"Null", ",", 
                    RowBox[{"TensorName", "[", "\[Xi]1", "]"}]}], "}"}], 
                  "]"}], ",", 
                 RowBox[{"TensorName", "[", "t", "]"}]}], "}"}], "]"}]}], 
             ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorType", "\[Rule]", "\"\<LieDerivative\>\""}], 
             ")"}]}], ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"OptionValue", "[", "Indices", "]"}], "=!=", 
                   "Null"}], "&&", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
                    RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}]}], 
                 ")"}], ",", 
                RowBox[{"OptionValue", "[", "Indices", "]"}], ",", "True", 
                ",", "indices"}], "]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"TensorComponents", "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"LieDT", "//", 
                RowBox[{"OptionValue", "[", "LieDerivativeOperator", "]"}]}], 
               ")"}]}], ")"}]}]}], 
          RowBox[{"(*", 
           RowBox[{",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipDisplay", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], ")"}]}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TooltipStyle", "\[Rule]", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], ")"}]}]}],
            "*)"}], "\[IndentingNewLine]", "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ")"}], ",", 
         RowBox[{"output", "=", 
          RowBox[{"TooltipDisplay", "[", 
           RowBox[{"output", ",", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", "}"}]}], ")"}], ",", 
         RowBox[{"output", "=", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"output", ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"LieDerivative", " ", "for", " ", "ExpressionForm"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieDerivative", "[", 
     RowBox[{
      RowBox[{"\[Xi]1_Tensor", "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Dimensions", "[", 
           RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
          RowBox[{"{", 
           RowBox[{"Length", "[", 
            RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}]}], 
         ")"}], "&&", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Since", " ", "user", " ", 
           RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", 
           "metric"}], ",", " ", 
          RowBox[{
          "we", " ", "only", " ", "allow", " ", "them", " ", "to", " ", "be", 
           " ", "vector", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"w", "/", " ", 
               StyleBox["upper",
                FontColor->RGBColor[1, 0, 1]]}], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["index",
               FontColor->RGBColor[1, 0, 1]]}], ")"}], "."}]}]}], "*)"}], 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "\[Xi]1", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}]}]}], ",", 
      RowBox[{"stuff_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1", ",", 
       RowBox[{"NonMetricTensor", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", "stuff", ",", "stuff", ",", 
         RowBox[{"CoordinateSystem", "\[Rule]", 
          RowBox[{"Coordinates", "[", "\[Xi]1", "]"}]}], ",", 
         RowBox[{"StartIndex", "\[Rule]", 
          RowBox[{"StartIndex", "[", "\[Xi]1", "]"}]}]}], "]"}], ",", 
       "opts"}], "]"}], "//", "TensorComponents"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LieDerivative", "[", 
     RowBox[{
      RowBox[{"stuff1_", "/;", 
       RowBox[{"TestExpressionForm", "[", "stuff1", "]"}]}], ",", "stuff2_", 
      ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "0"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Subscript", "[", 
     RowBox[{"Global`\[Sterling]", ",", "a_Tensor"}], "]"}], "[", "b_Tensor", 
    "]"}], ":=", 
   RowBox[{"LieDerivative", "[", 
    RowBox[{"a", ",", "b"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{
      StyleBox["LieDerivative",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", 
      StyleBox["Metric",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "with", " ", 
      StyleBox["new",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox[" ",
       FontColor->RGBColor[0.5, 0, 0.5]], 
      StyleBox["indices",
       FontColor->RGBColor[0.5, 0, 0.5]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"For", " ", "metric"}], ",", 
     RowBox[{"we", " ", "allow", " ", "to", " ", 
      StyleBox["move",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox[" ",
       FontColor->RGBColor[1, 0, 1]], 
      StyleBox["indices",
       FontColor->RGBColor[1, 0, 1]], " ", "at", " ", "the", " ", "same", " ", 
      RowBox[{"time", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"LieDerivative", "[", 
       RowBox[{"(*", 
        RowBox[{"New", " ", "indices", " ", "list"}], "*)"}], 
       RowBox[{"indices_List", ",", "\[Xi]_Tensor", ",", "m_Tensor", ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"TensorComponents", "[", "\[Xi]", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "\[Xi]", "]"}], "]"}], "}"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "m", "]"}], "]"}], "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"\[Xi]", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], 
             "\[RuleDelayed]", "mmm"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"m", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], 
             "\[RuleDelayed]", "mmm"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{
         "either", " ", "both", " ", "upper", " ", "or", " ", "lower", " ", 
          "indices"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Times", "@@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "m", "]"}]}], ")"}]}], "===", "1"}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Indices", "[", "\[Xi]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "indices"}], ")"}], "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "temp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Recall", " ", "previous", " ", "code"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"temp", "=", 
         RowBox[{"LieDerivative", "[", 
          RowBox[{"\[Xi]", ",", "m", ",", "opts"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Use", " ", 
          StyleBox["MoveIndices",
           FontColor->RGBColor[1, 0, 1]], " ", "to", " ", "rename", " ", 
          "and", " ", "move", " ", "indices"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"temp", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"temp", ",", "indices", ",", "m"}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"NewCode", ":", " ", 
      RowBox[{
       StyleBox["LieDerivative",
        FontColor->RGBColor[0.5, 0, 0.5]], " ", "on", " ", 
       StyleBox["General",
        FontColor->RGBColor[0.5, 0, 0.5]], 
       StyleBox[" ",
        FontColor->RGBColor[0.5, 0, 0.5]], 
       StyleBox["Tensor",
        FontColor->RGBColor[0.5, 0, 0.5]], " ", "with", " ", 
       StyleBox["new",
        FontColor->RGBColor[0.5, 0, 0.5]], 
       StyleBox[" ",
        FontColor->RGBColor[0.5, 0, 0.5]], 
       StyleBox["indices",
        FontColor->RGBColor[0.5, 0, 0.5]]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
       RowBox[{"For", " ", 
        StyleBox["Non",
         FontColor->RGBColor[1, 0, 1]]}], 
       StyleBox["-",
        FontColor->RGBColor[1, 0, 1]], 
       StyleBox["metric",
        FontColor->RGBColor[1, 0, 1]]}], ",", 
      RowBox[{"since", " ", "user", " ", 
       RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", 
       StyleBox["metric",
        FontColor->RGBColor[1, 0, 1]]}], ",", 
      RowBox[{
       RowBox[{"we", " ", "only", " ", "allow", " ", "to", " ", 
        StyleBox["re",
         FontColor->RGBColor[1, 0, 1]]}], 
       StyleBox["-",
        FontColor->RGBColor[1, 0, 1]], 
       RowBox[{
        StyleBox["name",
         FontColor->RGBColor[1, 0, 1]], " ", "but", " ", "not", " ", "move", 
        " ", "the", " ", 
        RowBox[{"indices", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"LieDerivative", "[", 
       RowBox[{"indices_List", ",", "\[Xi]1_Tensor", ",", "t_Tensor"}], "]"}],
       "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Dimensions", "[", 
          RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}], "===", 
         RowBox[{"{", 
          RowBox[{"Length", "[", 
           RowBox[{"Coordinates", "[", "t", "]"}], "]"}], "}"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"\[Xi]1", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], 
             "\[RuleDelayed]", "mmm"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "===", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"t", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], 
             "\[RuleDelayed]", "mmm"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{"t", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
              "tt"}]}], "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
            ")"}]}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}], "&&", 
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Indices", "[", "\[Xi]1", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"SuperMinus", "[", "_", "]"}], "}"}]}], "]"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", "indices"}], ")"}], "===", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}]}]}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LieDerivative", "[", 
       RowBox[{"\[Xi]1", ",", "t"}], "]"}], "/.", 
      RowBox[{"(*", 
       RowBox[{"Re", "-", 
        RowBox[{"name", " ", 
         RowBox[{"indices", "."}]}]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
       RowBox[{"(", 
        RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", "stuff_", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ":="}], 
   "*)"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.7277838546352525`*^9, 
   3.727783858169075*^9}, {3.727787467829364*^9, 3.727787495938246*^9}, {
   3.7277875756934986`*^9, 3.7277875792397604`*^9}, {3.7277876707418776`*^9, 
   3.72778770219399*^9}, {3.7277877584258285`*^9, 3.7277877915109577`*^9}, {
   3.7277878424043903`*^9, 3.7277878811264715`*^9}, 3.7277879383036757`*^9, {
   3.727788719881564*^9, 3.7277888261798315`*^9}, {3.727788912849109*^9, 
   3.7277889371845922`*^9}, {3.7277897311974845`*^9, 3.727789744827913*^9}, {
   3.7277899581351657`*^9, 3.7277900115452623`*^9}, {3.727790077297223*^9, 
   3.727790118143917*^9}, {3.7277904370689335`*^9, 3.72779068173335*^9}, {
   3.727790720372624*^9, 3.727790938406535*^9}, {3.7277909992197423`*^9, 
   3.7277910652090855`*^9}, {3.727791099381648*^9, 3.727791151586588*^9}, {
   3.72779119753117*^9, 3.727791333775207*^9}, {3.7277913649255753`*^9, 
   3.7277913932071843`*^9}, {3.727791440834066*^9, 3.727791443680626*^9}, {
   3.7277914802625117`*^9, 3.7277914963036475`*^9}, {3.727791596706025*^9, 
   3.727791632429778*^9}, {3.727791703379794*^9, 3.7277917697057447`*^9}, {
   3.7277921266899767`*^9, 3.727792128011541*^9}, {3.727836859594427*^9, 
   3.7278369493787804`*^9}, {3.727837606489853*^9, 3.727837664283385*^9}, {
   3.8407724493806095`*^9, 3.8407724507755156`*^9}, {3.840772521269809*^9, 
   3.840772561838919*^9}, 3.8407726113251805`*^9, {3.8407728203563204`*^9, 
   3.84077282884037*^9}, 3.840843520814411*^9, {3.84084355110458*^9, 
   3.840843606524502*^9}, 3.840843761720167*^9, 3.841219815037341*^9, {
   3.8412199088308015`*^9, 3.8412199564753337`*^9}, 3.8412200195293245`*^9, {
   3.8412200801236506`*^9, 3.8412201213506517`*^9}, {3.841220183972626*^9, 
   3.8412202704844627`*^9}, 3.841220343688476*^9, {3.841220471045478*^9, 
   3.8412204903984747`*^9}, {3.841220529820326*^9, 3.841220567276322*^9}, {
   3.8412206264934783`*^9, 3.8412206932614803`*^9}, {3.841220740020477*^9, 
   3.84122080573448*^9}, {3.841220850295054*^9, 3.841220894031576*^9}, {
   3.841220976430519*^9, 3.841221021565101*^9}, {3.8412212208717117`*^9, 
   3.8412212232887144`*^9}, {3.8412213151185365`*^9, 3.841221324693531*^9}, {
   3.841221715926469*^9, 3.8412217329239254`*^9}, {3.8412218195935717`*^9, 
   3.8412218202325735`*^9}, {3.841226222717462*^9, 3.8412262692575893`*^9}, {
   3.8412263374674025`*^9, 3.8412263447273617`*^9}, {3.841226450257053*^9, 
   3.841226452257242*^9}, {3.841226547637249*^9, 3.841226551347434*^9}, {
   3.8412267888636456`*^9, 3.8412268012802477`*^9}, {3.841226840088232*^9, 
   3.8412268426033783`*^9}, {3.841374778582284*^9, 3.8413748016048827`*^9}, {
   3.8413753509883113`*^9, 3.84137537446701*^9}, {3.8413754110980825`*^9, 
   3.8413754476306753`*^9}, {3.841375509218422*^9, 3.841375509386316*^9}, {
   3.8420741494651003`*^9, 3.8420741518869762`*^9}, {3.8430836490387526`*^9, 
   3.8430836892697897`*^9}, {3.8430840639774747`*^9, 3.843084097224845*^9}, {
   3.843084254078519*^9, 3.843084260616461*^9}, {3.843086139184486*^9, 
   3.843086144770327*^9}, 3.843086184585873*^9, {3.843086217684342*^9, 
   3.843086243060648*^9}, {3.8430863073994794`*^9, 3.843086324017996*^9}, {
   3.843086532412168*^9, 3.8430867154697385`*^9}, {3.8430867910647645`*^9, 
   3.843086797299054*^9}, {3.843087303135919*^9, 3.843087311531622*^9}, {
   3.8430876200860806`*^9, 3.843087626335846*^9}, {3.8430876717690125`*^9, 
   3.843087676128538*^9}, {3.8436218755549107`*^9, 3.843621884625325*^9}, {
   3.843953052171285*^9, 3.8439531331712875`*^9}, 3.8439531721087875`*^9, {
   3.843953210718161*^9, 3.843953242780662*^9}, {3.843953634960122*^9, 
   3.8439537080877857`*^9}, {3.8439537473534126`*^9, 
   3.8439539996823697`*^9}, {3.843954491581495*^9, 3.8439544928621845`*^9}, {
   3.8439545398116083`*^9, 3.8439545756232285`*^9}, {3.8439546084683695`*^9, 
   3.843954608765242*^9}, 3.8439546695440016`*^9, {3.8442942786848307`*^9, 
   3.8442942986589727`*^9}, {3.8442946485304184`*^9, 
   3.8442946507184362`*^9}, {3.8442948322958527`*^9, 
   3.8442948760817065`*^9}, {3.85328641394878*^9, 3.8532865362047644`*^9}, {
   3.8532865748668537`*^9, 3.853286694413516*^9}, {3.853286743393367*^9, 
   3.853286749694873*^9}, 3.8532867861129436`*^9, {3.853847887666399*^9, 
   3.853847895511449*^9}, {3.8538479472965136`*^9, 3.8538479898018494`*^9}, {
   3.853848030766468*^9, 3.8538481828965836`*^9}, {3.8538482474062223`*^9, 
   3.8538483979264755`*^9}, {3.85384879156872*^9, 3.8538488519287004`*^9}, {
   3.8538492581988363`*^9, 3.8538493734266167`*^9}, {3.8538494113188033`*^9, 
   3.8538494194888043`*^9}, {3.8538494615583715`*^9, 
   3.8538496452858953`*^9}, {3.8538496764885683`*^9, 
   3.8538496796187243`*^9}, {3.8538817293317723`*^9, 
   3.8538817302567725`*^9}, {3.8538817720547733`*^9, 3.853881804218772*^9}, {
   3.853881836292774*^9, 3.8538818993967733`*^9}, {3.8538820639457726`*^9, 
   3.853882065684772*^9}, {3.8538820985157733`*^9, 3.853882100741773*^9}, {
   3.853882140864772*^9, 3.853882144872773*^9}, {3.853970712805137*^9, 
   3.853970732138238*^9}, {3.8544129154059143`*^9, 3.8544129270583553`*^9}, {
   3.8544129963198357`*^9, 3.854413094881153*^9}, 3.8667065585405755`*^9, {
   3.8667155560354743`*^9, 3.8667155839816008`*^9}, {3.8667156231715536`*^9, 
   3.8667156242570257`*^9}, {3.8667159553250885`*^9, 3.866715968924334*^9}, {
   3.86671612478946*^9, 3.8667161259866066`*^9}, {3.866716187133911*^9, 
   3.8667162073638673`*^9}, {3.866716300228763*^9, 3.8667163365646706`*^9}, {
   3.8667163985941477`*^9, 3.866716399908143*^9}, {3.866716466572727*^9, 
   3.866716470528139*^9}, 3.866716504410533*^9, {3.8667165547048407`*^9, 
   3.866716576164322*^9}, 3.8667167314087124`*^9, {3.866717009105966*^9, 
   3.8667170223047967`*^9}, 3.866717183030675*^9, {3.8667172263819847`*^9, 
   3.8667172268975773`*^9}, {3.8667172704239807`*^9, 
   3.8667173329869967`*^9}, {3.866718656007507*^9, 3.866718679139799*^9}, {
   3.8667187176826735`*^9, 3.866718731626344*^9}, {3.866718827560895*^9, 
   3.8667189527415085`*^9}, 3.8667189838148117`*^9, {3.86671901690086*^9, 
   3.866719023981798*^9}, {3.866719064613601*^9, 3.866719065457305*^9}, {
   3.8667570290153775`*^9, 3.8667570496241226`*^9}, {3.86675712173438*^9, 
   3.8667571523418026`*^9}, {3.866771319815587*^9, 3.866771362730858*^9}, 
   3.866771483019455*^9, {3.8673139292955604`*^9, 3.8673140150998287`*^9}, {
   3.867314105599106*^9, 3.867314111348889*^9}, {3.8673141484914265`*^9, 
   3.867314155028867*^9}, {3.8673145737130547`*^9, 3.867314580540806*^9}, {
   3.8673146323803644`*^9, 3.867314706524504*^9}, {3.867315001827664*^9, 
   3.867315005587598*^9}, {3.867315061217061*^9, 3.8673151452667155`*^9}, {
   3.8673151833863354`*^9, 3.867315198296013*^9}, {3.867315275930767*^9, 
   3.867315286935861*^9}, {3.867315430442907*^9, 3.867315431247837*^9}, {
   3.8673156579963818`*^9, 3.867315698876066*^9}, {3.8673158182770147`*^9, 
   3.8673158471546636`*^9}, {3.8673158801749144`*^9, 3.8673158971210365`*^9}, 
   3.867315946916399*^9, {3.86731791029901*^9, 3.86731791062388*^9}, {
   3.8673179759683933`*^9, 3.8673179764255333`*^9}, 3.867372718912263*^9, {
   3.868529352230481*^9, 3.8685293537484713`*^9}, {3.8685294797567043`*^9, 
   3.8685294829925385`*^9}, {3.868529686646577*^9, 3.8685297026132135`*^9}, {
   3.868529737990218*^9, 3.8685298355806713`*^9}, {3.868530005093338*^9, 
   3.868530015128569*^9}, 3.868530050205814*^9, {3.868530101614198*^9, 
   3.8685301210795813`*^9}, {3.8685301641965904`*^9, 3.868530186902213*^9}, 
   3.868530229111146*^9, {3.86853027181614*^9, 3.868530302056173*^9}, 
   3.868530336445647*^9, 3.868530405649912*^9, {3.8685304435865345`*^9, 
   3.868530488395812*^9}, {3.868530577150242*^9, 3.8685305779158444`*^9}, {
   3.8685356669633317`*^9, 3.868535681781576*^9}, {3.8685357423895626`*^9, 
   3.868535763974206*^9}, 3.868537042471571*^9, {3.8685755353648205`*^9, 
   3.868575541432276*^9}, 3.86857687824716*^9, {3.8685769207889214`*^9, 
   3.868576933469455*^9}, {3.8685769868380694`*^9, 3.868577029227231*^9}, {
   3.8685770604909487`*^9, 3.8685770965591516`*^9}, {3.8685783681600904`*^9, 
   3.868578395844706*^9}, {3.8685788179449863`*^9, 3.868578853081208*^9}, {
   3.868578976975403*^9, 3.868578982270752*^9}, {3.8686020777834673`*^9, 
   3.8686021428444185`*^9}, {3.8686021903320837`*^9, 
   3.8686022142500906`*^9}, {3.8686022534652653`*^9, 3.868602254604102*^9}, {
   3.8686098373126893`*^9, 3.8686098408620358`*^9}, {3.8686115952638397`*^9, 
   3.868611611240094*^9}, {3.8691007751399565`*^9, 3.8691007766510267`*^9}, {
   3.8691755328545475`*^9, 3.869175543308442*^9}, {3.8692874025353785`*^9, 
   3.869287408255878*^9}, {3.8692874389547997`*^9, 3.8692874470488415`*^9}, {
   3.875757942517582*^9, 3.875758070239147*^9}, {3.884766776729697*^9, 
   3.8847668433293138`*^9}, {3.8848100735157237`*^9, 3.884810074532093*^9}, {
   3.8893334152283845`*^9, 3.8893336236380615`*^9}, {3.8893336838900366`*^9, 
   3.8893337733458395`*^9}, 3.889333849911951*^9, 3.8893339224133387`*^9, {
   3.8893340065579042`*^9, 3.889334022528113*^9}, {3.8896665886477823`*^9, 
   3.8896666190858235`*^9}, {3.8901927393306956`*^9, 3.890192804136893*^9}, {
   3.8901981801311736`*^9, 3.8901981821218605`*^9}, {3.8915191806843243`*^9, 
   3.891519184144026*^9}, {3.8915192220876703`*^9, 3.8915192292980275`*^9}, {
   3.8915871135033135`*^9, 3.891587141515642*^9}, {3.893209424350897*^9, 
   3.893209435677486*^9}, {3.893209471988702*^9, 3.893209535509034*^9}, {
   3.8932095880251827`*^9, 3.8932096267468843`*^9}, {3.8932097430886393`*^9, 
   3.893209758962556*^9}, 3.8932098249559894`*^9, {3.8950732616313677`*^9, 
   3.895073261646992*^9}, {3.895549051703639*^9, 3.8955490517246265`*^9}, {
   3.8955551724895377`*^9, 3.8955551725075264`*^9}, {3.895555838535388*^9, 
   3.8955558385493793`*^9}, {3.8955560194939394`*^9, 
   3.8955560195189266`*^9}},ExpressionUUID->"58101c3d-e202-45e2-8fee-\
0723b2d713ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
     RowBox[{
      RowBox[{"See", ":", " ", 
       RowBox[{"Operator", " ", "Linearity"}]}], " ", "&"}], " ", "Operator", 
     " ", "ProductRule"}],
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"LieDerivative", " ", "Linearity"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Thread", " ", "over", " ", "Plus", " ", "automatically"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", "t_Plus", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Plus", "@@", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"LieDerivative", "[", 
          RowBox[{"\[Xi]1", ",", "#", ",", "opts"}], "]"}], "&"}], "/@", 
        "t"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Implement", " ", "product", " ", "rule"}], " ", "*)"}], 
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", 
       RowBox[{"t_Times", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"(", 
            RowBox[{"Head", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "t"}], ")"}]}], ")"}], "]"}], "=!=", 
          RowBox[{"{", "Tensor", "}"}]}], ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"allTensors", ",", "therest"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"allTensors", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"List", "@@", "t"}], ")"}], ",", "_Tensor"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"therest", "=", 
         RowBox[{"Times", "@@", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"List", "@@", "t"}], ")"}], ",", "_Tensor"}], "]"}]}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"therest", " ", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"TensorIsZero", "[", 
             RowBox[{"LieDerivative", "[", 
              RowBox[{"\[Xi]1", ",", "allTensors", ",", "opts"}], "]"}], 
             "]"}], ",", "0", ",", "True", ",", 
            RowBox[{"LieDerivative", "[", 
             RowBox[{"\[Xi]1", ",", "allTensors", ",", "opts"}], "]"}]}], 
           "]"}]}], "+", 
         RowBox[{"allTensors", " ", 
          RowBox[{"LieDerivative", "[", 
           RowBox[{"\[Xi]1", ",", "therest", ",", "opts"}], "]"}]}]}]}]}], 
      "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "Use", " ", "TensorsProduct", " ", "to", " ", "take", " ", "care", " ", 
      "of", " ", 
      RowBox[{"TensorProduct", "'"}], "s", " ", "of", " ", "Tensors"}], " ", 
     "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", 
       RowBox[{"t_Times", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Union", "[", 
           RowBox[{"(", 
            RowBox[{"Head", "/@", 
             RowBox[{"(", 
              RowBox[{"List", "@@", "t"}], ")"}]}], ")"}], "]"}], "===", 
          RowBox[{"{", "Tensor", "}"}]}], ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"LieDerivative", "[", 
      RowBox[{"\[Xi]1", ",", 
       RowBox[{"TensorsProduct", "[", "t", "]"}], ",", "opts"}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.672589713073246*^9, 3.672589761941347*^9}, {
   3.6725899022528563`*^9, 3.672590034327141*^9}, {3.6725900803236427`*^9, 
   3.6725902035294995`*^9}, {3.672590264812632*^9, 3.6725902650154324`*^9}, {
   3.6725907946770754`*^9, 3.67259081539752*^9}, {3.6725908946558886`*^9, 
   3.672590896694893*^9}, {3.6725909905134745`*^9, 3.672591000782694*^9}, {
   3.672591038857369*^9, 3.67259103904657*^9}, {3.6725923754037485`*^9, 
   3.672592398045596*^9}, {3.6733705192827663`*^9, 3.673370525650383*^9}, {
   3.6733717913321257`*^9, 3.673371841574055*^9}, {3.673371898568012*^9, 
   3.673371900462016*^9}, {3.868531141276323*^9, 3.8685311472015696`*^9}, 
   3.868531244988261*^9, 3.868531361110857*^9, {3.8685315424513493`*^9, 
   3.8685315608391943`*^9}, {3.868532251889618*^9, 3.868532254360606*^9}, 
   3.8685334706106844`*^9, {3.868533775474222*^9, 3.8685337841052933`*^9}, 
   3.8685338377737684`*^9, {3.868534519918359*^9, 3.868534553199377*^9}, {
   3.8685347525835986`*^9, 3.868534761976937*^9}, {3.8685347925206175`*^9, 
   3.8685347986789913`*^9}, {3.8685351114840126`*^9, 3.8685351388502855`*^9}, 
   3.8685370512291574`*^9, 3.8685385145937676`*^9, 3.8685675965844393`*^9, 
   3.868575452030634*^9, {3.868577567979074*^9, 3.868577680281637*^9}, {
   3.868578034142892*^9, 3.8685780378058057`*^9}, {3.868579271603828*^9, 
   3.868579282084786*^9}, 3.8685844255671*^9, 3.8686096516247034`*^9, {
   3.868609745481092*^9, 3.8686097480303173`*^9}, {3.868609778269322*^9, 
   3.8686097796755514`*^9}, {3.868609905915547*^9, 3.868609951915227*^9}, 
   3.868610347605328*^9, {3.8686116844500647`*^9, 3.868611727916667*^9}, {
   3.8686120504048953`*^9, 3.868612065266871*^9}, {3.8692658106963*^9, 
   3.8692658324062576`*^9}, {3.8697902549385223`*^9, 
   3.8697903330935116`*^9}, {3.895073261646992*^9, 3.895073261646992*^9}, {
   3.8955490517336216`*^9, 
   3.8955490517356215`*^9}},ExpressionUUID->"c81cd627-8f4c-4b5e-ae5b-\
e293cfdee714"]
}, Closed]],

Cell[CellGroupData[{

Cell["LieBracket", "Subsection",
 CellChangeTimes->{
  3.867372724341937*^9},ExpressionUUID->"5a6f0069-2e6b-4d53-b6f4-\
b774d3db0b81"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox["LieBracket",
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "[", 
      RowBox[{"\[Xi]1_Tensor", ",", "\[Xi]2_Tensor", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dimensions", "[", 
         RowBox[{"TensorComponents", "[", "\[Xi]1", "]"}], "]"}], "===", 
        RowBox[{"{", 
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "\[Xi]1", "]"}], "]"}], "}"}], "===", 
        RowBox[{"{", 
         RowBox[{"Length", "[", 
          RowBox[{"Coordinates", "[", "\[Xi]2", "]"}], "]"}], "}"}]}], ")"}], 
      "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"StartIndex", "[", "\[Xi]1", "]"}], "===", 
        RowBox[{"StartIndex", "[", "\[Xi]1", "]"}]}], ")"}], "&&", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Since", " ", "user", " ", 
         RowBox[{"didn", "'"}], "t", " ", "input", " ", "the", " ", 
         "metric"}], ",", " ", 
        RowBox[{
        "we", " ", "only", " ", "allow", " ", "them", " ", "to", " ", "be", 
         " ", "vector", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"w", "/", " ", 
             StyleBox["upper",
              FontColor->RGBColor[1, 0, 1]]}], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["index",
             FontColor->RGBColor[1, 0, 1]]}], ")"}], "."}]}]}], "*)"}], 
      RowBox[{"TestOneVector", "[", "\[Xi]1", "]"}], "&&", 
      RowBox[{"TestOneVector", "[", "\[Xi]2", "]"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"LieBracketOperator", "|", "LieDerivativeOperator"}],
                  ")"}], "\[Rule]", "a_"}], ")"}], "\[Rule]", "a"}]}], "]"}], 
           "]"}], "===", "0"}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "opts", "}"}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"LieBracketOperator", "|", "LieDerivativeOperator"}],
                  ")"}], "\[Rule]", "a_"}], ")"}], "\[Rule]", "a"}]}], "]"}], 
           "]"}], "===", "1"}], ")"}]}], ")"}]}]}], ":=", 
    RowBox[{"Which", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{"{", "opts", "}"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"LieBracketOperator", "\[Rule]", "a_"}], ")"}], "\[Rule]",
            "LieBracketOperator"}]}], "]"}], "===", 
        RowBox[{"{", "LieBracketOperator", "}"}]}], ")"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"List", "[", 
          RowBox[{"\[Xi]1", ",", "\[Xi]2", ",", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", "opts", "}"}], "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"LieBracketOperator", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "LieBracketOperator", "]"}]}], 
                 ")"}], "\[Rule]", "Nothing"}], "}"}]}], ")"}]}], ",", 
           RowBox[{"(", 
            RowBox[{"LieDerivativeOperator", "\[Rule]", 
             RowBox[{"OptionValue", "[", "LieBracketOperator", "]"}]}], 
            ")"}]}], "]"}]}], ")"}], "//", "LieDerivative"}], ",", "True", 
      ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"List", "[", 
          RowBox[{"\[Xi]1", ",", "\[Xi]2", ",", "opts"}], "]"}]}], ")"}], "//",
        "LieDerivative"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "[", 
      RowBox[{
       RowBox[{"stuff1_", "/;", 
        RowBox[{"TestExpressionForm", "[", "stuff1", "]"}]}], ",", "stuff2_", 
       ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "0"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"LieBracket", "[", 
      RowBox[{"stuff1_", ",", 
       RowBox[{"stuff2_", "/;", 
        RowBox[{"TestExpressionForm", "[", "stuff2", "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "0"}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.7277838546352525`*^9, 
   3.727783858169075*^9}, {3.727787467829364*^9, 3.727787495938246*^9}, {
   3.7277875756934986`*^9, 3.7277875792397604`*^9}, {3.7277876707418776`*^9, 
   3.72778770219399*^9}, {3.7277877584258285`*^9, 3.7277877915109577`*^9}, {
   3.7277878424043903`*^9, 3.7277878811264715`*^9}, 3.7277879383036757`*^9, {
   3.727788719881564*^9, 3.7277888261798315`*^9}, {3.727788912849109*^9, 
   3.7277889371845922`*^9}, {3.7277897311974845`*^9, 3.727789744827913*^9}, {
   3.7277899581351657`*^9, 3.7277900115452623`*^9}, {3.727790077297223*^9, 
   3.727790118143917*^9}, {3.7277904370689335`*^9, 3.72779068173335*^9}, {
   3.727790720372624*^9, 3.727790938406535*^9}, {3.7277909992197423`*^9, 
   3.7277910652090855`*^9}, {3.727791099381648*^9, 3.727791151586588*^9}, {
   3.72779119753117*^9, 3.727791333775207*^9}, {3.7277913649255753`*^9, 
   3.7277913932071843`*^9}, {3.727791440834066*^9, 3.727791443680626*^9}, {
   3.7277914802625117`*^9, 3.7277914963036475`*^9}, {3.727791596706025*^9, 
   3.727791632429778*^9}, {3.727791703379794*^9, 3.7277917697057447`*^9}, {
   3.7277921266899767`*^9, 3.727792128011541*^9}, {3.727836859594427*^9, 
   3.7278369493787804`*^9}, {3.727837606489853*^9, 3.727837664283385*^9}, {
   3.8407724493806095`*^9, 3.8407724507755156`*^9}, {3.840772521269809*^9, 
   3.840772561838919*^9}, 3.8407726113251805`*^9, {3.8407728203563204`*^9, 
   3.84077282884037*^9}, 3.840843520814411*^9, {3.84084355110458*^9, 
   3.840843606524502*^9}, 3.840843761720167*^9, 3.841219815037341*^9, {
   3.8412199088308015`*^9, 3.8412199564753337`*^9}, 3.8412200195293245`*^9, {
   3.8412200801236506`*^9, 3.8412201213506517`*^9}, {3.841220183972626*^9, 
   3.8412202704844627`*^9}, 3.841220343688476*^9, {3.841220471045478*^9, 
   3.8412204903984747`*^9}, {3.841220529820326*^9, 3.841220567276322*^9}, {
   3.8412206264934783`*^9, 3.8412206932614803`*^9}, {3.841220740020477*^9, 
   3.84122080573448*^9}, {3.841220850295054*^9, 3.841220894031576*^9}, {
   3.841220976430519*^9, 3.841221021565101*^9}, {3.8412212208717117`*^9, 
   3.8412212232887144`*^9}, {3.8412213151185365`*^9, 3.841221324693531*^9}, {
   3.841221715926469*^9, 3.8412217329239254`*^9}, {3.8412218195935717`*^9, 
   3.8412218202325735`*^9}, {3.841226222717462*^9, 3.8412262692575893`*^9}, {
   3.8412263374674025`*^9, 3.8412263447273617`*^9}, {3.841226450257053*^9, 
   3.841226452257242*^9}, {3.841226547637249*^9, 3.841226551347434*^9}, {
   3.8412267888636456`*^9, 3.8412268012802477`*^9}, {3.841226840088232*^9, 
   3.8412268426033783`*^9}, {3.841374778582284*^9, 3.8413748016048827`*^9}, {
   3.8413753509883113`*^9, 3.84137537446701*^9}, {3.8413754110980825`*^9, 
   3.8413754476306753`*^9}, {3.841375509218422*^9, 3.841375509386316*^9}, {
   3.8420741494651003`*^9, 3.8420741518869762`*^9}, {3.8430836490387526`*^9, 
   3.8430836892697897`*^9}, {3.8430840639774747`*^9, 3.843084097224845*^9}, {
   3.843084254078519*^9, 3.843084260616461*^9}, {3.843086139184486*^9, 
   3.843086144770327*^9}, 3.843086184585873*^9, {3.843086217684342*^9, 
   3.843086243060648*^9}, {3.8430863073994794`*^9, 3.843086324017996*^9}, {
   3.843086532412168*^9, 3.8430867154697385`*^9}, {3.8430867910647645`*^9, 
   3.843086797299054*^9}, {3.843087303135919*^9, 3.843087311531622*^9}, {
   3.8430876200860806`*^9, 3.843087626335846*^9}, {3.8430876717690125`*^9, 
   3.843087676128538*^9}, {3.8436218755549107`*^9, 3.843621884625325*^9}, {
   3.843953052171285*^9, 3.8439531331712875`*^9}, 3.8439531721087875`*^9, {
   3.843953210718161*^9, 3.843953242780662*^9}, {3.843953634960122*^9, 
   3.8439537080877857`*^9}, {3.8439537473534126`*^9, 
   3.8439539996823697`*^9}, {3.843954491581495*^9, 3.8439544928621845`*^9}, {
   3.8439545398116083`*^9, 3.8439545756232285`*^9}, {3.8439546084683695`*^9, 
   3.843954608765242*^9}, 3.8439546695440016`*^9, {3.8442942786848307`*^9, 
   3.8442942986589727`*^9}, {3.8442946485304184`*^9, 
   3.8442946507184362`*^9}, {3.8442948322958527`*^9, 
   3.8442948760817065`*^9}, {3.85328641394878*^9, 3.8532865362047644`*^9}, {
   3.8532865748668537`*^9, 3.853286694413516*^9}, {3.853286743393367*^9, 
   3.853286749694873*^9}, 3.8532867861129436`*^9, {3.853847887666399*^9, 
   3.853847895511449*^9}, {3.8538479472965136`*^9, 3.8538479898018494`*^9}, {
   3.853848030766468*^9, 3.8538481828965836`*^9}, {3.8538482474062223`*^9, 
   3.8538483979264755`*^9}, {3.85384879156872*^9, 3.8538488519287004`*^9}, {
   3.8538492581988363`*^9, 3.8538493734266167`*^9}, {3.8538494113188033`*^9, 
   3.8538494194888043`*^9}, {3.8538494615583715`*^9, 
   3.8538496452858953`*^9}, {3.8538496764885683`*^9, 
   3.8538496796187243`*^9}, {3.8538817293317723`*^9, 
   3.8538817302567725`*^9}, {3.8538817720547733`*^9, 3.853881804218772*^9}, {
   3.853881836292774*^9, 3.8538818993967733`*^9}, {3.8538820639457726`*^9, 
   3.853882065684772*^9}, {3.8538820985157733`*^9, 3.853882100741773*^9}, {
   3.853882140864772*^9, 3.853882144872773*^9}, {3.853970712805137*^9, 
   3.853970732138238*^9}, {3.8544129154059143`*^9, 3.8544129270583553`*^9}, {
   3.8544129963198357`*^9, 3.854413094881153*^9}, 3.8667065585405755`*^9, {
   3.8667155560354743`*^9, 3.8667155839816008`*^9}, {3.8667156231715536`*^9, 
   3.8667156242570257`*^9}, {3.8667159553250885`*^9, 3.866715968924334*^9}, {
   3.86671612478946*^9, 3.8667161259866066`*^9}, {3.866716187133911*^9, 
   3.8667162073638673`*^9}, {3.866716300228763*^9, 3.8667163365646706`*^9}, {
   3.8667163985941477`*^9, 3.866716399908143*^9}, {3.866716466572727*^9, 
   3.866716470528139*^9}, 3.866716504410533*^9, {3.8667165547048407`*^9, 
   3.866716576164322*^9}, 3.8667167314087124`*^9, {3.866717009105966*^9, 
   3.8667170223047967`*^9}, 3.866717183030675*^9, {3.8667172263819847`*^9, 
   3.8667172268975773`*^9}, {3.8667172704239807`*^9, 
   3.8667173329869967`*^9}, {3.866718656007507*^9, 3.866718679139799*^9}, {
   3.8667187176826735`*^9, 3.866718731626344*^9}, {3.866718827560895*^9, 
   3.8667189527415085`*^9}, 3.8667189838148117`*^9, {3.86671901690086*^9, 
   3.866719023981798*^9}, {3.866719064613601*^9, 3.866719065457305*^9}, {
   3.8667570290153775`*^9, 3.8667570496241226`*^9}, {3.86675712173438*^9, 
   3.8667571523418026`*^9}, {3.866771319815587*^9, 3.866771362730858*^9}, 
   3.866771483019455*^9, {3.8673139292955604`*^9, 3.8673140150998287`*^9}, {
   3.867314105599106*^9, 3.867314111348889*^9}, {3.8673141484914265`*^9, 
   3.867314155028867*^9}, {3.8673145737130547`*^9, 3.867314580540806*^9}, {
   3.8673146323803644`*^9, 3.867314706524504*^9}, {3.867315001827664*^9, 
   3.867315005587598*^9}, {3.867315061217061*^9, 3.8673151452667155`*^9}, {
   3.8673151833863354`*^9, 3.867315198296013*^9}, {3.867315275930767*^9, 
   3.867315286935861*^9}, {3.867315430442907*^9, 3.867315431247837*^9}, {
   3.8673156579963818`*^9, 3.867315698876066*^9}, {3.8673158182770147`*^9, 
   3.8673158471546636`*^9}, {3.8673158801749144`*^9, 3.8673158971210365`*^9}, 
   3.867315946916399*^9, {3.86731791029901*^9, 3.86731791062388*^9}, {
   3.8673179759683933`*^9, 3.8673179764255333`*^9}, 3.867372718912263*^9, {
   3.8685207354568048`*^9, 3.8685207551603146`*^9}, 3.8685210132313423`*^9, {
   3.868582405641487*^9, 3.8685824175699167`*^9}, {3.868582695247071*^9, 
   3.8685827102954335`*^9}, {3.8685829336203713`*^9, 3.868582984949568*^9}, {
   3.8685830238690844`*^9, 3.868583053723572*^9}, {3.868583089579219*^9, 
   3.868583108339407*^9}, {3.868583249329068*^9, 3.8685832977776384`*^9}, {
   3.8686050115025916`*^9, 3.868605015860901*^9}, {3.8686052864670544`*^9, 
   3.8686052921621313`*^9}, {3.8686055937058306`*^9, 3.868605600871408*^9}, {
   3.8686058416617117`*^9, 3.868605843165784*^9}, {3.8691779591860023`*^9, 
   3.8691779661535935`*^9}, {3.8757580806309233`*^9, 3.87575809057111*^9}, {
   3.8847690854301567`*^9, 3.884769091298715*^9}, {3.884769936355911*^9, 
   3.8847699461449594`*^9}, {3.890192840075426*^9, 3.8901928525864983`*^9}, {
   3.895555838555376*^9, 3.895555838557375*^9}, {3.8955560195239244`*^9, 
   3.8955560195269213`*^9}},ExpressionUUID->"d180cf2c-a79b-4f69-aea8-\
e633c963da59"]
}, Closed]],

Cell[CellGroupData[{

Cell["CoordinateTransformation", "Subsection",
 CellChangeTimes->{
  3.5766860166362686`*^9},ExpressionUUID->"6b8fdb4f-3e2d-4c25-9e87-\
ef1a7343b3cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "JacobianComponents"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   StyleBox[
    RowBox[{
    "This", " ", "piece", " ", "is", " ", "supposed", " ", "to", " ", "not", 
     " ", "include", " ", "in", " ", "the", " ", "official", " ", 
     RowBox[{"version", "."}]}],
    FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"JacobianComponents", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ","}], "*)"}], 
      RowBox[{"ct", ":", 
       RowBox[{"{", 
        RowBox[{"Repeated", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SubMinus", "[", "_", "]"}], ",", 
             RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "\[Mu]T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "===", 
            RowBox[{
            "\[Nu]T", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{
            "\[Mu]T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "===", "Symbol"}], "&&", 
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{
            "\[Nu]T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "===", "Symbol"}]}], ")"}]}]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "lgth", ",", "jacobcomp", ",", "jacobm", 
         ",", "i", ",", "j", ",", "row", ",", "col"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacobcomp", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "rhs", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           RowBox[{"(*", 
            RowBox[{
            "index", " ", "of", " ", "\[Xi]", " ", "should", " ", "represent",
              " ", "column"}], "*)"}], ",", 
           RowBox[{
           "coords", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          RowBox[{"(*", 
           RowBox[{
           "index", " ", "of", " ", "x", " ", "should", " ", "represent", " ",
             "row"}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"jacobcomp", "[", 
            RowBox[{"row", ",", "col"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"row", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianComponents", "[", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"\[Mu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
        RowBox[{"\[Nu]T_", "/;", 
         RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ","}], "*)"}], 
      RowBox[{
       RowBox[{"ct", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
       RowBox[{"newcoords", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}]}], "]"}], 
     RowBox[{"(*", 
      RowBox[{"/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"SubMinus", "[", "_", "]"}], ",", 
             RowBox[{"SuperMinus", "[", "_", "]"}]}], "}"}]}], "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"!", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "\[Mu]T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "===", 
            RowBox[{
            "\[Nu]T", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], ")"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{
            "\[Mu]T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "===", "Symbol"}], "&&", 
          RowBox[{
           RowBox[{"Head", "[", 
            RowBox[{
            "\[Nu]T", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "]"}], "===", "Symbol"}]}], ")"}]}]}], "*)"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "lgth", ",", "lgthrhs", ",", "jacobcomp", 
         ",", "jacobm", ",", "i", ",", "j", ",", "row", ",", "col"}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacobcomp", "[", 
          RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
         RowBox[{"D", "[", 
          RowBox[{
           RowBox[{
           "rhs", "\[LeftDoubleBracket]", "j", "\[RightDoubleBracket]"}], 
           RowBox[{"(*", 
            RowBox[{
            "index", " ", "of", " ", "\[Xi]", " ", "should", " ", "represent",
              " ", "column"}], "*)"}], ",", 
           RowBox[{
           "newcoords", "\[LeftDoubleBracket]", "i", 
            "\[RightDoubleBracket]"}]}], 
          RowBox[{"(*", 
           RowBox[{
           "index", " ", "of", " ", "x", " ", "should", " ", "represent", " ",
             "row"}], "*)"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"jacobcomp", "[", 
            RowBox[{"row", ",", "col"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"row", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"col", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8273977289769225`*^9, 3.8273977812329187`*^9}, 
   3.827397822806463*^9, {3.827397968537464*^9, 3.827397997394462*^9}, {
   3.827398147233434*^9, 3.827398149618436*^9}, {3.8273981980344453`*^9, 
   3.8273982176574335`*^9}, 3.827399388146923*^9, {3.8273994610173683`*^9, 
   3.8273996208470078`*^9}, {3.8273997447970066`*^9, 
   3.8273997674971094`*^9}, {3.827399945547058*^9, 3.8274000345474024`*^9}, {
   3.8274003204670353`*^9, 3.827400320617378*^9}, {3.8274018870534353`*^9, 
   3.8274019128304358`*^9}, {3.8274020115474353`*^9, 3.827402011746435*^9}, {
   3.827402555874447*^9, 3.827402560071436*^9}, {3.827402616403505*^9, 
   3.827402721026507*^9}, {3.8274027657955055`*^9, 3.827402766018505*^9}, {
   3.827402865315505*^9, 3.8274029211545057`*^9}, {3.8274032953502235`*^9, 
   3.8274032997042713`*^9}, 3.8279123514164157`*^9, {3.8293907518052874`*^9, 
   3.829390752908742*^9}, {3.8293909656440907`*^9, 3.829390988110962*^9}, {
   3.829391266781184*^9, 3.8293912737178097`*^9}, {3.83030063830005*^9, 
   3.8303006575925713`*^9}, {3.83030120221494*^9, 3.830301223956378*^9}, {
   3.830301358484892*^9, 3.830301376862209*^9}, {3.830301444355482*^9, 
   3.8303014456592965`*^9}, {3.8364759682785816`*^9, 3.836475971171385*^9}, {
   3.838195988519491*^9, 3.838195993465493*^9}, {3.8516596540964975`*^9, 
   3.8516596578373747`*^9}, {3.8955547750370197`*^9, 
   3.895554775047022*^9}},ExpressionUUID->"d82d687a-8264-4ab2-8e90-\
126ea1a0db20"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{
    "Compute", " ", "Jacobians", " ", "for", " ", "coordinate", " ", 
     "transformations"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", "\[Rule]", " ", 
       RowBox[{"f1", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"y", " ", "\[Rule]", " ", 
       RowBox[{"f2", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"z", " ", "\[Rule]", " ", 
       RowBox[{"f3", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      "..."}], "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"returns", " ", 
    RowBox[{"Union", "[", 
     RowBox[{"r", ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"dx", " ", "\[Rule]", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f1"}], "/", 
              RowBox[{"\[PartialD]", "x"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "x"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f1"}], "/", 
              RowBox[{"\[PartialD]", "y"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "y"}]}], " ", "+"}], " ", "..."}]}], 
        ",", " ", 
        RowBox[{"dy", " ", "\[Rule]", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f2"}], "/", 
              RowBox[{"\[PartialD]", "x"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "x"}]}], " ", "+", " ", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[PartialD]", "f2"}], "/", 
              RowBox[{"\[PartialD]", "y"}]}], ")"}], 
            RowBox[{"\[DifferentialD]", "y"}]}], " ", "+"}], " ", "..."}]}]}],
        "}"}]}], " ", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    RowBox[{"\[Del]", " ", "transform"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateTransformation", "[", 
      RowBox[{"ct", ":", 
       RowBox[{"{", 
        RowBox[{"Repeated", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "jacob", ",", "i", ",", "j", ",", "ds", 
         ",", "R", ",", "lgth", ",", "dlist", ",", "drhs", ",", "dellist", 
         ",", "delrhs", ",", "delR", ",", "jacobm", ",", "invjacobm"}], "}"}],
        ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"dx", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx", "'"}], "/", "dx"}], ")"}], " ", "dx"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacob", "[", "i_", "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "rhs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ds", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[DifferentialD]", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "\[Rule]", 
             RowBox[{"jacob", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "coords", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"ds", ",", "ct"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", 
          StyleBox["Jacobian",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["*",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["d",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["matrix",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["form",
            FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "dlist", "\[LeftDoubleBracket]", "b", 
              "\[RightDoubleBracket]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["Jacobian",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ", 
          "matrix", " ", 
          RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"invjacobm", "=", 
           RowBox[{"Inverse", "[", "jacobm", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"invjacobm", "=", 
         RowBox[{
          RowBox[{"Transpose", "[", 
           RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}], "//", 
          "Simplify"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"dellist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Del]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"delR", "=", 
         RowBox[{"Thread", "[", 
          RowBox[{"dellist", "\[Rule]", 
           RowBox[{"invjacobm", ".", "dellist"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{"{", 
          RowBox[{"R", ",", "delR"}], "}"}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", " ", "\[Rule]", " ", 
        RowBox[{"f1", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"y", " ", "\[Rule]", " ", 
        RowBox[{"f2", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"z", " ", "\[Rule]", " ", 
        RowBox[{"f3", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", "..."}], 
      "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "allow"}], " ", "for", " ", "different",
      " ", "names", " ", "on", " ", "the", " ", "RHS", " ", "than", " ", 
     "the", " ", "previous"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"returns", " ", 
     RowBox[{"Union", "[", 
      RowBox[{"r", ",", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"dx", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f1"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"x", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"x", "'"}]}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f1"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"y", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"y", "'"}]}]}], " ", "+"}], " ", "..."}]}], ",", " ", 
         RowBox[{"dy", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f2"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"x", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"x", "'"}]}]}], " ", "+", " ", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"\[PartialD]", "f2"}], "/", 
               RowBox[{"\[PartialD]", 
                RowBox[{"y", "'"}]}]}], ")"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{"y", "'"}]}]}], " ", "+"}], " ", "..."}]}]}], "}"}]}], 
      " ", "]"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     RowBox[{"\[Del]", " ", "transform"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"CoordinateTransformation", "[", 
      RowBox[{
       RowBox[{"ct", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
       RowBox[{"newcoords", ":", 
        RowBox[{"{", 
         RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "rhs", ",", "jacob", ",", "i", ",", "j", ",", "ds", 
         ",", "R", ",", "lgth", ",", "lgthrhs", ",", "dlist", ",", "drhs", 
         ",", "dellist", ",", "delrhs", ",", "delR", ",", "jacobm", ",", 
         "invjacobm"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "extract", " ", "coordinates", " ", "and", " ", "transformation", " ",
          "rules"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"rhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"dx", " ", "\[Rule]", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"dx_old", "'"}], "/", "dx_new"}], ")"}], " ", 
           "dx_new"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"jacob", "[", "i_", "]"}], ":=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{
              RowBox[{
              "rhs", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{
              "newcoords", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}], "]"}], 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "newcoords", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "newcoords", "]"}]}], "}"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ds", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"\[DifferentialD]", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "\[Rule]", 
             RowBox[{"jacob", "[", "#", "]"}]}], ")"}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Length", "[", "coords", "]"}]}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"Flatten", "[", 
          RowBox[{"{", 
           RowBox[{"ds", ",", "ct"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["Jacobian",
           FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ", 
          "matrix", " ", 
          RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"invjacobm", "=", 
           RowBox[{"Inverse", "[", "jacobm", "]"}]}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"lgth", "===", "lgthrhs"}], ")"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Generate", " ", "a", " ", 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
            RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
            " ", 
            RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"dlist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[DifferentialD]", 
               RowBox[{
               "coords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Generate", " ", "a", " ", 
             StyleBox["list",
              FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
             RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of",
              " ", 
             RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"drhs", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[DifferentialD]", 
               RowBox[{
               "newcoords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Generate", " ", 
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
             StyleBox["d",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["*",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["d",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["matrix",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             RowBox[{
              StyleBox["form",
               FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"jacobm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "dlist", "\[LeftDoubleBracket]", "a", 
                  "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
                RowBox[{
                "drhs", "\[LeftDoubleBracket]", "b", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
           RowBox[{"invjacobm", "=", 
            RowBox[{
             RowBox[{"Transpose", "[", 
              RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}], "//", 
             "Simplify"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"dellist", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Del]", 
               RowBox[{
               "coords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"delrhs", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Del]", 
               RowBox[{
               "newcoords", "\[LeftDoubleBracket]", "#", 
                "\[RightDoubleBracket]"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"delR", "=", 
            RowBox[{"Thread", "[", 
             RowBox[{"dellist", "\[Rule]", 
              RowBox[{"invjacobm", ".", "delrhs"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "[", 
            RowBox[{"{", 
             RowBox[{"R", ",", "delR"}], "}"}], "]"}]}], ",", 
          RowBox[{"(", 
           RowBox[{"lgth", "=!=", "lgthrhs"}], ")"}], ",", "R"}], "]"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["NewCode",
      FontColor->RGBColor[0.5, 0, 0.5]], ":", " ", 
     RowBox[{
     "CoordinateTransformation", " ", "to", " ", "one", " ", "with", " ", 
      "the", " ", 
      StyleBox["same",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "symbols", " ", 
      RowBox[{"(", 
       StyleBox[
        RowBox[{
        "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}],
        FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Shouldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{"(*", " ", 
        RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           "&"}], "/@", "ct"}], "===", 
        RowBox[{"Coordinates", "[", "t", "]"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "lgth", ",", "jacobm", ",", "invjacobm", ",", 
          "jacobT", ",", "invjacobT", ",", "R", ",", "dlist", ",", "drhs", 
          ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", "newm", ",", 
          "name", ",", "si", ",", "m", ",", "mx", ",", "tensorproduct", ",", 
          "allindices", ",", "j", ",", "s", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Rank",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"number", ":"}],
            FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", 
           RowBox[{"list", "'"}], "s", " ", "length"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"idxl", "=", 
          RowBox[{"Length", "[", "indices", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
           "length", " ", "of", " ", "coordinates", " ", "transformation", 
            " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Extract", " ", 
           StyleBox["old",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coordinates",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"R", ":", " ", 
           RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
            RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{"CoordinateTransformation", "[", "ct", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"jacobm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dlist", "\[LeftDoubleBracket]", "a", 
                "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ",
            "matrix", " ", 
           RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"invjacobm", "=", 
            RowBox[{"Inverse", "[", "jacobm", "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"invjacobm", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         StyleBox[
          RowBox[{"(*", 
           RowBox[{
            RowBox[{
             RowBox[{"jacobT", "[", 
              RowBox[{"j_", ",", "i_"}], "]"}], "=", 
             RowBox[{"NonMetricTensor", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["j", "-"], ",", 
                 SuperscriptBox["i", "-"]}], "}"}], ",", "jacobm", ",", 
               "\"\<J\>\"", ",", 
               RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"invjacobT", "[", 
              RowBox[{"k_", ",", "j_"}], "]"}], "=", 
             RowBox[{"NonMetricTensor", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["k", "-"], ",", 
                 SuperscriptBox["j", "-"]}], "}"}], ",", 
               RowBox[{"Inverse", "[", "jacobm", "]"}], ",", 
               "\"\<\!\(\*SuperscriptBox[\(J\), \(-1\)]\)\>\"", ",", 
               RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], 
            ";"}], "*)"}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         StyleBox[
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"newm", "=", 
             RowBox[{"t", "/.", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                "\[RuleDelayed]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"TensorComponents", "\[Rule]", "mx"}], "/.", "ct"}],
                  ")"}]}], "}"}]}]}], ";"}], "*)"}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["New",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["tensor",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"Inherit", " ", "property", " ", "form", " ", "old", " ", 
             RowBox[{"one", "."}]}]}]}], "*)"}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{"newm", "=", "t"}], ";", 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"m", "=", 
             RowBox[{
              RowBox[{"TensorComponents", "[", "t", "]"}], "/.", "ct"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Sgn", "[", 
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
                 "invjacobm", ",", 
                 RowBox[{
                  RowBox[{"Sgn", "[", 
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "]"}], "===", 
                  RowBox[{"-", "1"}]}], ",", "jacobm"}], "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Prepend", "[", 
              RowBox[{"mx", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"tensorproduct", "=", 
             RowBox[{"TensorProduct", "[", 
              RowBox[{"Sequence", "@@", "mx"}], "]"}]}], ";"}], "*)"}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->GrayLevel[0.5]], 
         RowBox[{
          StyleBox["(*",
           FontColor->GrayLevel[0.5]], 
          RowBox[{
           StyleBox["Extract",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["tensor",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["components",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["and",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["perform",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["it",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["in",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["new",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox[
            RowBox[{"coord", ".", " ", "We"}],
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox[
            RowBox[{"haven", "'"}],
            FontColor->GrayLevel[0.5]], 
           StyleBox["t",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["contract",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["with",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox["Jacobians",
            FontColor->GrayLevel[0.5]], 
           StyleBox[" ",
            FontColor->GrayLevel[0.5]], 
           StyleBox[
            RowBox[{"yet", "."}],
            FontColor->GrayLevel[0.5]]}], 
          StyleBox["*)",
           FontColor->GrayLevel[0.5]]}], "\[IndentingNewLine]", 
         RowBox[{"mx", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", "t", "]"}], "/.", "ct"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Prepare", " ", "a", " ", "new", " ", "indices", " ", 
           RowBox[{"list", ".", " ", "Firstly"}], " ", "inherit", " ", "from",
            " ", "the", " ", "old", " ", "one"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"allindices", "=", "indices"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{"(*", 
               RowBox[{"If", " ", 
                RowBox[{"it", "'"}], "s", " ", "upper", " ", "index"}], 
               "*)"}], 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
               RowBox[{"(*", 
                RowBox[{
                "Tensor", " ", "Product", " ", "current", " ", "tensor", " ", 
                 "with", " ", "inverse", " ", 
                 RowBox[{"jacobian", "."}]}], "*)"}], 
               RowBox[{
                RowBox[{"mx", "=", 
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", "invjacobm"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Join", " ", "Current", " ", "indices", " ", "list", " ", 
                  "with", " ", 
                  RowBox[{"Jacobians", "'"}], " ", 
                  RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"SubMinus", "[", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{"Unique", "[", "j", "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"newm", "=", 
                 RowBox[{"newm", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                    "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
                   "}"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "extract", " ", "the", " ", "new", " ", "tensor", " ", 
                  "components"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"mx", "=", 
                 RowBox[{"TensorComponents", "[", "newm", "]"}]}], ";", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Indices", "[", "newm", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Same", ",", " ", 
                 RowBox[{"but", " ", "for", " ", "lower", " ", "index"}]}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"mx", "=", 
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", "jacobm"}], "]"}]}], ";", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"SubMinus", "[", 
                    RowBox[{"Unique", "[", "j", "]"}], "]"}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"newm", "=", 
                 RowBox[{"newm", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                    "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
                   "}"}]}]}], ";", 
                RowBox[{"mx", "=", 
                 RowBox[{"TensorComponents", "[", "newm", "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Indices", "[", "newm", "]"}]}]}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            StyleBox["\"\<Do\>\"",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["for",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["idxl",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[
             RowBox[{"(", 
              RowBox[{"rank", " ", "number"}], ")"}],
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["times",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[":",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
             RowBox[{
             "Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
              RowBox[{"hand", ".", " ", 
               StyleBox["If",
                FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
              "executed", " ", "index", " ", "is", " ", "an", " ", 
              StyleBox["upper",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["index",
               FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "an", " ", 
            StyleBox["inverse",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
            RowBox[{"it", "'"}], "s", " ", "a", " ", 
            StyleBox["lower",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["index",
             FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "a", " ", 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "upper", " ", "index"}], ",", 
              " ", 
              RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
             "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"it", "'"}], "s", " ", "lower", " ", "index"}], ",", 
               " ", 
               RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
              "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"allindices", "=", "indices"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
               RowBox[{"allindices", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"allindices", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox[
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"], ",", 
                    SuperscriptBox[
                    RowBox[{"Unique", "[", "j", "]"}], "-"]}], "}"}]}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"allindices", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"allindices", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox[
                    RowBox[{"Unique", "[", "j", "]"}], "-"], ",", 
                    SuperscriptBox[
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"]}], "}"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"allindices", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"], ",", 
                  SuperscriptBox[
                   RowBox[{"Unique", "[", "j", "]"}], "-"]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "]"}], "===", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"Unique", "[", "j", "]"}], "-"], ",", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"allindices", "=", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"allindices", ",", "indices"}], "]"}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newm", "=", 
            RowBox[{"newm", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
                 ")"}]}]}], "}"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
               RowBox[{"newm", "=", 
                RowBox[{"TensorsProduct", "[", 
                 RowBox[{"newm", " ", 
                  RowBox[{"invjacobT", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"Unique", "[", "j", "]"}]}], "]"}]}], "]"}]}], 
               ",", 
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"newm", "=", 
                RowBox[{"TensorsProduct", "[", 
                 RowBox[{"newm", " ", 
                  RowBox[{"jacobT", "[", 
                   RowBox[{
                    RowBox[{"Unique", "[", "j", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "OptionValue", " ", "is", " ", "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
              "_Integer"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"TensorName", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "If", " ", "OptionValue", " ", "is", " ", "\"\<not\>\"", " ", 
              "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"StartIndex", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
            StyleBox["TensorComponents",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["TensorName",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "and", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["StartIndex",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "m_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
                RowBox[{
                "OptionValue", "[", "CoordinateTransformationOperator", 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
            RowBox[{"list", ".", " ", 
             RowBox[{"Search", ":", " ", 
              RowBox[{
              "\"\<Options[CoordinateTransformation]\>\"", 
               "\[IndentingNewLine]", "User", " ", "should", " ", "input", 
               " ", "a", " ", "list", " ", 
               RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
               " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
               RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
            StyleBox["new",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "idxl"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Make", " ", "it", " ", "become", " ", 
             RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipDisplayNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
               "]"}], ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipStyleNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}],
               ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Final", " ", "output"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
         "newm"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "the", " ", "OptionValue", " ", "for", " ", 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "is", " ", 
        RowBox[{"OK", ".", " ", 
         RowBox[{"It", "'"}]}], "s", " ", "should", " ", "be", " ", "a", " ", 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["with",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["same",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["sign",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["of",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["original",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", "a", " ", 
        StyleBox["null",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["NewCode",
      FontColor->RGBColor[0.5, 0, 0.5]], ":", " ", 
     RowBox[{
     "CoordinateTransformation", " ", "to", " ", "one", " ", "with", " ", 
      StyleBox["different",
       FontColor->RGBColor[0.5, 0, 0.5]], " ", "symbols", " ", 
      RowBox[{"(", 
       StyleBox[
        RowBox[{
        "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}],
        FontColor->RGBColor[0.5, 0, 0.5]], ")"}]}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}], "===", 
          RowBox[{"Coordinates", "[", "t", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Length", "[", "ct", "]"}], "===", 
          RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "lgth", ",", "jacobm", ",", "invjacobm", ",", 
          "jacobT", ",", "invjacobT", ",", "R", ",", "dlist", ",", "drhs", 
          ",", "lgthrhs", ",", "indices", ",", "idxl", ",", "newm", ",", 
          "name", ",", "si", ",", "m", ",", "mx", ",", "tensorproduct", ",", 
          "allindices", ",", "j", ",", "s", ",", "l"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Rank",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"number", ":"}],
            FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", 
           RowBox[{"list", "'"}], "s", " ", "length"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"idxl", "=", 
          RowBox[{"Length", "[", "indices", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
           "length", " ", "of", " ", "coordinates", " ", "transformation", 
            " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"New", " ", 
           RowBox[{
            StyleBox["Dimension",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"length", " ", "of", " ", 
             RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
             RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
             RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
             "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
             "cover", " ", "induced", " ", 
             RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgthrhs", "=", 
          RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Extract", " ", 
           StyleBox["old",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coordinates",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"drhs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "newcoords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"R", ":", " ", 
           RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
            RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{"CoordinateTransformation", "[", 
           RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"jacobm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dlist", "\[LeftDoubleBracket]", "a", 
                "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
              RowBox[{
              "drhs", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ",
            "matrix", " ", 
           RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"invjacobm", "=", 
            RowBox[{"Inverse", "[", "jacobm", "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"invjacobm", "=", 
          RowBox[{"Transpose", "[", 
           RowBox[{"Inverse", "[", "jacobm", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            RowBox[{"jacobT", "[", 
             RowBox[{"j_", ",", "i_"}], "]"}], "=", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["j", "-"], ",", 
                SuperscriptBox["i", "-"]}], "}"}], ",", "jacobm", ",", 
              "\"\<J\>\"", ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"invjacobT", "[", 
             RowBox[{"k_", ",", "j_"}], "]"}], "=", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["k", "-"], ",", 
                SuperscriptBox["j", "-"]}], "}"}], ",", 
              RowBox[{"Inverse", "[", "jacobm", "]"}], ",", 
              "\"\<\!\(\*SuperscriptBox[\(J\), \(-1\)]\)\>\"", ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}],
            ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"newm", "=", 
            RowBox[{"t", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                "\[RuleDelayed]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"TensorComponents", "\[Rule]", "mx"}], "/.", "ct"}],
                  ")"}]}], ",", " ", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], 
                 ")"}]}]}], "}"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["New",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["tensor",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"Inherit", " ", "property", " ", "form", " ", "old", " ", 
             RowBox[{"one", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"newm", "=", "t"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"m", "=", 
            RowBox[{
             RowBox[{"TensorComponents", "[", "t", "]"}], "/.", "ct"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"mx", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
                "invjacobm", ",", 
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "]"}], "===", 
                 RowBox[{"-", "1"}]}], ",", "jacobm"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"mx", "=", 
            RowBox[{"Prepend", "[", 
             RowBox[{"mx", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"tensorproduct", "=", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"Sequence", "@@", "mx"}], "]"}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Extract",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["tensor",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["components",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", "perform", " ", 
           "it", " ", "in", " ", "new", " ", 
           RowBox[{"coord", ".", " ", "We"}], " ", 
           RowBox[{"haven", "'"}], "t", " ", "contract", " ", "with", " ", 
           "Jacobians", " ", 
           RowBox[{"yet", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"mx", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", "t", "]"}], "/.", "ct"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Prepare", " ", "a", " ", "new", " ", "indices", " ", 
           RowBox[{"list", ".", " ", "Firstly"}], " ", "inherit", " ", "from",
            " ", "the", " ", "old", " ", "one"}], "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"allindices", "=", "indices"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{"(*", 
               RowBox[{"If", " ", 
                RowBox[{"it", "'"}], "s", " ", "upper", " ", "index"}], 
               "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "Tensor", " ", "Product", " ", "current", " ", "tensor", " ", 
                 "with", " ", "inverse", " ", 
                 RowBox[{"jacovian", "."}]}], "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"mx", "=", 
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", "invjacobm"}], "]"}]}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "Join", " ", "Current", " ", "indices", " ", "list", " ", 
                  "with", " ", 
                  RowBox[{"Jacobians", "'"}], " ", 
                  RowBox[{"indices", "."}]}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"SubMinus", "[", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{"Unique", "[", "j", "]"}], "]"}]}], "}"}]}], 
                  "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
                RowBox[{"newm", "=", 
                 RowBox[{"newm", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                    "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
                   "}"}]}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{
                 "extract", " ", "the", " ", "new", " ", "tensor", " ", 
                  "components"}], "*)"}], "\[IndentingNewLine]", 
                RowBox[{"mx", "=", 
                 RowBox[{"TensorComponents", "[", "newm", "]"}]}], ";", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Indices", "[", "newm", "]"}]}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Same", ",", " ", 
                 RowBox[{"but", " ", "for", " ", "lower", " ", "index"}]}], 
                "*)"}], "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{
                RowBox[{"mx", "=", 
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", "jacobm"}], "]"}]}], ";", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Join", "[", 
                  RowBox[{
                   RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                   ",", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"SubMinus", "[", 
                    RowBox[{"Unique", "[", "j", "]"}], "]"}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
                RowBox[{"newm", "=", 
                 RowBox[{"newm", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                    "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
                   "}"}]}]}], ";", 
                RowBox[{"mx", "=", 
                 RowBox[{"TensorComponents", "[", "newm", "]"}]}], ";", 
                RowBox[{"allindices", "=", 
                 RowBox[{"Indices", "[", "newm", "]"}]}]}]}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
            StyleBox["\"\<Do\>\"",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["for",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["idxl",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[
             RowBox[{"(", 
              RowBox[{"rank", " ", "number"}], ")"}],
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["times",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[":",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
             RowBox[{
             "Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
              RowBox[{"hand", ".", " ", 
               StyleBox["If",
                FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
              "executed", " ", "index", " ", "is", " ", "an", " ", 
              StyleBox["upper",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox[" ",
               FontColor->RGBColor[1, 0, 1]], 
              StyleBox["index",
               FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "an", " ", 
            StyleBox["inverse",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
            RowBox[{"it", "'"}], "s", " ", "a", " ", 
            StyleBox["lower",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["index",
             FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
           RowBox[{"contract", " ", "with", " ", "a", " ", 
            RowBox[{
             StyleBox["Jacobian",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Which", "[", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{
              RowBox[{"If", " ", 
               RowBox[{"it", "'"}], "s", " ", "upper", " ", "index"}], ",", 
              " ", 
              RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
             "*)"}], 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", " ", 
                    StyleBox["inverse",
                    FontColor->RGBColor[1, 0, 1]]}], 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}], "*)"}], "invjacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"If", " ", 
                RowBox[{"it", "'"}], "s", " ", "lower", " ", "index"}], ",", 
               " ", 
               RowBox[{"and", " ", "in", " ", "coordinate", " ", "basis"}]}], 
              "*)"}], 
             RowBox[{
              RowBox[{
               RowBox[{"Sgn", "[", 
                RowBox[{
                "indices", "\[LeftDoubleBracket]", "s", 
                 "\[RightDoubleBracket]"}], "]"}], "===", 
               RowBox[{"-", "1"}]}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"OverHatSgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "s", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"mx", "=", 
              RowBox[{"Which", "[", "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"s", "<", "idxl"}], ",", 
                RowBox[{"Transpose", "[", 
                 RowBox[{
                  RowBox[{"TensorContract", "[", 
                   RowBox[{
                    RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                    RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                    "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(*", 
                 RowBox[{"Least", " ", "index", " ", 
                  RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                  RowBox[{"Transpose", "."}]}], "*)"}], 
                RowBox[{"s", "===", "idxl"}], ",", 
                RowBox[{"TensorContract", "[", 
                 RowBox[{
                  RowBox[{"TensorProduct", "[", 
                   RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                   "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"allindices", "=", "indices"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Do", "[", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
               RowBox[{"allindices", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"allindices", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"SubMinus", "[", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{"Unique", "[", "j", "]"}], "]"}]}], "}"}]}], 
                 "]"}]}], ",", 
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"allindices", "=", 
                RowBox[{"Join", "[", 
                 RowBox[{"allindices", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"SubMinus", "[", 
                    RowBox[{"Unique", "[", "j", "]"}], "]"}], ",", 
                    RowBox[{"SuperMinus", "[", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}]}], 
              "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"allindices", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"], ",", 
                  SuperscriptBox[
                   RowBox[{"Unique", "[", "j", "]"}], "-"]}], "}"}], ",", 
                RowBox[{
                 RowBox[{"Sgn", "[", 
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "]"}], "===", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"Unique", "[", "j", "]"}], "-"], ",", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "-"]}], "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"allindices", "=", 
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{"allindices", ",", "indices"}], "]"}], "//", 
             "Flatten"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"newm", "=", 
            RowBox[{"newm", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
                 ")"}]}]}], "}"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Do", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", "1"}], ",", 
               RowBox[{"newm", "=", 
                RowBox[{"TensorsProduct", "[", 
                 RowBox[{"newm", " ", 
                  RowBox[{"invjacobT", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"Unique", "[", "j", "]"}]}], "]"}]}], "]"}]}], 
               ",", 
               RowBox[{
                RowBox[{"Sgn", "[", 
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "]"}], "===", 
                RowBox[{"-", "1"}]}], ",", 
               RowBox[{"newm", "=", 
                RowBox[{"TensorsProduct", "[", 
                 RowBox[{"newm", " ", 
                  RowBox[{"jacobT", "[", 
                   RowBox[{
                    RowBox[{"Unique", "[", "j", "]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "indices", "\[LeftDoubleBracket]", "l", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}]}], "]"}], 
             "\[IndentingNewLine]", ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
         StyleBox["\[IndentingNewLine]",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox["\[IndentingNewLine]",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"If", " ", "OptionValue", " ", "is", " ", "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
              "_Integer"}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"TensorName", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{
             "If", " ", "OptionValue", " ", "is", " ", "\"\<not\>\"", " ", 
              "an", " ", 
              RowBox[{"integer", ".", " ", "That"}], " ", "is"}], ",", " ", 
             RowBox[{"user", " ", 
              RowBox[{"didn", "'"}], "t", " ", "specified", " ", 
              RowBox[{"it", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Inherit", " ", "from", " ", "old", " ", 
              RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"StartIndex", "[", "t", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"If", " ", "user", " ", "specified", " ", 
              RowBox[{"it", "."}]}], "*)"}], "\[IndentingNewLine]", "True", 
            ",", "\[IndentingNewLine]", 
            RowBox[{"(*", 
             RowBox[{"Specify", " ", "it", " ", "to", " ", "be", " ", 
              RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
            StyleBox["TensorComponents",
             FontColor->RGBColor[1, 0, 1]]}], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[",",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["  ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["StartIndex",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "and", 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            RowBox[{
             StyleBox["CoordinateSystem",
              FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "m_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
                RowBox[{
                "OptionValue", "[", "CoordinateTransformationOperator", 
                 "]"}]}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], 
               ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["Indices",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
            RowBox[{"list", ".", " ", 
             RowBox[{"Search", ":", " ", 
              RowBox[{
              "\"\<Options[CoordinateTransformation]\>\"", 
               "\[IndentingNewLine]", "User", " ", "should", " ", "input", 
               " ", "a", " ", "list", " ", 
               RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
               " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
               RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}],
           "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
           "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
            StyleBox["new",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["indices",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox["list",
             FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "idxl"}], ",", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Make", " ", "it", " ", "become", " ", 
             RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newm", "=", 
          RowBox[{"newm", "/.", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipDisplayNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
               "]"}], ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
           RowBox[{"newm", "=", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"TooltipStyleNoPart", "[", "newm", "]"}], "===", 
                RowBox[{"{", "}"}]}], ")"}], ",", 
              RowBox[{"Append", "[", 
               RowBox[{"newm", ",", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}],
               ",", "True", ",", 
              RowBox[{"newm", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                 ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Final", " ", "output"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
         "newm"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{"Check", " ", "the", " ", "OptionValue", " ", "for", " ", 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "is", " ", 
        RowBox[{"OK", ".", " ", 
         RowBox[{"It", "'"}]}], "s", " ", "should", " ", "be", " ", "a", " ", 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["with",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["same",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["sign",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["of",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["original",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["indices",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]], " ", "or", " ", "a", " ", 
        StyleBox["null",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox[" ",
         FontColor->RGBColor[1, 0, 1]], 
        StyleBox["list",
         FontColor->RGBColor[1, 0, 1]]}], "*)"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5766860372595043`*^9, 3.5766861748361464`*^9}, {
   3.576686207081403*^9, 3.5766862542090855`*^9}, {3.5766863122567873`*^9, 
   3.576686315220793*^9}, {3.5857176653762712`*^9, 3.5857176751106887`*^9}, {
   3.61152555817948*^9, 3.611525594725541*^9}, {3.6115257192804546`*^9, 
   3.611525732531658*^9}, {3.611525762862624*^9, 3.611525785828477*^9}, {
   3.6115259642452183`*^9, 3.6115259702438107`*^9}, 3.611526048675515*^9, {
   3.611526127082219*^9, 3.6115261313572855`*^9}, {3.6115263381834626`*^9, 
   3.611526346402089*^9}, {3.6115264737210445`*^9, 3.611526481127158*^9}, {
   3.631213472477243*^9, 3.6312135552955914`*^9}, {3.791373775114976*^9, 
   3.791373800937765*^9}, {3.827912458977579*^9, 3.8279124893122497`*^9}, 
   3.8279125450697765`*^9, 3.827913639048354*^9, {3.827914718023213*^9, 
   3.827914730632867*^9}, {3.827914870702771*^9, 3.827914960902944*^9}, {
   3.827915351823187*^9, 3.8279153931428566`*^9}, {3.827915642433074*^9, 
   3.8279156464329634`*^9}, {3.82791627429735*^9, 3.8279163192212067`*^9}, {
   3.827916355209874*^9, 3.827916370600563*^9}, {3.827917825959632*^9, 
   3.8279178423658814`*^9}, {3.827918040476101*^9, 3.827918044022971*^9}, {
   3.8279181179761066`*^9, 3.82791821128867*^9}, {3.827918251788662*^9, 
   3.827918328788662*^9}, {3.8279184441949153`*^9, 3.8279185396011715`*^9}, {
   3.8279186345542946`*^9, 3.82791864131993*^9}, {3.8279194569343395`*^9, 
   3.827919457653086*^9}, {3.828007628885556*^9, 3.8280076434338474`*^9}, {
   3.828007749253744*^9, 3.8280078751287394`*^9}, {3.828008054352151*^9, 
   3.828008069180266*^9}, {3.8280082376977882`*^9, 3.82800860148306*^9}, {
   3.8280086479381714`*^9, 3.828008651016302*^9}, {3.828008723724004*^9, 
   3.8280088660110054`*^9}, {3.828008926760992*^9, 3.8280093348951244`*^9}, {
   3.828009573477728*^9, 3.8280095949621134`*^9}, {3.8280098804844666`*^9, 
   3.828009946828231*^9}, {3.828009994250104*^9, 3.828010006312604*^9}, {
   3.8280100497813463`*^9, 3.8280100658125925`*^9}, {3.8280102095938864`*^9, 
   3.828010220968896*^9}, {3.828010286437642*^9, 3.8280102981876326`*^9}, {
   3.8280104289845123`*^9, 3.8280104612188873`*^9}, {3.8280105411251373`*^9, 
   3.828010667871298*^9}, {3.82801077959798*^9, 3.8280107801292305`*^9}, {
   3.828010919035491*^9, 3.828010952958317*^9}, {3.82804844772398*^9, 
   3.828048455025243*^9}, {3.8280490947247577`*^9, 3.8280491014928956`*^9}, {
   3.8283347921167855`*^9, 3.8283348422773747`*^9}, {3.8283356085788507`*^9, 
   3.8283356762278814`*^9}, {3.8283357193846874`*^9, 
   3.8283357206350765`*^9}, {3.8283359069903383`*^9, 3.828335910564749*^9}, {
   3.8284050988122187`*^9, 3.828405105674838*^9}, {3.828405161364459*^9, 
   3.828405173132292*^9}, {3.8284057004486313`*^9, 3.828405705774969*^9}, {
   3.8284058840786133`*^9, 3.828405895197787*^9}, {3.828406178988365*^9, 
   3.828406179188297*^9}, {3.8284065953612185`*^9, 3.8284066275426598`*^9}, {
   3.828406658493745*^9, 3.8284066720878067`*^9}, {3.828406705927764*^9, 
   3.828406767391438*^9}, {3.8284068701982136`*^9, 3.828406871094491*^9}, {
   3.828406905914282*^9, 3.8284069213375745`*^9}, {3.828407093838346*^9, 
   3.8284070960230455`*^9}, {3.8284072219822025`*^9, 
   3.8284072572474604`*^9}, {3.8284074029942303`*^9, 3.828407431551361*^9}, {
   3.828407771142164*^9, 3.828407771955371*^9}, {3.828407931286438*^9, 
   3.828407997698243*^9}, {3.8284080289012165`*^9, 3.828408047567336*^9}, 
   3.8284081459472895`*^9, {3.8284091606634893`*^9, 3.8284092026975565`*^9}, {
   3.8284092360643215`*^9, 3.828409299543207*^9}, {3.828409645328205*^9, 
   3.8284096470153437`*^9}, 3.8284104947108383`*^9, {3.8284105674692583`*^9, 
   3.82841065933626*^9}, {3.828410726234258*^9, 3.8284107903222494`*^9}, {
   3.82841083106426*^9, 3.8284108336632504`*^9}, {3.8284109386012487`*^9, 
   3.8284109496472483`*^9}, {3.8284109944622617`*^9, 3.828411015127249*^9}, {
   3.8284111857740593`*^9, 3.8284112637016187`*^9}, {3.8284112937912083`*^9, 
   3.828411320087208*^9}, {3.8284113900795603`*^9, 3.8284114495335503`*^9}, {
   3.828411522816216*^9, 3.828411577628216*^9}, {3.8284149339317055`*^9, 
   3.82841493430671*^9}, 3.8284149992172737`*^9, {3.8284366762758217`*^9, 
   3.828436681216711*^9}, {3.828436759726048*^9, 3.8284367755873733`*^9}, {
   3.828436807652364*^9, 3.8284368188164196`*^9}, {3.8284369342234297`*^9, 
   3.828436935595989*^9}, {3.8284370464740257`*^9, 3.8284370588472137`*^9}, 
   3.828437151583248*^9, {3.828437181986457*^9, 3.8284372359951067`*^9}, 
   3.828437451812648*^9, {3.8284377119283333`*^9, 3.8284377326463313`*^9}, {
   3.828437806991333*^9, 3.8284378510863323`*^9}, {3.8284380781833434`*^9, 
   3.8284381947583323`*^9}, {3.828438707743333*^9, 3.828438713790333*^9}, {
   3.828438796107334*^9, 3.8284388049023333`*^9}, {3.8285203769505787`*^9, 
   3.8285204279302626`*^9}, 3.8285205184534707`*^9, {3.828520654747607*^9, 
   3.828520664853598*^9}, 3.8285207315746174`*^9, 3.8287569156916804`*^9, {
   3.828758477195223*^9, 3.8287584775153885`*^9}, {3.8287585606378455`*^9, 
   3.8287586189276147`*^9}, {3.8287586636255884`*^9, 
   3.8287586645655155`*^9}, {3.8287587196575174`*^9, 3.828758737925274*^9}, {
   3.8287587752876277`*^9, 3.8287587755174265`*^9}, {3.8287595652551394`*^9, 
   3.828759616555873*^9}, 3.828760338961844*^9, {3.8294293741559253`*^9, 
   3.829429379235951*^9}, {3.8294340344975643`*^9, 3.8294340690221605`*^9}, {
   3.829434904204796*^9, 3.829434949352758*^9}, {3.8297301092794385`*^9, 
   3.829730140545044*^9}, 3.829730781060157*^9, 3.829731048702461*^9, {
   3.8302989739089756`*^9, 3.8302990014292603`*^9}, {3.8302990947410173`*^9, 
   3.8302991006550846`*^9}, {3.830299244366228*^9, 3.830299249246187*^9}, 
   3.8302993390795903`*^9, {3.830299561541435*^9, 3.830299563139207*^9}, 
   3.830340510819064*^9, {3.830341541182828*^9, 3.8303415415628843`*^9}, {
   3.830341589393078*^9, 3.83034175264839*^9}, 3.830341899988552*^9, {
   3.8303424614368095`*^9, 3.830342485601101*^9}, {3.8309048380244346`*^9, 
   3.8309049067245274`*^9}, {3.8309213201904173`*^9, 3.83092134733004*^9}, {
   3.8309213993803463`*^9, 3.830921399980441*^9}, {3.8309214412300787`*^9, 
   3.83092146427032*^9}, {3.830921505548376*^9, 3.8309215220899634`*^9}, 
   3.8309215817102127`*^9, {3.8309216287152233`*^9, 3.830921637890333*^9}, {
   3.8309476225822287`*^9, 3.8309476338164616`*^9}, {3.8309477980337276`*^9, 
   3.8309478205443945`*^9}, 3.830948429337406*^9, 3.830948536618656*^9, {
   3.830948568728038*^9, 3.83094859572886*^9}, {3.8309486422601023`*^9, 
   3.830948661619489*^9}, {3.8309487134944773`*^9, 3.830948736088661*^9}, {
   3.8309489362008524`*^9, 3.830948946107094*^9}, {3.8309490481852283`*^9, 
   3.830949059403986*^9}, {3.8309492549977245`*^9, 3.830949271294591*^9}, {
   3.8309493579712152`*^9, 3.8309493602837133`*^9}, {3.8309494207084975`*^9, 
   3.8309494771148295`*^9}, {3.8309495361148243`*^9, 3.830949541505448*^9}, {
   3.8309495736929617`*^9, 3.8309496405054474`*^9}, {3.8309499148034906`*^9, 
   3.8309499321785*^9}, 3.8309499812100673`*^9, {3.8309500115382013`*^9, 
   3.8309501195424337`*^9}, {3.830950328533402*^9, 3.830950328799038*^9}, {
   3.8309504088526993`*^9, 3.830950411139549*^9}, {3.8309507072394104`*^9, 
   3.83095070775941*^9}, {3.8309509282641344`*^9, 3.830950932468195*^9}, 
   3.831014826573057*^9, {3.83102868742659*^9, 3.8310286875338182`*^9}, {
   3.831028719731634*^9, 3.8310288508437653`*^9}, {3.8310292222166805`*^9, 
   3.831029223186657*^9}, {3.831029269024783*^9, 3.8310293048463297`*^9}, {
   3.8310293471867056`*^9, 3.831029382015969*^9}, {3.8310294261667013`*^9, 
   3.831029579696822*^9}, {3.831029750416043*^9, 3.8310298665162516`*^9}, {
   3.8310300483061385`*^9, 3.831030072975895*^9}, {3.8310303025861096`*^9, 
   3.8310303357760143`*^9}, {3.831030915036426*^9, 3.8310309501218896`*^9}, {
   3.831031066135521*^9, 3.831031129906371*^9}, 3.831031356536313*^9, {
   3.831031540423958*^9, 3.8310315444712205`*^9}, {3.83103196086119*^9, 
   3.8310320092539015`*^9}, {3.831032092565593*^9, 3.8310321100639725`*^9}, {
   3.8310322155587687`*^9, 3.8310322410664635`*^9}, {3.8310322784847455`*^9, 
   3.83103233050632*^9}, {3.831032364236226*^9, 3.831032378521075*^9}, {
   3.831032434536276*^9, 3.831032509066171*^9}, {3.831032663906209*^9, 
   3.831032688305134*^9}, {3.8310327754365253`*^9, 3.8310327838165383`*^9}, {
   3.8310328254766393`*^9, 3.8310328438161945`*^9}, {3.8310328834161944`*^9, 
   3.831032961776224*^9}, {3.8310332380135903`*^9, 3.8310332465244727`*^9}, {
   3.831033420284458*^9, 3.831033430388455*^9}, {3.8310334658289557`*^9, 
   3.831033472473857*^9}, {3.831033542176526*^9, 3.831033543396283*^9}, 
   3.831033739041902*^9, {3.8310341364697294`*^9, 3.831034172686021*^9}, {
   3.83103422829503*^9, 3.8310342306206484`*^9}, 3.831262232717558*^9, {
   3.831262269070448*^9, 3.831262289977763*^9}, {3.8312623364235067`*^9, 
   3.8312623517407694`*^9}, {3.8312624001235137`*^9, 3.831262452915802*^9}, {
   3.8312629883779125`*^9, 3.8312629911676874`*^9}, {3.8312630237831354`*^9, 
   3.831263040647483*^9}, {3.8312680223474417`*^9, 3.831268060897149*^9}, {
   3.8316777313690643`*^9, 3.8316777343985205`*^9}, {3.8318637657998734`*^9, 
   3.8318637927879753`*^9}, 3.8318643815838184`*^9, {3.831864564783893*^9, 
   3.831864594203931*^9}, {3.831865108424187*^9, 3.831865167464185*^9}, {
   3.8318652013939333`*^9, 3.831865233554014*^9}, {3.833962504338353*^9, 
   3.833962547582133*^9}, {3.833963009299059*^9, 3.833963029328559*^9}, {
   3.83396319352419*^9, 3.8339632206927223`*^9}, {3.833965885496167*^9, 
   3.833965886453918*^9}, {3.8339659350555477`*^9, 3.833965949903954*^9}, {
   3.8339667707638855`*^9, 3.833966788452899*^9}, {3.833967604781613*^9, 
   3.8339676517916126`*^9}, {3.833969285621872*^9, 3.833969316975874*^9}, {
   3.833969582125883*^9, 3.8339695847408743`*^9}, {3.83396990022988*^9, 
   3.8339699058828735`*^9}, {3.8339699784468765`*^9, 
   3.8339699863398733`*^9}, {3.833972613034884*^9, 3.833972644322872*^9}, {
   3.833972839904875*^9, 3.833972863545876*^9}, {3.833972940100874*^9, 
   3.8339729681845737`*^9}, 3.833973016978561*^9, {3.8339730546345625`*^9, 
   3.8339730556525745`*^9}, {3.834180272513849*^9, 3.834180336335994*^9}, {
   3.834180805546956*^9, 3.834180812339955*^9}, {3.834457257887797*^9, 
   3.8344573310596733`*^9}, {3.8344574676356373`*^9, 3.834457467996637*^9}, {
   3.8344576376120844`*^9, 3.8344576482821984`*^9}, {3.834460213821*^9, 
   3.834460215672103*^9}, 3.8346283508222275`*^9, {3.8346283895746064`*^9, 
   3.8346284029610076`*^9}, 3.8346284370614023`*^9, {3.8346327977895436`*^9, 
   3.834632798799369*^9}, {3.8346328440642424`*^9, 3.834632845264633*^9}, {
   3.835242907414958*^9, 3.8352429666850004`*^9}, {3.8364791035191293`*^9, 
   3.8364791121190343`*^9}, {3.83647920253152*^9, 3.8364792036038857`*^9}, {
   3.837837965698539*^9, 3.8378379680020175`*^9}, {3.8378382110275173`*^9, 
   3.8378382123691273`*^9}, {3.8381960890654964`*^9, 3.8381960894090242`*^9}, 
   3.838196171737731*^9, {3.838196247984604*^9, 3.838196253612496*^9}, {
   3.838887523338541*^9, 3.8388875771233654`*^9}, {3.838887624362226*^9, 
   3.838887655556985*^9}, {3.8388892098186026`*^9, 3.838889244194047*^9}, {
   3.838891540789715*^9, 3.838891544365509*^9}, {3.838892674002588*^9, 
   3.8388927518105397`*^9}, {3.838892803126495*^9, 3.8388928756638455`*^9}, {
   3.8388930475408263`*^9, 3.838893058755906*^9}, {3.8388930964436593`*^9, 
   3.8388931431848297`*^9}, {3.838893175499895*^9, 3.838893215866125*^9}, 
   3.838893845317069*^9, 3.838893940671934*^9, {3.838894200894449*^9, 
   3.8388942570408125`*^9}, {3.838894332755803*^9, 3.8388943329476857`*^9}, {
   3.838941180885867*^9, 3.838941194607026*^9}, {3.8389412251394434`*^9, 
   3.838941226837389*^9}, {3.8392805313168406`*^9, 3.839280547482416*^9}, {
   3.8392806874069877`*^9, 3.8392809452520313`*^9}, {3.8392810079104924`*^9, 
   3.83928101055124*^9}, {3.839281089654049*^9, 3.839281163118766*^9}, {
   3.839281239265699*^9, 3.8392812413058434`*^9}, {3.839281425844615*^9, 
   3.839281427944659*^9}, 3.8392815210860915`*^9, {3.839281964145401*^9, 
   3.8392819659280005`*^9}, {3.8392822074073315`*^9, 
   3.8392822080716205`*^9}, {3.839282729827943*^9, 3.8392827557113123`*^9}, {
   3.839282896593066*^9, 3.839282897097958*^9}, {3.839283111736799*^9, 
   3.8392831306866255`*^9}, {3.839283262465818*^9, 3.8392832784952354`*^9}, {
   3.83928420339861*^9, 3.839284224475358*^9}, {3.839284396394966*^9, 
   3.8392844085226*^9}, {3.8392844516223345`*^9, 3.8392844702421885`*^9}, {
   3.8392845558335457`*^9, 3.8392845584913993`*^9}, {3.8392846224409676`*^9, 
   3.839284628860804*^9}, {3.839284674890489*^9, 3.8392846978552947`*^9}, {
   3.8392852121318064`*^9, 3.8392852151814604`*^9}, 3.8392852580466638`*^9, {
   3.839285477495301*^9, 3.839285479184744*^9}, {3.839285678193797*^9, 
   3.8392856976085386`*^9}, {3.839285756387545*^9, 3.839285785183031*^9}, {
   3.851658978203777*^9, 3.851658994940258*^9}, {3.851659126095993*^9, 
   3.851659622122744*^9}, {3.851659776168416*^9, 3.8516599101628704`*^9}, {
   3.851659986489764*^9, 3.8516600124995203`*^9}, {3.85166005248201*^9, 
   3.851660060595397*^9}, {3.8516601313099756`*^9, 3.8516604069253397`*^9}, {
   3.851660482317264*^9, 3.8516604832712617`*^9}, {3.851660887323453*^9, 
   3.8516608901663084`*^9}, {3.8517341400636377`*^9, 3.851734186078158*^9}, {
   3.851734223643094*^9, 3.85173435830378*^9}, {3.8517344200828123`*^9, 
   3.851734472910993*^9}, {3.8517349363695*^9, 3.851734971646268*^9}, {
   3.8517350177415247`*^9, 3.851735104863488*^9}, {3.851735151683819*^9, 
   3.8517352117430077`*^9}, {3.8517353069438043`*^9, 
   3.8517353397954493`*^9}, {3.8517354904365554`*^9, 3.851735561383322*^9}, {
   3.851736070593397*^9, 3.851736105319126*^9}, {3.8517432952231894`*^9, 
   3.851743327325602*^9}, {3.8517434950515137`*^9, 3.8517434954695144`*^9}, {
   3.8517440713349266`*^9, 3.851744075232585*^9}, 3.8517480227824287`*^9, {
   3.851748115684579*^9, 3.851748123175583*^9}, 3.851748218518067*^9, {
   3.851748284162365*^9, 3.851748358822221*^9}, {3.851748391625774*^9, 
   3.8517486061179605`*^9}, {3.851748673340125*^9, 3.851748735689648*^9}, {
   3.8517488229570475`*^9, 3.85174883721066*^9}, {3.8519387674936323`*^9, 
   3.851938767668525*^9}, {3.851940258107381*^9, 3.8519402585091352`*^9}, {
   3.8519402947399745`*^9, 3.851940377746262*^9}, {3.851946340395294*^9, 
   3.85194638382277*^9}, {3.851946477093151*^9, 3.851946563588671*^9}, {
   3.8519466712617035`*^9, 3.8519466882778206`*^9}, {3.851946738077052*^9, 
   3.851946826228301*^9}, 3.851946873052717*^9, {3.851946923411469*^9, 
   3.8519472542320647`*^9}, 3.8519475491628857`*^9, {3.8519849413919263`*^9, 
   3.851984957049289*^9}, {3.852001517456498*^9, 3.8520015509011993`*^9}, {
   3.85200243434173*^9, 3.8520024688293777`*^9}, {3.852003061147726*^9, 
   3.852003074099679*^9}, {3.852004534219987*^9, 3.852004607489092*^9}, {
   3.8520082970798283`*^9, 3.852008307267228*^9}, {3.8540818416427555`*^9, 
   3.854081857122717*^9}, {3.8540818924229403`*^9, 3.854081892602889*^9}, {
   3.8599318563534193`*^9, 3.8599319353334403`*^9}, {3.8599319703592615`*^9, 
   3.859932047793455*^9}, {3.8599321050834837`*^9, 3.8599321154134912`*^9}, 
   3.8599321490735636`*^9, 3.859932990773585*^9, {3.8599330220337305`*^9, 
   3.859933046733574*^9}, {3.8599335174036903`*^9, 3.8599335451936464`*^9}, {
   3.865122271908385*^9, 3.8651222746271276`*^9}, {3.865122378517753*^9, 
   3.8651223860958834`*^9}, 3.865122429705253*^9, {3.8651225482540607`*^9, 
   3.865122657410304*^9}, {3.8651227171603107`*^9, 3.865122778160304*^9}, {
   3.865123148929227*^9, 3.8651232932023582`*^9}, {3.8651233588742285`*^9, 
   3.8651233681086*^9}, {3.8651234497179813`*^9, 3.8651234680929756`*^9}, {
   3.8651242046230936`*^9, 3.8651242126074753`*^9}, {3.8651244893447638`*^9, 
   3.865124491922883*^9}, {3.8651246302967834`*^9, 3.8651246413749027`*^9}, {
   3.8651248838471093`*^9, 3.865124885284616*^9}, {3.865124942463504*^9, 
   3.865124993418477*^9}, {3.865125465319874*^9, 3.8651255279627037`*^9}, {
   3.865125719141808*^9, 3.8651257385930653`*^9}, {3.865126334131736*^9, 
   3.8651263443877373`*^9}, 3.8651264539967237`*^9, {3.86546474902944*^9, 
   3.865464768736432*^9}, {3.8654827408866777`*^9, 3.8654828285760202`*^9}, {
   3.8654833888761053`*^9, 3.8654833933961964`*^9}, {3.865484093594002*^9, 
   3.8654841164539404`*^9}, {3.869287959062497*^9, 3.8692880345388403`*^9}, {
   3.869288076060412*^9, 3.8692881171983852`*^9}, {3.8692881814279604`*^9, 
   3.869288223067765*^9}, {3.869288253155406*^9, 3.8692882618770647`*^9}, {
   3.8692884764527645`*^9, 3.8692884966623898`*^9}, {3.8692885273945723`*^9, 
   3.8692885439404373`*^9}, {3.8692888136673517`*^9, 3.869288880667324*^9}, {
   3.8733425546472316`*^9, 3.8733425678816004`*^9}, {3.875757246963869*^9, 
   3.875757357706275*^9}, {3.8757594395132036`*^9, 3.875759444000308*^9}, {
   3.887260802724476*^9, 3.8872608153676753`*^9}, {3.8872609073875027`*^9, 
   3.8872609226032295`*^9}, {3.8872609562524853`*^9, 
   3.8872610418740244`*^9}, {3.8872610860867677`*^9, 3.8872611335278587`*^9}, 
   3.8890738325792713`*^9, {3.8950732616938667`*^9, 3.8950732617563653`*^9}, {
   3.8955490518555946`*^9, 3.895549051923224*^9}, {3.8983839823857994`*^9, 
   3.8983840203975215`*^9}, {3.8983841520479345`*^9, 
   3.8983841549072256`*^9}, {3.898384329375219*^9, 
   3.898384357374138*^9}},ExpressionUUID->"b3e7bd08-1c18-4283-aced-\
4e7fd0095136"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"(*", " ", 
    StyleBox[
     RowBox[{"Induced", " ", "Christoffel", " ", "Symbol"}],
     FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{"mt_Tensor", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "Metric"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mt", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorType", "\[Rule]", "tt_"}], ")"}], "\[Rule]", 
             "tt"}]}], "]"}], "===", 
          RowBox[{"{", "\"\<Metric\>\"", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "mt", "]"}], "]"}]}], ")"}]}], 
       RowBox[{"(*", 
        RowBox[{"&&", 
         RowBox[{"(", 
          RowBox[{"(*", " ", 
           RowBox[{"check", " ", "same", " ", "dimension"}], " ", "*)"}], 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "&"}], "/@", "ct"}], "]"}], "===", 
           RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}]}], "*)"}], 
       ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "i", ",", "j", ",", "ds2", ",", "si", ",", "op"}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"extract", " ", "old", " ", "coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "extract", " ", "StartIndex", " ", "so", " ", "we", " ", "know", 
           " ", "what", " ", "to", " ", "sum", " ", "over", " ", "below"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{"Cases", "[", 
              RowBox[{"mt", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"StartIndex", "\[Rule]", "mmm_"}], ")"}], "\[Rule]", 
                "mmm"}], ",", "\[Infinity]"}], "]"}], "\[LeftDoubleBracket]", 
             "1", "\[RightDoubleBracket]"}], ",", "True", ",", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "extract", " ", "metric", " ", "in", " ", "the", " ", "form", " ", 
           "of", " ", "coordinate", " ", "differentials"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"ds2", "=", 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"SubMinus", "[", "i", "]"}], ",", 
             RowBox[{"SubMinus", "[", "j", "]"}], ",", "mt"}], "]"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"ds2", "=", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ds2", "\[LeftDoubleBracket]", 
              RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
             RowBox[{"\[DifferentialD]", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], " ", 
             RowBox[{"\[DifferentialD]", 
              RowBox[{
              "coords", "\[LeftDoubleBracket]", "j", 
               "\[RightDoubleBracket]"}]}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", 
              RowBox[{"Length", "[", "coords", "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "1", ",", 
              RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Apply", " ", "CoordinateTransformation"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"op", "=", 
          RowBox[{
          "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"ds2", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"ds2", "/.", 
             RowBox[{"CoordinateTransformation", "[", 
              RowBox[{"ct", ",", "newcoords"}], "]"}]}], ")"}], "//", 
           "op"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"Re", "-", 
           RowBox[{
           "compute", " ", "Metric", " ", "using", " ", "new", " ", 
            "coordinates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"ensure", " ", "new", " ", "coordinates"}], ",", " ", 
           RowBox[{
           "StartIndex", " ", "and", " ", "TensorName", " ", "are", " ", 
            "brought", " ", "over"}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ds2", "=", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SubscriptBox["i", "-"], ",", 
            SubscriptBox["j", "-"], ",", "ds2", ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
            RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "output", " ", "with", " ", "the", " ", "same", " ", "indices"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Christoffel", "[", 
          RowBox[{
           RowBox[{"Sequence", "@@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ",", "ds2"}], 
          "]"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
          RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], ")"}]}]}], ";"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   StyleBox[
    RowBox[{"Coordinate", " ", "transform", " ", "a", " ", "metric"}],
    FontColor->RGBColor[0.5, 0, 0.5]], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", " ", "\[Rule]", " ", 
       RowBox[{"f1", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"y", " ", "\[Rule]", " ", 
       RowBox[{"f2", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      RowBox[{"z", " ", "\[Rule]", " ", 
       RowBox[{"f3", "[", 
        RowBox[{"x", ",", "y", ",", "z", ",", "..."}], "]"}]}], ",", " ", 
      "..."}], "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Modified", " ", 
    RowBox[{"code", ":", " ", 
     RowBox[{"Change", " ", "Indices", " ", "for", " ", "Metric"}]}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{"mt_Tensor", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "Metric"}], " ", "*)"}], 
         RowBox[{"(*", 
          RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "mt", "]"}], "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "mt", "]"}], "]"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"No", " ", "OverHat", " ", "Indices"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "mt", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "i", ",", "j", ",", "ds2", ",", "si", ",", "op", ",", 
         "name", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "StartIndex", " ", "so", " ", "we", " ", "know", " ",
           "what", " ", "to", " ", "sum", " ", "over", " ", "below"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           RowBox[{"StartIndex", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "metric", " ", "in", " ", "the", " ", "form", " ", 
          "of", " ", "coordinate", " ", "differentials"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "i", "]"}], ",", 
            RowBox[{"SubMinus", "[", "j", "]"}], ",", "mt"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ds2", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], " ", 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Apply", " ", "CoordinateTransformation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{
         "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"Change", " ", "Name", " ", "for", " ", "Metric"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           RowBox[{"TensorName", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ds2", "/.", 
            RowBox[{"CoordinateTransformation", "[", "ct", "]"}]}], ")"}], "//",
           "op"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Re", "-", 
          RowBox[{
          "compute", " ", "Metric", " ", "using", " ", "new", " ", 
           "coordinates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "ensure", " ", "the", " ", "StartIndex", " ", "and", " ", 
          "TensorName", " ", "are", " ", "brought", " ", "over"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["i", "-"], ",", 
           SubscriptBox["j", "-"], ",", "ds2", ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ",", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           RowBox[{"TensorName", "\[Rule]", "name"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "with", " ", "the", " ", "same", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Change", " ", "Indices", " ", "for", " ", "Metric"}]}],
          FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Default", " ", "OptionValue", " ", "of", " ", "Indices", " ", "is",
            " ", 
           RowBox[{"{", "}"}]}], ",", " ", 
          RowBox[{
          "whose", " ", "length", " ", "is", " ", "0.", " ", "If", " ", 
           "user", " ", "input", " ", "correctly"}], ",", " ", 
          RowBox[{"change", " ", "it", " ", "for", " ", 
           RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
             "2"}], ")"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"OptionValue", "[", "Indices", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}], ",", 
           "True", ",", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"Indices", "[", "mt", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
             "Null"}], ",", 
            RowBox[{"output", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"TooltipDisplayNoPart", "[", "output", "]"}], "===", 
                 RowBox[{"{", "}"}]}], ")"}], ",", 
               RowBox[{"Append", "[", 
                RowBox[{"output", ",", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
                "]"}], ",", "True", ",", 
               RowBox[{"output", "/.", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TooltipDisplay", "\[Rule]", 
                   RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                  ")"}]}]}]}], "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"TooltipDisplay", "[", 
            RowBox[{"output", ",", 
             RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}]}],
          "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
             RowBox[{"{", 
              RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
            RowBox[{"output", "=", 
             RowBox[{"Which", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"TooltipStyleNoPart", "[", "output", "]"}], "===", 
                 RowBox[{"{", "}"}]}], ")"}], ",", 
               RowBox[{"Append", "[", 
                RowBox[{"output", ",", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], 
                "]"}], ",", "True", ",", 
               RowBox[{"output", "/.", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                 "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{"TooltipStyle", "\[Rule]", 
                   RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                  ")"}]}]}]}], "]"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ")"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"TooltipStyle", "[", 
            RowBox[{"output", ",", 
             RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
         "]"}], ";", "\[IndentingNewLine]", "output"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"Enter", " ", "r"}], " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", " ", "\[Rule]", " ", 
        RowBox[{"f1", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"y", " ", "\[Rule]", " ", 
        RowBox[{"f2", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", 
       RowBox[{"z", " ", "\[Rule]", " ", 
        RowBox[{"f3", "[", 
         RowBox[{
          RowBox[{"x", "'"}], ",", 
          RowBox[{"y", "'"}], ",", 
          RowBox[{"z", "'"}], ",", "..."}], "]"}]}], ",", " ", "..."}], 
      "}"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
     RowBox[{"i", ".", "e", ".", " ", "allow"}], " ", "for", " ", "different",
      " ", "names", " ", "on", " ", "the", " ", "RHS", " ", "than", " ", 
     "the", " ", "previous"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{"mt_Tensor", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "Metric"}], " ", "*)"}], 
         RowBox[{"Quiet", "[", 
          RowBox[{"TestMetricTensor", "[", "mt", "]"}], "]"}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"Sort", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "&"}], "/@", "ct"}], "]"}], "===", 
          RowBox[{"Sort", "[", 
           RowBox[{"Coordinates", "[", "mt", "]"}], "]"}]}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"&&", 
          RowBox[{"(", 
           RowBox[{"(*", " ", 
            RowBox[{"check", " ", "same", " ", "dimension"}], " ", "*)"}], 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
               "&"}], "/@", "ct"}], "]"}], "===", 
            RowBox[{"Length", "[", "newcoords", "]"}]}], ")"}]}], "*)"}], 
        RowBox[{"(*", 
         RowBox[{"No", " ", "OverHat", " ", "Indices"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "mt", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "i", ",", "j", ",", "ds2", ",", "si", ",", "op", ",", 
         "name", ",", "output"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"extract", " ", "old", " ", "coordinates"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "StartIndex", " ", "so", " ", "we", " ", "know", " ",
           "what", " ", "to", " ", "sum", " ", "over", " ", "below"}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           RowBox[{"StartIndex", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "extract", " ", "metric", " ", "in", " ", "the", " ", "form", " ", 
          "of", " ", "coordinate", " ", "differentials"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "i", "]"}], ",", 
            RowBox[{"SubMinus", "[", "j", "]"}], ",", "mt"}], "]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ds2", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}], 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "i", 
              "\[RightDoubleBracket]"}]}], " ", 
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "j", 
              "\[RightDoubleBracket]"}]}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"j", ",", "1", ",", 
             RowBox[{"Length", "[", "coords", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Apply", " ", "CoordinateTransformation"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"op", "=", 
         RowBox[{
         "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"NewCode", ":", " ", 
          RowBox[{"Change", " ", "Name", " ", "for", " ", "Metric"}]}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"(*", 
            RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
           RowBox[{"TensorName", "[", "mt", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"ds2", "/.", 
            RowBox[{"CoordinateTransformation", "[", 
             RowBox[{"ct", ",", "newcoords"}], "]"}]}], ")"}], "//", "op"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Re", "-", 
          RowBox[{
          "compute", " ", "Metric", " ", "using", " ", "new", " ", 
           "coordinates"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"ensure", " ", "new", " ", "coordinates"}], ",", " ", 
          RowBox[{
          "StartIndex", " ", "and", " ", "TensorName", " ", "are", " ", 
           "brought", " ", "over"}]}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ds2", "=", 
         RowBox[{"Metric", "[", 
          RowBox[{
           SubscriptBox["i", "-"], ",", 
           SubscriptBox["j", "-"], ",", "ds2", ",", 
           RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], ",", 
           RowBox[{"StartIndex", "\[Rule]", "si"}], ",", 
           RowBox[{"TensorName", "\[Rule]", "name"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "output", " ", "with", " ", "the", " ", "same", " ", "indices"}], 
         " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"NewCode", ":", " ", 
           RowBox[{"Change", " ", "Indices", " ", "for", " ", "Metric"}]}],
          FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Default", " ", "OptionValue", " ", "of", " ", "Indices", " ", "is",
            " ", 
           RowBox[{"{", "}"}]}], ",", " ", 
          RowBox[{
          "whose", " ", "length", " ", "is", " ", "0.", " ", "If", " ", 
           "user", " ", "input", " ", "correctly"}], ",", " ", 
          RowBox[{"change", " ", "it", " ", "for", " ", 
           RowBox[{"them", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"output", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "2"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"OptionValue", "[", "Indices", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}], ",", 
           "True", ",", 
           RowBox[{"Metric", "[", 
            RowBox[{
             RowBox[{"Sequence", "@@", 
              RowBox[{"Indices", "[", "mt", "]"}]}], ",", "ds2", ",", 
             RowBox[{"TooltipStyle", "\[Rule]", " ", 
              RowBox[{"TooltipStyle", "[", "mt", "]"}]}]}], "]"}]}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "output", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"output", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"output", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"output", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "output", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"output", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"output", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        "output"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"NewCode", ":", " ", 
      RowBox[{"Induced", " ", "Tensor", " ", 
       RowBox[{"(", 
        RowBox[{
        "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}],
         ")"}], " ", "without", " ", "OverHat"}]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
             ")"}]}], "]"}], "===", 
          RowBox[{"{", "}"}]}]}], 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Shouldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"AmbientSpaceMetric_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "AmbientSpaceMetric", "]"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}], "===", 
         RowBox[{"Coordinates", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "t", "]"}]}], ",", "1"}], "]"}], "===", 
         RowBox[{"{", "}"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "lgth", ",", "jacobm", ",", " ", "R", ",", "dlist", 
         ",", "drhs", ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", 
         "newt", ",", "name", ",", "si", ",", "tensorproduct", ",", 
         "allindices", ",", "hyperm", ",", "InvInducedT", ",", "tempidxlist", 
         ",", "Q", ",", "W", ",", "m", ",", "mx", ",", "l", ",", "j", ",", 
         "lowerindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rank",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"number", ":"}],
           FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", 
          RowBox[{"list", "'"}], "s", " ", "length"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Dimension",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[":",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{
          "length", " ", "of", " ", "coordinates", " ", "transformation", " ",
            "list"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["old",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"drhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "newcoords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"R", ":", " ", 
          RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
           RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["n",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "n"}]}], "\[LessEqual]",
           "d"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "drhs", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
           RowBox[{"list", ".", " ", 
            RowBox[{"Search", ":", " ", 
             RowBox[{
             "\"\<Options[CoordinateTransformation]\>\"", 
              "\[IndentingNewLine]", "User", " ", "should", " ", "input", " ",
               "a", " ", "list", " ", 
              RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
              " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
              RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
           StyleBox["new",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
           "idxl"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Make", " ", "it", " ", "become", " ", 
            RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Lower", " ", "all", " ", "indices", " ", "of", " ", "tensor", " ", 
          "\"\<t\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"LowerAllIndices", "[", 
          RowBox[{
           RowBox[{"t", "/.", "ct"}], ",", "AmbientSpaceMetric"}], "]"}]}], 
        ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "Start"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"tensorproduct", "=", 
              RowBox[{"TensorProduct", "[", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"TensorComponents", "[", "newt", "]"}], ")"}], ",",
                   "jacobm"}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
             RowBox[{"allindices", "=", 
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Indices", "[", "newt", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"Unique", "[", "j", "]"}], "-"], ",", 
                  SuperscriptBox[
                   RowBox[{
                    RowBox[{
                    RowBox[{"Indices", "[", "newt", "]"}], 
                    "\[LeftDoubleBracket]", "l", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                   "-"]}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
            ",", 
            RowBox[{"{", 
             RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "End"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "Start"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"mx", "=", 
           RowBox[{"Table", "[", 
            RowBox[{"jacobm", ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"mx", "=", 
           RowBox[{"Prepend", "[", 
            RowBox[{"mx", ",", "m"}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"tensorproduct", "=", 
           RowBox[{"TensorProduct", "[", 
            RowBox[{"Sequence", "@@", "mx"}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allindices", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               SubscriptBox[
                RowBox[{"Unique", "[", "j", "]"}], "-"], ",", 
               SuperscriptBox[
                RowBox[{
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "l", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "-"]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"lowerindices", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox[
              RowBox[{"indices", "\[LeftDoubleBracket]", 
               RowBox[{"l", ",", "1"}], "\[RightDoubleBracket]"}], "-"], ",", 
             RowBox[{"{", 
              RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"allindices", "=", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{"allindices", ",", "lowerindices"}], "]"}], "//", 
            "Flatten"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newt", "=", 
           RowBox[{"newt", "/.", 
            RowBox[{"{", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TensorComponents", "\[Rule]", "tensorproduct"}], 
                ")"}]}]}], "}"}]}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         StyleBox["(*",
          FontColor->RGBColor[0.6, 0.4, 0.2]], 
         StyleBox[
          RowBox[{"Abondoned", " ", 
           RowBox[{"code", ":", " ", "End"}]}],
          FontColor->GrayLevel[0.5]], 
         StyleBox["*)",
          FontColor->RGBColor[0.6, 0.4, 0.2]]}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
         "prepare", " ", "new", " ", "matrix", " ", "and", " ", "indices"}], 
         "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Since", " ", "we", " ", "have", " ", "lower", " ", "all", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "we", " ", "should", " ", "inherit", " ", "the", " ", "indices", 
           " ", "list", " ", "but", " ", "all", " ", 
           RowBox[{"w", "/", " ", 
            StyleBox["SubMinus",
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-"],
            "&"}], "/@", "indices"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"project", " ", "into", " ", "the", " ", 
          RowBox[{"hypersurface", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["\"\<Do\>\"",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["for",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["idxl",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"(", 
             RowBox[{"rank", " ", "number"}], ")"}],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["times",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
            RowBox[{"Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
             RowBox[{"hand", ".", " ", "All"}], " ", "indices", " ", "are", 
             " ", 
             StyleBox["lower",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["indices",
              FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
          RowBox[{"so", " ", "contract", " ", "with", " ", 
           RowBox[{
            StyleBox["Jacobians",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"TensorProduct", " ", "with", " ", "a", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"mx", "=", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"mx", ",", "jacobm"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "Join", " ", "Current", " ", "indices", " ", "list", " ", "with", 
             " ", 
             RowBox[{"Jacobians", "'"}], " ", 
             RowBox[{"indices", "."}]}], "*)"}], 
           RowBox[{"allindices", "=", 
            RowBox[{"Join", "[", 
             RowBox[{
              StyleBox[
               RowBox[{"(", 
                RowBox[{"allindices", "//", "RemoveUnderBarredIndices"}], 
                ")"}], "Code"], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"SubMinus", "[", 
                 RowBox[{"Unique", "[", "j", "]"}], "]"}], ",", 
                RowBox[{"SuperMinus", "[", 
                 RowBox[{
                  RowBox[{
                  "indices", "\[LeftDoubleBracket]", "l", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"Execute", " ", "the", " ", 
             RowBox[{"contraction", ".", " ", "The"}], " ", "inner", " ", 
             "contraction", " ", "will", " ", "be", " ", "taken", " ", "care",
              " ", "by", " ", "code", " ", 
             RowBox[{"here", ":", " ", 
              RowBox[{
              "Search", " ", 
               "\"\<\!\(\*StyleBox[\"Einstein\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"summation\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\":\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"Repeated\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"indices\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"are\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"summed\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"over\",FontColor->RGBColor[0.5, 0, 0.5]]\)\>\"", 
               "\"\<\>"}]}]}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"newt", "=", 
            RowBox[{"newt", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "xxx_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"Indices", "\[Rule]", "allindices"}], ")"}]}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "xxxxx_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], 
              "}"}]}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
            "extract", " ", "the", " ", "new", " ", "tensor", " ", 
             "components"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"mx", "=", 
            RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
           RowBox[{"allindices", "=", 
            RowBox[{"Indices", "[", "newt", "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"l", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"generate", " ", 
          StyleBox["induced",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]], " ", 
          SuperscriptBox["H", "AB"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Recall", " ", "Metric", " ", "coordinate", " ", "transformation", 
          " ", 
          RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"InvInducedT", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"AmbientSpaceMetric", ",", "ct", ",", "newcoords", ",", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["Q", "-"], ",", 
              SuperscriptBox["W", "-"]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Recover", "/", "Raise"}], " ", "those", " ", "indices", 
          " ", "which", " ", "lower", " ", "at", " ", "the", " ", 
          RowBox[{"beginning", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{"newt", ",", "indices", ",", "InvInducedT"}], "]"}]}], ";", 
        " ", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"StartIndex", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["  ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "and", 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["CoordinateSystem",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"newt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
               RowBox[{
               "OptionValue", "[", "CoordinateTransformationOperator", 
                "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"CoordinateSystem", "\[Rule]", "xxxxxx_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], ")"}]}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[RuleDelayed]",
              " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"idx", "//", "RemoveRepeatedUnderBarredIndices"}], 
                ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Final", " ", "output"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        "newt"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    StyleBox[
     RowBox[{"NewCode", ":", " ", 
      RowBox[{"Induced", " ", "Tensor", " ", 
       RowBox[{"(", 
        RowBox[{
        "Other", " ", "than", " ", "Metric", " ", "and", " ", "Christoffel"}],
         ")"}], " ", "with", " ", 
       RowBox[{"OverHat", "."}]}]}],
     FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"t_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"TensorTypeNoPart", "[", "t", "]"}], ",", 
             RowBox[{"(", 
              RowBox[{"\"\<Metric\>\"", "|", "\"\<ChristoffelSymbols\>\""}], 
              ")"}]}], "]"}], "===", 
           RowBox[{"{", "}"}]}], ")"}]}], 
        RowBox[{"(*", 
         RowBox[{"S", 
          RowBox[{"houldn", "'"}], "t", " ", "be", " ", "Metric", " ", "or", 
          " ", "Christoffel"}], "*)"}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"AmbientSpaceMetric_Tensor", "/;", 
         RowBox[{"TestMetricTensor", "[", "AmbientSpaceMetric", "]"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"(*", " ", 
         RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}], "===", 
         RowBox[{"Coordinates", "[", "t", "]"}]}], ")"}], "&&", 
       RowBox[{"!", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "t", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}]}]}], ":=", 
     RowBox[{"Module", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "coords", ",", "lgth", ",", "jacobm", ",", " ", "R", ",", "dlist", 
         ",", "drhs", ",", "lgthrhs", ",", "indices", ",", "idxl", ",", " ", 
         "newt", ",", "name", ",", "si", ",", "tensorproduct", ",", 
         "allindices", ",", "hyperm", ",", "InvInducedT", ",", "tempidxlist", 
         ",", "Q", ",", "W", ",", "m", ",", "mx", ",", "l", ",", "j", ",", 
         "lowerindices"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"indices", "=", 
         RowBox[{"RemoveUnderBarredIndices", "[", 
          RowBox[{"Indices", "[", "t", "]"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Rank",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[
           RowBox[{"number", ":"}],
           FontColor->RGBColor[1, 0, 1]], " ", "indices", " ", 
          RowBox[{"list", "'"}], "s", " ", "length"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"idxl", "=", 
         RowBox[{"Length", "[", "indices", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Dimension",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[":",
           FontColor->RGBColor[1, 0, 1]], " ", 
          RowBox[{
          "length", " ", "of", " ", "coordinates", " ", "transformation", " ",
            "list"}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgth", "=", 
         RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"New", " ", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"length", " ", "of", " ", 
            RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
            RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
            RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
            "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
            "cover", " ", "induced", " ", 
            RowBox[{"tensor", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"lgthrhs", "=", 
         RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Extract", " ", 
          StyleBox["old",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["coordinates",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"coords", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}],
           "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"dlist", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "coords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Generate", " ", "a", " ", 
          StyleBox["list",
           FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
          RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
          " ", 
          RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"drhs", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"\[DifferentialD]", 
            RowBox[{
            "newcoords", "\[LeftDoubleBracket]", "#", 
             "\[RightDoubleBracket]"}]}], "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"R", ":", " ", 
          RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
           RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"R", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["n",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "n"}]}], "\[LessEqual]",
           "d"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"jacobm", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "dlist", "\[LeftDoubleBracket]", "a", "\[RightDoubleBracket]"}],
               "/.", "R"}], ",", 
             RowBox[{
             "drhs", "\[LeftDoubleBracket]", "b", "\[RightDoubleBracket]"}]}],
             "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"a", ",", "1", ",", "lgth"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Default", " ", "value", " ", "is", " ", "a", " ", "null", " ", 
           RowBox[{"list", ".", " ", 
            RowBox[{"Search", ":", " ", 
             RowBox[{
             "\"\<Options[CoordinateTransformation]\>\"", 
              "\[IndentingNewLine]", "User", " ", "should", " ", "input", " ",
               "a", " ", "list", " ", 
              RowBox[{"w", "/", " ", "its"}], " ", "length", " ", "equals", 
              " ", "to", " ", "the", " ", "rank", " ", "of", " ", 
              RowBox[{"tensor", "."}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "If", " ", "user", " ", "input", " ", "a", " ", "proper", " ", 
           StyleBox["new",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["indices",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
           "idxl"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{"Make", " ", "it", " ", "become", " ", 
            RowBox[{"OptionValue", "."}]}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"indices", "=", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Lower", " ", "all", " ", "indices", " ", "of", " ", "tensor", " ", 
          "\"\<t\>\""}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"allindices", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
               RowBox[{"-", "1"}]}], ")"}], ",", 
             SubscriptBox[
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-"], ",", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OverHatSgn", "[", "#", "]"}], "===", 
               RowBox[{"+", "1"}]}], ")"}], ",", "#"}], "]"}], "&"}], "/@", 
          "indices"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{
           RowBox[{"t", "/.", "ct"}], ",", "allindices", ",", 
           "AmbientSpaceMetric"}], "]"}]}], ";", "\[IndentingNewLine]", 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"(*", 
         RowBox[{
         "prepare", " ", "new", " ", "matrix", " ", "and", " ", "indices"}], 
         "*)"}], 
        StyleBox["\[IndentingNewLine]",
         FontColor->RGBColor[0.6, 0.4, 0.2]], 
        RowBox[{"mx", "=", 
         RowBox[{"TensorComponents", "[", "newt", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Since", " ", "we", " ", "have", " ", "lower", " ", "all", " ", 
           "indices"}], ",", " ", 
          RowBox[{
          "we", " ", "should", " ", "inherit", " ", "the", " ", "indices", 
           " ", "list", " ", "but", " ", "all", " ", 
           RowBox[{"w", "/", " ", 
            StyleBox["SubMinus",
             FontColor->RGBColor[1, 0, 1]]}]}]}], "*)"}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"project", " ", "into", " ", "the", " ", 
          RowBox[{"hypersurface", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
           StyleBox["\"\<Do\>\"",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["for",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["idxl",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[
            RowBox[{"(", 
             RowBox[{"rank", " ", "number"}], ")"}],
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["times",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[" ",
             FontColor->RGBColor[1, 0, 1]], "\[IndentingNewLine]", 
            RowBox[{"Contract", " ", "with", " ", "Jacobians", " ", "by", " ", 
             RowBox[{"hand", ".", " ", 
              StyleBox["If",
               FontColor->RGBColor[1, 0, 1]]}], " ", "current", " ", 
             "executed", " ", "index", " ", "is", " ", "an", " ", 
             StyleBox["upper",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox[" ",
              FontColor->RGBColor[1, 0, 1]], 
             StyleBox["index",
              FontColor->RGBColor[1, 0, 1]]}]}]}], ",", " ", 
          RowBox[{"contract", " ", "with", " ", "an", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["Jacobian",
             FontColor->RGBColor[1, 0, 1]], ".", " ", "If"}], " ", 
           RowBox[{"it", "'"}], "s", " ", "a", " ", 
           StyleBox["lower",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["index",
            FontColor->RGBColor[1, 0, 1]]}], ",", " ", 
          RowBox[{"contract", " ", "with", " ", "a", " ", 
           RowBox[{
            StyleBox["Jacobian",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Which", "[", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"If", " ", 
             RowBox[{"it", "'"}], "s", " ", "in", " ", "coordinate", " ", 
             "basis"}], "*)"}], 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"OverHatSgn", "[", 
               RowBox[{
               "indices", "\[LeftDoubleBracket]", "s", 
                "\[RightDoubleBracket]"}], "]"}], "===", 
              RowBox[{"-", "1"}]}], ")"}], ",", "\[IndentingNewLine]", 
            RowBox[{"mx", "=", 
             RowBox[{"Which", "[", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"s", "<", "idxl"}], ",", 
               RowBox[{"Transpose", "[", 
                RowBox[{
                 RowBox[{"TensorContract", "[", 
                  RowBox[{
                   RowBox[{"TensorProduct", "[", 
                    RowBox[{"mx", ",", 
                    RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                    "]"}], ",", 
                   RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{"1", ",", 
                    RowBox[{"s", "-", "1"}]}], "]"}]}], ",", 
                   RowBox[{"Sequence", "@@", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"s", "+", "1"}], ",", "idxl"}], "]"}]}], ",", 
                   "s"}], "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{"Least", " ", "index", " ", 
                 RowBox[{"doesn", "'"}], "t", " ", "need", " ", "a", " ", 
                 RowBox[{"Transpose", "."}]}], "*)"}], 
               RowBox[{"s", "===", "idxl"}], ",", 
               RowBox[{"TensorContract", "[", 
                RowBox[{
                 RowBox[{"TensorProduct", "[", 
                  RowBox[{"mx", ",", 
                   RowBox[{"(*", 
                    RowBox[{"Contract", " ", 
                    RowBox[{"w", "/", 
                    StyleBox[" ",
                    FontColor->RGBColor[1, 0, 1]], 
                    StyleBox["jacobian",
                    FontColor->RGBColor[1, 0, 1]]}]}], "*)"}], "jacobm"}], 
                  "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"{", 
                   RowBox[{"s", ",", 
                    RowBox[{"idxl", "+", "1"}]}], "}"}], "}"}]}], "]"}]}], 
              "]"}]}]}], "\[IndentingNewLine]", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", "1", ",", "idxl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"generate", " ", 
          StyleBox["induced",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["inverse",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["metric",
           FontColor->RGBColor[1, 0, 1]], " ", 
          SuperscriptBox["H", "AB"]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Recall", " ", "Metric", " ", "coordinate", " ", "transformation", 
          " ", 
          RowBox[{"code", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"InvInducedT", "=", 
         RowBox[{"CoordinateTransformation", "[", 
          RowBox[{"AmbientSpaceMetric", ",", "ct", ",", "newcoords", ",", 
           RowBox[{"Indices", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{
              SuperscriptBox["Q", "-"], ",", 
              SuperscriptBox["W", "-"]}], "}"}]}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Recover", "/", "Raise"}], " ", "those", " ", "indices", 
          " ", "which", " ", "lower", " ", "at", " ", "the", " ", 
          RowBox[{"beginning", "."}]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"MoveIndices", "[", 
          RowBox[{
           RowBox[{"newt", "/.", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mmm_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx"}], ")"}]}]}], ",", 
           "indices", ",", "InvInducedT"}], "]"}]}], ";", " ", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"name", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"MatchQ", "[", 
            RowBox[{
             RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
             "_Integer"}], "]"}], ",", 
           RowBox[{"TensorName", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Determine", " ", "the", " ", "output", " ", 
          StyleBox["StartIndex",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"si", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
              "_Integer"}], "]"}]}], ",", 
           RowBox[{"StartIndex", "[", "t", "]"}], ",", "True", ",", 
           RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{
          "Replace", " ", "new", " ", "Tensor", " ", "with", " ", "new", " ", 
           StyleBox["TensorComponents",
            FontColor->RGBColor[1, 0, 1]]}], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[" ",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["TensorName",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox[",",
           FontColor->RGBColor[1, 0, 1]], 
          StyleBox["  ",
           FontColor->RGBColor[1, 0, 1]], 
          RowBox[{
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "and", 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["CoordinateSystem",
             FontColor->RGBColor[1, 0, 1]], "."}]}]}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newt", "=", 
         RowBox[{"newt", "/.", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
             "\[RuleDelayed]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TensorComponents", "\[Rule]", "mx"}], "//", 
               RowBox[{
               "OptionValue", "[", "CoordinateTransformationOperator", 
                "]"}]}], ")"}]}], ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"CoordinateSystem", "\[Rule]", "xxxxxx_"}], ")"}], 
             "\[Rule]", 
             RowBox[{"(", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], ")"}]}], 
            ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[RuleDelayed]",
              " ", 
             RowBox[{"(", 
              RowBox[{"Indices", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"idx", "//", "RemoveRepeatedUnderBarredIndices"}], 
                ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "}"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["TooltipDisplay",
           FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
          StyleBox["TooltipStyle",
           FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
           "Null"}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}]}], 
              "]"}], ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
               "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipDisplay", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
           RowBox[{"{", 
            RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
          RowBox[{"newt", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newt", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newt", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newt", "/.", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
               RowBox[{"(", 
                RowBox[{"TooltipStyle", "\[Rule]", 
                 RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                ")"}]}]}]}], "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         StyleBox[
          RowBox[{"Final", " ", "output"}],
          FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
        "newt"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     StyleBox["NewCode",
      FontColor->RGBColor[0.5, 0, 0.5]], ":", " ", 
     RowBox[{"CoordinateTransformation", " ", "for", " ", 
      StyleBox["Christoffel",
       FontColor->RGBColor[0.5, 0, 0.5]]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"CoordinateTransformation", "[", 
       RowBox[{
        RowBox[{"chr_Tensor", "/;", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{"TensorTypeNoPart", "[", "chr", "]"}], ",", 
            "\"\<ChristoffelSymbols\>\""}], "]"}], "=!=", 
          RowBox[{"{", "}"}]}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"ct", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", 
           RowBox[{"Rule", "[", 
            RowBox[{"_Symbol", ",", "_"}], "]"}], "]"}], "}"}]}], ",", 
        RowBox[{"newcoords", ":", 
         RowBox[{"{", 
          RowBox[{"Repeated", "[", "_Symbol", "]"}], "}"}]}], ",", 
        RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"(*", " ", 
          RowBox[{"check", " ", "same", " ", "coordinates"}], " ", "*)"}], 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}], "===", 
          RowBox[{"Coordinates", "[", "chr", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"RankNumber", "[", "chr", "]"}], "===", "3"}], ")"}], 
        RowBox[{"(*", 
         RowBox[{"No", " ", "OverHat", " ", "Indices"}], "*)"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"OverHatSgn", "[", "#", "]"}], "&"}], "/@", 
             RowBox[{"Indices", "[", "chr", "]"}]}], ",", "1"}], "]"}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coords", ",", "lgth", ",", "jacobm", ",", "jacobT", ",", 
          "invjacobT", ",", "R", ",", "dlist", ",", "drhs", ",", "lgthrhs", 
          ",", "indices", ",", "idxl", ",", "newchr", ",", "name", ",", "si", 
          ",", "cps", ",", "grandom", ",", "DoubleD", ",", "Secondterm", ",", 
          "kk", ",", "Firstterm", ",", "disp", ",", "i", ",", "j", ",", "k", 
          ",", "l", ",", "hessian", ",", "invjacobm"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          StyleBox["Indices",
           FontColor->RGBColor[1, 0, 1]], " ", "of", " ", "input", " ", 
          "Christoffel"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"indices", "=", 
          RowBox[{"RemoveUnderBarredIndices", "[", 
           RowBox[{"Indices", "[", "chr", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["RankNumber",
            FontColor->RGBColor[1, 0, 1]], ":", " ", 
           RowBox[{
            RowBox[{"Christoffel", " ", "is", " ", "a", " ", "rank"}], "-", 
            RowBox[{"3", " ", 
             RowBox[{"array", "."}]}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"idxl", "=", "3"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox[
            RowBox[{"Indices", "."}],
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"OptionValue", "[", "Indices", "]"}], "]"}], "===", 
            "idxl"}], ",", "\[IndentingNewLine]", 
           RowBox[{"indices", "=", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["Dimension",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[":",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{
           "length", " ", "of", " ", "coordinates", " ", "transformation", 
            " ", "list"}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"lgth", "=", 
          RowBox[{"Length", "[", "ct", "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"New", " ", 
           RowBox[{
            StyleBox["Dimension",
             FontColor->RGBColor[1, 0, 1]], 
            StyleBox[":",
             FontColor->RGBColor[1, 0, 1]], " ", 
            RowBox[{"length", " ", "of", " ", 
             RowBox[{"newcoords", ".", " ", "Right"}], " ", "now", " ", 
             RowBox[{"it", "'"}], "s", " ", "might", " ", "be", " ", 
             RowBox[{"redundent", ".", " ", "Since"}], " ", "this", " ", 
             "piece", " ", "of", " ", "code", " ", "do", " ", "not", " ", 
             "cover", " ", "induced", " ", 
             RowBox[{"Christoffel", "."}]}]}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"lgthrhs", "=", 
          RowBox[{"Length", "[", "newcoords", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Extract", " ", 
           StyleBox["old",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["coordinates",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"coords", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "&"}], "/@", "ct"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"coordinates", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"dlist", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "coords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgth"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", "a", " ", 
           StyleBox["list",
            FontColor->RGBColor[1, 0, 1]], " ", "with", " ", 
           RowBox[{"\[DifferentialD]", " ", "in"}], " ", "front", " ", "of", 
           " ", 
           RowBox[{"newcoords", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"drhs", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"\[DifferentialD]", 
             RowBox[{
             "newcoords", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}]}], "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"1", ",", "lgthrhs"}], "]"}]}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"R", ":", " ", 
           RowBox[{"Jacobian", " ", "replacement", " ", "rule", " ", 
            RowBox[{"list", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"R", "=", 
          RowBox[{"CoordinateTransformation", "[", 
           RowBox[{"ct", ",", "newcoords"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["*",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["d",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["matrix",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           RowBox[{
            StyleBox["form",
             FontColor->RGBColor[1, 0, 1]], "."}]}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"jacobm", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Coefficient", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "dlist", "\[LeftDoubleBracket]", "a", 
                "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
              RowBox[{
              "drhs", "\[LeftDoubleBracket]", "b", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
           StyleBox["Tensor",
            FontColor->RGBColor[1, 0, 1]], " ", 
           RowBox[{"object", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"jacobT", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["i", "-"], ",", 
              SuperscriptBox["k", "-"]}], "}"}], ",", "jacobm", ",", 
            "\"\<J\>\"", ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["Hessian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "a", " ", 
           StyleBox["Tensor",
            FontColor->RGBColor[1, 0, 1]], " ", "object", " ", "by", " ", 
           "utilize", " ", 
           RowBox[{
           "\"\<\!\(\*StyleBox[\"PD\",FontColor->RGBColor[1, 0, 1]]\)\>\"", 
            ".", " ", "Search"}], " ", 
           RowBox[{
           "\"\<\!\(\*StyleBox[\"Derivative\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"for\",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\" \",FontColor->RGBColor[0.5, 0, \
0.5]]\)\!\(\*StyleBox[\"Tensor\",FontColor->RGBColor[0.5, 0, 0.5]]\)\>\"", 
            "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"hessian", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"D", "[", 
             RowBox[{"jacobT", ",", 
              RowBox[{
              "newcoords", "\[LeftDoubleBracket]", "\[Sigma]", 
               "\[RightDoubleBracket]"}]}], "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{"\[Sigma]", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
            RowBox[{"Evaluate", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "0", ",", 
                   RowBox[{"lgthrhs", "-", "1"}]}], "}"}], "&"}], "/@", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "k"}], "}"}]}], ")"}]}], "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Generate", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], " ", "as", " ", "d", "*", "d", " ",
            "matrix", " ", 
           RowBox[{"form", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"invjacobm", "=", 
          RowBox[{"Inverse", "[", "jacobm", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Contract", " ", 
           StyleBox["inverse",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["Jacobian",
            FontColor->RGBColor[1, 0, 1]], "  ", "and", " ", 
           StyleBox["Hessian",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], "by", " ", 
           RowBox[{"hand", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Secondterm", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              SubscriptBox["k", "-"], ",", 
              SuperscriptBox["l", "-"], ",", 
              SubscriptBox["j", "-"], ",", 
              SubscriptBox["i", "-"], ",", 
              SuperscriptBox["k", "-"]}], "}"}], ",", 
            RowBox[{"TensorProduct", "[", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"{", 
               RowBox[{"invjacobm", ",", "hessian"}], "}"}]}], "]"}], ",", 
            "\"\<S\>\"", ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "Start"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"grandom", "=", 
            RowBox[{"Metric", "[", 
             RowBox[{
              SubscriptBox["i", "-"], ",", 
              SubscriptBox["j", "-"], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"KroneckerDelta", "[", 
                 RowBox[{"row", ",", "col"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"row", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"col", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}], 
              ",", 
              RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{"jacobm", "=", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"Coefficient", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "dlist", "\[LeftDoubleBracket]", "a", 
                  "\[RightDoubleBracket]"}], "/.", "R"}], ",", 
                RowBox[{
                "drhs", "\[LeftDoubleBracket]", "b", 
                 "\[RightDoubleBracket]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"b", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"a", ",", "1", ",", "lgth"}], "}"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"jacobT", "[", 
             RowBox[{"i_", ",", "k_"}], "]"}], "=", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["i", "-"], ",", 
                SuperscriptBox["k", "-"]}], "}"}], ",", "jacobm", ",", 
              "\"\<J\>\"", ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"invjacobT", "[", 
             RowBox[{"k_", ",", "l_"}], "]"}], "=", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                SubscriptBox["k", "-"], ",", 
                SuperscriptBox["l", "-"]}], "}"}], ",", 
              RowBox[{"Inverse", "[", "jacobm", "]"}], ",", 
              "\"\<\!\(\*SuperscriptBox[\(J\), \(-1\)]\)\>\"", ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}]}], "]"}]}],
            ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"DoubleD", "[", "k_", "]"}], "=", 
            RowBox[{"PartialD", "[", 
             RowBox[{
              RowBox[{
              "indices", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{"jacobT", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                 "indices", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], ",", "k"}], "]"}], ",", 
              "grandom"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"Secondterm", "=", 
            RowBox[{"SwapIndices", "[", 
             RowBox[{
              RowBox[{"TensorsProduct", "[", 
               RowBox[{
                RowBox[{"DoubleD", "[", "kk", "]"}], " ", 
                RowBox[{"invjacobT", "[", 
                 RowBox[{"kk", ",", 
                  RowBox[{
                   RowBox[{
                   "indices", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", 
              "indices"}], "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          StyleBox["(*",
           FontColor->RGBColor[0.6, 0.4, 0.2]], 
          StyleBox[
           RowBox[{"Abondoned", " ", 
            RowBox[{"code", ":", " ", "End"}]}],
           FontColor->GrayLevel[0.5]], 
          StyleBox["*)",
           FontColor->RGBColor[0.6, 0.4, 0.2]]}], "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "The", " ", "first", " ", "term", " ", "is", " ", "the", " ", "one",
            " ", "transform", " ", "like", " ", "a", " ", "normal", " ", 
           RowBox[{"tensor", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Firstterm", "=", 
          RowBox[{"CoordinateTransformation", "[", 
           RowBox[{
            RowBox[{"chr", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
               "TensorType", "\[Rule]", "\"\<ChristoffelSymbols\>\""}], ")"}],
               "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorType", "\[Rule]", "Null"}], ")"}]}]}], ",", 
            "ct", ",", "newcoords", ",", 
            RowBox[{"Indices", "\[Rule]", "indices"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Sum", " ", "them", " ", 
           RowBox[{"up", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"cps", "=", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"Firstterm", "+", "Secondterm"}], "]"}], "//", 
           RowBox[{
           "OptionValue", "[", "CoordinateTransformationOperator", "]"}]}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TensorName",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"name", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"MatchQ", "[", 
             RowBox[{
              RowBox[{"OptionValue", "[", "TensorName", "]"}], ",", 
              "_Integer"}], "]"}], ",", 
            RowBox[{"TensorName", "[", "chr", "]"}], ",", "True", ",", 
            RowBox[{"OptionValue", "[", "TensorName", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["StartIndex",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"si", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"MatchQ", "[", 
              RowBox[{
               RowBox[{"OptionValue", "[", "StartIndex", "]"}], ",", 
               "_Integer"}], "]"}]}], ",", 
            RowBox[{"StartIndex", "[", "chr", "]"}], ",", "True", ",", 
            RowBox[{"OptionValue", "[", "StartIndex", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Determine", " ", "the", " ", "output", " ", 
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"disp", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<\[CapitalGamma]\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "newcoords", "\[LeftDoubleBracket]", "\[Mu]s", 
                    "\[RightDoubleBracket]"}], ",", "Null"}], "}"}], "]"}], 
                  ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"Null", ",", 
                    RowBox[{
                    "newcoords", "\[LeftDoubleBracket]", "\[Alpha]s", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"Null", ",", 
                    RowBox[{
                    "newcoords", "\[LeftDoubleBracket]", "\[Beta]s", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], "}"}], "]"}],
                "\[Rule]", 
               RowBox[{"cps", "\[LeftDoubleBracket]", 
                RowBox[{"\[Mu]s", ",", "\[Alpha]s", ",", "\[Beta]s"}], 
                "\[RightDoubleBracket]"}]}], ")"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Mu]s", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Alpha]s", ",", "1", ",", "lgthrhs"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Beta]s", ",", "1", ",", "lgthrhs"}], "}"}]}], "]"}], 
           "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Only", " ", "display", " ", 
           StyleBox["nonzero",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox[" ",
            FontColor->RGBColor[1, 0, 1]], 
           StyleBox["components",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"disp", "=", 
          RowBox[{"Select", "[", 
           RowBox[{"disp", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Flatten", "[", 
                 RowBox[{"Cases", "[", 
                  RowBox[{
                   RowBox[{"{", "#", "}"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Row", "[", "__", "]"}], "\[Rule]", "cc_"}], 
                    ")"}], "\[Rule]", "cc"}]}], "]"}], "]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "=!=",
                "0"}], ")"}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Inherit", " ", "old", " ", "chr", " ", "array", " ", "and", " ", 
           "replace", " ", 
           RowBox[{"w", "/", " ", "new"}], " ", 
           RowBox[{"property", "."}]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"newchr", "=", 
          RowBox[{"chr", "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorName", "\[Rule]", "name"}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "st_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"StartIndex", "\[Rule]", "si"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TensorComponents", "\[Rule]", "cps"}], ")"}]}], ",", 
             " ", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"CoordinateSystem", "\[Rule]", "coords"}], ")"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"CoordinateSystem", "\[Rule]", "newcoords"}], ")"}]}], 
             ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "idx_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"Indices", "\[Rule]", "indices"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "dp_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TooltipDisplay", "\[Rule]", "disp"}], ")"}]}]}], 
            "\[IndentingNewLine]", "}"}]}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           StyleBox["TooltipDisplay",
            FontColor->RGBColor[1, 0, 1]], " ", "and", " ", 
           StyleBox["TooltipStyle",
            FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipDisplayNoPart", "[", "newchr", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newchr", ",", 
               RowBox[{"TooltipDisplay", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newchr", "=", 
              RowBox[{"newchr", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", "td_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipDisplay", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
                 ")"}]}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
           RowBox[{"newchr", "=", 
            RowBox[{"newchr", "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], "\[Rule]", 
              RowBox[{"(", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
               ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", 
             RowBox[{"(*", "Small", "*)"}], "}"}]}], ",", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"TooltipStyleNoPart", "[", "newchr", "]"}], "===", 
               RowBox[{"{", "}"}]}], ")"}], ",", 
             RowBox[{"Append", "[", 
              RowBox[{"newchr", ",", 
               RowBox[{"TooltipStyle", "\[Rule]", 
                RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}]}], "]"}], 
             ",", "True", ",", 
             RowBox[{"newchr", "=", 
              RowBox[{"newchr", "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", "tts_"}], ")"}], 
                "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TooltipStyle", "\[Rule]", 
                  RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], 
                 ")"}]}]}]}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          StyleBox[
           RowBox[{"Final", " ", "output"}],
           FontColor->RGBColor[1, 0, 1]], "*)"}], "\[IndentingNewLine]", 
         "newchr"}]}], "\[IndentingNewLine]", "]"}], 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "check", " ", "if", " ", "user", " ", "input", " ", "new", " ", 
         "indices", " ", "list"}], ",", " ", 
        RowBox[{"they", " ", "are", " ", 
         RowBox[{"proper", ".", " ", "Or"}], " ", "it", " ", "should", " ", 
         "be", " ", "default", " ", "one", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Null", " ", "list"}], ")"}], "."}]}]}], "*)"}], "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"OptionValue", "[", "Indices", "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"Indices", "[", "chr", "]"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
           RowBox[{"OptionValue", "[", "Indices", "]"}]}], "===", 
          RowBox[{"{", "}"}]}], ")"}]}], ")"}]}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.5766860372595043`*^9, 3.5766861748361464`*^9}, {
   3.576686207081403*^9, 3.5766862542090855`*^9}, {3.5766863122567873`*^9, 
   3.576686315220793*^9}, {3.5857176653762712`*^9, 3.5857176751106887`*^9}, {
   3.61152555817948*^9, 3.611525594725541*^9}, {3.6115257192804546`*^9, 
   3.611525732531658*^9}, {3.611525762862624*^9, 3.611525785828477*^9}, {
   3.6115259642452183`*^9, 3.6115259702438107`*^9}, 3.611526048675515*^9, {
   3.611526127082219*^9, 3.6115261313572855`*^9}, {3.6115263381834626`*^9, 
   3.611526346402089*^9}, {3.6115264737210445`*^9, 3.611526481127158*^9}, {
   3.631213472477243*^9, 3.6312135552955914`*^9}, {3.791373775114976*^9, 
   3.791373800937765*^9}, {3.791373845939101*^9, 3.7913738521218815`*^9}, {
   3.791373883418435*^9, 3.7913739122953753`*^9}, {3.791374077604042*^9, 
   3.7913740859229364`*^9}, {3.7913742842108393`*^9, 3.791374381056077*^9}, {
   3.7913744440610085`*^9, 3.7913744524976625`*^9}, {3.7913745766614137`*^9, 
   3.7913746033916826`*^9}, {3.7913750795520983`*^9, 
   3.7913751275068636`*^9}, {3.791375169984248*^9, 3.7913754744698925`*^9}, {
   3.791375549255173*^9, 3.7913755893242836`*^9}, {3.7913757000156403`*^9, 
   3.7913757849045725`*^9}, {3.791375822180374*^9, 3.791375833831088*^9}, {
   3.7913760032939596`*^9, 3.791376022463707*^9}, {3.791376152831176*^9, 
   3.791376173181718*^9}, {3.791376312073864*^9, 3.791376393969635*^9}, {
   3.791376761430072*^9, 3.791376766372392*^9}, {3.791376823485746*^9, 
   3.791376823721032*^9}, {3.7913769724436283`*^9, 3.7913769730038176`*^9}, {
   3.791377007726359*^9, 3.791377034933732*^9}, {3.791378096082344*^9, 
   3.791378121287795*^9}, {3.791378351938716*^9, 3.7913784424713683`*^9}, {
   3.813531869316082*^9, 3.8135318754866095`*^9}, {3.8135321987328243`*^9, 
   3.8135322688580503`*^9}, {3.813532612839867*^9, 3.813532641067562*^9}, {
   3.8302991722508783`*^9, 3.8302991971752295`*^9}, {3.831262773437828*^9, 
   3.8312627946575546`*^9}, {3.831262885929614*^9, 3.83126295941741*^9}, {
   3.8312630445574408`*^9, 3.8312630452274733`*^9}, {3.831263269887483*^9, 
   3.8312632746378884`*^9}, {3.831263900667856*^9, 3.83126392199778*^9}, {
   3.8312640000175867`*^9, 3.831264019377539*^9}, {3.8312642944556017`*^9, 
   3.83126429756776*^9}, {3.8312651495381556`*^9, 3.831265271938054*^9}, {
   3.8312653524080353`*^9, 3.831265390347721*^9}, {3.8312654470632105`*^9, 
   3.831265453538062*^9}, {3.8312655604847045`*^9, 3.831265632828084*^9}, {
   3.831265677608101*^9, 3.8312657207479196`*^9}, 3.8312658567079782`*^9, {
   3.8312659127557898`*^9, 3.8312659306872306`*^9}, {3.83126599174815*^9, 
   3.831266061408039*^9}, {3.8312661524553366`*^9, 3.8312661614747543`*^9}, 
   3.831266266595829*^9, {3.8312664417517304`*^9, 3.831266452901108*^9}, {
   3.8312665496405935`*^9, 3.8312665504586477`*^9}, 3.831267667876541*^9, {
   3.831267817266686*^9, 3.831267850897955*^9}, {3.831268008162943*^9, 
   3.83126800840481*^9}, {3.831268070797202*^9, 3.8312680939423895`*^9}, {
   3.8316769466830792`*^9, 3.831676948680995*^9}, {3.8316773995174656`*^9, 
   3.83167740797581*^9}, 3.832239670727999*^9, 3.832240540193565*^9, {
   3.83397304067356*^9, 3.8339730627705727`*^9}, {3.8339739546125712`*^9, 
   3.8339739683865705`*^9}, {3.833974013848563*^9, 3.833974029292571*^9}, {
   3.8339746251335607`*^9, 3.83397463138557*^9}, {3.8339747355895615`*^9, 
   3.8339747481965604`*^9}, {3.833974859509572*^9, 3.8339748636765604`*^9}, {
   3.8339749020545645`*^9, 3.8339749137625713`*^9}, 3.834180361240376*^9, {
   3.8341804215463667`*^9, 3.8341804826634245`*^9}, {3.834180643074933*^9, 
   3.834180791744959*^9}, 3.8344569848822765`*^9, {3.834461959265718*^9, 
   3.834461980551714*^9}, {3.8344623632354026`*^9, 3.8344623726371145`*^9}, {
   3.834632805079589*^9, 3.834632805369529*^9}, {3.8346328506516705`*^9, 
   3.8346328515892024`*^9}, 3.8346409452956944`*^9, 3.8346410073811364`*^9, {
   3.8346410402057204`*^9, 3.8346411198162208`*^9}, {3.834641164386244*^9, 
   3.834641208056117*^9}, {3.8346413387079678`*^9, 3.834641365438099*^9}, {
   3.8346415043608437`*^9, 3.8346416707958107`*^9}, {3.8346417024758277`*^9, 
   3.834641729106323*^9}, 3.8346417784985933`*^9, {3.8346420553885183`*^9, 
   3.834642059735894*^9}, {3.834642163215891*^9, 3.8346421857950325`*^9}, 
   3.8346422969459443`*^9, 3.8346424544659023`*^9, {3.834642527595927*^9, 
   3.8346425677759295`*^9}, {3.834642621335927*^9, 3.834642660466186*^9}, {
   3.8346427619559884`*^9, 3.8346428423142495`*^9}, {3.8346429206659594`*^9, 
   3.834642982155967*^9}, {3.834643051771033*^9, 3.834643075138304*^9}, {
   3.83464312169599*^9, 3.8346431570861025`*^9}, {3.8346431900060205`*^9, 
   3.8346431943361645`*^9}, {3.8346432511965218`*^9, 
   3.8346433281061287`*^9}, {3.834643423366362*^9, 3.8346434247560844`*^9}, {
   3.8346435017661133`*^9, 3.834643502226549*^9}, {3.8346436921211205`*^9, 
   3.8346436957065125`*^9}, {3.834643758258899*^9, 3.8346437778384132`*^9}, {
   3.834643910946554*^9, 3.8346439332361393`*^9}, {3.8346441239361553`*^9, 
   3.834644134182126*^9}, {3.8346441643466015`*^9, 3.8346441816164074`*^9}, 
   3.8346442578064933`*^9, {3.834644330146165*^9, 3.834644385886299*^9}, {
   3.8346444260361595`*^9, 3.8346444799887905`*^9}, {3.834644540926159*^9, 
   3.834644560236623*^9}, {3.834644603531491*^9, 3.8346446064156685`*^9}, {
   3.8346447991466894`*^9, 3.83464481476143*^9}, {3.834644855491501*^9, 
   3.8346448875466967`*^9}, {3.8346449296262236`*^9, 3.834644983426652*^9}, {
   3.834645153303463*^9, 3.8346451571989517`*^9}, {3.83464525774662*^9, 
   3.834645292972023*^9}, {3.834659316768429*^9, 3.834659324768429*^9}, {
   3.834659626472149*^9, 3.8346596282221365`*^9}, {3.8346596803940134`*^9, 
   3.834659743581521*^9}, {3.8346615976567926`*^9, 3.8346616108914986`*^9}, {
   3.8346623758241253`*^9, 3.8346623779143295`*^9}, {3.83466275668042*^9, 
   3.834662764132884*^9}, {3.834662872991097*^9, 3.834662886644603*^9}, {
   3.8346630353970356`*^9, 3.834663040064489*^9}, {3.834663154236847*^9, 
   3.834663156172061*^9}, {3.8346632002709827`*^9, 3.83466321623462*^9}, {
   3.8346633478489656`*^9, 3.8346635616846848`*^9}, {3.8346636246446304`*^9, 
   3.834663698516676*^9}, {3.834663809844703*^9, 3.8346638125045633`*^9}, {
   3.8346639922043304`*^9, 3.834664020231512*^9}, {3.834664053594386*^9, 
   3.834664057514188*^9}, {3.8346641299422474`*^9, 3.8346641355602026`*^9}, {
   3.834664279721854*^9, 3.834664280311626*^9}, {3.83466432149695*^9, 
   3.834664321671835*^9}, {3.834664382531965*^9, 3.8346644399022274`*^9}, {
   3.834664501002262*^9, 3.834664534621837*^9}, 3.8346645888022785`*^9, {
   3.834664667584591*^9, 3.8346646739109936`*^9}, 3.8346647186123285`*^9, {
   3.8346649361019945`*^9, 3.83466494293187*^9}, {3.835230876615305*^9, 
   3.8352308812053065`*^9}, {3.8352312426263385`*^9, 3.835231263599336*^9}, 
   3.83523274359801*^9, 3.8352355385790834`*^9, {3.835236122579385*^9, 
   3.8352361380815697`*^9}, 3.8352408516950192`*^9, {3.835241002024505*^9, 
   3.8352410219647503`*^9}, {3.8352410761647573`*^9, 
   3.8352411025269384`*^9}, {3.835241721204963*^9, 3.835241775414659*^9}, {
   3.8352418324448214`*^9, 3.8352418352346992`*^9}, {3.8352418690216584`*^9, 
   3.8352418916046104`*^9}, {3.8352430574647636`*^9, 3.835243133425039*^9}, {
   3.8352431855587187`*^9, 3.835243205214796*^9}, {3.835243410115445*^9, 
   3.835243449774908*^9}, 3.8352436927148457`*^9, {3.835260427327055*^9, 
   3.8352604593310194`*^9}, {3.836478841347335*^9, 3.836478844105544*^9}, {
   3.8364792695423393`*^9, 3.8364792729594707`*^9}, {3.836479438933189*^9, 
   3.8364794439554005`*^9}, {3.836528590183087*^9, 3.836528596458969*^9}, {
   3.8365292101953654`*^9, 3.8365292104563646`*^9}, {3.8365293059976087`*^9, 
   3.836529310161163*^9}, {3.837835229956184*^9, 3.837835291611537*^9}, {
   3.8378378536207695`*^9, 3.8378378598553658`*^9}, 3.8378379187679663`*^9, {
   3.8378383971560125`*^9, 3.8378384055885706`*^9}, 3.8381787595840764`*^9, {
   3.8381792461695576`*^9, 3.8381792526642027`*^9}, 3.8381821502569027`*^9, {
   3.838196329220991*^9, 3.838196366412893*^9}, {3.8381964728524733`*^9, 
   3.8381965193576775`*^9}, {3.838196562572216*^9, 3.8381966226125317`*^9}, {
   3.8381967179027476`*^9, 3.83819680095301*^9}, {3.838941430833702*^9, 
   3.838941433273188*^9}, {3.8389414736534853`*^9, 3.838941480219411*^9}, {
   3.8389415643949904`*^9, 3.8389415836430416`*^9}, {3.8389416516763315`*^9, 
   3.8389416520422907`*^9}, {3.8389417464591*^9, 3.8389417470229487`*^9}, {
   3.838941782078619*^9, 3.838941799560769*^9}, 3.8389418582413216`*^9, {
   3.8389418908555727`*^9, 3.8389419098786163`*^9}, 3.8389419625588913`*^9, {
   3.8389420072221684`*^9, 3.838942023059643*^9}, 3.838942118839542*^9, {
   3.8389422875808764`*^9, 3.838942292656728*^9}, {3.838942465955798*^9, 
   3.8389425497289095`*^9}, {3.8519474446226397`*^9, 3.8519474689081783`*^9}, 
   3.851947657755291*^9, {3.8519846352386665`*^9, 3.8519846504732904`*^9}, {
   3.8519847173031654`*^9, 3.8519847746268835`*^9}, {3.851984835806229*^9, 
   3.8519848594586744`*^9}, {3.8519849207816105`*^9, 
   3.8519849222547064`*^9}, {3.851984987345701*^9, 3.851984991797963*^9}, {
   3.8519854168016357`*^9, 3.8519854176181335`*^9}, {3.851985619818688*^9, 
   3.8519856584009404`*^9}, {3.8519857933984814`*^9, 3.85198586818945*^9}, {
   3.851995440082447*^9, 3.8519954402625957`*^9}, {3.8520003550651927`*^9, 
   3.85200037884506*^9}, {3.852000444985998*^9, 3.852000592147633*^9}, {
   3.852001260268153*^9, 3.852001288840613*^9}, {3.852001567651076*^9, 
   3.85200159708597*^9}, {3.8520016281553907`*^9, 3.852001660087246*^9}, {
   3.8520020262326803`*^9, 3.85200207164746*^9}, {3.8520021532818995`*^9, 
   3.85200215977687*^9}, {3.852002257110978*^9, 3.852002258781122*^9}, {
   3.852002335670207*^9, 3.8520023650950546`*^9}, {3.852002472854662*^9, 
   3.8520024931294746`*^9}, {3.852002543898943*^9, 3.8520026758379354`*^9}, 
   3.8520029504156837`*^9, {3.852003038920529*^9, 3.852003039155536*^9}, {
   3.852003221413771*^9, 3.852003222193513*^9}, {3.852003688801026*^9, 
   3.852003689245734*^9}, {3.8520044834370694`*^9, 3.8520044913399096`*^9}, 
   3.852004596473931*^9, {3.8520047513625917`*^9, 3.8520047559426823`*^9}, {
   3.8520050416464043`*^9, 3.852005076571128*^9}, 3.852005561627511*^9, {
   3.8520056939379826`*^9, 3.85200570949446*^9}, {3.8520057759692173`*^9, 
   3.85200577937274*^9}, {3.852005878800118*^9, 3.852005896778963*^9}, 
   3.852005953033114*^9, {3.8520069260281925`*^9, 3.8520069884478393`*^9}, {
   3.85200724148831*^9, 3.8520072447824845`*^9}, {3.8520073030263815`*^9, 
   3.8520073903808427`*^9}, {3.8520074509227095`*^9, 
   3.8520074608742204`*^9}, {3.8520075627756796`*^9, 
   3.8520075846790094`*^9}, {3.852007700012619*^9, 3.8520077082539425`*^9}, {
   3.8520077475205393`*^9, 3.8520078049219666`*^9}, {3.8520078940324287`*^9, 
   3.852007925193779*^9}, {3.8520081917401185`*^9, 3.852008307599712*^9}, {
   3.852008391974231*^9, 3.852008580979924*^9}, {3.8520086147662163`*^9, 
   3.8520087190369277`*^9}, 3.8532183413869658`*^9, {3.854079284182682*^9, 
   3.854079380952521*^9}, {3.854079428922762*^9, 3.8540794425223026`*^9}, {
   3.854079477872908*^9, 3.8540795416323805`*^9}, {3.8540795809028273`*^9, 
   3.8540795852125497`*^9}, {3.854079661622464*^9, 3.8540796849325013`*^9}, {
   3.8540797521427517`*^9, 3.8540797862127934`*^9}, {3.854080214244691*^9, 
   3.8540802199065905`*^9}, {3.85408067567531*^9, 3.8540806886427865`*^9}, {
   3.8540808393914876`*^9, 3.8540808514728518`*^9}, {3.85408096824259*^9, 
   3.8540809785825105`*^9}, {3.854081014292982*^9, 3.8540810210983295`*^9}, {
   3.8540822468311057`*^9, 3.8540822475411277`*^9}, {3.8540822854510555`*^9, 
   3.8540823107010717`*^9}, {3.859932162165827*^9, 3.8599322481655917`*^9}, {
   3.8599330632035866`*^9, 3.859933103363799*^9}, {3.859933456912382*^9, 
   3.8599334804736323`*^9}, 3.8599335112639112`*^9, {3.8651224726271276`*^9, 
   3.8651224881896367`*^9}, {3.8655603232181425`*^9, 
   3.8655603449357166`*^9}, {3.866757276796852*^9, 3.866757284230239*^9}, {
   3.8667573251342516`*^9, 3.866757331830942*^9}, 3.8667600594699836`*^9, {
   3.8667600928889527`*^9, 3.8667600941940765`*^9}, 3.8667602550662622`*^9, {
   3.866760315970516*^9, 3.8667603168734627`*^9}, 3.866760351739221*^9, {
   3.866760553766507*^9, 3.866760553896491*^9}, {3.8667607644698286`*^9, 
   3.8667608162114105`*^9}, {3.866761021201997*^9, 3.8667610384894876`*^9}, {
   3.8667612539089365`*^9, 3.866761269138236*^9}, {3.8667613114839106`*^9, 
   3.8667613175460825`*^9}, {3.8667613727309275`*^9, 3.866761374335284*^9}, {
   3.866761478381152*^9, 3.8667614914684916`*^9}, {3.8667615582659807`*^9, 
   3.86676156164209*^9}, {3.866762028965324*^9, 3.8667621232927685`*^9}, {
   3.8667622020437737`*^9, 3.866762204580702*^9}, 3.866762792618925*^9, {
   3.8667628278761187`*^9, 3.8667628601315174`*^9}, {3.8673079628872156`*^9, 
   3.8673080458647776`*^9}, {3.867310107723305*^9, 3.8673101225724306`*^9}, {
   3.8673101568780828`*^9, 3.8673101570459766`*^9}, {3.867310202514511*^9, 
   3.867310209903311*^9}, 3.867310245339754*^9, 3.8673110459173374`*^9, {
   3.8757573654731493`*^9, 3.8757578106694517`*^9}, {3.875759448173336*^9, 
   3.8757594699397273`*^9}, 3.887259797022865*^9, 3.887259938599162*^9, 
   3.8872600205346575`*^9, {3.8872601135883245`*^9, 3.887260114738619*^9}, {
   3.887260292224229*^9, 3.88726031661516*^9}, {3.8872604715338783`*^9, 
   3.887260503120411*^9}, {3.8872623528139877`*^9, 3.8872623549576654`*^9}, {
   3.88726240196175*^9, 3.887262402917159*^9}, {3.8872624611122932`*^9, 
   3.8872624630760784`*^9}, 3.895073261787615*^9, 3.8955490520311565`*^9, {
   3.895555172541506*^9, 3.8955551726204605`*^9}, {3.8972547247446156`*^9, 
   3.8972547320403323`*^9}, {3.8972547730623674`*^9, 3.897254776630147*^9}, {
   3.897276987865556*^9, 3.8972769941306562`*^9}, {3.8972770382582183`*^9, 
   3.8972771216973343`*^9}, {3.8972773002156973`*^9, 3.897277300549489*^9}, {
   3.897277363197585*^9, 3.8972773924232583`*^9}, {3.897277525575749*^9, 
   3.8972775270988054`*^9}, {3.898384401869528*^9, 
   3.8983844158430395`*^9}},ExpressionUUID->"af284ae8-289c-4c91-bc16-\
2f323eb155c6"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorIsZero", "Subsection",
 CellChangeTimes->{{3.521765238359375*^9, 3.52176525215625*^9}, 
   3.521765347328125*^9, {3.533880012946951*^9, 3.5338800148345547`*^9}, {
   3.5760890087086353`*^9, 3.5760890111890397`*^9}, {3.583789536600904*^9, 
   3.583789562445382*^9}, {3.583789592737115*^9, 3.583789617611538*^9}, {
   3.629763445553209*^9, 
   3.629763458802249*^9}},ExpressionUUID->"a00f9896-4f06-4a88-8e52-\
0ee43a61bd0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "TensorIsZero", " ", "returns", " ", "True", " ", "if", " ", "every", " ", 
    "component", " ", "of", " ", "the", " ", "input", " ", "Tensor", " ", 
    "is", " ", "zero", " ", "and", " ", "False", " ", "otherwise"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", 
    StyleBox[
     RowBox[{"TensorIsZero", " ", "Pattern"}],
     FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TensorIsZero", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"stuff_Tensor", "|", "stuff_Times", "|", "stuff_Plus"}], 
         ")"}], "/;", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "stuffop", ",", "stuffopTorF", ",", "TIZop", ",", "TIZopTorF", ",", 
         RowBox[{"tensorcomp", "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"TensorComponents", "[", "stuff", "]"}], "]"}]}]}], "}"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"stuffop", "=", 
         RowBox[{"TensorOperator", "[", 
          RowBox[{
           RowBox[{"Cases", "[", 
            RowBox[{
             RowBox[{"{", "stuff", "}"}], ",", 
             RowBox[{"Tensor", "[", "___", "]"}], ",", "Infinity"}], "]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "]"}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
          "Simplify", " ", "or", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
          "Simplify"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"stuffopTorF", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"stuffop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
           "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"TIZop", "=", 
         RowBox[{"OptionValue", "[", "TensorIsZeroOperator", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
          "Simplify", " ", "or", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
          RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
          "Simplify"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"TIZopTorF", "=", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TIZop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
           "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"non", "-", "scalar"}], " ", "*)"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Head", "[", "tensorcomp", "]"}], "===", "List"}], ")"}], 
          ",", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "True"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Union", "[", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Flatten", "[", "tensorcomp", "]"}], "//", "TIZop"}],
                 ")"}], "]"}], ",", "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "False"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "True"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Union", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Flatten", "[", "tensorcomp", "]"}], "//", 
                   "stuffop"}], ")"}], "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "False"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Union", "[", 
                 RowBox[{"Simplify", "[", 
                  RowBox[{"Flatten", "[", "tensorcomp", "]"}], "]"}], "]"}]}],
                "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], 
            "===", 
            RowBox[{"{", "0", "}"}]}], ")"}], ",", "\[IndentingNewLine]", 
          "True", ",", 
          RowBox[{"(", 
           RowBox[{"(*", " ", 
            RowBox[{"scalar", " ", "case"}], " ", "*)"}], 
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "True"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Simplify", "[", 
               RowBox[{"tensorcomp", ",", "TIZop"}], "]"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"(", 
               RowBox[{"TIZopTorF", "===", "False"}], ")"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "True"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"tensorcomp", "//", "stuffop"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"(", 
                 RowBox[{"stuffopTorF", "===", "False"}], ")"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"Simplify", "[", "tensorcomp", "]"}]}], 
               "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], "===",
             "0"}], ")"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     StyleBox[
      RowBox[{"TensorIsZero", " ", "for", " ", "List"}],
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Now", " ", "we", " ", "allow", " ", "it", " ", "to", " ", "input", " ", 
     "a", " ", 
     StyleBox["List",
      FontColor->RGBColor[1, 0, 1]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorIsZero", "[", 
      RowBox[{"stuff_List", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Flatten", "[", "stuff", "]"}], "//", 
          RowBox[{"OptionValue", "[", "TensorIsZeroOperator", "]"}]}], ")"}], 
        "]"}], "===", 
       RowBox[{"{", "0", "}"}]}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"NewCode", ":", " ", 
     StyleBox[
      RowBox[{"TensorIsZero", " ", "for", " ", "ExpressionForm"}],
      FontColor->RGBColor[0.5, 0, 0.5]]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorIsZero", "[", 
      RowBox[{
       RowBox[{"stuff_", "/;", 
        RowBox[{"TestExpressionForm", "[", "stuff", "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"stuff", "//", 
         RowBox[{"OptionValue", "[", "TensorIsZeroOperator", "]"}]}], ")"}], "===",
        "0"}], ")"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.521765262109375*^9, 3.52176533240625*^9}, {
   3.5338800168001575`*^9, 3.533880034708989*^9}, {3.5760890361958838`*^9, 
   3.5760892921299334`*^9}, {3.576089327198795*^9, 3.5760893665108643`*^9}, {
   3.5760894467730045`*^9, 3.576089487177076*^9}, {3.576089599746874*^9, 
   3.576089794357215*^9}, {3.5760898355568876`*^9, 3.576089917379031*^9}, {
   3.576089953181094*^9, 3.576090082318121*^9}, {3.576560147053269*^9, 
   3.5765603514136276`*^9}, {3.5765603906008964`*^9, 3.576560411879334*^9}, {
   3.5765604668226304`*^9, 3.576560468913034*^9}, {3.5765932405918536`*^9, 
   3.576593241668256*^9}, {3.5765932876571364`*^9, 3.576593294365148*^9}, {
   3.576593413472658*^9, 3.5765934397421603`*^9}, {3.5837895835345883`*^9, 
   3.5837896999162455`*^9}, {3.583789732961135*^9, 3.5837897641899214`*^9}, {
   3.5837898029911404`*^9, 3.583789812347676*^9}, {3.5837898853688526`*^9, 
   3.583789939647957*^9}, {3.629763483304508*^9, 3.629763563401334*^9}, {
   3.6326179475223174`*^9, 3.6326179682978544`*^9}, {3.6326188774302964`*^9, 
   3.632618942045817*^9}, {3.844900612864136*^9, 3.8449006410808396`*^9}, {
   3.844900830504729*^9, 3.844900834935007*^9}, {3.844900933070919*^9, 
   3.8449009335186443`*^9}, {3.845519758647561*^9, 3.8455197656636577`*^9}, {
   3.8552692108635197`*^9, 3.8552692359430957`*^9}, {3.869789450147613*^9, 
   3.8697894649601*^9}, {3.8697897648047676`*^9, 3.8697898113081326`*^9}, {
   3.877048249565341*^9, 3.877048249940361*^9}, {3.8847714439909678`*^9, 
   3.884771463526497*^9}, {3.8865696363752375`*^9, 3.8865696456015406`*^9}, {
   3.8865709348867865`*^9, 3.8865709493098817`*^9}, {3.886571029011668*^9, 
   3.8865711098433933`*^9}, {3.8865711415568123`*^9, 3.886571221987591*^9}, {
   3.8865712792427473`*^9, 3.886571306594387*^9}, {3.8865713371215377`*^9, 
   3.8865714251931553`*^9}, {3.8865716577922697`*^9, 
   3.8865716593503084`*^9}, {3.8865717229593024`*^9, 3.886571732413467*^9}, {
   3.8865717736060305`*^9, 3.886571776470789*^9}, {3.886571821174187*^9, 
   3.8865718263649797`*^9}, {3.8865718581323643`*^9, 
   3.8865721163794327`*^9}, {3.8865721517885704`*^9, 3.886572211297825*^9}, {
   3.886572488928479*^9, 3.8865724895910697`*^9}, {3.8865726869268227`*^9, 
   3.886572699405741*^9}, {3.8865728198130307`*^9, 3.886572823013053*^9}, 
   3.8865728757325*^9, {3.8865729178195143`*^9, 3.8865729881391706`*^9}, {
   3.886573172602474*^9, 3.886573172865312*^9}, {3.886573299311857*^9, 
   3.8865733886803017`*^9}, 3.8865736908089437`*^9, {3.8865737656012077`*^9, 
   3.8865737730276213`*^9}, {3.8865738297164164`*^9, 3.8865738360195265`*^9}, 
   3.8865742829090977`*^9, {3.8865746463813815`*^9, 3.886574658755741*^9}, {
   3.8865749416487617`*^9, 3.8865749551124516`*^9}, {3.8867346888245454`*^9, 
   3.886734688843537*^9}, {3.8867377505656157`*^9, 3.886737849562188*^9}, {
   3.8867385640730906`*^9, 3.886738583824981*^9}, {3.8867386222324376`*^9, 
   3.8867386781277514`*^9}, {3.8867388690413775`*^9, 3.886738954774979*^9}, {
   3.886738990838873*^9, 3.8867390072857904`*^9}, 3.8867397517307873`*^9, 
   3.886739840287139*^9, 3.88673999530371*^9, 3.8867400476224427`*^9, {
   3.8869078564161425`*^9, 3.886907897012661*^9}, {3.887112625403908*^9, 
   3.8871126262901936`*^9}, {3.88711302324362*^9, 3.8871130307036085`*^9}, {
   3.895555838564371*^9, 
   3.8955558385673685`*^9}},ExpressionUUID->"2f5af4b6-2f92-465b-ae16-\
6ac60fd229f1"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorEquations", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
  3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
  3.7277791595451746`*^9, 3.7277791625376096`*^9}, {3.727779261292117*^9, 
  3.7277792645777283`*^9}, {3.8494974093622155`*^9, 
  3.8494974165099134`*^9}},ExpressionUUID->"bbfd1ab0-1e50-42bd-8f51-\
869014502f0a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   StyleBox[
    RowBox[{"NewCode", ":", " ", "TensorEquations"}],
    FontColor->RGBColor[0.5, 0, 0.5]], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TensorEquations", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"t_Tensor", "|", "t_Times", "|", "t_Plus"}], ")"}], ",", 
        "0"}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "*)"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "head", " ", "is", " ", "Times", " ", "or", " ", "Plus"}], 
        ",", " ", 
        RowBox[{
        "there", " ", "should", " ", "be", " ", "Tensor", " ", "inside", " ", 
         "it"}]}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "t", "]"}]}], ")"}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"comp", "=", 
         RowBox[{"Normal", "[", 
          RowBox[{"TensorComponents", "[", "t", "]"}], "]"}]}], "}"}], ",", 
       RowBox[{"(*", "DeleteDuplicates", "*)"}], 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "comp", "]"}], "=!=", "List"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{"comp", "\[Equal]", "0"}], ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Head", "[", "comp", "]"}], "===", "List"}], ")"}], ",", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}], "/@", 
            RowBox[{"Flatten", "[", "comp", "]"}]}], "]"}], "/.", 
          RowBox[{"(*", 
           RowBox[{"Remove", " ", "redundent", " ", "True", " ", 
            RowBox[{"result", "."}]}], "*)"}], 
          RowBox[{"True", "\[Rule]", "Nothing"}]}]}], "]"}]}], "]"}]}], ";"}],
    "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"TensorEquations", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"LHSt_Tensor", "|", "LHSt_Times", "|", "LHSt_Plus"}], ")"}], 
        ",", 
        RowBox[{"(", 
         RowBox[{"RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus"}], 
         ")"}]}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "*)"}], "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "LHSt", "]"}]}], ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{"!", 
         RowBox[{"TestExpressionForm", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"LHScomp", "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"TensorComponents", "[", "LHSt", "]"}], "]"}]}], ",", 
         RowBox[{"RHScomp", "=", 
          RowBox[{"Normal", "[", 
           RowBox[{"TensorComponents", "[", "RHSt", "]"}], "]"}]}], ",", 
         "EqLHSmRHSm"}], "}"}], ",", 
       RowBox[{"Quiet", "[", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHScomp", "]"}], "=!=", "List"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHScomp", "]"}], "=!=", "List"}], ")"}]}], 
          ",", 
          RowBox[{"(", 
           RowBox[{"LHScomp", "\[Equal]", "RHScomp"}], ")"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHScomp", "]"}], "===", "List"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHScomp", "]"}], "===", "List"}], ")"}]}], 
          ",", 
          RowBox[{
           RowBox[{"EqLHSmRHSm", "=", 
            RowBox[{"Equal", "[", 
             RowBox[{"LHScomp", ",", "RHScomp"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"EqLHSmRHSm", "===", "True"}], ")"}], ",", "True", ",", 
             RowBox[{"(", 
              RowBox[{"EqLHSmRHSm", "===", "False"}], ")"}], ",", "False", 
             ",", "True", ",", 
             RowBox[{
              RowBox[{"DeleteDuplicates", "[", 
               RowBox[{"Thread", "[", 
                RowBox[{"Flatten", "/@", "EqLHSmRHSm"}], "]"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"True", "\[Rule]", "Nothing"}], "}"}]}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
      RowBox[{"(*", 
       RowBox[{"/.", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", "Nothing", "]"}], "\[Rule]", " ", 
          RowBox[{"{", "}"}]}], ")"}]}], "*)"}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\n", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"TensorEquations", "[", 
       RowBox[{"t_", ",", "0"}], 
       RowBox[{"(*", 
        RowBox[{",", 
         RowBox[{"opts", ":", 
          RowBox[{"OptionsPattern", "[", "]"}]}]}], "*)"}], "]"}], "/;", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{
        "If", " ", "head", " ", "is", " ", "Times", " ", "or", " ", "Plus"}], 
        ",", " ", 
        RowBox[{
        "there", " ", "should", " ", "be", " ", "Tensor", " ", "inside", " ", 
         "it"}]}], "*)"}], 
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "t", "]"}], ")"}]}], ":=", 
     RowBox[{"(", 
      RowBox[{"t", "\[Equal]", "0"}], ")"}]}], "*)"}], "\n", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"TensorEquations", "[", 
      RowBox[{"LHSt_", ",", "RHSt_"}], 
      RowBox[{"(*", 
       RowBox[{",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "*)"}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "LHSt", "]"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"TestExpressionForm", "[", "RHSt", "]"}], ")"}]}]}], ":=", 
    RowBox[{"(", 
     RowBox[{"LHSt", "\[Equal]", "RHSt"}], ")"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TensorEquations", "[", 
        RowBox[{"LHSt_Tensor", ",", "RHSt_Tensor"}], "]"}], "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "LHSt", "]"}], "]"}]}], ")"}], "===", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Sgn", "[", "#", "]"}], "&"}], "/@", 
            RowBox[{"RemoveUnderBarredIndices", "[", 
             RowBox[{"Indices", "[", "RHSt", "]"}], "]"}]}], ")"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Coordinates", "[", "LHSt", "]"}], "===", 
          RowBox[{"Coordinates", "[", "RHSt", "]"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Dimensions", "[", "LHSt", "]"}], "===", 
          RowBox[{"Dimensions", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rank", ",", "eqnlist"}], "}"}], ",", 
        RowBox[{
         RowBox[{"rank", "=", 
          RowBox[{"RankNumber", "[", "LHSt", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"eqnlist", "=", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "LHSt", "]"}], "==", 
            RowBox[{"TensorComponents", "[", "RHSt", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"eqnlist", "=", 
            RowBox[{"(", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Thread", "[", "#", "]"}], "&"}], ")"}], ",", 
                "eqnlist"}], "]"}], "]"}], ")"}]}], ",", 
           RowBox[{"rank", "-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", "eqnlist", "]"}], "/.", 
          RowBox[{"True", "\[Rule]", "Nothing"}]}]}]}], "\[IndentingNewLine]",
        "]"}]}], ";"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TensorEquations", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"LHSt_Tensor", "|", "LHSt_Times", "|", "LHSt_Plus"}], ")"}],
          ",", 
         RowBox[{"(", 
          RowBox[{"RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus"}], 
          ")"}]}], "]"}], "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"LHSt", ",", 
            RowBox[{"Tensor", "[", "___", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"RHSt", ",", 
            RowBox[{"Tensor", "[", "___", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "\[NotEqual]", 
          RowBox[{"{", "}"}]}], ")"}]}]}], ":=", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"rank", ",", "eqnlist"}], "}"}], ",", 
        RowBox[{
         RowBox[{"rank", "=", 
          RowBox[{"RankNumber", "[", 
           RowBox[{"First", "[", 
            RowBox[{"Cases", "[", 
             RowBox[{"LHSt", ",", 
              RowBox[{"Tensor", "[", "___", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "Infinity"}], "}"}]}], "]"}], "]"}], "]"}]}],
          ";", "\[IndentingNewLine]", 
         RowBox[{"eqnlist", "=", 
          RowBox[{"Thread", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", "LHSt", "]"}], "==", 
            RowBox[{"TensorComponents", "[", "RHSt", "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"eqnlist", "=", 
            RowBox[{"(", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Map", "[", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Thread", "[", "#", "]"}], "&"}], ")"}], ",", 
                "eqnlist"}], "]"}], "]"}], ")"}]}], ",", 
           RowBox[{"rank", "-", "1"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"DeleteDuplicates", "[", "eqnlist", "]"}], "/.", 
          RowBox[{"True", "\[Rule]", "Nothing"}]}]}]}], "\[IndentingNewLine]",
        "]"}]}], ";"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.7277838546352525`*^9, 
   3.727783858169075*^9}, {3.727787467829364*^9, 3.727787495938246*^9}, {
   3.7277875756934986`*^9, 3.7277875792397604`*^9}, {3.7277876707418776`*^9, 
   3.72778770219399*^9}, {3.7277877584258285`*^9, 3.7277877915109577`*^9}, {
   3.7277878424043903`*^9, 3.7277878811264715`*^9}, 3.7277879383036757`*^9, {
   3.727788719881564*^9, 3.7277888261798315`*^9}, {3.727788912849109*^9, 
   3.7277889371845922`*^9}, {3.7277897311974845`*^9, 3.727789744827913*^9}, {
   3.7277899581351657`*^9, 3.7277900115452623`*^9}, {3.727790077297223*^9, 
   3.727790118143917*^9}, {3.7277904370689335`*^9, 3.72779068173335*^9}, {
   3.727790720372624*^9, 3.727790938406535*^9}, {3.7277909992197423`*^9, 
   3.7277910652090855`*^9}, {3.727791099381648*^9, 3.727791151586588*^9}, {
   3.72779119753117*^9, 3.727791333775207*^9}, {3.7277913649255753`*^9, 
   3.7277913932071843`*^9}, {3.727791440834066*^9, 3.727791443680626*^9}, {
   3.7277914802625117`*^9, 3.7277914963036475`*^9}, {3.727791596706025*^9, 
   3.727791632429778*^9}, {3.727791703379794*^9, 3.7277917697057447`*^9}, {
   3.7277921266899767`*^9, 3.727792128011541*^9}, {3.727836859594427*^9, 
   3.7278369493787804`*^9}, {3.727837606489853*^9, 3.727837664283385*^9}, {
   3.8407724493806095`*^9, 3.8407724507755156`*^9}, {3.840772521269809*^9, 
   3.840772561838919*^9}, 3.8407726113251805`*^9, {3.8407728203563204`*^9, 
   3.84077282884037*^9}, 3.840843520814411*^9, {3.84084355110458*^9, 
   3.840843606524502*^9}, 3.840843761720167*^9, 3.841219815037341*^9, {
   3.8412199088308015`*^9, 3.8412199564753337`*^9}, 3.8412200195293245`*^9, {
   3.8412200801236506`*^9, 3.8412201213506517`*^9}, {3.841220183972626*^9, 
   3.8412202704844627`*^9}, 3.841220343688476*^9, {3.841220471045478*^9, 
   3.8412204903984747`*^9}, {3.841220529820326*^9, 3.841220567276322*^9}, {
   3.8412206264934783`*^9, 3.8412206932614803`*^9}, {3.841220740020477*^9, 
   3.84122080573448*^9}, {3.841220850295054*^9, 3.841220894031576*^9}, {
   3.841220976430519*^9, 3.841221021565101*^9}, {3.8412212208717117`*^9, 
   3.8412212232887144`*^9}, {3.8412213151185365`*^9, 3.841221324693531*^9}, {
   3.841221715926469*^9, 3.8412217329239254`*^9}, {3.8412218195935717`*^9, 
   3.8412218202325735`*^9}, {3.841226222717462*^9, 3.8412262692575893`*^9}, {
   3.8412263374674025`*^9, 3.8412263447273617`*^9}, {3.841226450257053*^9, 
   3.841226452257242*^9}, {3.841226547637249*^9, 3.841226551347434*^9}, {
   3.8412267888636456`*^9, 3.8412268012802477`*^9}, {3.841226840088232*^9, 
   3.8412268426033783`*^9}, {3.841374778582284*^9, 3.8413748016048827`*^9}, {
   3.8413753509883113`*^9, 3.84137537446701*^9}, {3.8413754110980825`*^9, 
   3.8413754476306753`*^9}, {3.841375509218422*^9, 3.841375509386316*^9}, {
   3.8420741494651003`*^9, 3.8420741518869762`*^9}, {3.8430836490387526`*^9, 
   3.8430836892697897`*^9}, {3.8430840639774747`*^9, 3.843084097224845*^9}, {
   3.843084254078519*^9, 3.843084260616461*^9}, {3.843086139184486*^9, 
   3.843086144770327*^9}, 3.843086184585873*^9, {3.843086217684342*^9, 
   3.843086243060648*^9}, {3.8430863073994794`*^9, 3.843086324017996*^9}, {
   3.843086532412168*^9, 3.8430867154697385`*^9}, {3.8430867910647645`*^9, 
   3.843086797299054*^9}, {3.843087303135919*^9, 3.843087311531622*^9}, {
   3.8430876200860806`*^9, 3.843087626335846*^9}, {3.8430876717690125`*^9, 
   3.843087676128538*^9}, {3.8436218755549107`*^9, 3.843621884625325*^9}, {
   3.843953052171285*^9, 3.8439531331712875`*^9}, 3.8439531721087875`*^9, {
   3.843953210718161*^9, 3.843953242780662*^9}, {3.843953634960122*^9, 
   3.8439537080877857`*^9}, {3.8439537473534126`*^9, 
   3.8439539996823697`*^9}, {3.843954491581495*^9, 3.8439544928621845`*^9}, {
   3.8439545398116083`*^9, 3.8439545756232285`*^9}, {3.8439546084683695`*^9, 
   3.843954608765242*^9}, 3.8439546695440016`*^9, {3.8442942786848307`*^9, 
   3.8442942986589727`*^9}, {3.8442946485304184`*^9, 
   3.8442946507184362`*^9}, {3.8442948322958527`*^9, 3.8442948760817065`*^9}, 
   3.8494974055819693`*^9, {3.8494974439011073`*^9, 3.849497469232937*^9}, 
   3.849498807918336*^9, {3.8494989041605053`*^9, 3.849498917006427*^9}, 
   3.8494994869228063`*^9, {3.8495224371441317`*^9, 3.8495224556921625`*^9}, {
   3.8495240820795927`*^9, 3.8495240913336377`*^9}, {3.8495256785111856`*^9, 
   3.8495257730866847`*^9}, {3.849525804563687*^9, 3.849525818832687*^9}, {
   3.8495751243561454`*^9, 3.849575175020314*^9}, {3.8495761199604163`*^9, 
   3.849576149146634*^9}, {3.849576180096719*^9, 3.8495761805374513`*^9}, {
   3.8495762325623136`*^9, 3.8495763337605724`*^9}, {3.8495765806739206`*^9, 
   3.849576581809227*^9}, 3.8495768444806547`*^9, 3.849576932488044*^9, {
   3.8495779369829893`*^9, 3.8495779514302177`*^9}, {3.849578014197403*^9, 
   3.849578014895976*^9}, {3.8495784173706245`*^9, 3.849578426658496*^9}, 
   3.8496746816447744`*^9, {3.850114684456916*^9, 3.8501146891472316`*^9}, {
   3.850114744147259*^9, 3.850114778206957*^9}, {3.8501148339673586`*^9, 
   3.850114866230935*^9}, {3.8552860224834337`*^9, 3.8552861155461764`*^9}, {
   3.875758119064145*^9, 3.8757581534635124`*^9}, {3.8847700925418625`*^9, 
   3.8847700969157248`*^9}, {3.8847701892682724`*^9, 3.88477018993957*^9}, {
   3.884770625948062*^9, 3.8847707575311513`*^9}, {3.8853754990368237`*^9, 
   3.8853755164340982`*^9}, 3.88542507241416*^9, 3.8854254808705816`*^9, {
   3.8870270881831913`*^9, 3.887027094090424*^9}, {3.8871202027756996`*^9, 
   3.8871202327426343`*^9}, {3.8915848179678693`*^9, 
   3.8915848469271636`*^9}, {3.8915849087498255`*^9, 
   3.8915849234387784`*^9}, {3.8915849964233656`*^9, 3.891585045885871*^9}, 
   3.891585336959988*^9, {3.891586855025494*^9, 3.891586871288495*^9}, 
   3.8920087263740225`*^9, {3.895555838573365*^9, 3.895555838588356*^9}, {
   3.8974394851866407`*^9, 3.89743952209593*^9}, {3.8974395788959775`*^9, 
   3.8974395881512833`*^9}, {3.8974398779739237`*^9, 
   3.8974398895659885`*^9}, {3.897439927918388*^9, 
   3.89743993972712*^9}},ExpressionUUID->"6bd51a80-bab0-48e3-b098-\
59a9caf39d3f"]
}, Closed]],

Cell[CellGroupData[{

Cell["TensorDivision", "Subsection",
 CellChangeTimes->{{3.8871119254294667`*^9, 
  3.887111926352727*^9}},ExpressionUUID->"8a45d202-28be-4482-b50b-\
e26fefc3992b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "TensorDivision"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"TensorDivision", "[", 
      RowBox[{"(*", 
       RowBox[{"LHS", " ", "is", " ", 
        RowBox[{"numerator", "."}]}], "*)"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"LHSt_Tensor", "|", "LHSt_Times", "|", "LHSt_Plus"}], ")"}], 
       ",", 
       RowBox[{"(*", 
        RowBox[{"RHS", " ", "is", " ", 
         RowBox[{"denominator", "."}]}], "*)"}], 
       RowBox[{"(", 
        RowBox[{"RHSt_Tensor", "|", "RHSt_Times", "|", "RHSt_Plus"}], ")"}], 
       ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "LHSt", "]"}]}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{"!", 
        RowBox[{"TestExpressionForm", "[", "RHSt", "]"}]}], ")"}]}]}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "stuffop", ",", "stuffopTorF", ",", "TDop", ",", "TDopTorF", ",", "op",
         ",", "LHScomp", ",", "RHScomp", ",", "NonTrivialcompN", ",", 
        "EquilityList", ",", "\[Kappa]", ",", "solnst", ",", "solns", ",", 
        "solnsFlatten", ",", "solnsUnion", ",", "soln", ",", 
        RowBox[{"LHSttemp", "=", "LHSt"}], ",", 
        RowBox[{"RHSttemp", "=", "RHSt"}], ",", 
        RowBox[{"rank", "=", 
         RowBox[{"RankNumber", "[", "LHSt", "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHSt", "]"}], "===", "Times"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "LHSt", "]"}], "===", "Plus"}], ")"}]}], 
          ")"}], ",", 
         RowBox[{"LHSttemp", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{"LHSt", ",", " ", "Tensor"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHSt", "]"}], "===", "Times"}], ")"}], "||", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Head", "[", "RHSt", "]"}], "===", "Plus"}], ")"}]}], 
          ")"}], ",", 
         RowBox[{"RHSttemp", "=", 
          RowBox[{"TensorsProduct", "[", 
           RowBox[{"RHSt", ",", " ", "Tensor"}], "]"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"stuffop", "=", 
        RowBox[{"TensorOperator", "[", "LHSttemp", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
         "Simplify", " ", "or", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
         "Simplify"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"stuffopTorF", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"stuffop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
          "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"TDop", "=", 
        RowBox[{"OptionValue", "[", "TensorDivisionOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"stuff", "'"}], "s", " ", "TensorOperator", " ", "is", " ", 
         "Simplify", " ", "or", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "True"}], " ", "for", " ", "not", " ", 
         RowBox[{"Simplify", ".", " ", "False"}], " ", "for", " ", 
         "Simplify"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"TDopTorF", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"TDop", "=!=", "Simplify"}], ")"}], ",", "True", ",", 
          "True", ",", "False"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"op", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
         "TDopTorF", ",", "TDop", ",", "stuffopTorF", ",", "stuffop", ",", 
          "True", ",", "TDop"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"LHScomp", "=", 
        RowBox[{
         RowBox[{"LHSttemp", "//", "TensorComponents"}], "//", "op"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"RHScomp", "=", 
        RowBox[{
         RowBox[{"RHSttemp", "//", "TensorComponents"}], "//", "op"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ComponentRankNumber", "[", "LHScomp", "]"}], "=!=", "0"}],
           ")"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"NonTrivialcompN", "=", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Flatten", "[", "LHScomp", "]"}], ")"}], "/.", 
             RowBox[{"{", 
              RowBox[{"0", "\[Rule]", "Nothing"}], "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"EquilityList", "=", 
           RowBox[{"MapThread", "[", 
            RowBox[{"Equal", ",", 
             RowBox[{"{", 
              RowBox[{"LHScomp", ",", 
               RowBox[{"\[Kappa]", " ", "RHScomp"}]}], "}"}], ",", "rank"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"solnst", "=", 
           RowBox[{"Map", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"Solve", "[", 
               RowBox[{"#", ",", "\[Kappa]"}], "]"}], "&"}], ",", 
             "EquilityList", ",", 
             RowBox[{"{", "rank", "}"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solns", "=", 
           RowBox[{"solnst", "//", "op"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"solnsFlatten", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Flatten", "[", 
              RowBox[{
               RowBox[{"solns", "/.", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"{", "}"}], "}"}], "->", 
                  RowBox[{"{", 
                   RowBox[{
                   "{", " ", "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", 
                    "}"}], "}"}]}], ")"}]}], ",", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"rank", "+", "2"}]}], "}"}]}], "]"}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"{", "}"}], "\[Rule]", "\[Infinity]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"\[Kappa]", "\[Rule]", "soln___"}], "}"}], 
               "\[RuleDelayed]", " ", "soln"}]}], "}"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"solnsUnion", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"solnsFlatten", "//", "Flatten"}], ")"}], "//", 
              "Union"}], ")"}], "/.", 
            RowBox[{
            "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", "\[Rule]", " ", 
             "Nothing"}]}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"solnsFlatten", "//", "Flatten"}], ")"}], "/.", 
                   RowBox[{
                   "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", "\[Rule]", 
                    " ", "Nothing"}]}], ")"}], "]"}], "===", 
                "NonTrivialcompN"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Length", "[", "solnsUnion", "]"}], "===", "1"}], 
               ")"}]}], ")"}], ",", 
            RowBox[{
            "solnsUnion", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "True", ",", 
            RowBox[{"LHSt", "/.", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", "mx_"}], ")"}], 
                "\[Rule]", " ", 
                RowBox[{"(", 
                 RowBox[{"TensorComponents", "\[Rule]", 
                  RowBox[{"(", 
                   RowBox[{"solnsFlatten", "/.", 
                    RowBox[{
                    RowBox[{
                    "{", "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\"", "}"}], 
                    "->", "\"\<\!\(\*FractionBox[\(0\), \(0\)]\)\>\""}]}], 
                   ")"}]}], ")"}]}], ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"TensorName", "\[Rule]", "tn_"}], ")"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{"TensorName", "\[Rule]", 
                  FractionBox[
                   RowBox[{"TensorName", "[", "LHSttemp", "]"}], 
                   RowBox[{"TensorName", "[", "RHSttemp", "]"}]]}], ")"}]}]}],
               "}"}]}]}], "]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ComponentRankNumber", "[", "LHScomp", "]"}], "===", "0"}],
           ")"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Solve", "[", 
            RowBox[{
             RowBox[{"LHScomp", "\[Equal]", 
              RowBox[{"\[Kappa]", " ", "RHScomp"}]}], ",", "\[Kappa]"}], 
            "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"{", 
               RowBox[{"\[Kappa]", "\[Rule]", "soln___"}], "}"}], "}"}], 
             "\[RuleDelayed]", " ", 
             RowBox[{"(", 
              RowBox[{"soln", "//", "op"}], ")"}]}], "}"}]}], ")"}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8871119361462755`*^9, 3.887112017758164*^9}, {
   3.887112059357123*^9, 3.8871120696216364`*^9}, {3.88711241770765*^9, 
   3.887112445876791*^9}, {3.887112582185009*^9, 3.887112702840073*^9}, {
   3.8871129900373397`*^9, 3.8871130189340277`*^9}, {3.887113057012743*^9, 
   3.8871130743167067`*^9}, {3.8871131336605434`*^9, 3.887113239356813*^9}, {
   3.887115220908261*^9, 3.88711524157168*^9}, {3.887115892180296*^9, 
   3.88711590965677*^9}, {3.88711682362072*^9, 3.887117032868149*^9}, {
   3.8871174974391575`*^9, 3.8871175466390905`*^9}, {3.887117970683464*^9, 
   3.887117994987946*^9}, 3.8871180563472786`*^9, {3.8871181482343864`*^9, 
   3.887118186361709*^9}, {3.887118254808637*^9, 3.887118278337125*^9}, {
   3.8871183114336557`*^9, 3.8871183291161585`*^9}, {3.8871186542222023`*^9, 
   3.8871186637410035`*^9}, {3.8871187327013226`*^9, 3.887118737630596*^9}, {
   3.8871187818694715`*^9, 3.887118792820798*^9}, {3.887118860908371*^9, 
   3.887118871768297*^9}, {3.8871189579324584`*^9, 3.8871189784586177`*^9}, {
   3.8871190340130568`*^9, 3.8871190358183994`*^9}, {3.887119185263136*^9, 
   3.887119220339895*^9}, {3.8871573933804483`*^9, 3.8871574147169876`*^9}, 
   3.887157511275786*^9, 3.887158080238427*^9, {3.889047248117734*^9, 
   3.889047275391917*^9}, {3.889047319056067*^9, 3.889047323695837*^9}, {
   3.889047462529028*^9, 3.8890475118222685`*^9}, {3.889048426055933*^9, 
   3.8890484430084143`*^9}, {3.889334404741991*^9, 3.889334435877804*^9}, {
   3.8893345115578957`*^9, 3.8893345442125607`*^9}, 3.891584860939592*^9, {
   3.895073261803241*^9, 3.895073261803241*^9}, {3.8955395758777876`*^9, 
   3.895539616135646*^9}, {3.895555838594351*^9, 3.8955558385983496`*^9}, {
   3.9533409285000887`*^9, 3.953340936842648*^9}, 3.953341100872147*^9, 
   3.953341381543809*^9},ExpressionUUID->"c48cf425-f1a2-4462-9c2a-\
870af9587f71"]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
GeodesicSystem, GeodesicLagrangians, GeodesicHamiltonianDynamics\
\>", "Subsection",
 CellChangeTimes->{{3.52174375309375*^9, 3.5217437626875*^9}, {
  3.669439370764881*^9, 3.669439374298902*^9}, {3.7181131427585125`*^9, 
  3.7181131460241966`*^9}, {3.718873428731206*^9, 3.7188734353831544`*^9}, {
  3.796244559633416*^9, 
  3.7962445602198296`*^9}},ExpressionUUID->"3dc93e88-18fc-4b08-a0f2-\
3b0ced8ffdbc"],

Cell["\<\
GeodesicSystem takes as input
{Metric Tensor, AffineParameter, NonAffineParameter}
and produces as output:
{Lagrangian for geodesic motion in affine parameter form, 
Lag. non-affine parameter form, 
Geodesic equations in affine parameter,
Geodesic equations in non-affine parameter forms}\
\>", "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 
  3.7181753757743816`*^9}},ExpressionUUID->"e2214c72-9e0d-4f3b-a15d-\
6117c612dd78"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeodesicSystem", "[", 
     RowBox[{"m_Tensor", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", 
        "si", ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
        "coot", ",", "a\[Lambda]", ",", "ct", ",", "comehere", ",", 
        "L\[Lambda]", ",", "Lt", ",", "output"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
        RowBox[{
        "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
         "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a\[Lambda]", "=", 
        RowBox[{"OptionValue", "[", "AffineParameter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{"affine", " ", "parameter"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ct", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "}"}], 
          ",", "cooo"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", "one",
           " ", "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ct", "]"}], "===", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"coot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"#", "===", 
               RowBox[{
               "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{
              "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"#", "=!=", 
               RowBox[{
               "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"#", "/.", 
               RowBox[{"#", "\[Rule]", 
                RowBox[{"#", "[", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "]"}]}]}]}], "]"}], "&"}], "/@", "cooo"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
           "not", " ", "one", " ", "of", " ", "the", " ", "coordinates"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ct", "===", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"coot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"#", "[", 
                RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], 
                "]"}]}]}], ")"}], "&"}], "/@", "cooo"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ct", "=", 
        RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
         "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coo\[Lambda]", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"#", "\[Rule]", 
             RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
         "cooo"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "construct", " ", "affine", " ", "parameter", " ", "Lagrangian"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"L\[Lambda]", "=", 
        RowBox[{
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], "]"}],
          "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"L\[Lambda]", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L\[Lambda]", "\[LeftDoubleBracket]", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
             "\[LeftDoubleBracket]", "\[Mu]", "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
             "\[LeftDoubleBracket]", "\[Nu]", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"construct", " ", "non"}], "-", 
         RowBox[{"affine", " ", "parameter", " ", "Lagrangian"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], "]"}],
          "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cooo", ",", "coot"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Lt", "\[LeftDoubleBracket]", 
              RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
              "\[Mu]", "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
              "\[Nu]", "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"output", ":", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", "1", ")"}], " ", "Lag", " ", "in", " ", "affine", " ",
            "parameter", " ", "form"}]}], ",", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"Lag", " ", "in", " ", "non"}], "-", 
           RowBox[{"affine", " ", "parameter", " ", "form"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", "2", ")"}], " ", "Geodesic", " ", "Equations", " ", 
           "in", " ", "affine", " ", "parameter", " ", "form"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"(", "3", ")"}], " ", "Geodesic", " ", "Equations", " ", 
            "in", " ", "non"}], "-", 
           RowBox[{"affine", " ", "parameter", " ", "form"}]}]}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"L\[Lambda]", ",", "Lt", ",", 
         RowBox[{"EulerEquations", "[", 
          RowBox[{"L\[Lambda]", ",", "coo\[Lambda]", ",", "a\[Lambda]"}], 
          "]"}], ",", 
         RowBox[{"EulerEquations", "[", 
          RowBox[{"Lt", ",", 
           RowBox[{"Complement", "[", 
            RowBox[{"coot", ",", 
             RowBox[{"{", "ct", "}"}]}], "]"}], ",", "ct"}], "]"}]}], 
        "}"}]}]}], "\[IndentingNewLine]", "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"OptionValue", "[", "AffineParameter", "]"}], "]"}], "===", 
        "Symbol"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "]"}], "===",
         "Symbol"}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, 
   3.8955551726274557`*^9},ExpressionUUID->"774edf3d-4b55-4145-849b-\
051d46c6a79d"],

Cell["\<\
GeodesicLagrangians takes as input
{Metric Tensor, AffineParameter, NonAffineParameter}
and produces as output:
{Lagrangian for geodesic motion in affine parameter form, 
Lag. non-affine parameter form}
That is, it is GeodesicSystem, except it does not compute the geodesic \
equations.\
\>", "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 3.7181753757743816`*^9}, {
  3.718873468850099*^9, 
  3.7188735320314307`*^9}},ExpressionUUID->"1b74c357-bac8-4f82-b251-\
cefd17cf0c45"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeodesicLagrangians", "[", 
     RowBox[{"m_Tensor", ",", 
      RowBox[{"opts", ":", 
       RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], "/;", 
    RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", 
        "si", ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
        "coot", ",", "a\[Lambda]", ",", "ct", ",", "comehere", ",", 
        "L\[Lambda]", ",", "Lt", ",", "output"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
        RowBox[{
        "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
         "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"a\[Lambda]", "=", 
        RowBox[{"OptionValue", "[", "AffineParameter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"cooo", "=", 
        RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"non", "-", 
         RowBox[{"affine", " ", "parameter"}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ct", "=", 
        RowBox[{"Intersection", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "}"}], 
          ",", "cooo"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Which", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", "one",
           " ", "of", " ", "the", " ", "coordinates"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "ct", "]"}], "===", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"coot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"#", "===", 
               RowBox[{
               "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{
              "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"#", "=!=", 
               RowBox[{
               "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
               ",", 
              RowBox[{"#", "/.", 
               RowBox[{"#", "\[Rule]", 
                RowBox[{"#", "[", 
                 RowBox[{
                 "ct", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                  "]"}]}]}]}], "]"}], "&"}], "/@", "cooo"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "if", " ", "input", " ", "NonAffineParameter", " ", "is", " ", 
           "not", " ", "one", " ", "of", " ", "the", " ", "coordinates"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"ct", "===", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"coot", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"#", "/.", 
              RowBox[{"#", "\[Rule]", 
               RowBox[{"#", "[", 
                RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], 
                "]"}]}]}], ")"}], "&"}], "/@", "cooo"}]}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"ct", "=", 
        RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
         "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coo\[Lambda]", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "/.", 
            RowBox[{"#", "\[Rule]", 
             RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
         "cooo"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"d", "=", 
        RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "construct", " ", "affine", " ", "parameter", " ", "Lagrangian"}], 
        " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"L\[Lambda]", "=", 
        RowBox[{
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], "]"}],
          "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"L\[Lambda]", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "/", "2"}], ")"}], 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"L\[Lambda]", "\[LeftDoubleBracket]", 
             RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
             "\[LeftDoubleBracket]", "\[Mu]", "\[RightDoubleBracket]"}], 
            RowBox[{
             RowBox[{"D", "[", 
              RowBox[{"coo\[Lambda]", ",", "a\[Lambda]"}], "]"}], 
             "\[LeftDoubleBracket]", "\[Nu]", "\[RightDoubleBracket]"}]}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"construct", " ", "non"}], "-", 
         RowBox[{"affine", " ", "parameter", " ", "Lagrangian"}]}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{
         RowBox[{"TensorComponents", "[", 
          RowBox[{"Metric", "[", 
           RowBox[{
            RowBox[{"SubMinus", "[", "\[Mu]", "]"}], ",", 
            RowBox[{"SubMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], "]"}],
          "/.", 
         RowBox[{"Thread", "[", 
          RowBox[{"Rule", "[", 
           RowBox[{"cooo", ",", "coot"}], "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Lt", "=", 
        RowBox[{"Power", "[", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Lt", "\[LeftDoubleBracket]", 
              RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
              "\[Mu]", "\[RightDoubleBracket]"}], 
             RowBox[{
              RowBox[{"D", "[", 
               RowBox[{"coot", ",", "ct"}], "]"}], "\[LeftDoubleBracket]", 
              "\[Nu]", "\[RightDoubleBracket]"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}], ",", 
          RowBox[{"1", "/", "2"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"output", ":", " ", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", "1", ")"}], " ", "Lag", " ", "in", " ", "affine", " ",
            "parameter", " ", "form"}]}], ",", " ", 
         RowBox[{
          RowBox[{"Lag", " ", "in", " ", "non"}], "-", 
          RowBox[{"affine", " ", "parameter", " ", "form"}]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"L\[Lambda]", ",", "Lt"}], "}"}]}]}], "\[IndentingNewLine]", 
     "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"OptionValue", "[", "AffineParameter", "]"}], "]"}], "===", 
        "Symbol"}], ")"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Head", "[", 
         RowBox[{"OptionValue", "[", "NonAffineParameter", "]"}], "]"}], "===",
         "Symbol"}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.718873830380347*^9, 
   3.718873835202129*^9}, {3.7188738658095665`*^9, 3.7188738773171687`*^9}, 
   3.8955551726324525`*^9},ExpressionUUID->"5d23b930-244c-4440-9bb2-\
85e665a9cfe2"],

Cell["\<\
GeodesicHamiltonianDynamics takes as input
{Metric Tensor, {coordinates \[Rule] momenta}, AffineParameter}
and produces as output:
{Hamiltonian for geodesic motion in affine parameter form, 
{x-dot = \[PartialD]H/\[PartialD]p,p-dot = -\[PartialD]H/\[PartialD]x}}.\
\>", "Text",
 CellChangeTimes->{{3.7181132097147055`*^9, 3.718113264109483*^9}, {
  3.7181143852731085`*^9, 3.7181143974866204`*^9}, {3.7181151783546247`*^9, 
  3.7181152155867205`*^9}, {3.7181669623574867`*^9, 3.7181669718634157`*^9}, {
  3.718168163546671*^9, 3.718168165734876*^9}, {3.7181702710162296`*^9, 
  3.7181703112290707`*^9}, {3.718175343109828*^9, 3.7181753757743816`*^9}, {
  3.718873468850099*^9, 3.7188735320314307`*^9}, {3.79523642171525*^9, 
  3.795236452723382*^9}, {3.7952365062913537`*^9, 3.7952365067526426`*^9}, {
  3.795236578273012*^9, 3.795236625209828*^9}, {3.7962386295423265`*^9, 
  3.7962386329016805`*^9}, {3.796243853750134*^9, 
  3.7962439114898167`*^9}},ExpressionUUID->"a487075c-68f8-446d-88be-\
4ec5655f4d49"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GeodesicHamiltonianDynamics", "[", 
     RowBox[{"m_Tensor", ",", "cp_List", ",", "a\[Lambda]_Symbol"}], "]"}], "/;", 
    RowBox[{
     RowBox[{"TestMetricTensor", "[", "m", "]"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "list", " ", "of", " ", "Rules", " ", "relating", " ", "coords", " ", 
       "to", " ", "momenta"}], " ", "*)"}], 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"cp", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"Repeated", "[", 
        RowBox[{"Rule", "[", 
         RowBox[{"lhs_", ",", "rhs_"}], "]"}], "]"}]}], "]"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "lhs", " ", "of", " ", "Rules", " ", "in", " ", "cp", " ", "should", 
       " ", "be", " ", "the", " ", "coordinates", " ", "of", " ", "m"}], " ", 
      "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Evaluate", "[", 
          RowBox[{"(", 
           RowBox[{"cp", "/.", 
            RowBox[{
             RowBox[{"Rule", "[", 
              RowBox[{"lhs_", ",", "rhs_"}], "]"}], "\[Rule]", "lhs"}]}], 
           ")"}], "]"}], ",", 
         RowBox[{"Coordinates", "[", "m", "]"}]}], "]"}], "===", 
       RowBox[{"Sort", "[", 
        RowBox[{"Coordinates", "[", "m", "]"}], "]"}]}], ")"}], "&&", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Affine", " ", "Parameter", " ", "should", " ", "not", " ", "be", " ", 
       "coordinate"}], " ", "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Intersection", "[", 
        RowBox[{
         RowBox[{"Coordinates", "[", "m", "]"}], ",", 
         RowBox[{"{", "a\[Lambda]", "}"}]}], "]"}], "===", 
       RowBox[{"{", "}"}]}], ")"}]}]}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mm", ",", "ss", ",", "\[Sigma]", ",", "\[Mu]", ",", "\[Nu]", ",", "si",
        ",", "cooo", ",", "d", ",", "cc", ",", "coo\[Lambda]", ",", 
       "p\[Lambda]", ",", "coot", ",", "ct", ",", "comehere", ",", 
       "H\[Lambda]", ",", "g\[Mu]\[Nu]", ",", "Lt", ",", "output", ",", 
       "coo\[Lambda]Eqn", ",", "p\[Lambda]Eqn"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{"extract", " ", "affine", " ", "and", " ", "non"}], "-", 
       RowBox[{
       "affine", " ", "parameter", " ", "for", " ", "solving", " ", 
        "geodesic", " ", "eqn"}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cooo", "=", 
       RowBox[{"Coordinates", "[", "m", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "coordinates", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
        "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coo\[Lambda]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
        "cooo"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "momentum", " ", "as", " ", "a", " ", "function", " ", "of", " ", 
        "affine", " ", "parameter"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"p\[Lambda]", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "/.", 
           RowBox[{"#", "\[Rule]", 
            RowBox[{"#", "[", "a\[Lambda]", "]"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"cooo", "/.", "cp"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"d", "=", 
       RowBox[{"Length", "[", "cooo", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "construct", " ", "affine", " ", "parameter", " ", "Hamiltonian"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"g\[Mu]\[Nu]", "=", 
       RowBox[{
        RowBox[{"TensorComponents", "[", 
         RowBox[{"Metric", "[", 
          RowBox[{
           RowBox[{"SuperMinus", "[", "\[Mu]", "]"}], ",", 
           RowBox[{"SuperMinus", "[", "\[Nu]", "]"}], ",", "m"}], "]"}], 
         "]"}], "/.", 
        RowBox[{"Thread", "[", 
         RowBox[{"Rule", "[", 
          RowBox[{"cooo", ",", "coo\[Lambda]"}], "]"}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"H\[Lambda]", "=", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "/", "2"}], ")"}], 
        RowBox[{"Sum", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"g\[Mu]\[Nu]", "\[LeftDoubleBracket]", 
            RowBox[{"\[Mu]", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
           RowBox[{
           "p\[Lambda]", "\[LeftDoubleBracket]", "\[Mu]", 
            "\[RightDoubleBracket]"}], 
           RowBox[{
           "p\[Lambda]", "\[LeftDoubleBracket]", "\[Nu]", 
            "\[RightDoubleBracket]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Mu]", ",", "1", ",", "d"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        SuperscriptBox[
         OverscriptBox["x", "."], "\[Mu]"], " ", "=", " ", 
        RowBox[{
         SuperscriptBox["g", "\[Mu]\[Nu]"], 
         SubscriptBox["p", "\[Nu]"]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"coo\[Lambda]Eqn", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "coo\[Lambda]", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}], ",", "a\[Lambda]"}], "]"}], 
           "\[Equal]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"g\[Mu]\[Nu]", "\[LeftDoubleBracket]", 
               RowBox[{"#", ",", "\[Nu]"}], "\[RightDoubleBracket]"}], 
              RowBox[{
              "p\[Lambda]", "\[LeftDoubleBracket]", "\[Nu]", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Nu]", ",", "1", ",", "d"}], "}"}]}], "]"}]}], ")"}], 
         "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "d"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["p", "."], "\[Mu]"], " ", "=", " ", 
        RowBox[{
         RowBox[{
          RowBox[{"-", " ", 
           RowBox[{"\[PartialD]", "H"}]}], "/", 
          RowBox[{"\[PartialD]", 
           SuperscriptBox["x", "\[Mu]"]}]}], " ", "=", " ", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"1", "/", "2"}], ")"}]}], 
          RowBox[{
           SubscriptBox["\[PartialD]", "\[Mu]"], 
           SuperscriptBox["g", "\[Alpha]\[Beta]"]}], " ", 
          SubscriptBox["p", "\[Alpha]"], " ", 
          SubscriptBox["p", "\[Beta]"]}]}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"p\[Lambda]Eqn", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"D", "[", 
            RowBox[{
             RowBox[{
             "p\[Lambda]", "\[LeftDoubleBracket]", "#", 
              "\[RightDoubleBracket]"}], ",", "a\[Lambda]"}], "]"}], 
           "\[Equal]", 
           RowBox[{"-", 
            RowBox[{"D", "[", 
             RowBox[{"H\[Lambda]", ",", 
              RowBox[{
              "coo\[Lambda]", "\[LeftDoubleBracket]", "#", 
               "\[RightDoubleBracket]"}]}], "]"}]}]}], ")"}], "&"}], "/@", 
        RowBox[{"Range", "[", 
         RowBox[{"1", ",", "d"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"output", ":", " ", "Hamiltonian"}], ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xdot", " ", "eqns"}], ",", " ", 
          RowBox[{"pdot", " ", "eqns"}]}], "}"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"H\[Lambda]", ",", 
        RowBox[{"Join", "[", 
         RowBox[{"coo\[Lambda]Eqn", ",", "p\[Lambda]Eqn"}], "]"}]}], 
       "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.52174396084375*^9, 3.521743989140625*^9}, {
   3.52174404553125*^9, 3.52174406490625*^9}, {3.52174411178125*^9, 
   3.521744178*^9}, {3.52175753421875*^9, 3.52175753465625*^9}, {
   3.521759735640625*^9, 3.521759758125*^9}, {3.5217868350625*^9, 
   3.521786885078125*^9}, {3.52178704734375*^9, 3.521787116328125*^9}, {
   3.521787178828125*^9, 3.5217871886875*^9}, {3.521787424390625*^9, 
   3.5217874283125*^9}, {3.521787532828125*^9, 3.52178754371875*^9}, 
   3.521910410859375*^9, {3.5219174194375*^9, 3.521917422546875*^9}, {
   3.521917491703125*^9, 3.5219174925*^9}, {3.521917608890625*^9, 
   3.521917617625*^9}, {3.521918314421875*^9, 3.521918316125*^9}, {
   3.521919269328125*^9, 3.5219193048125*^9}, {3.521919497375*^9, 
   3.52191951465625*^9}, {3.521921384*^9, 3.5219213845625*^9}, {
   3.521922223546875*^9, 3.5219222338125*^9}, {3.521955617484375*^9, 
   3.521955648359375*^9}, {3.521990471359375*^9, 3.52199061959375*^9}, {
   3.521990750328125*^9, 3.521990763484375*^9}, {3.532452011949185*^9, 
   3.532452013961588*^9}, {3.532452056362463*^9, 3.5324520586088667`*^9}, {
   3.5324523712334156`*^9, 3.5324523744782214`*^9}, {3.5324524076906796`*^9, 
   3.532452416130295*^9}, {3.6297526960186977`*^9, 3.629752705008212*^9}, {
   3.6299261040969267`*^9, 3.629926110841316*^9}, 3.6694393941659937`*^9, {
   3.669441203316702*^9, 3.669441278031819*^9}, {3.6694413314969053`*^9, 
   3.669441344335925*^9}, {3.6694413927307887`*^9, 3.6694414202318296`*^9}, {
   3.669514862752521*^9, 3.6695148645345235`*^9}, {3.6695149391946507`*^9, 
   3.669514991276733*^9}, {3.669515032105801*^9, 3.66951506111785*^9}, {
   3.6695152519181633`*^9, 3.669515260451182*^9}, {3.6695153013712487`*^9, 
   3.669515312627266*^9}, {3.6695154093496957`*^9, 3.6695154099216995`*^9}, {
   3.6695167123289385`*^9, 3.669516722073496*^9}, {3.6695173941773467`*^9, 
   3.669517413711464*^9}, {3.6695188004335203`*^9, 3.669518824793914*^9}, {
   3.6695194703083725`*^9, 3.6695194811419926`*^9}, {3.6695209914193163`*^9, 
   3.669521009949376*^9}, {3.669521115596419*^9, 3.6695212488830423`*^9}, {
   3.6695213351253843`*^9, 3.6695213791829042`*^9}, {3.669523166945903*^9, 
   3.6695232008429565`*^9}, {3.6695232691576443`*^9, 
   3.6695232946376853`*^9}, {3.669523348301781*^9, 3.6695234515499983`*^9}, {
   3.6695234848580523`*^9, 3.6695234857220545`*^9}, {3.6695235958404326`*^9, 
   3.669523596974471*^9}, {3.6695236354808025`*^9, 3.66952372849792*^9}, {
   3.66952376388914*^9, 3.6695237647051687`*^9}, {3.669523797091816*^9, 
   3.6695238756779413`*^9}, {3.6695239078229923`*^9, 3.6695239452280507`*^9}, 
   3.669524104919151*^9, {3.6695244117364087`*^9, 3.6695244138805313`*^9}, {
   3.66952454961929*^9, 3.669524582457168*^9}, {3.669524667216015*^9, 
   3.669524719319178*^9}, {3.669524760089368*^9, 3.6695248023595705`*^9}, {
   3.6695248594438553`*^9, 3.669524879383955*^9}, {3.6695251507197723`*^9, 
   3.6695252045538516`*^9}, {3.669525319076599*^9, 3.6695255239586067`*^9}, {
   3.669525569509823*^9, 3.6695255843268876`*^9}, {3.669526032181349*^9, 
   3.6695260335224257`*^9}, {3.669526535424133*^9, 3.669526592160378*^9}, {
   3.6695269712790256`*^9, 3.6695270006767073`*^9}, {3.669529384680343*^9, 
   3.669529386685458*^9}, {3.6695306845557566`*^9, 3.669530688418766*^9}, 
   3.6695338215879908`*^9, {3.6696043936661644`*^9, 3.669604394425166*^9}, {
   3.6697730792502522`*^9, 3.669773086852687*^9}, {3.669821997814456*^9, 
   3.66982200572567*^9}, 3.669822439592286*^9, {3.672717485337129*^9, 
   3.6727175397682424`*^9}, {3.6727176071010933`*^9, 3.672717636492775*^9}, {
   3.6727176686836157`*^9, 3.6727177213646293`*^9}, {3.6727177702034225`*^9, 
   3.6727178572564015`*^9}, {3.672717887283119*^9, 3.6727178937694902`*^9}, {
   3.6727179404391594`*^9, 3.6727179406311703`*^9}, {3.672719714402387*^9, 
   3.672719718733203*^9}, {3.6727198336652737`*^9, 3.672719918631877*^9}, {
   3.718113152795261*^9, 3.7181131936108465`*^9}, {3.718120008664604*^9, 
   3.7181200362640686`*^9}, {3.718120083644309*^9, 3.718120084142719*^9}, {
   3.7181201654003277`*^9, 3.7181202146220803`*^9}, {3.718120257514296*^9, 
   3.7181203600643024`*^9}, {3.718120416774328*^9, 3.7181204439284606`*^9}, {
   3.718120536272476*^9, 3.718120566018412*^9}, {3.7181206683107376`*^9, 
   3.7181206878104663`*^9}, {3.718120853577713*^9, 3.718120898589381*^9}, {
   3.718121337528339*^9, 3.718121483084839*^9}, {3.71812163923243*^9, 
   3.718121681989288*^9}, {3.718121850222268*^9, 3.7181218503891525`*^9}, {
   3.7181219781023026`*^9, 3.718122044575076*^9}, {3.718122111517206*^9, 
   3.718122127839568*^9}, {3.7181675623891754`*^9, 3.718167579643383*^9}, {
   3.718167890730296*^9, 3.718167925898554*^9}, {3.7181680170534754`*^9, 
   3.718168019226018*^9}, {3.7181681770793886`*^9, 3.7181681806114984`*^9}, {
   3.718168213068512*^9, 3.718168241881523*^9}, {3.718168354431093*^9, 
   3.7181683671608443`*^9}, {3.718168522595014*^9, 3.7181685240174723`*^9}, {
   3.7181685665341315`*^9, 3.7181685916153936`*^9}, {3.718168627541527*^9, 
   3.7181686285518384`*^9}, {3.7181686869782743`*^9, 3.718168723302059*^9}, {
   3.7181688624713755`*^9, 3.718168864987712*^9}, {3.7181690228007035`*^9, 
   3.718169162996397*^9}, {3.7181692591219144`*^9, 3.718169420287557*^9}, {
   3.7181695331034083`*^9, 3.7181696882869735`*^9}, {3.718169747473213*^9, 
   3.718169774785277*^9}, {3.718169805784819*^9, 3.7181698277390833`*^9}, {
   3.718169912045196*^9, 3.718169914685809*^9}, {3.7181699598061514`*^9, 
   3.718169970324886*^9}, {3.718174849977064*^9, 3.718174901960864*^9}, {
   3.7181749447138357`*^9, 3.7181751333396473`*^9}, {3.7181751964131765`*^9, 
   3.718175299958202*^9}, {3.7181757489809313`*^9, 3.718175751121794*^9}, {
   3.7181761529552455`*^9, 3.718176156643181*^9}, {3.718177761323681*^9, 
   3.71817776185317*^9}, {3.7181779797531166`*^9, 3.718178001182824*^9}, {
   3.718178432801987*^9, 3.7181784336636972`*^9}, {3.7181785165633006`*^9, 
   3.7181785212720814`*^9}, 3.718180370619824*^9, {3.718873830380347*^9, 
   3.718873835202129*^9}, {3.7188738658095665`*^9, 3.7188738773171687`*^9}, {
   3.795236633054888*^9, 3.795236637487018*^9}, {3.795237058500819*^9, 
   3.7952370721195955`*^9}, {3.795238295820283*^9, 3.795238335710862*^9}, {
   3.796238945540854*^9, 3.7962389458769197`*^9}, {3.7962435477699513`*^9, 
   3.7962435896731133`*^9}, {3.7962436264189253`*^9, 3.796243633625187*^9}, {
   3.796243669561882*^9, 3.796243841658557*^9}, {3.7962439686220517`*^9, 
   3.7962440093348923`*^9}, {3.7962440542451525`*^9, 3.796244108444075*^9}, {
   3.7962441540377183`*^9, 3.796244194236745*^9}, {3.79624422817227*^9, 
   3.7962444052771587`*^9}, {3.7962456028887367`*^9, 3.796245651655817*^9}, {
   3.796245708618054*^9, 3.79624573899321*^9}, {3.796245891659901*^9, 
   3.796245912316416*^9}, {3.796245998749711*^9, 3.796246089724656*^9}, {
   3.796246294738079*^9, 3.7962463249560823`*^9}, {3.7962463643883657`*^9, 
   3.796246369747878*^9}, {3.796246423605193*^9, 3.7962465442497487`*^9}, {
   3.796246690078211*^9, 3.796246720302842*^9}, {3.7962469650530725`*^9, 
   3.7962469862386737`*^9}, {3.7962471295630054`*^9, 3.796247135951657*^9}, {
   3.7962471723875256`*^9, 3.7962471802348495`*^9}, 
   3.8955551726374493`*^9},ExpressionUUID->"2326bf4b-94b0-4d6a-94dc-\
818f699c4d72"]
}, Closed]],

Cell[CellGroupData[{

Cell["SphericalHarmonicYTensor", "Subsection",
 CellChangeTimes->{{3.884211086191988*^9, 3.8842110935365057`*^9}, 
   3.8854228740812063`*^9},ExpressionUUID->"7281337e-90c7-4b6f-8c1b-\
99b585cc5ebe"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "SphericalHarmonicYTensor"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicYTensor", "[", 
      RowBox[{
      "l_", ",", "m_", ",", "\[Theta]_Symbol", ",", "\[Phi]_Symbol", ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "g", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",", 
          "tempidx"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"g", "=", 
          RowBox[{"Metric", "[", 
           RowBox[{
            SubscriptBox["i", "-"], ",", 
            SubscriptBox["j", "-"], ",", 
            RowBox[{"(", "\[NoBreak]", GridBox[{
               {"1", "0"},
               {"0", 
                SuperscriptBox[
                 RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}
              }], "\[NoBreak]", ")"}], ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
            ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Y\>\"", ",", 
               RowBox[{"Column", "[", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "l"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
            RowBox[{"TensorAssumption", "\[Rule]", " ", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
                RowBox[{"2", "Pi"}]}], ",", 
               RowBox[{
               "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
              "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"Y", "=", 
            RowBox[{"TooltipDisplay", "[", 
             RowBox[{"Y", ",", 
              RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Y", "=", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"Y", ",", 
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "Y"}]}], "\[IndentingNewLine]", 
       "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"l", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"m", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}]}]}]}], 
    RowBox[{"(*", 
     RowBox[{"&&", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"l", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"m", ",", "Complexes"}], "]"}], "===", "True"}], ")"}]}],
          ")"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
          ")"}]}], ",", "True", ",", "True"}], "]"}]}], "*)"}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"SphericalHarmonicYTensor", "[", 
      RowBox[{"l_", ",", "m_", ",", 
       RowBox[{"g_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestMetricTensor", "[", "g", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dimensions", "[", "g", "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}], ")"}], "&&", 
          RowBox[{"TensorIsZero", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", 
              RowBox[{"Ricci", "[", 
               RowBox[{
                SubscriptBox[
                 RowBox[{"Unique", "[", "i", "]"}], "-"], ",", 
                SubscriptBox[
                 RowBox[{"Unique", "[", "j", "]"}], "-"], ",", "g"}], "]"}]}],
              ")"}], "//", "Simplify"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coord", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",", 
          "tempidx", ",", "FS", ",", "FSlist"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"coord", "=", 
          RowBox[{"Coordinates", "[", "g", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"NonMetricTensor", "[", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"SphericalHarmonicY", "[", 
             RowBox[{"l", ",", "m", ",", 
              RowBox[{"Sequence", "@@", "coord"}]}], "]"}], ",", 
            RowBox[{"Row", "[", 
             RowBox[{"{", 
              RowBox[{"\"\<Y\>\"", ",", 
               RowBox[{"Column", "[", 
                RowBox[{"{", 
                 RowBox[{"m", ",", "l"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
            RowBox[{"CoordinateSystem", "\[Rule]", "coord"}], ",", 
            RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"TooltipDisplay", "[", 
           RowBox[{"Y", ",", 
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"Y", "=", 
          RowBox[{"TooltipStyle", "[", 
           RowBox[{"Y", ",", 
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}], ";",
          "\[IndentingNewLine]", "Y"}]}], "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"l", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Element", "[", 
            RowBox[{"m", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}]}]}]}], 
    RowBox[{"(*", 
     RowBox[{"&&", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"l", ",", "Complexes"}], "]"}], "===", "True"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Element", "[", 
             RowBox[{"m", ",", "Complexes"}], "]"}], "===", "True"}], ")"}]}],
          ")"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
          ")"}]}], ",", "True", ",", "True"}], "]"}]}], "*)"}], 
    ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842111799679384`*^9, 3.884211208663726*^9}, {
   3.8842113327198052`*^9, 3.884211349708627*^9}, {3.8842120618296947`*^9, 
   3.8842120711925664`*^9}, {3.884212102090336*^9, 3.8842121449134693`*^9}, {
   3.884212220385887*^9, 3.884212287902378*^9}, 3.884212364732334*^9, {
   3.8842124479732265`*^9, 3.884212474087426*^9}, {3.8842125872596455`*^9, 
   3.8842126004813623`*^9}, {3.884212721113248*^9, 3.8842128053821273`*^9}, {
   3.8842128533406825`*^9, 3.8842128556062346`*^9}, {3.884212919019755*^9, 
   3.884212971543861*^9}, {3.884213341240335*^9, 3.8842134408385954`*^9}, {
   3.8842134714576373`*^9, 3.884213479215489*^9}, {3.8842135287050447`*^9, 
   3.8842135509518585`*^9}, {3.8842137270656085`*^9, 3.884213803120216*^9}, {
   3.8842153165278273`*^9, 3.8842153243590126`*^9}, {3.884216057538616*^9, 
   3.8842160840764046`*^9}, {3.8842161708415847`*^9, 3.884216190713771*^9}, {
   3.884216285793537*^9, 3.8842163504480495`*^9}, 3.8842171224519215`*^9, {
   3.8842171526988573`*^9, 3.8842172051628532`*^9}, {3.8842172925236835`*^9, 
   3.884217355577456*^9}, {3.884217387817747*^9, 3.884217559106192*^9}, 
   3.8842176247605553`*^9, {3.8842176652323236`*^9, 3.8842176691119366`*^9}, {
   3.8842180067846823`*^9, 3.8842181160125628`*^9}, {3.8842187297934227`*^9, 
   3.884218732504753*^9}, {3.884218769097356*^9, 3.8842187758324037`*^9}, {
   3.8842198970105605`*^9, 3.8842198975552254`*^9}, {3.8847725583453474`*^9, 
   3.884772694357439*^9}, {3.8847730879350386`*^9, 3.8847731814856796`*^9}, {
   3.8847733733150434`*^9, 3.884773411463228*^9}, {3.884773713220128*^9, 
   3.8847737559787064`*^9}, {3.8847742769732823`*^9, 
   3.8847743371864786`*^9}, {3.8847745701966186`*^9, 3.884774585388344*^9}, {
   3.8847771389883747`*^9, 3.884777248808498*^9}, {3.8847773323381205`*^9, 
   3.8847773657724657`*^9}, {3.884777433537753*^9, 3.8847774623712406`*^9}, {
   3.88477774915334*^9, 3.8847777945223017`*^9}, {3.8847778311500263`*^9, 
   3.8847778567222977`*^9}, {3.884777894084848*^9, 3.8847780996136293`*^9}, {
   3.884778213493109*^9, 3.8847782247188997`*^9}, {3.884778276048366*^9, 
   3.8847783034797277`*^9}, 3.884778563193598*^9, 3.8847786246010637`*^9, {
   3.8847786570848303`*^9, 3.884778681450074*^9}, {3.8847787174242096`*^9, 
   3.884778737568679*^9}, {3.884778789361764*^9, 3.884778807209193*^9}, {
   3.884778989654413*^9, 3.8847790337839985`*^9}, {3.8847790876765347`*^9, 
   3.884779090051464*^9}, {3.8847791344562144`*^9, 3.8847791905151544`*^9}, {
   3.8847794384306984`*^9, 3.8847794472939796`*^9}, {3.884808910539687*^9, 
   3.884808993629153*^9}, {3.8848092468668528`*^9, 3.8848092584097037`*^9}, 
   3.884809531350893*^9, {3.8853770548177433`*^9, 3.8853770800476036`*^9}, {
   3.8853788852282257`*^9, 3.8853788997772565`*^9}, {3.8853797146679535`*^9, 
   3.8853797212509594`*^9}, 3.885380034450748*^9, {3.8853801942724185`*^9, 
   3.885380227359583*^9}, {3.885380313793097*^9, 3.8853803198183784`*^9}, {
   3.885382727483036*^9, 3.8853827346196365`*^9}, {3.885384569036267*^9, 
   3.8853846127591195`*^9}, {3.885384651395302*^9, 3.8853847685720725`*^9}, {
   3.8853876735131207`*^9, 3.8853876795713844`*^9}, {3.8853887475957575`*^9, 
   3.885388783458391*^9}, {3.8853895956652217`*^9, 3.8853896048391438`*^9}, 
   3.8854228714338207`*^9, 3.8854233759921265`*^9, {3.8870186844190083`*^9, 
   3.8870186996410522`*^9}, 
   3.8955551726414475`*^9},ExpressionUUID->"9f06ca08-8f2d-4be0-a5fd-\
c759237e39e4"]
}, Closed]],

Cell[CellGroupData[{

Cell["VectorSphericalHarmonic", "Subsection",
 CellChangeTimes->{{3.884211086191988*^9, 
  3.8842110935365057`*^9}},ExpressionUUID->"4375b8ad-6ca0-4d8e-a4f4-\
b57cc6e2c0cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"NewCode", ":", " ", "VectorSphericalHarmonic"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"VectorSphericalHarmonic", "[", 
      RowBox[{
       RowBox[{"idx_", "/;", 
        RowBox[{"(", 
         RowBox[{"TestIndices", "[", "idx", "]"}], ")"}]}], ",", "l_", ",", 
       "m_", ",", "\[Theta]_Symbol", ",", "\[Phi]_Symbol", ",", 
       RowBox[{"VectorType_", "/;", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"VectorType", ",", 
          RowBox[{"(", 
           RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
         "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "g", ",", "i", ",", "j", ",", "result", ",", "norm", ",", "tempidx", 
          ",", "FS", ",", "FSlist", ",", "ltemp", ",", "mtemp"}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "=", 
          RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"FSlist", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
             RowBox[{"2", "Pi"}]}], ",", 
            RowBox[{"0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}],
            "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"IntegerQ", "[", "l", "]"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"FSlist", ",", 
             RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}], 
          "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"FSlist", ",", 
             RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
              RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
           RowBox[{"AppendTo", "[", 
            RowBox[{"FSlist", ",", 
             RowBox[{
              RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
              "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{
           "We", " ", "find", " ", "that", " ", "it", " ", "took", " ", "too",
             " ", "long", " ", "time", " ", "to", " ", "calculate", " ", "a", 
            " ", "good", " ", "form", " ", "of", " ", 
            RowBox[{"VectorSphericalHarmonic", ".", 
             RowBox[{"That", "'"}]}], " ", "s", " ", "why", " ", "we", " ", 
            "want", " ", "to", " ", "save", " ", "the", " ", "result", " ", 
            RowBox[{"directly", ".", " ", "See"}], " ", "Wei"}], "-", 
           RowBox[{
           "Hao", " ", "test", " ", "notebook", " ", "part", " ", "2."}]}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SuperMinus"}], 
              ")"}]}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mtemp", " ", 
                  RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{
                   "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  SqrtBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}]], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ",", 
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"Del", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                "]"}], "]"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", " ", "FSlist"}]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SuperMinus"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Csc", "[", "\[Theta]", "]"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mtemp", " ", 
                    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}], 
                    ")"}]}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Y\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", " ", "FSlist"}]}], "]"}],
             ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SubMinus"}], 
              ")"}]}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SubscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mtemp", " ", 
                  RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{
                   "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  SqrtBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}]], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ",", 
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"Del", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                "]"}], "]"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", "FSlist"}]}], "]"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], "&&", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Head", "[", "idx", "]"}], "===", "SubMinus"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SubscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Sin", "[", "\[Theta]", "]"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mtemp", " ", 
                    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}], 
                    ")"}]}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
                 RowBox[{"Row", "[", 
                  RowBox[{"{", 
                   RowBox[{"\"\<\[DifferentialD]\>\"", ",", 
                    RowBox[{"Row", "[", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Y\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                    "]"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}], ",", 
              RowBox[{"TensorAssumption", "\[Rule]", " ", "FSlist"}]}], 
             "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"g", "=", 
            RowBox[{"Metric", "[", 
             RowBox[{
              SubscriptBox["i", "-"], ",", 
              SubscriptBox["j", "-"], ",", 
              RowBox[{"(", "\[NoBreak]", GridBox[{
                 {"1", "0"},
                 {"0", 
                  SuperscriptBox[
                   RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}
                }], "\[NoBreak]", ")"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";"}], 
          "*)"}], 
         RowBox[{"result", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"(*", 
              RowBox[{"MoveIndices", "["}], "*)"}], 
             RowBox[{
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"norm", "===", "True"}], ",", 
                RowBox[{"(", 
                 RowBox[{"result", "/.", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                " ", "result"}], "]"}], 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{",", 
                 RowBox[{"{", 
                  RowBox[{"tempidx", "//", 
                   RowBox[{
                   "idx", "\[LeftDoubleBracket]", "0", 
                    "\[RightDoubleBracket]"}]}], "}"}], ",", "g"}], "]"}], 
               "*)"}], "/.", 
              RowBox[{"{", 
               RowBox[{"tempidx", "\[Rule]", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], " ", "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ltemp", "\[Rule]", " ", "l"}], ",", 
              RowBox[{"mtemp", "\[Rule]", " ", "m"}]}], "}"}]}], ")"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"!", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"IntegerQ", "[", "l", "]"}]}], ")"}], "&&", 
                RowBox[{"(", 
                 RowBox[{"!", 
                  RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ")"}]}], 
             ",", 
             RowBox[{
              RowBox[{"FSlist", "=", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
                  RowBox[{"2", "Pi"}]}], ",", 
                 RowBox[{
                 "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
                "}"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"IntegerQ", "[", "l", "]"}]}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"FSlist", ",", 
                  RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"FSlist", ",", 
                  RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"Which", "[", 
               RowBox[{
                RowBox[{"!", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
                   RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"FSlist", ",", 
                  RowBox[{
                   RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
                   "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"FS", "=", 
               RowBox[{
                RowBox[{"FullSimplify", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{"Evaluate", "[", "FSlist", "]"}]}], "]"}], "&"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"result", "=", 
               RowBox[{"result", "//", "FS"}]}]}]}], "\[IndentingNewLine]", 
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipDisplay", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
           RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
           ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"VectorSphericalHarmonic", "[", 
       RowBox[{
        RowBox[{"idx_", "/;", 
         RowBox[{"(", 
          RowBox[{"TestIndices", "[", "idx", "]"}], ")"}]}], ",", "l_", ",", 
        "m_", ",", "\[Theta]_Symbol", ",", "\[Phi]_Symbol", ",", 
        RowBox[{"VectorType_", "/;", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"VectorType", ",", 
           RowBox[{"(", 
            RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
          "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "g", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",", 
           "norm", ",", "tempidx", ",", "FS", ",", "FSlist"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"norm", "=", 
           RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"FSlist", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
              RowBox[{"2", "Pi"}]}], ",", 
             RowBox[{
             "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "l", "]"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
               RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{
               RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
               "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"FS", "=", 
           RowBox[{
            RowBox[{"FullSimplify", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Evaluate", "[", "FSlist", "]"}]}], "]"}], "&"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"g", "=", 
           RowBox[{"Metric", "[", 
            RowBox[{
             SubscriptBox["i", "-"], ",", 
             SubscriptBox["j", "-"], ",", 
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {"1", "0"},
                {"0", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}
               }], "\[NoBreak]", ")"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
             RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
             RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"SphericalHarmonicY", "[", 
              RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
             ",", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<Y\>\"", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "l"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
             RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], ",", 
             RowBox[{"CovariantD", "[", 
              RowBox[{
               SuperscriptBox["tempidx", "-"], ",", "Y", ",", "g"}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{"Normal", "[", 
               RowBox[{"CovariantHodgeDual", "[", 
                RowBox[{
                 SuperscriptBox["tempidx", "-"], ",", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[DifferentialD]", 
                    SubscriptBox["k", "-"]], "Y"}], ")"}], ",", "g"}], "]"}], 
               "]"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MoveIndices", "[", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"norm", "===", "True"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"result", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                  " ", "result"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"tempidx", "//", 
                  RowBox[{
                  "idx", "\[LeftDoubleBracket]", "0", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "g"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"tempidx", "\[Rule]", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], " ", "}"}]}], ")"}], "//", 
            "FS"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
             "Null"}], ",", 
            RowBox[{"result", "=", 
             RowBox[{"TooltipDisplay", "[", 
              RowBox[{"result", ",", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"result", "=", 
             RowBox[{"TooltipStyle", "[", 
              RowBox[{"result", ",", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}],
            "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
        "\[IndentingNewLine]", "]"}], "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "l", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
         ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "m", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
         ")"}], "&&", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
            RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
            ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"VectorSphericalHarmonic", "[", 
      RowBox[{
       RowBox[{"idx_", "/;", 
        RowBox[{"(", 
         RowBox[{"TestIndices", "[", "idx", "]"}], ")"}]}], ",", "l_", ",", 
       "m_", ",", 
       RowBox[{"g_Tensor", "/;", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"TestMetricTensor", "[", "g", "]"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Dimensions", "[", "g", "]"}], "===", 
            RowBox[{"{", 
             RowBox[{"2", ",", "2"}], "}"}]}], ")"}], "&&", 
          RowBox[{"TensorIsZero", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"g", "-", 
              RowBox[{"Ricci", "[", 
               RowBox[{
                SubscriptBox[
                 RowBox[{"Unique", "[", "iiiii", "]"}], "-"], ",", 
                SubscriptBox[
                 RowBox[{"Unique", "[", "jjjjj", "]"}], "-"], ",", "g"}], 
               "]"}]}], ")"}], "//", "Simplify"}], "]"}]}], ")"}]}], ",", 
       RowBox[{"VectorType_", "/;", 
        RowBox[{"MatchQ", "[", 
         RowBox[{"VectorType", ",", 
          RowBox[{"(", 
           RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
         "]"}]}], ",", 
       RowBox[{"opts", ":", 
        RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
     RowBox[{
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
         "coord", ",", "result", ",", "norm", ",", "tempidx", ",", "FS", ",", 
          "FSlist", ",", "\[Theta]", ",", "\[Phi]", ",", "ltemp", ",", 
          "mtemp"}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"norm", "=", 
          RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"coord", "=", 
          RowBox[{"Coordinates", "[", "g", "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"\[Theta]", "=", 
          RowBox[{
          "coord", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"\[Phi]", "=", 
          RowBox[{
          "coord", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"result", "=", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"mtemp", " ", 
                  RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{
                   "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                   "]"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["\[ExponentialE]", 
                   RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                  SqrtBox[
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}]], " ", 
                  RowBox[{"SphericalHarmonicY", "[", 
                   RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ",", 
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 SuperscriptBox[
                  RowBox[{"Csc", "[", "\[Theta]", "]"}], "2"], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}]}], "}"}], ",", 
              RowBox[{"Del", "[", 
               RowBox[{"Row", "[", 
                RowBox[{"{", 
                 RowBox[{"\"\<Y\>\"", ",", 
                  RowBox[{"Column", "[", 
                   RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                "]"}], "]"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], ",", 
            RowBox[{"NonMetricTensor", "[", 
             RowBox[{
              RowBox[{"{", 
               SuperscriptBox["tempidx", "-"], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\[ImaginaryI]", " ", "mtemp", " ", 
                 RowBox[{"Csc", "[", "\[Theta]", "]"}], " ", 
                 RowBox[{"SphericalHarmonicY", "[", 
                  RowBox[{
                  "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                  "]"}]}], ",", 
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"Csc", "[", "\[Theta]", "]"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"mtemp", " ", 
                    RowBox[{"Cot", "[", "\[Theta]", "]"}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{
                    "ltemp", ",", "mtemp", ",", "\[Theta]", ",", "\[Phi]"}], 
                    "]"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["\[ExponentialE]", 
                    RowBox[{
                    RowBox[{"-", "\[ImaginaryI]"}], " ", "\[Phi]"}]], " ", 
                    RowBox[{"\[Sqrt]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"ltemp", "-", "mtemp"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", "ltemp", "+", "mtemp"}], ")"}]}], 
                    ")"}]}], " ", 
                    RowBox[{"SphericalHarmonicY", "[", 
                    RowBox[{"ltemp", ",", 
                    RowBox[{"1", "+", "mtemp"}], ",", "\[Theta]", ",", 
                    "\[Phi]"}], "]"}]}]}], ")"}]}]}], "}"}], ",", 
              RowBox[{"Row", "[", 
               RowBox[{"{", 
                RowBox[{"\"\<\[FivePointedStar]\>\"", ",", 
                 RowBox[{"\"\<d\>\"", "[", 
                  RowBox[{"Row", "[", 
                   RowBox[{"{", 
                    RowBox[{"\"\<Y\>\"", ",", 
                    RowBox[{"Column", "[", 
                    RowBox[{"{", 
                    RowBox[{"mtemp", ",", "ltemp"}], "}"}], "]"}]}], "}"}], 
                   "]"}], "]"}]}], "}"}], "]"}], ",", 
              RowBox[{"CoordinateSystem", "\[Rule]", 
               RowBox[{"{", 
                RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
              RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], "]"}]}], ";", 
         RowBox[{"result", "=", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MoveIndices", "[", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"norm", "===", "True"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"result", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                  " ", "result"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"tempidx", "//", 
                  RowBox[{
                  "idx", "\[LeftDoubleBracket]", "0", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "g"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"tempidx", "\[Rule]", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], " ", "}"}]}], ")"}], "/.", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ltemp", "\[Rule]", " ", "l"}], ",", 
              RowBox[{"mtemp", "\[Rule]", " ", "m"}]}], "}"}]}], ")"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"IntegerQ", "[", "l", "]"}]}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"!", 
                RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ")"}]}], ",", 
           RowBox[{
            RowBox[{"FSlist", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
                RowBox[{"2", "Pi"}]}], ",", 
               RowBox[{
               "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
              "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"IntegerQ", "[", "l", "]"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"FSlist", ",", 
                RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}],
              "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"IntegerQ", "[", "m", "]"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"FSlist", ",", 
                RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"Which", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
                 RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
              RowBox[{"AppendTo", "[", 
               RowBox[{"FSlist", ",", 
                RowBox[{
                 RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
                 "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"FS", "=", 
             RowBox[{
              RowBox[{"FullSimplify", "[", 
               RowBox[{"#", ",", 
                RowBox[{"Evaluate", "[", "FSlist", "]"}]}], "]"}], "&"}]}], 
            ";", "\[IndentingNewLine]", 
            RowBox[{"result", "=", "result"}]}]}], 
          RowBox[{"(*", 
           RowBox[{"//", "FS"}], "*)"}], "\[IndentingNewLine]", "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
            "Null"}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipDisplay", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
             "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"result", "=", 
            RowBox[{"TooltipStyle", "[", 
             RowBox[{"result", ",", 
              RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}], 
          "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
       "\[IndentingNewLine]", "]"}], "/;", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], ",", 
           RowBox[{"(", 
            RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
        ")"}], "&&", 
       RowBox[{"Which", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
           RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
           ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"VectorSphericalHarmonic", "[", 
       RowBox[{
        RowBox[{"idx_", "/;", 
         RowBox[{"(", 
          RowBox[{"TestIndices", "[", "idx", "]"}], ")"}]}], ",", "l_", ",", 
        "m_", ",", 
        RowBox[{"g_Tensor", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestMetricTensor", "[", "g", "]"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Dimensions", "[", "g", "]"}], "===", 
             RowBox[{"{", 
              RowBox[{"2", ",", "2"}], "}"}]}], ")"}]}], 
          RowBox[{"(*", 
           RowBox[{"&&", 
            RowBox[{"TensorIsZero", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"g", "-", 
                RowBox[{"Ricci", "[", 
                 RowBox[{
                  SubscriptBox[
                   RowBox[{"Unique", "[", "i", "]"}], "-"], ",", 
                  SubscriptBox[
                   RowBox[{"Unique", "[", "j", "]"}], "-"], ",", "g"}], 
                 "]"}]}], ")"}], "//", "Simplify"}], "]"}]}], "*)"}], ")"}]}],
         ",", 
        RowBox[{"VectorType_", "/;", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"VectorType", ",", 
           RowBox[{"(", 
            RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
          "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "coord", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",",
            "norm", ",", "tempidx", ",", "FS", ",", "FSlist"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"norm", "=", 
           RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"coord", "=", 
           RowBox[{"Coordinates", "[", "g", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"FSlist", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "\[LessEqual]", " ", 
              RowBox[{
              "coord", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
               "\[LessEqual]", 
              RowBox[{"2", "Pi"}]}], ",", 
             RowBox[{"0", "\[LessEqual]", " ", 
              RowBox[{
              "coord", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               "\[LessEqual]", "Pi"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "l", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "m", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
               RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{
               RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
               "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"FS", "=", 
           RowBox[{
            RowBox[{"FullSimplify", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Evaluate", "[", "FSlist", "]"}]}], "]"}], "&"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"SphericalHarmonicY", "[", 
              RowBox[{"l", ",", "m", ",", 
               RowBox[{"Sequence", "@@", "coord"}]}], "]"}], ",", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<Y\>\"", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "l"}], "}"}], "]"}]}], "}"}], "]"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", "coord"}], ",", 
             RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], ",", 
             RowBox[{"CovariantD", "[", 
              RowBox[{
               SuperscriptBox["tempidx", "-"], ",", "Y", ",", "g"}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{"Normal", "[", 
               RowBox[{"CovariantHodgeDual", "[", 
                RowBox[{
                 SuperscriptBox["tempidx", "-"], ",", 
                 RowBox[{"(", 
                  RowBox[{
                   SubscriptBox["\[DifferentialD]", 
                    SubscriptBox["k", "-"]], "Y"}], ")"}], ",", "g"}], "]"}], 
               "]"}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"MoveIndices", "[", 
               RowBox[{
                RowBox[{"Which", "[", 
                 RowBox[{
                  RowBox[{"norm", "===", "True"}], ",", 
                  RowBox[{"(", 
                   RowBox[{"result", "/.", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                  " ", "result"}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"tempidx", "//", 
                  RowBox[{
                  "idx", "\[LeftDoubleBracket]", "0", 
                   "\[RightDoubleBracket]"}]}], "}"}], ",", "g"}], "]"}], "/.", 
              RowBox[{"{", 
               RowBox[{"tempidx", "\[Rule]", 
                RowBox[{
                "idx", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}], " ", "}"}]}], ")"}], "//", 
            "FS"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}], "=!=", 
             "Null"}], ",", 
            RowBox[{"result", "=", 
             RowBox[{"TooltipDisplay", "[", 
              RowBox[{"result", ",", 
               RowBox[{"OptionValue", "[", "TooltipDisplay", "]"}]}], 
              "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TooltipStyle", "]"}], "=!=", 
             RowBox[{"{", "}"}]}], ",", 
            RowBox[{"result", "=", 
             RowBox[{"TooltipStyle", "[", 
              RowBox[{"result", ",", 
               RowBox[{"OptionValue", "[", "TooltipStyle", "]"}]}], "]"}]}]}],
            "]"}], ";", "\[IndentingNewLine]", "result"}]}], 
        "\[IndentingNewLine]", "]"}], "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "l", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
         ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
          RowBox[{"MatchQ", "[", 
           RowBox[{
            RowBox[{"Head", "[", "m", "]"}], ",", 
            RowBox[{"(", 
             RowBox[{"Symbol", "|", "Plus", "|", "Times"}], ")"}]}], "]"}]}], 
         ")"}], "&&", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
            RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
            ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], ";"}], "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"VectorSphericalHarmonic", "[", 
       RowBox[{
        RowBox[{"idx_", "/;", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TestIndices", "[", "idx", "]"}], "&&", 
           RowBox[{"MatchQ", "[", 
            RowBox[{"idx", ",", 
             RowBox[{"SuperMinus", "[", "_", "]"}]}], "]"}]}], ")"}]}], ",", 
        "l_", ",", "m_", ",", "\[Theta]p_Symbol", ",", "\[Phi]p_Symbol", ",", 
        RowBox[{"VectorType_", "/;", 
         RowBox[{"MatchQ", "[", 
          RowBox[{"VectorType", ",", 
           RowBox[{"(", 
            RowBox[{"\"\<Gradient\>\"", "|", "\"\<Curl\>\""}], ")"}]}], 
          "]"}]}], ",", 
        RowBox[{"opts", ":", 
         RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
      RowBox[{
       RowBox[{"Module", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "g", ",", "i", ",", "j", ",", "Y", ",", "k", ",", "result", ",", 
           "norm", ",", "tempidx", ",", "FS", ",", "FSlist", ",", "\[Phi]", 
           ",", "\[Theta]"}], "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"norm", "=", 
           RowBox[{"OptionValue", "[", "Normalize", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"FSlist", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"0", "\[LessEqual]", " ", "\[Phi]", "\[LessEqual]", 
              RowBox[{"2", "Pi"}]}], ",", 
             RowBox[{
             "0", "\[LessEqual]", "\[Theta]", "\[LessEqual]", "Pi"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "l", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{"l", "\[Element]", "NonNegativeIntegers"}]}], "]"}]}], 
           "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Head", "[", "m", "]"}], "===", "Symbol"}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{"m", "\[Element]", "Integers"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"!", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
               RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}]}], ",", 
            RowBox[{"AppendTo", "[", 
             RowBox[{"FSlist", ",", 
              RowBox[{
               RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", 
               "l"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"FS", "=", 
           RowBox[{
            RowBox[{"FullSimplify", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Evaluate", "[", "FSlist", "]"}]}], "]"}], "&"}]}], ";",
           "\[IndentingNewLine]", 
          RowBox[{"g", "=", 
           RowBox[{"Metric", "[", 
            RowBox[{
             SubscriptBox["i", "-"], ",", 
             SubscriptBox["j", "-"], ",", 
             RowBox[{"(", "\[NoBreak]", GridBox[{
                {"1", "0"},
                {"0", 
                 SuperscriptBox[
                  RowBox[{"Sin", "[", "\[Theta]", "]"}], "2"]}
               }], "\[NoBreak]", ")"}], ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
             RowBox[{"TensorName", "\[Rule]", "\"\<g\>\""}], ",", 
             RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Y", "=", 
           RowBox[{"NonMetricTensor", "[", 
            RowBox[{
             RowBox[{"{", "}"}], ",", 
             RowBox[{"SphericalHarmonicY", "[", 
              RowBox[{"l", ",", "m", ",", "\[Theta]", ",", "\[Phi]"}], "]"}], 
             ",", 
             RowBox[{"Row", "[", 
              RowBox[{"{", 
               RowBox[{"\"\<Y\>\"", ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"Null", ",", "l"}], "}"}], "]"}], ",", 
                RowBox[{"Column", "[", 
                 RowBox[{"{", 
                  RowBox[{"m", ",", "Null"}], "}"}], "]"}]}], "}"}], "]"}], 
             ",", 
             RowBox[{"CoordinateSystem", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"\[Theta]", ",", "\[Phi]"}], "}"}]}], ",", 
             RowBox[{"StartIndex", "\[Rule]", "1"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"result", "=", 
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Gradient\>\""}], ")"}], ",", 
             RowBox[{"CovariantD", "[", 
              RowBox[{
               SuperscriptBox["tempidx", "-"], ",", "Y", ",", "g"}], "]"}], 
             ",", 
             RowBox[{"(", 
              RowBox[{"VectorType", "===", "\"\<Curl\>\""}], ")"}], ",", 
             RowBox[{"(", 
              RowBox[{"CovariantHodgeDual", "[", 
               RowBox[{
                SuperscriptBox["tempidx", "-"], ",", 
                RowBox[{"(", 
                 RowBox[{
                  SubscriptBox["\[DifferentialD]", 
                   SubscriptBox["k", "-"]], "Y"}], ")"}], ",", "g"}], "]"}], 
              ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Which", "[", 
                RowBox[{
                 RowBox[{"norm", "===", "True"}], ",", 
                 RowBox[{"(", 
                  RowBox[{"result", "/.", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", " ", "comp_"}], 
                    ")"}], "\[RuleDelayed]", " ", 
                    RowBox[{"(", 
                    RowBox[{"TensorComponents", "\[Rule]", 
                    RowBox[{
                    FractionBox["1", 
                    RowBox[{"Sqrt", "[", 
                    RowBox[{"l", " ", 
                    RowBox[{"(", 
                    RowBox[{"l", "+", "1"}], ")"}]}], "]"}]], "  ", 
                    "comp"}]}], ")"}]}], "}"}]}], ")"}], ",", "True", ",", 
                 " ", "result"}], "]"}], "/.", 
               RowBox[{"{", 
                RowBox[{
                 SuperscriptBox["tempidx", "-"], "\[Rule]", " ", "idx"}], 
                "}"}]}], ")"}], "//", "FS"}], ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"\[Theta]", "\[Rule]", "\[Theta]p"}], ",", 
             RowBox[{"\[Phi]", "\[Rule]", "\[Phi]p"}]}], "}"}]}]}]}], 
        "\[IndentingNewLine]", "]"}], "/;", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "l", "]"}], "||", 
          RowBox[{
           RowBox[{"Head", "[", "l", "]"}], "===", "Symbol"}]}], ")"}], "&&", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"IntegerQ", "[", "m", "]"}], "||", 
          RowBox[{
           RowBox[{"Head", "[", "m", "]"}], "===", "Symbol"}]}], ")"}], "&&", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"IntegerQ", "[", "l", "]"}], "&&", 
            RowBox[{"IntegerQ", "[", "m", "]"}]}], ")"}], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"l", "\[GreaterEqual]", "0"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "l"}], "\[LessEqual]", "m", "\[LessEqual]", "l"}], 
            ")"}]}], ",", "True", ",", "True"}], "]"}]}]}]}], ";"}], 
    "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8842111799679384`*^9, 3.884211208663726*^9}, {
   3.8842113327198052`*^9, 3.884211349708627*^9}, {3.8842120618296947`*^9, 
   3.8842120711925664`*^9}, {3.884212102090336*^9, 3.8842121449134693`*^9}, {
   3.884212220385887*^9, 3.884212287902378*^9}, 3.884212364732334*^9, {
   3.8842124479732265`*^9, 3.884212474087426*^9}, {3.8842125872596455`*^9, 
   3.8842126004813623`*^9}, {3.884212721113248*^9, 3.8842128053821273`*^9}, {
   3.8842128533406825`*^9, 3.8842128556062346`*^9}, {3.884212919019755*^9, 
   3.884212971543861*^9}, {3.884213341240335*^9, 3.8842134408385954`*^9}, {
   3.8842134714576373`*^9, 3.884213479215489*^9}, {3.8842135287050447`*^9, 
   3.8842135509518585`*^9}, {3.8842137270656085`*^9, 3.884213803120216*^9}, {
   3.8842153165278273`*^9, 3.8842153243590126`*^9}, {3.884216057538616*^9, 
   3.8842160840764046`*^9}, {3.8842161708415847`*^9, 3.884216190713771*^9}, {
   3.884216285793537*^9, 3.8842163504480495`*^9}, 3.8842171224519215`*^9, {
   3.8842171526988573`*^9, 3.8842172051628532`*^9}, {3.8842172925236835`*^9, 
   3.884217355577456*^9}, {3.884217387817747*^9, 3.884217559106192*^9}, 
   3.8842176247605553`*^9, {3.8842176652323236`*^9, 3.8842176691119366`*^9}, {
   3.8842180067846823`*^9, 3.8842181160125628`*^9}, {3.8842187297934227`*^9, 
   3.884218732504753*^9}, {3.884218769097356*^9, 3.8842187758324037`*^9}, {
   3.8842198970105605`*^9, 3.8842198975552254`*^9}, {3.8847725583453474`*^9, 
   3.884772694357439*^9}, {3.8847730879350386`*^9, 3.8847731814856796`*^9}, {
   3.8847733733150434`*^9, 3.884773411463228*^9}, {3.884773713220128*^9, 
   3.8847737559787064`*^9}, {3.8847742769732823`*^9, 
   3.8847743371864786`*^9}, {3.8847745701966186`*^9, 3.884774585388344*^9}, {
   3.8847771389883747`*^9, 3.884777248808498*^9}, {3.8847773323381205`*^9, 
   3.8847773657724657`*^9}, {3.884777433537753*^9, 3.8847774623712406`*^9}, {
   3.88477774915334*^9, 3.8847777945223017`*^9}, {3.8847778311500263`*^9, 
   3.8847778567222977`*^9}, {3.884777894084848*^9, 3.8847780996136293`*^9}, {
   3.884778213493109*^9, 3.8847782247188997`*^9}, {3.884778276048366*^9, 
   3.8847783034797277`*^9}, 3.884778563193598*^9, 3.8847786246010637`*^9, {
   3.8847786570848303`*^9, 3.884778681450074*^9}, {3.8847787174242096`*^9, 
   3.884778737568679*^9}, {3.884778789361764*^9, 3.884778807209193*^9}, {
   3.884778989654413*^9, 3.8847790337839985`*^9}, {3.8847790876765347`*^9, 
   3.884779090051464*^9}, {3.8847791344562144`*^9, 3.8847791905151544`*^9}, {
   3.8847794384306984`*^9, 3.8847794472939796`*^9}, {3.884808910539687*^9, 
   3.884808993629153*^9}, {3.8848092468668528`*^9, 3.8848092584097037`*^9}, 
   3.884809531350893*^9, {3.8853770548177433`*^9, 3.8853770800476036`*^9}, {
   3.8853788852282257`*^9, 3.8853788997772565`*^9}, {3.8853797146679535`*^9, 
   3.8853797212509594`*^9}, 3.885380034450748*^9, {3.8853801942724185`*^9, 
   3.885380227359583*^9}, {3.885380313793097*^9, 3.8853803198183784`*^9}, {
   3.885382727483036*^9, 3.8853827346196365`*^9}, {3.885384569036267*^9, 
   3.8853846127591195`*^9}, {3.885384651395302*^9, 3.8853847685720725`*^9}, {
   3.8853876735131207`*^9, 3.8853876795713844`*^9}, {3.8853887475957575`*^9, 
   3.885388783458391*^9}, {3.8853895956652217`*^9, 3.8853896048391438`*^9}, {
   3.8854383951490545`*^9, 3.8854383971406994`*^9}, 3.8859637166042895`*^9, {
   3.8859858592724957`*^9, 3.885985863780736*^9}, 3.8859859757145605`*^9, {
   3.885986143564756*^9, 3.885986242604554*^9}, {3.8859869157516174`*^9, 
   3.885986924516262*^9}, {3.886043716667695*^9, 3.886043723940254*^9}, 
   3.886116295880954*^9, {3.887018559591035*^9, 3.88701859518428*^9}, {
   3.8870186306190505`*^9, 3.8870186385618443`*^9}, {3.8922100563046684`*^9, 
   3.892210147318981*^9}, {3.8922101815943794`*^9, 3.8922101875457277`*^9}, {
   3.8922103663401184`*^9, 3.8922103952288847`*^9}, {3.8955547752305737`*^9, 
   3.895554775261554*^9}, {3.8955551726514406`*^9, 
   3.8955551726584353`*^9}},ExpressionUUID->"50c6e264-7529-47c9-b7ad-\
c8dfe917b77a"]
}, Closed]],

Cell[CellGroupData[{

Cell["ElectromagneticStressEnergyTensor", "Subsection",
 CellChangeTimes->{
  3.8955460780113373`*^9},ExpressionUUID->"a55d1c18-3c45-4e1f-9386-\
d993b2e4baea"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElectromagneticStressEnergyTensor", "[", 
    RowBox[{
     RowBox[{"\[Mu]T1_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T1", "]"}]}], ",", 
     RowBox[{"\[Mu]T2_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T2", "]"}]}], ",", 
     RowBox[{"F_Tensor", "/;", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TensorType", "[", "F", "]"}], "===", "\"\<Faraday\>\""}], 
       ")"}]}], ",", 
     RowBox[{"m_Tensor", "/;", 
      RowBox[{"TestMetricTensor", "[", "m", "]"}]}], ",", 
     RowBox[{"opts", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "Tup", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Alpha]", ",", "\[Beta]"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Tup", "=", 
       RowBox[{"RemoveUnderBarredIndices", "[", 
        RowBox[{"TensorsProduct", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Which", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
               "\"\<Mostly minus\>\""}], ")"}], ",", " ", 
             RowBox[{"-", "1"}], ",", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
               "\"\<Mostly plus\>\""}], ")"}], ",", " ", "1"}], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TensorsProduct", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SuperscriptBox["\[Mu]", "-"], ",", 
                    SuperscriptBox["\[Alpha]", "-"]}], "}"}], ",", "m"}], 
                 "]"}], ",", " ", 
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SuperscriptBox["\[Nu]", "-"], ",", 
                    SubscriptBox["\[Alpha]", "-"]}], "}"}], ",", "m"}], 
                 "]"}]}], "}"}], "]"}], "-", 
             RowBox[{"TensorsProduct", "[", 
              RowBox[{"{", 
               RowBox[{
                FractionBox["1", "4"], ",", 
                RowBox[{"Metric", "[", 
                 RowBox[{
                  SuperscriptBox["\[Mu]", "-"], ",", 
                  SuperscriptBox["\[Nu]", "-"], ",", "m"}], "]"}], ",", 
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SubscriptBox["\[Alpha]", "-"], ",", 
                    SubscriptBox["\[Beta]", "-"]}], "}"}], ",", "m"}], "]"}], 
                ",", " ", 
                RowBox[{"MoveIndices", "[", 
                 RowBox[{"F", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    SuperscriptBox["\[Alpha]", "-"], ",", 
                    SuperscriptBox["\[Beta]", "-"]}], "}"}], ",", "m"}], 
                 "]"}]}], "}"}], "]"}]}], ")"}]}], ",", "Tensor", ",", 
          RowBox[{"TensorName", "\[Rule]", " ", "\"\<T\>\""}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"MoveIndices", "[", 
       RowBox[{"Tup", ",", 
        RowBox[{"{", 
         RowBox[{"\[Mu]T1", ",", "\[Mu]T2"}], "}"}], ",", "m"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.8955464645924206`*^9, 3.8955464677672596`*^9}, {
   3.895554775272547*^9, 3.895554775275545*^9}, 3.895555172662923*^9, 
   3.8966132596299334`*^9, 
   3.8974732966612697`*^9},ExpressionUUID->"e76f6b7f-8058-4fc4-8e18-\
32647377a312"]
}, Closed]],

Cell[CellGroupData[{

Cell["Ideal Magnetohydrodynamics (iMHD) in 4D", "Subsection",
 CellChangeTimes->{{3.6712529656246877`*^9, 3.6712529992017484`*^9}, 
   3.6712918765546055`*^9, {3.671306355705207*^9, 3.6713063567529087`*^9}, {
   3.671973284907233*^9, 3.671973287294138*^9}, 
   3.6728125969265647`*^9},ExpressionUUID->"9aeb1f18-2f1d-4f6e-b2d8-\
2c04ed42fe68"],

Cell[CellGroupData[{

Cell["Description (Reference only, no code)", "Subsubsection",
 CellChangeTimes->{{3.6712939383165674`*^9, 3.6712939602890015`*^9}, {
  3.6713264163476667`*^9, 
  3.671326425672784*^9}},ExpressionUUID->"5db8945c-3ed2-4319-93e6-\
ef131d7ea38b"],

Cell[TextData[{
 "The primary goal of these functions in ",
 StyleBox["TensoriaCalc",
  FontSlant->"Italic"],
 " pre-pended with \[OpenCurlyDoubleQuote]MHD\[CloseCurlyDoubleQuote] is to \
implement the partial differential equations (PDEs) of ideal \
magnetohydrodynamics (MHD) in a user-specified 4-dimensional (4D) curved \
spacetime. "
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6712999242607985`*^9}, {3.6713002674192395`*^9, 3.67130026770004*^9}, {
   3.671301138554565*^9, 3.6713011412789707`*^9}, {3.6713025332643924`*^9, 
   3.671302583890283*^9}, {3.6713063610760164`*^9, 3.671306370954634*^9}, {
   3.6713172720006523`*^9, 3.671317305271164*^9}, 3.67205765272163*^9, {
   3.672615347021308*^9, 3.67261535107387*^9}, 
   3.6728041921198864`*^9},ExpressionUUID->"550153cc-829c-4cab-b436-\
a3dffadefa9f"],

Cell[TextData[{
 StyleBox["\[OpenCurlyDoubleQuote]Frozen-in\[CloseCurlyDoubleQuote] condition",
  FontWeight->"Bold"],
 "\tIdeal MHD describes Maxwell's equations coupled to an \
electromagnetic-current-carrying perfect fluid plasma, in such a way that the \
latter's number density current ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "bd22dff8-97b3-423c-96b0-cf43139db58e"],
 " is always orthogonal to the electromagnetic field strength ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c6c53874-c0a3-4f1f-8742-9d7ec219c9ea"],
 ", i.e., ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "\[Mu]"], 
     SubscriptBox["F", "\[Mu]\[Nu]"]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"d80b0ee4-adcb-4704-bad1-9358954411c1"],
 "."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6712999242607985`*^9}, {3.6713002674192395`*^9, 3.67130026770004*^9}, {
   3.671301138554565*^9, 3.6713011412789707`*^9}, {3.6713025332643924`*^9, 
   3.671302583890283*^9}, {3.6713063610760164`*^9, 3.671306370954634*^9}, {
   3.6713172720006523`*^9, 3.671317305271164*^9}, 3.67205765272163*^9, {
   3.672615347021308*^9, 3.67261535107387*^9}, {3.6728041921198864`*^9, 
   3.672804202689913*^9}, {3.6728477815841436`*^9, 3.6728477818411584`*^9}, {
   3.67284786194174*^9, 
   3.6728478793117332`*^9}},ExpressionUUID->"06625af5-e892-4986-a9e0-\
3fcb55cd4351"],

Cell[TextData[{
 StyleBox["Fields",
  FontWeight->"Bold"],
 "\t\tThe fundamental degrees of freedom in 4D MHD are 3 scalar fields, which \
we will denote here as {",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["\[CapitalPhi]", "I"], "=", " ", 
     SubscriptBox["\[CapitalPhi]", "I"]}], ",", 
    RowBox[{"I", "=", "1"}], ",", "2", ",", "3"}], TraditionalForm]],
  ExpressionUUID->"8f9bafb6-fee1-48c5-9fea-1ba50ba535f7"],
 "}."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
  3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
  3.6712999847107153`*^9}, {3.6713011559638033`*^9, 3.6713011566044044`*^9}, {
  3.6713025903862963`*^9, 3.6713025945993032`*^9}, {3.6720577776285486`*^9, 
  3.6720577874011984`*^9}, {3.6728478276507783`*^9, 
  3.6728478418005877`*^9}},ExpressionUUID->"4fe5a98c-8d34-40fb-a0f9-\
d95ece083cf3"],

Cell[TextData[{
 "From the first two scalar fields, we build the electromagnetic tensor from \
the wedge product of their associated 1-forms: ",
 Cell[BoxData[
  FormBox["F", TraditionalForm]],ExpressionUUID->
  "6309e498-ec00-42d3-ac4a-baf3195abf55"],
 " = \[DifferentialD]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalPhi]", "1"], TraditionalForm]],ExpressionUUID->
  "43663510-bd6c-473b-986e-e7cb02bfdef5"],
 "\[Wedge] \[DifferentialD]",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalPhi]", "2"], TraditionalForm]],ExpressionUUID->
  "ea8b0a16-82e1-4a11-9332-48810fd61099"],
 ", or in components,\n\t ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["F", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c9d7bfeb-49cb-44fc-bfa6-dd71d383400c"],
 " = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", 
    RowBox[{"[", "\[Mu]"}]], TraditionalForm]],ExpressionUUID->
  "594cf7d7-8801-4fad-9064-b58c963965ac"],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[CapitalPhi]", "1"], TraditionalForm]],ExpressionUUID->
  "7f2da032-a3d7-47a4-afaf-d38ba42596ba"],
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[PartialD]", 
    RowBox[{"\[Nu]", "]"}]], TraditionalForm]],ExpressionUUID->
  "14f866d0-47f6-4443-b36d-74e55f68d28f"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[CapitalPhi]", "2"], "\[Congruent]", " "}], 
   TraditionalForm]],ExpressionUUID->"97a8f05d-248e-4809-ae61-77c2bf8ba289"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}]}], "-", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Nu]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}]}]}], TraditionalForm]],
  ExpressionUUID->"f19e4706-bd18-49b5-af67-35a5807f25da"],
 "."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
  3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
  3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.6713003548108*^9}, {
  3.6713022457043276`*^9, 3.671302250464336*^9}, {3.6716554243959045`*^9, 
  3.6716554267284403`*^9}},ExpressionUUID->"484f6c56-4b94-4e41-89a3-\
11bbf52411f1"],

Cell[TextData[{
 "The third scalar field enters in the plasma current,\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "\[Mu]"], "=", 
    SuperscriptBox[
     OverscriptBox["\[Epsilon]", "~"], 
     RowBox[{"\[Mu]", " ", "\[Alpha]\[Beta]\[Gamma]"}]]}], TraditionalForm]],
  ExpressionUUID->"cd674a85-66b2-4ce9-bab3-629d7bd08397"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Alpha]"], 
    SuperscriptBox["\[CapitalPhi]", "1"]}], TraditionalForm]],ExpressionUUID->
  "a59f03a2-7da9-4b74-afb0-aa9593f51668"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Beta]"], 
    SuperscriptBox["\[CapitalPhi]", "2"]}], TraditionalForm]],ExpressionUUID->
  "0735f634-a893-4d34-9214-b56f304d042c"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[PartialD]", "\[Gamma]"], 
    SuperscriptBox["\[CapitalPhi]", "3"]}], TraditionalForm]],ExpressionUUID->
  "ae1caf8e-9548-48ee-b207-3f60ca278584"],
 ".\nBecause of the anti-symmetric properties of the covariant Levi-Civita \
tensor ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    OverscriptBox["\[Epsilon]", "~"], 
    RowBox[{"\[Mu]", " ", "\[Alpha]\[Beta]\[Gamma]"}]], TraditionalForm]],
  ExpressionUUID->"1853f0d9-d4b6-4b03-a51f-0562dfee9b8b"],
 ", we can see directly that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "\[Mu]"], 
     RowBox[{
      SubscriptBox["\[PartialD]", "\[Mu]"], 
      SuperscriptBox["\[CapitalPhi]", "I"]}]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"caf1167a-56f1-43d5-81c5-a822aa77ae70"],
 ", and hence ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["n", "\[Mu]"], 
     SubscriptBox["F", "\[Mu]\[Nu]"]}], "=", "0"}], TraditionalForm]],
  ExpressionUUID->"c8243cb4-0f69-4efe-bce5-e9e2b1779d17"],
 ", as already advertised."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
  3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
  3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
  3.671301168251836*^9, 3.671301219523346*^9}, {3.671302283501396*^9, 
  3.671302285156999*^9}, {3.6713064349874682`*^9, 3.6713065040065913`*^9}, {
  3.671325910470871*^9, 3.6713259156956806`*^9}, {3.671655439988644*^9, 
  3.6716554446362157`*^9}, {3.672847949864769*^9, 
  3.672847998587556*^9}},ExpressionUUID->"9a4d30a7-e9b1-49e7-ad9a-\
e04e4ad3649c"],

Cell[TextData[{
 StyleBox["Action",
  FontWeight->"Bold"],
 "\tThe action for MHD is\n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "MHD"], TraditionalForm]],ExpressionUUID->
  "da779efb-c03e-4cee-9737-89b65bed5c43"],
 " ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Congruent]", " ", 
    RowBox[{"\[Integral]", 
     RowBox[{
      RowBox[{
       SuperscriptBox["\[DifferentialD]", "4"], 
       SuperscriptBox[
        RowBox[{"x", "(", 
         RowBox[{"|", "g", "|"}], ")"}], 
        RowBox[{"1", "/", "2"}]]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SubscriptBox["\[Rho]", "0"], "[", 
          RowBox[{
           SubscriptBox["\[Sigma]", "g"], 
           RowBox[{
            SuperscriptBox["n", "2"], "/", "2"}]}], "]"}]}], "-", 
        RowBox[{
         FractionBox["1", "4"], 
         SubscriptBox["F", "\[Mu]\[Nu]"], 
         SuperscriptBox["F", "\[Mu]\[Nu]"]}]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"88832433-85a0-48b6-93c8-cea521bc8246"],
 ", \t(Eq. 0)\nwhere ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "0"], TraditionalForm]],ExpressionUUID->
  "081b1362-ca0f-44c7-8f2e-654b02f1f06c"],
 " depends on spacetime solely through the plasma current squared ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["n", "2"], " "}], TraditionalForm]],ExpressionUUID->
  "ac71e382-fcde-4f1d-8046-2b6a88e8d0b7"],
 "\[Congruent] ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["n", "\[Mu]"], 
    SuperscriptBox["n", "\[Mu]"]}], TraditionalForm]],ExpressionUUID->
  "ee9cfb10-d739-408e-9989-8683446bdef1"],
 "; the \n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "g"], TraditionalForm]],ExpressionUUID->
  "7fa876e4-85a5-4270-a110-991c15ef0237"],
 "=+1 \tif you use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], "=", 
    RowBox[{"diag", "[", 
     RowBox[{
      RowBox[{"+", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "ecbe931b-43b9-47a7-aadf-6a40be46be5a"],
 ", \tand \n\t",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "g"], TraditionalForm]],ExpressionUUID->
  "88ef3c17-e3f6-4ecc-a418-f36a57e109da"],
 "=-1 \t\tif you use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Eta]", "\[Mu]\[Nu]"], "=", 
    RowBox[{"diag", "[", 
     RowBox[{
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "]"}]}], TraditionalForm]],ExpressionUUID->
  "587517c8-a071-408b-af76-0200afc2a44c"],
 ". "
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.6713015211602836`*^9}, {3.6713021050902667`*^9, 
   3.6713021175900917`*^9}, {3.671302187410219*^9, 3.671302230187499*^9}, {
   3.6713022613933554`*^9, 3.6713022747623806`*^9}, {3.6713026394845953`*^9, 
   3.6713026552222257`*^9}, {3.6713163754068813`*^9, 
   3.6713163767344017`*^9}, {3.6713168451540966`*^9, 3.6713168531742196`*^9}, 
   3.6713254673688707`*^9, {3.6713261628766065`*^9, 3.671326165437511*^9}, 
   3.671416946336981*^9, {3.6716553861103163`*^9, 3.671655395090454*^9}, {
   3.672000174407357*^9, 3.672000252570828*^9}, {3.6720577487456045`*^9, 
   3.6720577601732807`*^9}, {3.6721992727423687`*^9, 
   3.6721992897763424`*^9}, {3.6726338051713476`*^9, 3.672633841555118*^9}, {
   3.6728042174099483`*^9, 3.6728042322774773`*^9}, {3.6733611839717145`*^9, 
   3.673361208718671*^9}},ExpressionUUID->"737bb917-bcee-448c-8c61-\
0e630eff150f"],

Cell[TextData[{
 "See https://arxiv.org/abs/1410.5843 and http://arxiv.org/abs/1412.3135 for \
a discussion of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", "MHD"], TraditionalForm]],ExpressionUUID->
  "5bcddd49-1367-49b8-ac72-3e6d53d2dc78"],
 " as a special case of string fluids. The ",
 Cell[BoxData[
  FormBox[
   RowBox[{"-", 
    SubscriptBox["\[Rho]", "0"]}], TraditionalForm]],ExpressionUUID->
  "b3365926-e120-4052-9d47-ac239a5804e4"],
 " describes the plasma and the ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{"1", "/", "4"}], ")"}]}], 
    SuperscriptBox["F", "2"]}], TraditionalForm]],ExpressionUUID->
  "571689af-7c14-4d7a-84ae-9e382a2ad43b"],
 " portion is the Maxwell action. Note that, by allowing ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Rho]", "0"], TraditionalForm]],ExpressionUUID->
  "2205f59f-5a1e-4683-8f54-c9e678681944"],
 " to depend on spacetime solely through ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["n", "2"], TraditionalForm]],ExpressionUUID->
  "3e01f928-01c7-441b-a7aa-c4b1bce97ea4"],
 ", we are not taking into account the additional conserved charges that \
might be present; for a field theoretic discussion; see, for e.g., arXiv: \
1107.0731."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.6713015211602836`*^9}, {3.6713021050902667`*^9, 
   3.6713021175900917`*^9}, {3.671302187410219*^9, 3.671302230187499*^9}, {
   3.6713022613933554`*^9, 3.6713022747623806`*^9}, {3.6713026394845953`*^9, 
   3.6713026552222257`*^9}, {3.6713163754068813`*^9, 
   3.6713163767344017`*^9}, {3.6713168451540966`*^9, 3.6713168531742196`*^9}, 
   3.6713254673688707`*^9, {3.6713261628766065`*^9, 3.671326165437511*^9}, 
   3.671416946336981*^9, {3.6716553861103163`*^9, 3.671655395090454*^9}, {
   3.672000174407357*^9, 3.672000252570828*^9}, {3.6720577487456045`*^9, 
   3.6720577601732807`*^9}, {3.6721992727423687`*^9, 
   3.6721992897763424`*^9}, {3.6726338051713476`*^9, 3.672633841555118*^9}, {
   3.673286561825926*^9, 3.6732866350221124`*^9}, {3.6733139956381245`*^9, 
   3.67331400411861*^9}},ExpressionUUID->"cda8c66d-f29b-4fb2-8ec7-\
df06179942fe"],

Cell[TextData[{
 StyleBox["iMHD Equations",
  FontWeight->"Bold"],
 ".\tIf we first define \n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["P", "\[Alpha]\[Beta]"], "\[Congruent]", 
    RowBox[{
     SubscriptBox["\[Del]", "\[Sigma]"], 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["\[Sigma]", "g"], 
       RowBox[{
        RowBox[{
         SubscriptBox["\[Rho]", "0"], "'"}], "[", 
        RowBox[{
         SubscriptBox["\[Sigma]", "g"], 
         RowBox[{
          SuperscriptBox["n", "2"], "/", "2"}]}], "]"}], " ", 
       RowBox[{
        SuperscriptBox["\[Del]", 
         RowBox[{"[", "\[Sigma]"}]], 
        SubscriptBox["\[CapitalPhi]", "1"]}], " ", 
       RowBox[{
        SuperscriptBox["\[Del]", "\[Alpha]"], 
        SubscriptBox["\[CapitalPhi]", "2"]}], " ", 
       RowBox[{
        SuperscriptBox["\[Del]", 
         RowBox[{"\[Beta]", "]"}]], 
        SubscriptBox["\[CapitalPhi]", "3"]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"d112b565-42f8-4db3-918f-441d6de9c07f"],
 ",\nthe Maxwell\[CloseCurlyQuote]s equations part of MHD are\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Sigma]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], 
      SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Alpha]"], 
      SuperscriptBox["\[CapitalPhi]", "1"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Beta]"], 
      SuperscriptBox["\[CapitalPhi]", "3"]}], 
     SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], TraditionalForm]],
  ExpressionUUID->"d12bc89e-9b4d-40bd-b2ef-6485ce5f4ddb"],
 "\t(Eq. 1)\n\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Sigma]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Mu]"], 
      SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", "\[Alpha]"], 
      SuperscriptBox["\[CapitalPhi]", "2"]}], 
     RowBox[{
      SubscriptBox["\[Del]", "\[Beta]"], 
      SuperscriptBox["\[CapitalPhi]", "3"]}], 
     SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], TraditionalForm]],
  ExpressionUUID->"c7ec35d4-e5a4-4567-a77c-eee0f0f84683"],
 "\t(Eq. 2)\nwhile the plasma portion of MHD reads\n\t0 = ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["F", "\[Alpha]\[Beta]"], 
    SuperscriptBox["P", "\[Alpha]\[Beta]"]}], TraditionalForm]],
  ExpressionUUID->"b3e22f0e-0452-4a52-b615-3530714f79ea"],
 "\t\t\t\t(Eq. 3)"
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.67130161042527*^9}, {3.671301642739733*^9, 3.67130189913665*^9}, {
   3.6713020725946083`*^9, 3.671302080791623*^9}, {3.671302294196416*^9, 
   3.671302299942226*^9}, {3.671302701437313*^9, 3.671302707921325*^9}, {
   3.671308035066533*^9, 3.671308035066533*^9}, {3.671311462510113*^9, 
   3.671311462510113*^9}, {3.6713168260038023`*^9, 3.671316842011548*^9}, 
   3.6713172420976934`*^9, {3.671916353600253*^9, 3.671916353600253*^9}, {
   3.672000264598516*^9, 3.672000264598516*^9}, {3.6720658484648476`*^9, 
   3.672065853317422*^9}, {3.672199241914605*^9, 3.672199252737224*^9}, 
   3.672633787858714*^9},ExpressionUUID->"7365e31d-053a-4341-847b-\
9d20c90a79a6"],

Cell[TextData[{
 "Note that, ",
 StyleBox["Force-Free-Electrodynamics",
  FontSlant->"Italic"],
 " (FFE) \n\t",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Del]", "\[Sigma]"], TraditionalForm]],ExpressionUUID->
  "40540c97-d284-4ce6-baf9-dfafda2aae49"],
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    RowBox[{"T", "[", "EM", "]"}], "\[Sigma]\[Alpha]"], TraditionalForm]],
  ExpressionUUID->"49495f34-0125-499a-adf7-110428497e99"],
 " = ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Sigma]", "g"], TraditionalForm]],ExpressionUUID->
  "0f425b4a-2f13-45c2-af9b-768c5490aa75"],
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[Del]", "\[Mu]"], 
     SuperscriptBox["F", "\[Mu]\[Sigma]"]}], 
    SubscriptBox["F", "\[Sigma]\[Alpha]"]}], TraditionalForm]],ExpressionUUID->
  "f5df8c90-6771-4fab-b581-fec05ad0494f"],
 ",\t\t",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      SubscriptBox["\[Del]", 
       RowBox[{"[", "\[Alpha]"}]], 
      SubscriptBox["F", 
       RowBox[{"\[Beta]\[Gamma]", "]"}]]}], "=", "0"}], ","}], 
   TraditionalForm]],ExpressionUUID->"524c1cae-c551-40ae-94a2-89ad1bc354d7"],
 "\n(i.e., where the electromagnetic current becomes orthogonal to the \
Maxwell tensor) is the limit where Eq. 3 is neglected and the \
right-hand-sides of Eq. 1 and Eq. 2 are set to zero."
}], "Text",
 CellChangeTimes->{{3.6712939736745253`*^9, 3.671293991572858*^9}, {
   3.6712969404506416`*^9, 3.6712970253866053`*^9}, {3.6712997216015625`*^9, 
   3.6713002470684023`*^9}, {3.6713002953152914`*^9, 3.671300453483987*^9}, {
   3.671301168251836*^9, 3.6713013179499617`*^9}, {3.671301439298715*^9, 
   3.6713015211602836`*^9}, {3.6713021050902667`*^9, 
   3.6713021175900917`*^9}, {3.671302187410219*^9, 3.671302230187499*^9}, {
   3.6713022613933554`*^9, 3.6713022747623806`*^9}, {3.6713026394845953`*^9, 
   3.6713026552222257`*^9}, {3.6713163754068813`*^9, 
   3.6713163767344017`*^9}, {3.6713168451540966`*^9, 
   3.6713168531742196`*^9}, {3.6713254673688707`*^9, 3.671325587440387*^9}, {
   3.671325641949685*^9, 3.671325673935543*^9}, {3.6713262351501374`*^9, 
   3.671326276096711*^9}, {3.6720578277743187`*^9, 3.672057856699763*^9}, {
   3.672065866985132*^9, 3.6720659248185205`*^9}, {3.6726338705178776`*^9, 
   3.6726338737439833`*^9}, {3.6726339216357756`*^9, 
   3.6726339453866234`*^9}, {3.6727105453318057`*^9, 3.672710565891543*^9}, 
   3.673661973765536*^9},ExpressionUUID->"2910b6b4-dd90-4a69-8a52-\
32d0f911eefa"],

Cell[TextData[{
 StyleBox["Credit",
  FontWeight->"Bold"],
 "\t\tIf you use MHDSystem for scientific research, please cite the URL \
http://www.stargazing.net/yizen/MHD.html; and the paper at \
http://arxiv.org/abs/1605.08786, during the course of which MHDSystem was \
developed."
}], "Text",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQvW3qVqaCqNeOt0I+sYDoFdl9pYVAWihepwFEMzgY
XywC0lEGj4SKgfQ9sVcSIPpSzXodEM3Fz9EGosXS9s0A0cL9L5eDaG5F1U0g
uvyx0m8QzfFo0x8Q3aKQy1oCpP/9P8oFouOmreED0TmpEQIg+lzje1sQXSnz
3B5E67C+/VQFpC0axD+D6Jh3S3SrgbTp5KV6IPrU2ezkeiC9TDyvCERfSrar
BNE/3tvWgui3Z1MOg2gnieYTINrieMWfJ9GvHUtTxBieAmmTtviXL4B0kOGs
DyC6ZNIFx38xrx23nTN3AtFuESYeINoiXscbRKvP09qkHPvasbV9zxYQ7Vq/
w+lL3GvHvVLfvEE0ANAtp6Y=
  "],ExpressionUUID->"0b80b6e4-d06c-4784-8abe-4917f26d885e"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDSystem", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 
  3.671291759353691*^9}},ExpressionUUID->"865bec23-b795-4f79-abb2-\
692dba52b506"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MHDSystem", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ph1_", ",", "ph2_", ",", "ph3_"}], "}"}], ",", "rho_Function",
       ",", "gBH_Tensor", ",", 
      RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], "/;", 
    RowBox[{"TestMetricTensor", "[", "gBH", "]"}]}], ":=", 
   RowBox[{
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "MHDRules", ",", "\[Rho]0", ",", "nT", ",", "q123", ",", "n", ",", 
        "\[Alpha]1", ",", "\[Alpha]2", ",", "\[Alpha]3", ",", "\[Zeta]", ",", 
        "F\[Mu]\[Nu]", ",", "F\[Mu]\[Nu]T", ",", "LHS1", ",", "LHS2", ",", 
        "RHS1", ",", "RHS2", ",", "RHS3", ",", "\[CapitalPhi]1", ",", 
        "\[CapitalPhi]2", ",", "\[CapitalPhi]3", ",", "x0", ",", "x1", ",", 
        "x2", ",", "x3", ",", "si", ",", "\[Sigma]", ",", "\[Rho]", ",", 
        "\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]", ",", "X", ",", "Y", ",", 
        "Z", ",", "\[Mu]", ",", "\[Nu]", ",", "\[Beta]1", ",", "\[Gamma]1", 
        ",", "q123T", ",", "q1", ",", "q2", ",", "q3", ",", "q1T", ",", "q2T",
         ",", "q3T", ",", "\[Rho]0q123T", ",", "\[Rho]0q123", ",", "P", ",", 
        "PT", ",", "divF", ",", "divFT", ",", "F2", ",", "MaxwellT", ",", 
        "PlasmaT", ",", "coords", ",", "Opr", ",", "gsgn", ",", "TotalT"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "metric", " ", "signature", " ", "converted", " ", "to", " ", "sign", 
        " ", "of", " ", "eta_", "00"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"gsgn", "=", 
        RowBox[{"Which", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
            "\"\<Mostly minus\>\""}], ")"}], ",", "1", ",", 
          "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
            "\"\<Mostly plus\>\""}], ")"}], ",", 
          RowBox[{"-", "1"}]}], "\[IndentingNewLine]", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"gradients", " ", "of", " ", "X", " ", "Y", " ", "Z"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{"coords", "=", 
        RowBox[{"Coordinates", "[", 
         RowBox[{"UniqueIndices", "[", "gBH", "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Replacement", " ", "rules"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"MHDRules", "=", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"\[CapitalPhi]1", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "coords", "]"}], ",", "ph1"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\[CapitalPhi]2", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "coords", "]"}], ",", "ph2"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\[CapitalPhi]3", "\[Rule]", 
           RowBox[{"Function", "[", 
            RowBox[{
             RowBox[{"Evaluate", "[", "coords", "]"}], ",", "ph3"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\[Rho]0", "\[Rule]", "rho"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Opr", " ", "acts", " ", "on", " ", "output"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Opr", "=", 
        RowBox[{"OptionValue", "[", "MHDOperator", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"NewCode", ":", " ", "ExtractFunctions"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"si", "=", 
        RowBox[{"StartIndex", "[", "gBH", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q1T", "[", "\[Sigma]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "Del", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(1\)]\)\>\"", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Sigma]", "-"], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPhi]1", "[", 
                   RowBox[{"Sequence", "@@", "coords"}], "]"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "coords"}], ")"}], "/.", "MHDRules"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q1", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"q1T", "[", "\[Alpha]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q2T", "[", "\[Sigma]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "Del", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(2\)]\)\>\"", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Sigma]", "-"], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPhi]2", "[", 
                   RowBox[{"Sequence", "@@", "coords"}], "]"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "coords"}], ")"}], "/.", "MHDRules"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q2", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"q2T", "[", "\[Sigma]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q3T", "[", "\[Sigma]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Gradient\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "Del", "[", 
            "\"\<\!\(\*SubscriptBox[\(\[CapitalPhi]\), \(3\)]\)\>\"", "]"}]}],
           ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Sigma]", "-"], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"D", "[", 
                 RowBox[{
                  RowBox[{"\[CapitalPhi]3", "[", 
                   RowBox[{"Sequence", "@@", "coords"}], "]"}], ",", "#"}], 
                 "]"}], "&"}], "/@", "coords"}], ")"}], "/.", "MHDRules"}], 
            ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q3", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"q3T", "[", "\[Sigma]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "Maxwell", " ", "tensor", " ", "and", " ", "its", " ", "divergence"}],
         " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"F\[Mu]\[Nu]T", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<Maxwell\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"F\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Sigma]", "-"], ",", 
             SubscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"TensorWedge", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q1", "[", 
                SubscriptBox["\[Alpha]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q2", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}]}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"F\[Mu]\[Nu]", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_"}], "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"F\[Mu]\[Nu]T", "[", 
           RowBox[{"\[Sigma]", ",", "\[Rho]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "\[Beta]"}], "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"maxwell", " ", "stress", " ", "tensor"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"TensorContract", "[", 
         RowBox[{
          RowBox[{"TensorProduct", "[", 
           RowBox[{
            RowBox[{"TensorComponents", "[", 
             RowBox[{"F\[Mu]\[Nu]", "[", 
              RowBox[{
               SubscriptBox["\[Alpha]", "-"], ",", 
               SubscriptBox["\[Beta]", "-"]}], "]"}], "]"}], ",", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"F\[Mu]\[Nu]", "[", 
              RowBox[{
               SuperscriptBox["\[Alpha]", "-"], ",", 
               SuperscriptBox["\[Beta]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "3"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"gsgn", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"TensorContract", "[", 
              RowBox[{
               RowBox[{"TensorProduct", "[", 
                RowBox[{
                 RowBox[{"TensorComponents", "[", 
                  RowBox[{"F\[Mu]\[Nu]", "[", 
                   RowBox[{
                    SubscriptBox["\[Alpha]", "-"], ",", 
                    SubscriptBox["\[Beta]", "-"]}], "]"}], "]"}], ",", 
                 RowBox[{"TensorComponents", "[", 
                  RowBox[{"F\[Mu]\[Nu]", "[", 
                   RowBox[{
                    SubscriptBox["\[Alpha]", "-"], ",", 
                    SuperscriptBox["\[Beta]", "-"]}], "]"}], "]"}]}], "]"}], 
               ",", 
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4"}], "}"}], "}"}]}], "]"}]}], "+", 
            RowBox[{
             FractionBox["1", "4"], 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"Metric", "[", 
               RowBox[{
                SubscriptBox["\[Alpha]", "-"], ",", 
                SubscriptBox["\[Beta]", "-"], ",", "gBH"}], "]"}], "]"}], 
             "F2"}]}], ")"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MaxwellT", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MHDMaxwell\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[EM]\>\""}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Sigma]", "-"], ",", 
             SubscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", "F2"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "dX", " ", "\[Wedge]", " ", "dY", " ", "\[Wedge]", " ", "dZ"}], " ", 
        "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q123T", "[", 
         RowBox[{"\[Alpha]1_", ",", "\[Alpha]2_", ",", "\[Alpha]3_"}], "]"}], 
        "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<3-Form\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"TensorName", " ", "\[Rule]", 
           RowBox[{
           "OverTilde", "[", 
            "\"\<\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\)\>\"", "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SubscriptBox["\[Alpha]1", "-"], ",", 
             SubscriptBox["\[Alpha]2", "-"], ",", 
             SubscriptBox["\[Alpha]3", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Normal", "[", 
            RowBox[{"TensorWedge", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q1", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q2", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"q3", "[", 
                SubscriptBox["\[Beta]", "-"], "]"}], "]"}]}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"q123", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"\[Mu]1", ",", "\[Mu]2", ",", "\[Mu]3"}], "}"}], ",", 
          RowBox[{"MoveIndices", "[", 
           RowBox[{
            RowBox[{"q123T", "[", 
             RowBox[{"\[Mu]1", ",", "\[Mu]2", ",", "\[Mu]3"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], 
            ",", 
            RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Plasma", " ", "current"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"nT", "[", "\[Mu]_", "]"}], "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"CovariantHodgeDual", "[", 
             RowBox[{
              SuperscriptBox["\[Mu]", "-"], ",", 
              RowBox[{"q123", "[", 
               RowBox[{
                SubscriptBox["\[Alpha]", "-"], ",", 
                SubscriptBox["\[Beta]", "-"], ",", 
                SubscriptBox["\[Gamma]", "-"]}], "]"}], ",", 
              RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "//", 
            "Opr"}], ")"}], "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"TensorName", "\[Rule]", "name_"}], ")"}], "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
            "TensorName", "\[Rule]", 
             "\"\<\!\(\*StyleBox[\"n\",FontSlant->\"Italic\"]\)\>\""}], 
            ")"}]}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"n", "[", "\[Mu]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"nT", "[", "\[Sigma]", "]"}], ",", 
          RowBox[{"{", "\[Mu]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Construct", " ", 
         SuperscriptBox["P", "\[Beta]\[Gamma]"], " ", "in", " ", "the", " ", 
         "notes"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Rho]0q123T", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<3-Form\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Alpha]", "-"], ",", 
             SuperscriptBox["\[Beta]", "-"], ",", 
             SuperscriptBox["\[Gamma]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{
            RowBox[{"Opr", "[", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"gsgn", " ", 
                 RowBox[{
                  RowBox[{"\[Rho]0", "'"}], "[", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "/", "2"}], ")"}], "gsgn", " ", 
                   RowBox[{
                    RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
                    RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SuperscriptBox["\[Sigma]", "-"], "]"}], "]"}]}]}], 
                  "]"}]}], ")"}], "/.", "MHDRules"}], ")"}], "]"}], 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"q123", "[", 
              RowBox[{
               SuperscriptBox["\[Alpha]1", "-"], ",", 
               SuperscriptBox["\[Beta]1", "-"], ",", 
               SuperscriptBox["\[Gamma]1", "-"]}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Rho]0q123", "[", 
         RowBox[{"\[Alpha]_", ",", "\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"\[Rho]0q123T", "[", 
           RowBox[{"\[Alpha]1", ",", "\[Alpha]2", ",", "\[Alpha]3"}], "]"}], 
          ",", 
          RowBox[{"{", 
           RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PT", "[", 
         RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<2-Form\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"P\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Beta]", "-"], ",", 
             SuperscriptBox["\[Gamma]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"TensorComponents", "[", 
            RowBox[{"CovariantD", "[", 
             RowBox[{
              SubscriptBox["\[Sigma]", "-"], ",", 
              RowBox[{"\[Rho]0q123", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Beta]1", "-"], ",", 
                SuperscriptBox["\[Gamma]1", "-"]}], "]"}], ",", 
              RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}]}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"P", "[", 
         RowBox[{"\[Beta]_", ",", "\[Gamma]_"}], "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"Opr", "[", 
           RowBox[{"PT", "[", 
            RowBox[{"\[Alpha]1", ",", "\[Alpha]2"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Beta]", ",", "\[Gamma]"}], "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
        "perfect", " ", "fluid", " ", "stress", " ", "tensor", " ", "of", " ",
          "plasma"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{
          RowBox[{"TensorComponents", "[", 
           RowBox[{"n", "[", 
            SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
          RowBox[{"TensorComponents", "[", 
           RowBox[{"n", "[", 
            SuperscriptBox["\[Sigma]", "-"], "]"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"F2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"gsgn", " ", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"Metric", "[", 
              RowBox[{
               SuperscriptBox["\[Alpha]", "-"], ",", 
               SuperscriptBox["\[Beta]", "-"], ",", 
               RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}], 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Rho]0", "[", 
               RowBox[{"gsgn", " ", 
                RowBox[{"F2", "/", "2"}]}], "]"}], "-", 
              RowBox[{
               RowBox[{
                RowBox[{"\[Rho]0", "'"}], "[", 
                RowBox[{"gsgn", " ", 
                 RowBox[{"F2", "/", "2"}]}], "]"}], "gsgn", " ", "F2"}]}], 
             ")"}]}], "+", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Rho]0", "'"}], "[", 
             RowBox[{"gsgn", " ", 
              RowBox[{"F2", "/", "2"}]}], "]"}], 
            RowBox[{"TensorProduct", "[", 
             RowBox[{
              RowBox[{"TensorComponents", "[", 
               RowBox[{"n", "[", 
                SuperscriptBox["\[Mu]", "-"], "]"}], "]"}], ",", 
              RowBox[{"TensorComponents", "[", 
               RowBox[{"n", "[", 
                SuperscriptBox["\[Nu]", "-"], "]"}], "]"}]}], "]"}]}]}], 
          ")"}], "/.", "MHDRules"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"PlasmaT", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MHDPlasma\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Plasma]\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "-"], ",", 
             SuperscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"Opr", "[", "F2", "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"total", " ", "stress", " ", "tensor"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"TotalT", "[", 
         RowBox[{"\[Sigma]_", ",", "\[Rho]_"}], "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MHDMaxwellPlasma\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)[Total]\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             SuperscriptBox["\[Sigma]", "-"], ",", 
             SuperscriptBox["\[Rho]", "-"]}], "}"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "remember", " ", "we", " ", "defined", " ", "photon", " ", 
            "T\[Mu]\[Nu]", " ", "with", " ", "both", " ", "lower", " ", 
            "indices", " ", "and", " ", "plasma", " ", "with", " ", "both", 
            " ", "upper"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{
            RowBox[{"TensorComponents", "[", 
             RowBox[{"RaiseAllIndices", "[", 
              RowBox[{
               RowBox[{"MaxwellT", "[", 
                RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], ",", 
               RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}], 
            "+", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"PlasmaT", "[", 
              RowBox[{"\[Mu]", ",", "\[Nu]"}], "]"}], "]"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"EM", " ", "current"}], " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"divFT", "[", "\[Mu]_", "]"}], "=", 
        RowBox[{"Tensor", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"TensorType", "\[Rule]", "\"\<MaxwellCurrent\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
          "TensorName", " ", "\[Rule]", 
           "\"\<\!\(\*StyleBox[\"J\",FontSlant->\"Italic\"]\)\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Indices", "\[Rule]", 
           RowBox[{"{", 
            SubscriptBox["\[Mu]", "-"], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"StartIndex", "\[Rule]", "si"}], ",", "\[IndentingNewLine]", 
          RowBox[{"TensorComponents", "\[Rule]", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"CovariantD", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                RowBox[{"F\[Mu]\[Nu]", "[", 
                 RowBox[{
                  SubscriptBox["\[Sigma]", "-"], ",", 
                  SubscriptBox["\[Rho]", "-"]}], "]"}], ",", 
                RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}], "]"}], "//",
              "Opr"}], ")"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"CoordinateSystem", "\[Rule]", "coords"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"divF", "[", "\[Rho]_", "]"}], ":=", 
        RowBox[{"MoveIndices", "[", 
         RowBox[{
          RowBox[{"divFT", "[", "\[Alpha]", "]"}], ",", 
          RowBox[{"{", "\[Rho]", "}"}], ",", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EOM", " ", 
          RowBox[{"I", " ", ":", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Del]", "\[Sigma]"], "\[Zeta]"}], " ", 
            RowBox[{
             SubscriptBox["\[Del]", "\[Mu]"], 
             SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}]}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["q1", "\[Alpha]"], " ", 
          SubscriptBox["q3", "\[Beta]"], " ", 
          SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LHS1", "=", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TensorComponents", "[", 
             RowBox[{"q1", "[", 
              SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
            RowBox[{"TensorComponents", "[", 
             RowBox[{"divF", "[", 
              SuperscriptBox["\[Rho]", "-"], "]"}], "]"}]}], ")"}], "//", 
          "Opr"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RHS1", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q1", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q3", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"P", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Rho]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EOM", " ", 
          RowBox[{"II", " ", ":", " ", 
           RowBox[{
            RowBox[{
             SubscriptBox["\[Del]", "\[Sigma]"], "Y"}], " ", 
            RowBox[{
             SubscriptBox["\[Del]", "\[Mu]"], 
             SuperscriptBox["F", "\[Mu]\[Sigma]"]}]}]}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["q2", "\[Alpha]"], " ", 
          SubscriptBox["q3", "\[Beta]"], " ", 
          SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"LHS2", "=", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"TensorComponents", "[", 
            RowBox[{"q2", "[", 
             SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
           RowBox[{"TensorComponents", "[", 
            RowBox[{"divF", "[", 
             SuperscriptBox["\[Rho]", "-"], "]"}], "]"}]}], ")"}], "//", 
         "Opr"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"RHS2", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q2", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"q3", "[", 
               SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"P", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Rho]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{
         RowBox[{"EOM", " ", 
          RowBox[{"III", " ", ":", " ", "0"}]}], " ", "=", " ", 
         RowBox[{
          SubscriptBox["q2", "\[Alpha]"], " ", 
          SubscriptBox["q3", "\[Beta]"], " ", 
          SuperscriptBox["P", "\[Alpha]\[Beta]"]}]}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"RHS3", "=", 
        RowBox[{"Opr", "[", 
         RowBox[{"TensorContract", "[", 
          RowBox[{
           RowBox[{"TensorProduct", "[", 
            RowBox[{
             RowBox[{"TensorComponents", "[", 
              RowBox[{"F\[Mu]\[Nu]", "[", 
               RowBox[{
                SubscriptBox["\[Sigma]", "-"], ",", 
                SubscriptBox["\[Rho]", "-"]}], "]"}], "]"}], ",", 
             RowBox[{"TensorComponents", "[", 
              RowBox[{"P", "[", 
               RowBox[{
                SuperscriptBox["\[Sigma]", "-"], ",", 
                SuperscriptBox["\[Rho]", "-"]}], "]"}], "]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"1", ",", "3"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "output", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{"MHDSystem", "[", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"3", " ", "scalars"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"MHDScalarFunction1", "\[Rule]", "ph1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDScalarFunction2", "\[Rule]", "ph2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDScalarFunction3", "\[Rule]", "ph3"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD1FormTensor1", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q1T", "[", 
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD1FormTensor2", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q2T", "[", 
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD1FormTensor3", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q3T", "[", 
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHD3FormTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"q123T", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Alpha]1", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Alpha]2", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Alpha]3", "]"}]}], "]"}], ")"}]}], ",",
          "\[IndentingNewLine]", 
         RowBox[{"MHDMaxwellTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"F\[Mu]\[Nu]T", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDPlasmaCurrentTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"nT", "[", 
            RowBox[{"Unique", "[", "\[Mu]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDRank2PTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"PT", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Beta]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Gamma]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDMaxwellCurrentTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"divFT", "[", 
            RowBox[{"Unique", "[", "\[Rho]", "]"}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDEquationsList", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"{", 
            RowBox[{"(*", " ", 
             RowBox[{
              RowBox[{"eq", " ", "1"}], ":", " ", 
              RowBox[{"{", 
               RowBox[{"LHS", ",", "RHS"}], "}"}]}], " ", "*)"}], 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"LHS1", ",", "RHS1"}], "}"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"eq", " ", "2"}], ":", " ", 
               RowBox[{"{", 
                RowBox[{"LHS", ",", "RHS"}], "}"}]}], " ", "*)"}], 
             RowBox[{"{", 
              RowBox[{"LHS2", ",", "RHS2"}], "}"}], ",", 
             RowBox[{"(*", " ", 
              RowBox[{
               RowBox[{"eq", " ", "3"}], ":", " ", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"LHS", "=", "0"}], ",", "RHS"}], "}"}]}], " ", 
              "*)"}], 
             RowBox[{"{", 
              RowBox[{"0", ",", "RHS3"}], "}"}]}], "}"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"stress", " ", "tensors"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"MHDMaxwellStressTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"MaxwellT", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDPlasmaStressTensor", "\[Rule]", 
          RowBox[{"(", 
           RowBox[{"PlasmaT", "[", 
            RowBox[{
             RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
             RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}], ")"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDTotalStressTensor", "\[Rule]", 
          RowBox[{"TotalT", "[", 
           RowBox[{
            RowBox[{"Unique", "[", "\[Sigma]", "]"}], ",", 
            RowBox[{"Unique", "[", "\[Rho]", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MHDPlasmaEnergyDensityOperator", "\[Rule]", "rho"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
           RowBox[{"MHD", " ", "Lagrangian"}], " ", "-", "\[Rho]0", "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}], 
            RowBox[{"F", "^", "2"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"MHDLagrangianDensity", "\[Rule]", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"\[Rho]0", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "/", "2"}], ")"}], "gsgn", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SubscriptBox["\[Sigma]", "-"], "]"}], "]"}], ".", 
                   RowBox[{"TensorComponents", "[", 
                    RowBox[{"n", "[", 
                    SuperscriptBox["\[Sigma]", "-"], "]"}], "]"}]}], ")"}]}], 
                "//", "Opr"}], "]"}], "/.", "MHDRules"}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "/", "4"}], ")"}], 
            RowBox[{"TensorContract", "[", 
             RowBox[{
              RowBox[{"TensorProduct", "[", 
               RowBox[{
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"F\[Mu]\[Nu]", "[", 
                  RowBox[{
                   SubscriptBox[
                    RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
                   SubscriptBox[
                    RowBox[{"Unique", "[", "\[Rho]", "]"}], "-"]}], "]"}], 
                 "]"}], ",", 
                RowBox[{"TensorComponents", "[", 
                 RowBox[{"F\[Mu]\[Nu]", "[", 
                  RowBox[{
                   SuperscriptBox[
                    RowBox[{"Unique", "[", "\[Sigma]", "]"}], "-"], ",", 
                   SuperscriptBox[
                    RowBox[{"Unique", "[", "\[Rho]", "]"}], "-"]}], "]"}], 
                 "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"1", ",", "3"}], "}"}], ",", 
                RowBox[{"{", 
                 RowBox[{"2", ",", "4"}], "}"}]}], "}"}]}], "]"}]}]}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{"store", " ", "metric", " ", "info", " ", "too"}], " ", 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{"MHDMetricTensor", "\[Rule]", 
          RowBox[{"UniqueIndices", "[", "gBH", "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"CoordinateSystem", "\[Rule]", 
          RowBox[{"Coordinates", "[", 
           RowBox[{"UniqueIndices", "[", "gBH", "]"}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"MetricSignature", "\[Rule]", 
          RowBox[{"OptionValue", "[", "MetricSignature", "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
        "\"\<Mostly minus\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"OptionValue", "[", "MetricSignature", "]"}], "===", 
        "\"\<Mostly plus\>\""}], ")"}]}], ")"}]}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6698407509849577`*^9, 3.6698408131231823`*^9}, {
   3.669840872347288*^9, 3.6698409488818502`*^9}, {3.669840991774727*^9, 
   3.669841033699402*^9}, {3.6698419414843903`*^9, 3.6698419624920273`*^9}, {
   3.669844135719773*^9, 3.669844146429385*^9}, {3.6698441850648756`*^9, 
   3.669844242456984*^9}, {3.6698442807508526`*^9, 3.669844349794979*^9}, {
   3.669844444602553*^9, 3.6698445620849667`*^9}, {3.6698446255136824`*^9, 
   3.6698446259816837`*^9}, {3.6698446774140253`*^9, 
   3.6698446785060277`*^9}, {3.6698448410975957`*^9, 
   3.6698448884506965`*^9}, {3.6698449486940107`*^9, 3.669844980673071*^9}, {
   3.6698450434029026`*^9, 3.6698450679501467`*^9}, 3.6698497394799695`*^9, {
   3.6698497866486673`*^9, 3.6698498110510635`*^9}, {3.669850009369406*^9, 
   3.6698501202347474`*^9}, {3.6699951003821154`*^9, 
   3.6699951056424165`*^9}, {3.6700152867878075`*^9, 
   3.6700155764745617`*^9}, {3.670015610588749*^9, 3.670015619500365*^9}, {
   3.670015688032091*^9, 3.6700157284663663`*^9}, {3.670015764421632*^9, 
   3.670015840169986*^9}, 3.670015932904459*^9, {3.6700160562011747`*^9, 
   3.6700160572045774`*^9}, {3.670016122696644*^9, 3.6700161250250483`*^9}, {
   3.6700161619991264`*^9, 3.670016418179453*^9}, {3.6700164525571203`*^9, 
   3.670016461968338*^9}, {3.6700165114424562`*^9, 3.6700166079154744`*^9}, {
   3.670016764585868*^9, 3.670016836804602*^9}, {3.670016880763682*^9, 
   3.6700169664870434`*^9}, {3.6700170094099264`*^9, 
   3.6700170622300243`*^9}, {3.670017100500495*^9, 3.670017244388363*^9}, {
   3.670017363001262*^9, 3.6700173953593225`*^9}, {3.670017462672247*^9, 
   3.670017476121673*^9}, {3.6700175294839745`*^9, 3.670017541837601*^9}, 
   3.670017575207465*^9, {3.6700176084221263`*^9, 3.670017646195198*^9}, {
   3.670017737480567*^9, 3.6700177522929935`*^9}, {3.6700178028644886`*^9, 
   3.6700178056130934`*^9}, {3.670017840849758*^9, 3.6700178473589697`*^9}, {
   3.670017880056429*^9, 3.670017962184577*^9}, {3.670018073504243*^9, 
   3.6700181574050417`*^9}, {3.670018298935869*^9, 3.670018391996192*^9}, {
   3.670018474341902*^9, 3.670018496033142*^9}, {3.6700198295079913`*^9, 
   3.670019850108429*^9}, {3.6700200865048394`*^9, 3.6700200955293555`*^9}, {
   3.6700201634792423`*^9, 3.6700201767249994`*^9}, {3.670020222450615*^9, 
   3.6700202303600674`*^9}, {3.6700203037302637`*^9, 3.670020312014738*^9}, {
   3.67002160862269*^9, 3.6700219383065467`*^9}, {3.670021970975415*^9, 
   3.6700220613285832`*^9}, {3.670022148355561*^9, 3.6700222543946257`*^9}, {
   3.670022314136043*^9, 3.670022475157253*^9}, {3.670022632842272*^9, 
   3.6700226385836*^9}, {3.6700226826761227`*^9, 3.670022910527155*^9}, {
   3.6700229916547947`*^9, 3.6700230300119886`*^9}, {3.670023065992047*^9, 
   3.670023079549822*^9}, {3.6700231136807747`*^9, 3.6700231230233088`*^9}, {
   3.670023186021912*^9, 3.6700232414570827`*^9}, {3.6700233199825745`*^9, 
   3.670023365143157*^9}, {3.67002350785632*^9, 3.670023512767601*^9}, {
   3.6700242405522275`*^9, 3.6700242438014135`*^9}, {3.670024287679923*^9, 
   3.6700242878359323`*^9}, {3.6700307649379253`*^9, 3.670030793394918*^9}, {
   3.6700312099092374`*^9, 3.670031213504408*^9}, {3.6702619445939174`*^9, 
   3.6702619736270037`*^9}, {3.6702620996385703`*^9, 
   3.6702621139110003`*^9}, {3.6702663908732367`*^9, 3.670266421699106*^9}, {
   3.670278065955389*^9, 3.6702780759854174`*^9}, {3.6702785090017376`*^9, 
   3.670278541310362*^9}, {3.670279388636643*^9, 3.6702794147881994`*^9}, {
   3.670279541262638*^9, 3.6702795520292535`*^9}, {3.6702796236673512`*^9, 
   3.670279624217383*^9}, {3.6702827119484987`*^9, 3.6702827127435*^9}, 
   3.670282982704276*^9, {3.670283460474086*^9, 3.6702834750611115`*^9}, {
   3.6702835325737185`*^9, 3.6702835327737193`*^9}, {3.6702839522574463`*^9, 
   3.670283953087448*^9}, {3.6702839856815014`*^9, 3.670284002932531*^9}, {
   3.670285440438506*^9, 3.670285441450564*^9}, {3.670285621430858*^9, 
   3.6702857053406577`*^9}, {3.670285747482068*^9, 3.670285820685255*^9}, {
   3.670641278882371*^9, 3.670641300855426*^9}, 3.671153638476224*^9, {
   3.671153803524514*^9, 3.671153804538516*^9}, {3.6711538519469995`*^9, 
   3.6711538529766006`*^9}, {3.6711539744228144`*^9, 
   3.6711540720321856`*^9}, {3.671154210357629*^9, 3.671154237735677*^9}, {
   3.6711553279119406`*^9, 3.671155328486949*^9}, {3.6711557160209007`*^9, 
   3.6711557519100504`*^9}, {3.6711559593857374`*^9, 
   3.6711559599307456`*^9}, {3.6711560522321634`*^9, 
   3.6711560776825542`*^9}, {3.671160567619633*^9, 3.6711605752697506`*^9}, {
   3.6711606330031376`*^9, 3.6711606431582937`*^9}, {3.6711623442717776`*^9, 
   3.6711623637685156`*^9}, {3.6712331143792067`*^9, 
   3.6712331149146075`*^9}, {3.67123328825992*^9, 3.6712332939053307`*^9}, {
   3.671233324332985*^9, 3.6712333444059205`*^9}, {3.671234162724057*^9, 
   3.6712341640656595`*^9}, {3.6713117260442896`*^9, 
   3.6713118538070493`*^9}, {3.671311908576447*^9, 3.6713120679373302`*^9}, {
   3.671312258693669*^9, 3.671312390041202*^9}, {3.671312526540651*^9, 
   3.671312528976755*^9}, {3.6713125783172426`*^9, 3.671312583561352*^9}, {
   3.6713126199232163`*^9, 3.6713126446873603`*^9}, {3.6713126855189323`*^9, 
   3.67131280735098*^9}, {3.6713128500021553`*^9, 3.6713128506729565`*^9}, {
   3.671312946557827*^9, 3.671312948757431*^9}, {3.6713130460576043`*^9, 
   3.6713130512624135`*^9}, {3.6713130848574734`*^9, 3.671313177276537*^9}, {
   3.6713132363976417`*^9, 3.6713133067451663`*^9}, {3.6713133912683177`*^9, 
   3.6713134378077*^9}, {3.6713134755055676`*^9, 3.671313523195552*^9}, {
   3.6713135539140067`*^9, 3.6713136616836243`*^9}, {3.6713141886895947`*^9, 
   3.671314206986129*^9}, {3.6713142729172583`*^9, 3.671314320244461*^9}, {
   3.671314382803979*^9, 3.671314406338523*^9}, {3.6713144460288997`*^9, 
   3.6713144519214106`*^9}, {3.671314509247419*^9, 3.6713145662951264`*^9}, {
   3.6713146150466185`*^9, 3.671314641993169*^9}, {3.671316434765293*^9, 
   3.671316560927231*^9}, {3.6713173719371877`*^9, 3.671317383674868*^9}, {
   3.671318481327589*^9, 3.6713185032388296`*^9}, {3.6713205092302103`*^9, 
   3.6713205274902515`*^9}, {3.671327960855012*^9, 3.671328006898153*^9}, {
   3.671328077771554*^9, 3.6713280786915655`*^9}, {3.671328346906844*^9, 
   3.671328403260105*^9}, {3.671328435040474*^9, 3.6713284944061975`*^9}, {
   3.6713285296141777`*^9, 3.6713285925975037`*^9}, {3.6713286580032825`*^9, 
   3.671328686873643*^9}, {3.6713287203990974`*^9, 3.6713287849524355`*^9}, {
   3.6713301291127234`*^9, 3.6713302473541813`*^9}, {3.671330431919444*^9, 
   3.6713305348185244`*^9}, {3.6713305852967997`*^9, 
   3.6713306000119867`*^9}, {3.67133080351445*^9, 3.6713308764378576`*^9}, {
   3.6713310103645735`*^9, 3.671331010989581*^9}, {3.6713326189264183`*^9, 
   3.6713326527543397`*^9}, {3.6713326854197855`*^9, 3.671333033889147*^9}, {
   3.671333325567628*^9, 3.6713334467342186`*^9}, 3.6713336281141233`*^9, {
   3.67133369078738*^9, 3.671333723340295*^9}, {3.6713350232097397`*^9, 
   3.6713350950648537`*^9}, {3.6713351291324053`*^9, 3.671335152509943*^9}, {
   3.6713352182375484`*^9, 3.6713352954251633`*^9}, {3.671375299692408*^9, 
   3.671375328640455*^9}, {3.6713755396827817`*^9, 3.6713755841368523`*^9}, {
   3.6713769595887375`*^9, 3.671376982868069*^9}, {3.671377029893759*^9, 
   3.6713772568907423`*^9}, 3.6713782071427402`*^9, 3.6713788972695937`*^9, {
   3.671379022134815*^9, 3.671379030218828*^9}, {3.671379583515187*^9, 
   3.671379628909272*^9}, {3.671412711183956*^9, 3.671412754202117*^9}, {
   3.671412788105138*^9, 3.6714128563311863`*^9}, {3.6716698852061872`*^9, 
   3.671669904196023*^9}, {3.6716803067832537`*^9, 3.6716803262702956`*^9}, {
   3.671681989201393*^9, 3.671682059816351*^9}, {3.671682226044402*^9, 
   3.671682248227848*^9}, {3.6716827737980146`*^9, 3.6716827838032355`*^9}, {
   3.671683631343897*^9, 3.6716836607069592`*^9}, {3.671683694308832*^9, 
   3.671683764773095*^9}, {3.671685378758671*^9, 3.6716854558755507`*^9}, {
   3.671685717341633*^9, 3.671685721293841*^9}, {3.67168605969421*^9, 
   3.671686062020015*^9}, {3.6716865682840405`*^9, 3.671686731939052*^9}, {
   3.671686792320012*^9, 3.6716869603382215`*^9}, {3.671716178056795*^9, 
   3.6717162204942226`*^9}, {3.671717455510002*^9, 3.671717469571807*^9}, {
   3.671729201402174*^9, 3.6717292439842567`*^9}, {3.671738743906927*^9, 
   3.671738744741929*^9}, {3.6717387965862207`*^9, 3.6717388041322565`*^9}, {
   3.6717388965915847`*^9, 3.6717389575517855`*^9}, {3.671739046023117*^9, 
   3.6717390819162316`*^9}, {3.671739145066948*^9, 3.6717391540759697`*^9}, {
   3.671739433517739*^9, 3.671739448788816*^9}, 3.671739657649922*^9, 
   3.6717396912850113`*^9, {3.6717397274651127`*^9, 3.6717397690257444`*^9}, {
   3.671739859526066*^9, 3.6717398816706333`*^9}, {3.6717401507134266`*^9, 
   3.6717401616264687`*^9}, {3.671742582834978*^9, 3.671742616200077*^9}, {
   3.6717426484541445`*^9, 3.67174266430518*^9}, {3.6717448154864273`*^9, 
   3.671744819904636*^9}, {3.671747331643324*^9, 3.6717473509173756`*^9}, {
   3.6717474311453514`*^9, 3.671747431394952*^9}, {3.671759379283369*^9, 
   3.6717594050569177`*^9}, 3.6719023749869566`*^9, {3.6719104918126836`*^9, 
   3.6719104997168016`*^9}, {3.671910663331614*^9, 3.671910792732334*^9}, {
   3.67191416198909*^9, 3.671914248367917*^9}, {3.6719142784358788`*^9, 
   3.671914298441186*^9}, {3.671985860082047*^9, 3.67198588930231*^9}, {
   3.671986163107979*^9, 3.6719862021990623`*^9}, {3.6719863230490193`*^9, 
   3.6719864088835974`*^9}, 3.671986638141303*^9, 3.6719866718560724`*^9, {
   3.671987044801633*^9, 3.6719871425822334`*^9}, {3.6719879462385225`*^9, 
   3.6719879468353233`*^9}, {3.671988053078989*^9, 3.671988054790595*^9}, {
   3.671988228607614*^9, 3.6719882313778195`*^9}, {3.6719938740389967`*^9, 
   3.671993910774098*^9}, {3.671993951181409*^9, 3.6719939653572197`*^9}, {
   3.6719940048624797`*^9, 3.6719940336181245`*^9}, {3.6719940665560083`*^9, 
   3.671994086730162*^9}, {3.6719942545847626`*^9, 3.671994285251517*^9}, {
   3.671994331025135*^9, 3.671994427561657*^9}, {3.6719944627366686`*^9, 
   3.6719945605932655`*^9}, {3.6719946985661573`*^9, 
   3.6719947273488035`*^9}, {3.6719948157108574`*^9, 
   3.6719948401022525`*^9}, {3.671995850760059*^9, 3.6719958532342005`*^9}, {
   3.6719960395018544`*^9, 3.6719960932969313`*^9}, {3.671996258959407*^9, 
   3.6719963108823767`*^9}, {3.6719963661735387`*^9, 
   3.6719964078369217`*^9}, {3.67199702007594*^9, 3.671997050416675*^9}, {
   3.671997097806386*^9, 3.67199722673576*^9}, {3.6720574581761417`*^9, 
   3.6720574788739595`*^9}, {3.672057528817227*^9, 3.6720575718453875`*^9}, {
   3.6720579223707714`*^9, 3.672057924285801*^9}, {3.67206040778795*^9, 
   3.672060422495676*^9}, {3.672079391745922*^9, 3.6720793932090054`*^9}, {
   3.6720799971475487`*^9, 3.6720800204498816`*^9}, {3.6721538363500133`*^9, 
   3.6721538393156214`*^9}, {3.672154064684695*^9, 3.6721541003794684`*^9}, {
   3.672154132264433*^9, 3.672154140751649*^9}, 3.672156374947054*^9, {
   3.6721566432286744`*^9, 3.672156654968855*^9}, {3.672156804531152*^9, 
   3.6721568419417267`*^9}, {3.6721568980750885`*^9, 3.672156898520096*^9}, {
   3.672156959688535*^9, 3.672156966046133*^9}, {3.672157070870243*^9, 
   3.6721570932330866`*^9}, {3.6721572800284557`*^9, 
   3.6721572949711847`*^9}, {3.672157354399598*^9, 3.672157392890189*^9}, {
   3.672157455198646*^9, 3.672157459411211*^9}, 3.6721575371474047`*^9, {
   3.672157594018278*^9, 3.672157618381152*^9}, {3.6721578326944447`*^9, 
   3.672157835714491*^9}, {3.672157972029084*^9, 3.672157992824404*^9}, {
   3.6722325937310085`*^9, 3.672232600466112*^9}, {3.672233281204068*^9, 
   3.672233324647235*^9}, {3.6722599024334993`*^9, 3.6722599694053297`*^9}, 
   3.672260828582472*^9, {3.672260862013384*^9, 3.6722608817595134`*^9}, {
   3.672535133197075*^9, 3.6725351401292887`*^9}, {3.6727109677763033`*^9, 
   3.672710974758817*^9}, {3.672711620427865*^9, 3.672711621467881*^9}, {
   3.672711690671444*^9, 3.6727116931639824`*^9}, {3.6727119200224667`*^9, 
   3.6727119293151093`*^9}, {3.6727124484568567`*^9, 
   3.6727124519768715`*^9}, {3.672712792202832*^9, 3.6727127927353334`*^9}, {
   3.672802452532505*^9, 3.6728024564225645`*^9}, {3.8757581684051456`*^9, 
   3.875758196765579*^9}, 
   3.8955551726779127`*^9},ExpressionUUID->"be69bc0c-f23e-42f8-b5d2-\
e67fb1a31db0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Appearance", " ", "of", " ", "MHDSystem"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"MHDSystem", "/:", 
    RowBox[{"Format", "[", 
     RowBox[{"MHDSystem", "[", "\[IndentingNewLine]", 
      RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
       RowBox[{"MHDScalarFunction1", "\[Rule]", "ph1_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDScalarFunction2", "\[Rule]", "ph2_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDScalarFunction3", "\[Rule]", "ph3_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MetricSignature", "\[Rule]", "ss_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDPlasmaEnergyDensityOperator", "\[Rule]", "rho_"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"MHDMetricTensor", "\[Rule]", "ggg_"}]}], 
      "\[IndentingNewLine]", "]"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "sg", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"metric", " ", "signature"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sg", "=", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"ss", "===", "\"\<Mostly minus\>\""}], ",", "\"\<+\>\"", 
          ",", 
          RowBox[{"ss", "===", "\"\<Mostly plus\>\""}], ",", "\"\<-\>\""}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"MHDSystem", "[", 
        RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"ph1", ",", "ph2", ",", "ph3", ",", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"],\
 \"\[Mu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"TensorComponents", "[", "nnnT", "]"}]}]}], "}"}], ",",
             "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\"\<\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \
\"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"TensorComponents", "[", "F\[Mu]\[Nu]TT", "]"}], 
                "]"}]}], ",", 
              RowBox[{
              "\"\<\!\(\*SuperscriptBox[StyleBox[\"J\",FontSlant->\"Italic\"],\
 \"\[Mu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"TensorComponents", "[", "MaxJTT", "]"}]}]}], "}"}], 
            ",", "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)EM\!\(\*SubscriptBox[StyleBox[\"]\",\
FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"TensorComponents", "[", "MaxTT", "]"}], "]"}]}], ",", 
              RowBox[{
              "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*\
StyleBox[\"[\",FontSlant->\"Italic\"]\)Plasma\!\(\*SubscriptBox[StyleBox[\"]\"\
,FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
               RowBox[{"MatrixForm", "[", 
                RowBox[{"TensorComponents", "[", "PlasmaTT", "]"}], "]"}]}]}],
              "}"}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
          "\"\<Ideal MHD/Maxwell's equation 1: \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", "\[IndentingNewLine]", 
           "\"\<Ideal MHD/Maxwell's equation 2: \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(2\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", "\[IndentingNewLine]", 
           "\"\<Ideal MHD/Plasma equation: 0 = \
\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \
\"\[Alpha]\[Beta]\"]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", "\[IndentingNewLine]", 
           RowBox[{
           "\"\<With \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\) \[Congruent] \>\"", "<>", "sg", "<>", 
            "\"\<\!\(\*SubscriptBox[\(\[Del]\), \
\(\[Sigma]\)]\)\!\(\*StyleBox[\"(\",FontSize->16]\)\!\(\*SubscriptBox[\(\[Rho]\
\), \(0\)]\)[\>\"", "<>", "sg", "<>", 
            "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \
\"2\"]\)/2] \!\(\*SuperscriptBox[\(\[Del]\), \
\([\[Sigma]\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \
\(1\)]\)\!\(\*SuperscriptBox[\(\[Del]\), \(\[Alpha]\)]\)\!\(\*SubscriptBox[\(\
\[CapitalPhi]\), \(2\)]\)\!\(\*SuperscriptBox[\(\[Del]\), \
\(\(\[Beta]\)\(]\)\)]\)\!\(\*SubscriptBox[\(\[CapitalPhi]\), \
\(3\)]\)\!\(\*StyleBox[\")\",FontSize->16]\)\>\""}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Scalar fields : \>\"", ",", 
              RowBox[{"MatrixForm", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\)\>\"", 
                  "\[Rule]", "ph1"}], ",", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\)\>\"", 
                  "\[Rule]", "ph2"}], ",", 
                 RowBox[{
                 "\"\<\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(3\)]\)\>\"", 
                  "\[Rule]", "ph3"}]}], "}"}], "]"}]}], "}"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Row", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<Plasma energy density : \>\"", ",", 
              RowBox[{
               RowBox[{
               "\"\< \!\(\*SubscriptBox[\(\[Rho]\), \(0\)]\)[\>\"", "<>", 
                "sg", "<>", 
                "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"\
], \"2\"]\)/2]\>\""}], "\[Rule]", 
               RowBox[{"rho", "[", 
                RowBox[{
                "sg", "<>", 
                 "\"\<\!\(\*StyleBox[SuperscriptBox[StyleBox[\"n\",FontSlant->\
\"Italic\"], \
\"2\"],FontSlant->\"Italic\"]\)\!\(\*StyleBox[\"/\",FontSlant->\"Italic\"]\)\!\
\(\*StyleBox[\"2\",FontSlant->\"Italic\"]\)\>\""}], "]"}]}]}], "}"}], "]"}], 
           ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
             "\"\<\!\(\*SubscriptBox[\(g\), \(\[Mu]\[Nu]\)]\)\>\"", "\[Rule]", 
              RowBox[{"MatrixForm", "[", 
               RowBox[{"TensorComponents", "[", "ggg", "]"}], "]"}]}], ",", 
             RowBox[{"Coordinates", "\[Rule]", 
              RowBox[{"Coordinates", "[", "ggg", "]"}]}]}], "}"}]}], "}"}], 
         "]"}], "]"}]}]}], "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6698407509849577`*^9, 3.6698408131231823`*^9}, {
   3.669840872347288*^9, 3.6698409488818502`*^9}, {3.669840991774727*^9, 
   3.669841033699402*^9}, {3.6698419414843903`*^9, 3.6698419624920273`*^9}, {
   3.669844135719773*^9, 3.669844146429385*^9}, {3.6698441850648756`*^9, 
   3.669844242456984*^9}, {3.6698442807508526`*^9, 3.669844349794979*^9}, {
   3.669844444602553*^9, 3.6698445620849667`*^9}, {3.6698446255136824`*^9, 
   3.6698446259816837`*^9}, {3.6698446774140253`*^9, 
   3.6698446785060277`*^9}, {3.6698448410975957`*^9, 
   3.6698448884506965`*^9}, {3.6698449486940107`*^9, 3.669844980673071*^9}, {
   3.6698450434029026`*^9, 3.6698450679501467`*^9}, 3.6698497394799695`*^9, {
   3.6698497866486673`*^9, 3.6698498110510635`*^9}, {3.669850009369406*^9, 
   3.6698501202347474`*^9}, {3.6699951003821154`*^9, 
   3.6699951056424165`*^9}, {3.6700152867878075`*^9, 
   3.6700155764745617`*^9}, {3.670015610588749*^9, 3.670015619500365*^9}, {
   3.670015688032091*^9, 3.6700157284663663`*^9}, {3.670015764421632*^9, 
   3.670015840169986*^9}, 3.670015932904459*^9, {3.6700160562011747`*^9, 
   3.6700160572045774`*^9}, {3.670016122696644*^9, 3.6700161250250483`*^9}, {
   3.6700161619991264`*^9, 3.670016418179453*^9}, {3.6700164525571203`*^9, 
   3.670016461968338*^9}, {3.6700165114424562`*^9, 3.6700166079154744`*^9}, {
   3.670016764585868*^9, 3.670016836804602*^9}, {3.670016880763682*^9, 
   3.6700169664870434`*^9}, {3.6700170094099264`*^9, 
   3.6700170622300243`*^9}, {3.670017100500495*^9, 3.670017244388363*^9}, {
   3.670017363001262*^9, 3.6700173953593225`*^9}, {3.670017462672247*^9, 
   3.670017476121673*^9}, {3.6700175294839745`*^9, 3.670017541837601*^9}, 
   3.670017575207465*^9, {3.6700176084221263`*^9, 3.670017646195198*^9}, {
   3.670017737480567*^9, 3.6700177522929935`*^9}, {3.6700178028644886`*^9, 
   3.6700178056130934`*^9}, {3.670017840849758*^9, 3.6700178473589697`*^9}, {
   3.670017880056429*^9, 3.670017962184577*^9}, {3.670018073504243*^9, 
   3.6700181574050417`*^9}, {3.670018298935869*^9, 3.670018391996192*^9}, {
   3.670018474341902*^9, 3.670018496033142*^9}, {3.6700198295079913`*^9, 
   3.670019850108429*^9}, {3.6700200865048394`*^9, 3.6700200955293555`*^9}, {
   3.6700201634792423`*^9, 3.6700201767249994`*^9}, {3.670020222450615*^9, 
   3.6700202303600674`*^9}, {3.6700203037302637`*^9, 3.670020312014738*^9}, {
   3.67002160862269*^9, 3.6700219383065467`*^9}, {3.670021970975415*^9, 
   3.6700220613285832`*^9}, {3.670022148355561*^9, 3.6700222543946257`*^9}, {
   3.670022314136043*^9, 3.670022475157253*^9}, {3.670022632842272*^9, 
   3.6700226385836*^9}, {3.6700226826761227`*^9, 3.670022910527155*^9}, {
   3.6700229916547947`*^9, 3.6700230300119886`*^9}, {3.670023065992047*^9, 
   3.670023079549822*^9}, {3.6700231136807747`*^9, 3.6700231230233088`*^9}, {
   3.670023186021912*^9, 3.6700232414570827`*^9}, {3.6700233199825745`*^9, 
   3.670023365143157*^9}, {3.67002350785632*^9, 3.670023512767601*^9}, {
   3.6700242405522275`*^9, 3.6700242438014135`*^9}, {3.670024287679923*^9, 
   3.6700242878359323`*^9}, {3.6700307649379253`*^9, 3.670030793394918*^9}, {
   3.6700312099092374`*^9, 3.670031213504408*^9}, {3.6702619445939174`*^9, 
   3.6702619736270037`*^9}, {3.6702620996385703`*^9, 
   3.6702621139110003`*^9}, {3.6702663908732367`*^9, 3.670266421699106*^9}, {
   3.670278065955389*^9, 3.6702780759854174`*^9}, {3.6702785090017376`*^9, 
   3.670278541310362*^9}, {3.670279388636643*^9, 3.6702794147881994`*^9}, {
   3.670279541262638*^9, 3.6702795520292535`*^9}, {3.6702796236673512`*^9, 
   3.670279624217383*^9}, {3.6702827119484987`*^9, 3.6702827127435*^9}, 
   3.670282982704276*^9, {3.670283460474086*^9, 3.6702834750611115`*^9}, {
   3.6702835325737185`*^9, 3.6702835327737193`*^9}, {3.6702839522574463`*^9, 
   3.670283953087448*^9}, {3.6702839856815014`*^9, 3.670284002932531*^9}, {
   3.670285440438506*^9, 3.670285441450564*^9}, {3.670285621430858*^9, 
   3.6702857053406577`*^9}, {3.670285747482068*^9, 3.670285820685255*^9}, {
   3.670641278882371*^9, 3.670641300855426*^9}, 3.671153638476224*^9, {
   3.671153803524514*^9, 3.671153804538516*^9}, {3.6711538519469995`*^9, 
   3.6711538529766006`*^9}, {3.6711539744228144`*^9, 
   3.6711540720321856`*^9}, {3.671154210357629*^9, 3.671154237735677*^9}, {
   3.6711553279119406`*^9, 3.671155328486949*^9}, {3.6711557160209007`*^9, 
   3.6711557519100504`*^9}, {3.6711559593857374`*^9, 
   3.6711559599307456`*^9}, {3.6711560522321634`*^9, 
   3.6711560776825542`*^9}, {3.671160567619633*^9, 3.6711605752697506`*^9}, {
   3.6711606330031376`*^9, 3.6711606431582937`*^9}, {3.6711623442717776`*^9, 
   3.6711623637685156`*^9}, {3.6712331143792067`*^9, 
   3.6712331149146075`*^9}, {3.67123328825992*^9, 3.6712332939053307`*^9}, {
   3.671233324332985*^9, 3.6712333444059205`*^9}, {3.671234162724057*^9, 
   3.6712341640656595`*^9}, {3.6713117260442896`*^9, 
   3.6713118538070493`*^9}, {3.671311908576447*^9, 3.6713120679373302`*^9}, {
   3.671312258693669*^9, 3.671312390041202*^9}, {3.671312526540651*^9, 
   3.671312528976755*^9}, {3.6713125783172426`*^9, 3.671312583561352*^9}, {
   3.6713126199232163`*^9, 3.6713126446873603`*^9}, {3.6713126855189323`*^9, 
   3.67131280735098*^9}, {3.6713128500021553`*^9, 3.6713128506729565`*^9}, {
   3.671312946557827*^9, 3.671312948757431*^9}, {3.6713130460576043`*^9, 
   3.6713130512624135`*^9}, {3.6713130848574734`*^9, 3.671313177276537*^9}, {
   3.6713132363976417`*^9, 3.6713133067451663`*^9}, {3.6713133912683177`*^9, 
   3.6713134378077*^9}, {3.6713134755055676`*^9, 3.671313523195552*^9}, {
   3.6713135539140067`*^9, 3.6713136616836243`*^9}, {3.6713141886895947`*^9, 
   3.671314206986129*^9}, {3.6713142729172583`*^9, 3.671314320244461*^9}, {
   3.671314382803979*^9, 3.671314406338523*^9}, {3.6713144460288997`*^9, 
   3.6713144519214106`*^9}, {3.671314509247419*^9, 3.6713145662951264`*^9}, {
   3.6713146150466185`*^9, 3.671314641993169*^9}, {3.671316434765293*^9, 
   3.671316560927231*^9}, {3.6713173719371877`*^9, 3.671317383674868*^9}, {
   3.671318481327589*^9, 3.6713185032388296`*^9}, {3.6713205092302103`*^9, 
   3.6713205274902515`*^9}, {3.671327960855012*^9, 3.671328006898153*^9}, {
   3.671328077771554*^9, 3.6713280786915655`*^9}, {3.671328346906844*^9, 
   3.671328403260105*^9}, {3.671328435040474*^9, 3.6713284944061975`*^9}, {
   3.6713285296141777`*^9, 3.6713285925975037`*^9}, {3.6713286580032825`*^9, 
   3.671328686873643*^9}, {3.6713287203990974`*^9, 3.6713287849524355`*^9}, {
   3.6713301291127234`*^9, 3.6713302473541813`*^9}, {3.671330431919444*^9, 
   3.6713305348185244`*^9}, {3.6713305852967997`*^9, 
   3.6713306000119867`*^9}, {3.67133080351445*^9, 3.6713308764378576`*^9}, {
   3.6713310103645735`*^9, 3.671331010989581*^9}, {3.6713326189264183`*^9, 
   3.6713326527543397`*^9}, {3.6713326854197855`*^9, 3.671333033889147*^9}, {
   3.671333325567628*^9, 3.6713334467342186`*^9}, 3.6713336281141233`*^9, {
   3.67133369078738*^9, 3.671333723340295*^9}, {3.6713350232097397`*^9, 
   3.6713350950648537`*^9}, {3.6713351291324053`*^9, 3.671335152509943*^9}, {
   3.6713352182375484`*^9, 3.6713352954251633`*^9}, {3.671375299692408*^9, 
   3.671375328640455*^9}, {3.6713755396827817`*^9, 3.6713755841368523`*^9}, {
   3.6713769595887375`*^9, 3.671376982868069*^9}, {3.671377029893759*^9, 
   3.6713772568907423`*^9}, 3.6713782071427402`*^9, 3.6713788972695937`*^9, {
   3.671379022134815*^9, 3.671379030218828*^9}, {3.671379583515187*^9, 
   3.671379628909272*^9}, {3.671412711183956*^9, 3.671412754202117*^9}, {
   3.671412788105138*^9, 3.6714128563311863`*^9}, {3.6716698852061872`*^9, 
   3.671669904196023*^9}, {3.6716803067832537`*^9, 3.6716803262702956`*^9}, {
   3.671681989201393*^9, 3.671682059816351*^9}, {3.671682226044402*^9, 
   3.671682248227848*^9}, {3.6716827737980146`*^9, 3.6716827838032355`*^9}, {
   3.671683631343897*^9, 3.6716836607069592`*^9}, {3.671683694308832*^9, 
   3.671683764773095*^9}, {3.671685378758671*^9, 3.6716854558755507`*^9}, {
   3.671685717341633*^9, 3.671685721293841*^9}, {3.67168605969421*^9, 
   3.671686062020015*^9}, {3.6716865682840405`*^9, 3.671686731939052*^9}, {
   3.671686792320012*^9, 3.6716869603382215`*^9}, {3.671716178056795*^9, 
   3.6717162204942226`*^9}, {3.671717455510002*^9, 3.671717469571807*^9}, {
   3.671729201402174*^9, 3.6717292439842567`*^9}, {3.671738743906927*^9, 
   3.671738744741929*^9}, {3.6717387965862207`*^9, 3.6717388041322565`*^9}, {
   3.6717388965915847`*^9, 3.6717389575517855`*^9}, {3.671739046023117*^9, 
   3.6717390819162316`*^9}, {3.671739145066948*^9, 3.6717391540759697`*^9}, {
   3.671739433517739*^9, 3.671739448788816*^9}, 3.671739657649922*^9, 
   3.6717396912850113`*^9, {3.6717397274651127`*^9, 3.6717397690257444`*^9}, {
   3.671739859526066*^9, 3.6717398816706333`*^9}, {3.6717401507134266`*^9, 
   3.6717401616264687`*^9}, {3.671742582834978*^9, 3.671742616200077*^9}, {
   3.6717426484541445`*^9, 3.67174266430518*^9}, {3.6717448154864273`*^9, 
   3.671744819904636*^9}, {3.671747331643324*^9, 3.6717473509173756`*^9}, {
   3.6717474311453514`*^9, 3.671747431394952*^9}, {3.671759379283369*^9, 
   3.6717594050569177`*^9}, {3.6719023749869566`*^9, 3.6719024250485573`*^9}, 
   3.671911322863121*^9, {3.67191147518095*^9, 3.6719114790923586`*^9}, {
   3.6719120628572145`*^9, 3.6719121030219183`*^9}, {3.671912928036829*^9, 
   3.6719129761193404`*^9}, {3.671913044901679*^9, 3.6719130987500067`*^9}, 
   3.671914466066261*^9, {3.672000111820778*^9, 3.6720001412774625`*^9}, {
   3.672057170871729*^9, 3.6720571777768345`*^9}, {3.6720572267500873`*^9, 
   3.6720574117979293`*^9}, {3.6720581974574966`*^9, 3.672058269968611*^9}, {
   3.672060080562924*^9, 3.672060088633048*^9}, {3.6720602748859086`*^9, 
   3.6720603202591057`*^9}, {3.672060449116085*^9, 3.672060636126457*^9}, {
   3.6720607300879*^9, 3.6720607401830554`*^9}, {3.6721491576113987`*^9, 
   3.672149197466469*^9}, {3.672149342720563*^9, 3.672149421863228*^9}, {
   3.6721494537807903`*^9, 3.672149455935794*^9}, {3.672149510183656*^9, 
   3.672149523668858*^9}, {3.6721495582443657`*^9, 3.6721496328054357`*^9}, {
   3.672158045357711*^9, 3.6721581261264515`*^9}, {3.6721581970650406`*^9, 
   3.672158212435277*^9}, {3.672158329304572*^9, 3.6721583525049286`*^9}, {
   3.672158418495942*^9, 3.67215844309132*^9}, 3.6722608297945414`*^9, {
   3.6722608632444544`*^9, 
   3.672260883167594*^9}},ExpressionUUID->"e7aa6d7e-597e-4268-9cea-\
38b386020295"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"old", " ", "code"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"MHDSystem", "/:", 
     RowBox[{"Format", "[", 
      RowBox[{"MHDSystem", "[", "\[IndentingNewLine]", 
       RowBox[{"xxx___", ",", "\[IndentingNewLine]", 
        RowBox[{"MHDScalar1", "\[Rule]", "ph1_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MHDScalar2", "\[Rule]", "ph2_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MHDScalar3", "\[Rule]", "ph3_"}], ",", "\[IndentingNewLine]", 
        RowBox[{"MHDMaxwellTensor", "\[Rule]", "F\[Mu]\[Nu]TT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDMaxwellStressTensor", "\[Rule]", "MaxTT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDMaxwellCurrentTensor", "\[Rule]", "MaxJTT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDPlasmaStressTensor", "\[Rule]", "PlasmaTT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDEquationsList", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l1_", ",", "r1_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"l2_", ",", "r2_"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "r3_"}], "}"}]}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDPlasmaCurrentTensor", "\[Rule]", "nnnT_"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MHDMetricTensor", "\[Rule]", "ggg_"}]}], 
       "\[IndentingNewLine]", "]"}], "]"}], ":=", 
     RowBox[{"MHDSystem", "[", 
      RowBox[{"MatrixForm", "[", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"ph1", ",", "ph2", ",", "ph3", ",", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[StyleBox[\"n\",FontSlant->\"Italic\"], \
\"\[Mu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"TensorComponents", "[", "nnnT", "]"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"TensorComponents", "[", "F\[Mu]\[Nu]TT", "]"}], 
              "]"}]}], ",", 
            RowBox[{
            "\"\<\!\(\*SuperscriptBox[StyleBox[\"J\",FontSlant->\"Italic\"], \
\"\[Mu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"TensorComponents", "[", "MaxJTT", "]"}]}]}], "}"}], ",",
           "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)EM\!\(\*SubscriptBox[StyleBox[\"]\",FontSlant->\
\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"TensorComponents", "[", "MaxTT", "]"}], "]"}]}], ",", 
            RowBox[{
            "\"\<\!\(\*StyleBox[\"T\",FontSlant->\"Italic\"]\)\!\(\*StyleBox[\
\"[\",FontSlant->\"Italic\"]\)Plasma\!\(\*SubscriptBox[StyleBox[\"]\",\
FontSlant->\"Italic\"], \"\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
             RowBox[{"MatrixForm", "[", 
              RowBox[{"TensorComponents", "[", "PlasmaTT", "]"}], "]"}]}]}], 
           "}"}], ","}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ideal MHD/Maxwell's equation 1: \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(1\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(1\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", 
             RowBox[{"l1", "==", "r1"}]}], "}"}], "]"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ideal MHD/Maxwell's equation 2: \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Sigma]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(2\)]\) \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Mu]\)]\)\!\(\*SuperscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \"\
\[Mu]\[Sigma]\"]\) = \!\(\*SubscriptBox[\(\[Del]\), \
\(\[Alpha]\)]\)\!\(\*SuperscriptBox[\(\[CapitalPhi]\), \(2\)]\) \
\!\(\*SubscriptBox[\(\[Del]\), \(\[Beta]\)]\)\!\(\*SuperscriptBox[\(\
\[CapitalPhi]\), \(3\)]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", 
             RowBox[{"l2", "==", "r2"}]}], "}"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{"MatrixForm", "[", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ideal MHD/Plasma equation: 0 = \
\!\(\*SubscriptBox[StyleBox[\"F\",FontSlant->\"Italic\"], \
\"\[Alpha]\[Beta]\"]\) \
\!\(\*SuperscriptBox[StyleBox[\"P\",FontSlant->\"Italic\"], \"\[Alpha]\[Beta]\
\"]\)\>\"", ",", 
             RowBox[{"0", "==", "r3"}]}], "}"}], "]"}], "}"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
           "\"\<\!\(\*SubscriptBox[StyleBox[\"g\",FontSlant->\"Italic\"], \"\
\[Mu]\[Nu]\"]\)\>\"", "\[Rule]", 
            RowBox[{"MatrixForm", "[", 
             RowBox[{"TensorComponents", "[", "ggg", "]"}], "]"}]}], ",", 
           RowBox[{"Coordinates", "\[Rule]", 
            RowBox[{"Coordinates", "[", "ggg", "]"}]}]}], "}"}]}], "}"}], 
       "]"}], "]"}]}], ";"}], " ", "*)"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6698407509849577`*^9, 3.6698408131231823`*^9}, {
   3.669840872347288*^9, 3.6698409488818502`*^9}, {3.669840991774727*^9, 
   3.669841033699402*^9}, {3.6698419414843903`*^9, 3.6698419624920273`*^9}, {
   3.669844135719773*^9, 3.669844146429385*^9}, {3.6698441850648756`*^9, 
   3.669844242456984*^9}, {3.6698442807508526`*^9, 3.669844349794979*^9}, {
   3.669844444602553*^9, 3.6698445620849667`*^9}, {3.6698446255136824`*^9, 
   3.6698446259816837`*^9}, {3.6698446774140253`*^9, 
   3.6698446785060277`*^9}, {3.6698448410975957`*^9, 
   3.6698448884506965`*^9}, {3.6698449486940107`*^9, 3.669844980673071*^9}, {
   3.6698450434029026`*^9, 3.6698450679501467`*^9}, 3.6698497394799695`*^9, {
   3.6698497866486673`*^9, 3.6698498110510635`*^9}, {3.669850009369406*^9, 
   3.6698501202347474`*^9}, {3.6699951003821154`*^9, 
   3.6699951056424165`*^9}, {3.6700152867878075`*^9, 
   3.6700155764745617`*^9}, {3.670015610588749*^9, 3.670015619500365*^9}, {
   3.670015688032091*^9, 3.6700157284663663`*^9}, {3.670015764421632*^9, 
   3.670015840169986*^9}, 3.670015932904459*^9, {3.6700160562011747`*^9, 
   3.6700160572045774`*^9}, {3.670016122696644*^9, 3.6700161250250483`*^9}, {
   3.6700161619991264`*^9, 3.670016418179453*^9}, {3.6700164525571203`*^9, 
   3.670016461968338*^9}, {3.6700165114424562`*^9, 3.6700166079154744`*^9}, {
   3.670016764585868*^9, 3.670016836804602*^9}, {3.670016880763682*^9, 
   3.6700169664870434`*^9}, {3.6700170094099264`*^9, 
   3.6700170622300243`*^9}, {3.670017100500495*^9, 3.670017244388363*^9}, {
   3.670017363001262*^9, 3.6700173953593225`*^9}, {3.670017462672247*^9, 
   3.670017476121673*^9}, {3.6700175294839745`*^9, 3.670017541837601*^9}, 
   3.670017575207465*^9, {3.6700176084221263`*^9, 3.670017646195198*^9}, {
   3.670017737480567*^9, 3.6700177522929935`*^9}, {3.6700178028644886`*^9, 
   3.6700178056130934`*^9}, {3.670017840849758*^9, 3.6700178473589697`*^9}, {
   3.670017880056429*^9, 3.670017962184577*^9}, {3.670018073504243*^9, 
   3.6700181574050417`*^9}, {3.670018298935869*^9, 3.670018391996192*^9}, {
   3.670018474341902*^9, 3.670018496033142*^9}, {3.6700198295079913`*^9, 
   3.670019850108429*^9}, {3.6700200865048394`*^9, 3.6700200955293555`*^9}, {
   3.6700201634792423`*^9, 3.6700201767249994`*^9}, {3.670020222450615*^9, 
   3.6700202303600674`*^9}, {3.6700203037302637`*^9, 3.670020312014738*^9}, {
   3.67002160862269*^9, 3.6700219383065467`*^9}, {3.670021970975415*^9, 
   3.6700220613285832`*^9}, {3.670022148355561*^9, 3.6700222543946257`*^9}, {
   3.670022314136043*^9, 3.670022475157253*^9}, {3.670022632842272*^9, 
   3.6700226385836*^9}, {3.6700226826761227`*^9, 3.670022910527155*^9}, {
   3.6700229916547947`*^9, 3.6700230300119886`*^9}, {3.670023065992047*^9, 
   3.670023079549822*^9}, {3.6700231136807747`*^9, 3.6700231230233088`*^9}, {
   3.670023186021912*^9, 3.6700232414570827`*^9}, {3.6700233199825745`*^9, 
   3.670023365143157*^9}, {3.67002350785632*^9, 3.670023512767601*^9}, {
   3.6700242405522275`*^9, 3.6700242438014135`*^9}, {3.670024287679923*^9, 
   3.6700242878359323`*^9}, {3.6700307649379253`*^9, 3.670030793394918*^9}, {
   3.6700312099092374`*^9, 3.670031213504408*^9}, {3.6702619445939174`*^9, 
   3.6702619736270037`*^9}, {3.6702620996385703`*^9, 
   3.6702621139110003`*^9}, {3.6702663908732367`*^9, 3.670266421699106*^9}, {
   3.670278065955389*^9, 3.6702780759854174`*^9}, {3.6702785090017376`*^9, 
   3.670278541310362*^9}, {3.670279388636643*^9, 3.6702794147881994`*^9}, {
   3.670279541262638*^9, 3.6702795520292535`*^9}, {3.6702796236673512`*^9, 
   3.670279624217383*^9}, {3.6702827119484987`*^9, 3.6702827127435*^9}, 
   3.670282982704276*^9, {3.670283460474086*^9, 3.6702834750611115`*^9}, {
   3.6702835325737185`*^9, 3.6702835327737193`*^9}, {3.6702839522574463`*^9, 
   3.670283953087448*^9}, {3.6702839856815014`*^9, 3.670284002932531*^9}, {
   3.670285440438506*^9, 3.670285441450564*^9}, {3.670285621430858*^9, 
   3.6702857053406577`*^9}, {3.670285747482068*^9, 3.670285820685255*^9}, {
   3.670641278882371*^9, 3.670641300855426*^9}, 3.671153638476224*^9, {
   3.671153803524514*^9, 3.671153804538516*^9}, {3.6711538519469995`*^9, 
   3.6711538529766006`*^9}, {3.6711539744228144`*^9, 
   3.6711540720321856`*^9}, {3.671154210357629*^9, 3.671154237735677*^9}, {
   3.6711553279119406`*^9, 3.671155328486949*^9}, {3.6711557160209007`*^9, 
   3.6711557519100504`*^9}, {3.6711559593857374`*^9, 
   3.6711559599307456`*^9}, {3.6711560522321634`*^9, 
   3.6711560776825542`*^9}, {3.671160567619633*^9, 3.6711605752697506`*^9}, {
   3.6711606330031376`*^9, 3.6711606431582937`*^9}, {3.6711623442717776`*^9, 
   3.6711623637685156`*^9}, {3.6712331143792067`*^9, 
   3.6712331149146075`*^9}, {3.67123328825992*^9, 3.6712332939053307`*^9}, {
   3.671233324332985*^9, 3.6712333444059205`*^9}, {3.671234162724057*^9, 
   3.6712341640656595`*^9}, {3.6713117260442896`*^9, 
   3.6713118538070493`*^9}, {3.671311908576447*^9, 3.6713120679373302`*^9}, {
   3.671312258693669*^9, 3.671312390041202*^9}, {3.671312526540651*^9, 
   3.671312528976755*^9}, {3.6713125783172426`*^9, 3.671312583561352*^9}, {
   3.6713126199232163`*^9, 3.6713126446873603`*^9}, {3.6713126855189323`*^9, 
   3.67131280735098*^9}, {3.6713128500021553`*^9, 3.6713128506729565`*^9}, {
   3.671312946557827*^9, 3.671312948757431*^9}, {3.6713130460576043`*^9, 
   3.6713130512624135`*^9}, {3.6713130848574734`*^9, 3.671313177276537*^9}, {
   3.6713132363976417`*^9, 3.6713133067451663`*^9}, {3.6713133912683177`*^9, 
   3.6713134378077*^9}, {3.6713134755055676`*^9, 3.671313523195552*^9}, {
   3.6713135539140067`*^9, 3.6713136616836243`*^9}, {3.6713141886895947`*^9, 
   3.671314206986129*^9}, {3.6713142729172583`*^9, 3.671314320244461*^9}, {
   3.671314382803979*^9, 3.671314406338523*^9}, {3.6713144460288997`*^9, 
   3.6713144519214106`*^9}, {3.671314509247419*^9, 3.6713145662951264`*^9}, {
   3.6713146150466185`*^9, 3.671314641993169*^9}, {3.671316434765293*^9, 
   3.671316560927231*^9}, {3.6713173719371877`*^9, 3.671317383674868*^9}, {
   3.671318481327589*^9, 3.6713185032388296`*^9}, {3.6713205092302103`*^9, 
   3.6713205274902515`*^9}, {3.671327960855012*^9, 3.671328006898153*^9}, {
   3.671328077771554*^9, 3.6713280786915655`*^9}, {3.671328346906844*^9, 
   3.671328403260105*^9}, {3.671328435040474*^9, 3.6713284944061975`*^9}, {
   3.6713285296141777`*^9, 3.6713285925975037`*^9}, {3.6713286580032825`*^9, 
   3.671328686873643*^9}, {3.6713287203990974`*^9, 3.6713287849524355`*^9}, {
   3.6713301291127234`*^9, 3.6713302473541813`*^9}, {3.671330431919444*^9, 
   3.6713305348185244`*^9}, {3.6713305852967997`*^9, 
   3.6713306000119867`*^9}, {3.67133080351445*^9, 3.6713308764378576`*^9}, {
   3.6713310103645735`*^9, 3.671331010989581*^9}, {3.6713326189264183`*^9, 
   3.6713326527543397`*^9}, {3.6713326854197855`*^9, 3.671333033889147*^9}, {
   3.671333325567628*^9, 3.6713334467342186`*^9}, 3.6713336281141233`*^9, {
   3.67133369078738*^9, 3.671333723340295*^9}, {3.6713350232097397`*^9, 
   3.6713350950648537`*^9}, {3.6713351291324053`*^9, 3.671335152509943*^9}, {
   3.6713352182375484`*^9, 3.6713352954251633`*^9}, {3.671375299692408*^9, 
   3.671375328640455*^9}, {3.6713755396827817`*^9, 3.6713755841368523`*^9}, {
   3.6713769595887375`*^9, 3.671376982868069*^9}, {3.671377029893759*^9, 
   3.6713772568907423`*^9}, 3.6713782071427402`*^9, 3.6713788972695937`*^9, {
   3.671379022134815*^9, 3.671379030218828*^9}, {3.671379583515187*^9, 
   3.671379628909272*^9}, {3.671412711183956*^9, 3.671412754202117*^9}, {
   3.671412788105138*^9, 3.6714128563311863`*^9}, {3.6716698852061872`*^9, 
   3.671669904196023*^9}, {3.6716803067832537`*^9, 3.6716803262702956`*^9}, {
   3.671681989201393*^9, 3.671682059816351*^9}, {3.671682226044402*^9, 
   3.671682248227848*^9}, {3.6716827737980146`*^9, 3.6716827838032355`*^9}, {
   3.671683631343897*^9, 3.6716836607069592`*^9}, {3.671683694308832*^9, 
   3.671683764773095*^9}, {3.671685378758671*^9, 3.6716854558755507`*^9}, {
   3.671685717341633*^9, 3.671685721293841*^9}, {3.67168605969421*^9, 
   3.671686062020015*^9}, {3.6716865682840405`*^9, 3.671686731939052*^9}, {
   3.671686792320012*^9, 3.6716869603382215`*^9}, {3.671716178056795*^9, 
   3.6717162204942226`*^9}, {3.671717455510002*^9, 3.671717469571807*^9}, {
   3.671729201402174*^9, 3.6717292439842567`*^9}, {3.671738743906927*^9, 
   3.671738744741929*^9}, {3.6717387965862207`*^9, 3.6717388041322565`*^9}, {
   3.6717388965915847`*^9, 3.6717389575517855`*^9}, {3.671739046023117*^9, 
   3.6717390819162316`*^9}, {3.671739145066948*^9, 3.6717391540759697`*^9}, {
   3.671739433517739*^9, 3.671739448788816*^9}, 3.671739657649922*^9, 
   3.6717396912850113`*^9, {3.6717397274651127`*^9, 3.6717397690257444`*^9}, {
   3.671739859526066*^9, 3.6717398816706333`*^9}, {3.6717401507134266`*^9, 
   3.6717401616264687`*^9}, {3.671742582834978*^9, 3.671742616200077*^9}, {
   3.6717426484541445`*^9, 3.67174266430518*^9}, {3.6717448154864273`*^9, 
   3.671744819904636*^9}, {3.671747331643324*^9, 3.6717473509173756`*^9}, {
   3.6717474311453514`*^9, 3.671747431394952*^9}, {3.671759379283369*^9, 
   3.6717594050569177`*^9}, {3.6719023749869566`*^9, 3.6719024250485573`*^9}, 
   3.671911322863121*^9},ExpressionUUID->"8d79a8a5-7ec4-4e96-b4c8-\
b15d70013b23"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDScalar", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.671291989975409*^9, 3.6712920251686726`*^9}, {3.6712948275859375`*^9, 
  3.671294844060867*^9}, {3.6713194430010953`*^9, 
  3.6713194439188976`*^9}},ExpressionUUID->"6b883a84-a833-4032-b90f-\
01b764466ccc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "scalars", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{"1", ",", "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDScalarFunction1", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{"2", ",", "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDScalarFunction2", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{"3", ",", "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "xx", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDScalarFunction3", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"1", "-", 
     RowBox[{"forms", "/", "vectors"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "1", ",", 
       "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "xx"}], "}"}], ",", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHD1FormTensor1", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "2", ",", 
       "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "xx"}], "}"}], ",", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHD1FormTensor2", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MHDScalar", "[", 
      RowBox[{
       RowBox[{"\[Mu]T_", "/;", 
        RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "3", ",", 
       "mm_MHDSystem"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Alpha]", ",", "xx"}], "}"}], ",", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHD1FormTensor3", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", "\[Mu]T", "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "]"}]}], ";"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.6713817105197372`*^9, 3.6713817218947725`*^9}, {3.6716839677836056`*^9, 
   3.6716839724206157`*^9}, 3.6721575443550158`*^9, {3.6721575952732973`*^9, 
   3.67215761953117*^9}, {3.6722608389090624`*^9, 3.672260876852233*^9}, {
   3.895554775321517*^9, 
   3.8955547753265142`*^9}},ExpressionUUID->"bd12b7be-8b0d-43d8-912f-\
7a4b2aecd725"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHD3Form", "Subsubsection",
 CellChangeTimes->{{3.67131945597293*^9, 
  3.6713194752303767`*^9}},ExpressionUUID->"e87a704e-ca4f-4e56-bc1a-\
70782c9b0a2c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHD3Form", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
     RowBox[{"\[Nu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", 
     RowBox[{"\[Gamma]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Gamma]T", "]"}]}], ",", "mm_MHDSystem"}],
     "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "\[Beta]", ",", "xx"}], "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHD3FormTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]T", ",", "\[Nu]T", ",", "\[Gamma]T"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, {3.67132018377633*^9, 3.671320233640031*^9}, {
   3.6713204707071257`*^9, 3.671320521037039*^9}, {3.67132057253094*^9, 
   3.6713205737497425`*^9}, 3.671683978752929*^9, {3.895554775334509*^9, 
   3.895554775338506*^9}},ExpressionUUID->"2cea03de-e41a-4d25-89fa-\
b6ed5552e8a1"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDPlasmaCurrent", "Subsubsection",
 CellChangeTimes->{{3.67131945597293*^9, 
  3.671319472420971*^9}},ExpressionUUID->"0b6fed30-3634-43ee-80c8-\
2ecafdd0e265"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDPlasmaCurrent", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDPlasmaCurrentTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", "\[Mu]T", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, 3.6713203381120396`*^9, 3.6713203776117315`*^9, 
   3.6716839812985353`*^9, {3.671901818149008*^9, 3.671901818352808*^9}, 
   3.8955547753465014`*^9},ExpressionUUID->"27725eec-53c5-41b7-850c-\
df20b3c08fa2"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDMaxwell", "Subsubsection",
 CellChangeTimes->{{3.67131945597293*^9, 3.671319472420971*^9}, {
  3.6719017418984957`*^9, 
  3.671901745072509*^9}},ExpressionUUID->"293f512d-0167-44ba-99c9-\
f7fe9e66e44b"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDMaxwell", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
     RowBox[{"\[Nu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMaxwellTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, 3.6713203381120396`*^9, 3.6713203776117315`*^9, 
   3.6716839812985353`*^9, {3.6719017509607368`*^9, 3.671901820696019*^9}, {
   3.895554775354497*^9, 
   3.895554775356496*^9}},ExpressionUUID->"1a414918-ee66-4e6f-ad5a-\
be0b8c63c99c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDMaxwellCurrent", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.6712918250647116`*^9, 3.671291851675561*^9}, {3.6713205405498753`*^9, 
  3.671320542500879*^9}},ExpressionUUID->"b9a4af75-3a33-450a-9c0f-\
4ce1c0791806"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDMaxwellCurrent", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMaxwellCurrentTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", "\[Mu]T", "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
   3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
   3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
   3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
   3.6713201531446695`*^9}, {3.6713205464704885`*^9, 
   3.6713205473284903`*^9}, {3.671379414641571*^9, 3.671379416667574*^9}, 
   3.671683986327546*^9, {3.671901878412259*^9, 3.6719018786356597`*^9}, 
   3.8955547753644905`*^9},ExpressionUUID->"f80df394-c6f8-48b0-bd29-\
6b0999066c15"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDRank2P", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.6712918250647116`*^9, 3.671291851675561*^9}, {3.6713205405498753`*^9, 
  3.671320542500879*^9}, {3.671320662454723*^9, 
  3.671320664487726*^9}},ExpressionUUID->"b0b8d692-4957-467d-ae1e-\
aa214d3370e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MHDRank2P", "[", 
    RowBox[{
     RowBox[{"\[Mu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
     RowBox[{"\[Nu]T_", "/;", 
      RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "mm_MHDSystem"}], 
    "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", 
     RowBox[{"MoveIndices", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDRank2PTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
    "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671319027734232*^9, 3.671319027749832*^9}, {
  3.6713190656093225`*^9, 3.6713191567849135`*^9}, {3.6713191897201796`*^9, 
  3.671319290158579*^9}, {3.671319353327314*^9, 3.671319396723198*^9}, {
  3.671320060937481*^9, 3.6713200640646896`*^9}, {3.671320120148004*^9, 
  3.6713201531446695`*^9}, {3.6713205464704885`*^9, 3.6713205473284903`*^9}, {
  3.6713206807925572`*^9, 3.6713207087614145`*^9}, {3.6716839894791527`*^9, 
  3.6716840006539755`*^9}, {3.6719021034720726`*^9, 3.6719021040240746`*^9}, {
  3.895554775372487*^9, 
  3.895554775374485*^9}},ExpressionUUID->"cca260ae-8eb8-43cf-b070-\
73050e196e5f"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDEquations", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.671291949032036*^9, 3.67129195723645*^9}, {3.671759690104679*^9, 
  3.671759693174185*^9}},ExpressionUUID->"1de083d4-2870-4c02-8d71-\
5d6c7c6e7e6d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "remember", " ", "we", " ", "have", " ", "ordered", " ", "the", " ", 
    "eqns", " ", "from", " ", "left", " ", "to", " ", "right", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"eq", ".", " ", "1"}], ",", " ", "2", ",", " ", 
      RowBox[{"3", " ", "in", " ", "Description", " ", "above"}]}], ")"}]}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDEquations", "[", "mm_MHDSystem", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"Equal", "@@", "#"}], ")"}], "&"}], "/@", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"mm", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"MHDEquationsList", "\[Rule]", "xx_"}], ")"}], 
           "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
        "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
  3.6713197986800923`*^9, 3.671319837413413*^9}, {3.671319908367972*^9, 
  3.671319920020796*^9}, {3.671319960429677*^9, 3.6713199897783375`*^9}, {
  3.6717594135802336`*^9, 3.6717594193916445`*^9}, {3.671902199088857*^9, 
  3.6719021993414583`*^9}, {3.6727131990613623`*^9, 
  3.6727131993263626`*^9}},ExpressionUUID->"d5943ebb-12da-48aa-ba02-\
3d505a60df87"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDEnergyMomentumShearStress", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
   3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
   3.671296920383006*^9}, {3.671320850508881*^9, 3.6713208819661403`*^9}, {
   3.6713822787618303`*^9, 3.6713822873288484`*^9}, {3.6719082728413897`*^9, 
   3.6719082779503*^9}, 
   3.6719951735673256`*^9},ExpressionUUID->"34826003-b078-4f6c-9e5e-\
6c618ecc57de"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"MHDEnergyMomentumShearStress", "[", 
     RowBox[{
      RowBox[{"\[Mu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
      RowBox[{"\[Nu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "ss_String", ",", 
      "mm_MHDSystem"}], "]"}], "/;", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Maxwell\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Photons\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<EM\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Electromagnetic\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Plasma\>\""}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{"ss", "===", "\"\<Total\>\""}], ")"}]}], ")"}]}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "xx", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Which", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<Maxwell\>\""}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<Photons\>\""}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<EM\>\""}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{"ss", "===", "\"\<Electromagnetic\>\""}], ")"}]}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMaxwellStressTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"ss", "===", "\"\<Plasma\>\""}], ")"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDPlasmaStressTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{"ss", "===", "\"\<Total\>\""}], ")"}], ",", 
       "\[IndentingNewLine]", "\t\t", 
       RowBox[{"MoveIndices", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDTotalStressTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Mu]T", ",", "\[Nu]T"}], "}"}], ",", 
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"mm", ",", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
             "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
          "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], "]"}]}], ";"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.671413101592453*^9, 3.6714131015949535`*^9}, {
   3.671413146783147*^9, 3.6714131653084316`*^9}, {3.6719022155273247`*^9, 
   3.671902218455936*^9}, {3.6719024827607923`*^9, 3.6719027523435783`*^9}, {
   3.671902784010708*^9, 3.671902816521225*^9}, {3.671902847200535*^9, 
   3.6719028537069664`*^9}, {3.6719951061834717`*^9, 3.67199510825559*^9}, 
   3.6719951415674953`*^9, {3.6725949044347167`*^9, 3.672594921445549*^9}, 
   3.672713241781448*^9, {3.8955547753874764`*^9, 
   3.8955547753904753`*^9}},ExpressionUUID->"ca54feb2-d00e-4f7e-b100-\
a65454a219b4"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDPlasmaEnergyDensity", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
   3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
   3.671296920383006*^9}, {3.6713024921211157`*^9, 3.671302495647722*^9}, {
   3.6716553379120765`*^9, 3.67165534204714*^9}, {3.6719161658473687`*^9, 
   3.6719161711799507`*^9}, 3.6719974442492013`*^9, {3.672059703046625*^9, 
   3.6720597124242687`*^9}},ExpressionUUID->"9fe1b10e-8538-43de-b21f-\
03b7c5eb1687"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "extract", " ", "plasma", " ", "energy", " ", "density", " ", "operator", 
    " ", "from", " ", "MHDSystem"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDPlasmaEnergyDensity", "[", "mm_MHDSystem", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"mm", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MHDPlasmaEnergyDensityOperator", "\[Rule]", "xx_"}], 
           ")"}], "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
   3.671378999288777*^9, 3.6713790029447823`*^9}, 3.671760009531562*^9, {
   3.671902947401533*^9, 3.6719029536069517`*^9}, 3.671997430871436*^9, {
   3.6720597879559298`*^9, 
   3.672059814553838*^9}},ExpressionUUID->"df59a9b6-049f-49d0-9094-\
da66833be24c"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDMetric", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
  3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
  3.671296920383006*^9}, {3.6713024921211157`*^9, 
  3.671302495647722*^9}},ExpressionUUID->"86ba7e76-0b9d-41d2-a82b-\
b1c6c7226501"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"extract", " ", "metric", " ", "from", " ", "MHDSystem"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDMetric", "[", 
     RowBox[{
      RowBox[{"\[Mu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Mu]T", "]"}]}], ",", 
      RowBox[{"\[Nu]T_", "/;", 
       RowBox[{"TestIndices", "[", "\[Nu]T", "]"}]}], ",", "mm_MHDSystem"}], 
     "]"}], ":=", 
    RowBox[{"Metric", "[", 
     RowBox[{"\[Mu]T", ",", "\[Nu]T", ",", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", "xx", "}"}], ",", 
        RowBox[{
         RowBox[{"Cases", "[", 
          RowBox[{"mm", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"MHDMetricTensor", "\[Rule]", "xx_"}], ")"}], 
            "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
         "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
     "]"}]}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
  3.671378999288777*^9, 3.6713790029447823`*^9}, {3.6722580555528636`*^9, 
  3.6722580895568085`*^9}, {3.8955547753984704`*^9, 
  3.895554775400469*^9}},ExpressionUUID->"dba3ad66-c194-4162-bbe2-\
88aa9be0e86d"]
}, Closed]],

Cell[CellGroupData[{

Cell["MHDLagrangian", "Subsubsection",
 CellChangeTimes->{{3.6712917467837687`*^9, 3.6712917814391313`*^9}, {
   3.671291949032036*^9, 3.67129195723645*^9}, {3.6712968576832933`*^9, 
   3.671296920383006*^9}, {3.6713024921211157`*^9, 3.671302495647722*^9}, {
   3.6716553379120765`*^9, 3.67165534204714*^9}, {3.6719161658473687`*^9, 
   3.6719161711799507`*^9}, 
   3.6719974442492013`*^9},ExpressionUUID->"d7ea3f83-6f7c-4a43-b6a3-\
c9bdd5b55d7b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "extract", " ", "Lagrangian", " ", "density", " ", "from", " ", 
    "MHDSystem"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MHDLagrangian", "[", "mm_MHDSystem", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "xx", "}"}], ",", 
      RowBox[{
       RowBox[{"Cases", "[", 
        RowBox[{"mm", ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"MHDLagrangianDensity", "\[Rule]", "xx_"}], ")"}], 
          "\[RuleDelayed]", "xx"}], ",", "\[Infinity]"}], "]"}], 
       "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], "]"}]}], 
   ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.6713194925206084`*^9, 3.6713195365221214`*^9}, {
   3.671378999288777*^9, 3.6713790029447823`*^9}, 3.671760009531562*^9, {
   3.671902947401533*^9, 3.6719029536069517`*^9}, 
   3.671997430871436*^9},ExpressionUUID->"bcb84637-decb-49f1-b131-\
ecc12403ffa5"]
}, Closed]],

Cell["Update History (MHD-related only)", "Subsubsection",
 CellChangeTimes->{{3.6712939383165674`*^9, 3.6712939602890015`*^9}, {
  3.6713264163476667`*^9, 3.671326425672784*^9}, {3.6721489369921913`*^9, 
  3.6721489484272118`*^9}},ExpressionUUID->"fa2a8b50-6d07-47f6-b1be-\
2e88a8613a2e"]
}, Closed]]
}, If[{97} === Open, Closed, Open]]],

Cell[CellGroupData[{

Cell["Protect", "Section",
 CellChangeTimes->{{3.52035689815625*^9, 
  3.5203569071875*^9}},ExpressionUUID->"d17ead81-6517-42ab-898c-9f79ba651411"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Protect", " ", "these", " ", "symbols", " ", "so", " ", "they", " ", 
    "cannot", " ", "be", " ", "altered"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Protect", "[", 
    RowBox[{
    "Del", ",", "SubMinus", ",", "SuperMinus", ",", "Tensor", ",", 
     "TensorType", ",", "TensorName", ",", "Indices", ",", "Metric", ",", 
     "Riemann", ",", "Weyl", ",", "Ricci", ",", "RicciScalar", ",", 
     "Einstein", ",", "CoordinateSystem", ",", "Coordinates", ",", 
     "TensorComponents", ",", "RiemannComponents", ",", "RicciComponents", 
     ",", "Christoffel", ",", "RicciScalarInvariant", ",", 
     "ChristoffelComponents", ",", "StartIndex", ",", "Determinant", ",", 
     "MetricDeterminant", ",", "TooltipDisplay", ",", "ChristoffelOperator", 
     ",", "RiemannOperator", ",", "RicciOperator", ",", "RicciScalarOperator",
      ",", "EinsteinOperator", ",", "WeylOperator", ",", "CovariantBox", ",", 
     "CoordinateTransformation", ",", "GradientSquared", ",", 
     RowBox[{"(*", 
      RowBox[{"TensorsProduct", ","}], "*)"}], "CovariantD", ",", "PartialD", 
     ",", "SwapIndices", ",", "UnderBar", ",", "TensorIsZero", ",", 
     "NonMetricTensor", ",", "MoveIndices", ",", "LeviCivita", ",", 
     "RaiseAllIndices", ",", "LowerAllIndices", ",", "UniqueIndices", ",", 
     "CovariantHodgeDual", ",", "GeodesicSystem", ",", "GeodesicLagrangians", 
     ",", "GeodesicHamiltonianDynamics", ",", "AffineParameter", ",", 
     "NonAffineParameter", ",", "LieDerivative", ",", "MHDSystem", ",", 
     "MHDScalarFunction1", ",", "MHDScalarFunction2", ",", 
     "MHDScalarFunction3", ",", "MHD1FormTensor1", ",", "MHD1FormTensor2", 
     ",", "MHD1FormTensor3", ",", "MHD3Form", ",", "MHDMaxwellTensor", ",", 
     "MHDPlasmaCurrentTensor", ",", "MHDRank2PTensor", ",", 
     "MHDMaxwellCurrent", ",", "MHDEquations", ",", "MHDEquationsList", ",", 
     "MHDMetricTensor", ",", "MHDScalar", ",", "MHD3Form", ",", 
     "MHDPlasmaCurrent", ",", "MHDMaxwell", ",", "MHDMaxwellCurrent", ",", 
     "MHDMaxwellStressTensor", ",", "MHDPlasmaStressTensor", ",", "MHDRank2P",
      ",", "MHDEnergyMomentumShearStress", ",", "MHDMetric", ",", 
     "MHDOperator", ",", "MetricSignature", ",", "MHDTotalStressTensor", ",", 
     "MHDLagrangian", ",", "MHDLagrangianDensity", ",", 
     "MHDPlasmaEnergyDensityOperator", ",", "MHDPlasmaEnergyDensity", 
     RowBox[{"(*", 
      RowBox[{"NewCode", ":", " ", "Protect"}], "*)"}], ",", 
     "CoordinateTransformationOperator", ",", "SymmetrizeIndices", ",", 
     "AntiSymmetrizeIndices", ",", "SymmetrizeIndicesOperator", ",", 
     "AntiSymmetrizeIndicesOperator", ",", "ExteriorD", ",", "MetricOperator",
      ",", "LieDerivativeOperator", ",", "TensorEquations", ",", 
     "OrthonormalFrameField", ",", "OrthonormalFrameFieldOperator", ",", 
     "InverseOrthonormalFrameField", ",", "FlatMetric", ",", 
     "TestOrthonormalFrameField", ",", "OrthonormalFrameFieldIndices", ",", 
     "OrthonormalBasis", ",", "CoordinateBasis", ",", "LieBracket", ",", 
     "LieBracketOperator", ",", "PotentialForm", ",", "ExpressionForm", 
     RowBox[{"(*", 
      RowBox[{",", "OperatorLinearity"}], "*)"}], ",", "OperatorProductRule", 
     ",", "VectorSphericalHarmonic", ",", "SphericalHarmonicYTensor", ",", 
     "TensorAssumption", ",", "TensorIsZeroOperator", ",", "TensorOperator", 
     ",", "TensorDivision", ",", "TensorDivisionOperator", ",", 
     RowBox[{"(*", 
      RowBox[{"TensorPlus", ","}], "*)"}], "TensorComponentsManipulation", 
     ",", "InteriorProduct", ",", "\[Iota]", ",", "\[Sterling]", ",", 
     "WedgeProductExpand", ",", "ToTensorComponents", ",", "LT", ",", 
     "TensorsProduct", ",", "ContractTensors", ",", "OperatorNullList", ",", 
     "OperatorDistributeOverPlus", ",", "OperatorExpansion", ",", 
     "OperatorFactorOutScalar", ",", "OperatorRemoveSingleComponentList", ",",
      "OperatorThreadThroughFunction", ",", "OperatorTensorReturnItself", ",",
      "OperatorExpressionFormReturnItself", ",", "OperatorTensorsProduct", 
     ",", "OperatorContractThroughFunction", ",", "OutputBecomesOneTensor", 
     ",", "OperatorThreadThroughTimes"}], "]"}], ";"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.520356911703125*^9, 3.520356939078125*^9}, {
   3.52037580859375*^9, 3.52037581165625*^9}, {3.520376122796875*^9, 
   3.5203761244375*^9}, {3.520699927546875*^9, 3.520699927734375*^9}, 
   3.52081566028125*^9, {3.520899516171875*^9, 3.520899525640625*^9}, 
   3.520957431171875*^9, {3.521140471609375*^9, 3.52114047246875*^9}, {
   3.521146855359375*^9, 3.521146855984375*^9}, {3.521484919640625*^9, 
   3.521484940328125*^9}, {3.52157286365625*^9, 3.521572871984375*^9}, {
   3.52167432159375*^9, 3.521674326078125*^9}, {3.521703057234375*^9, 
   3.521703062015625*^9}, {3.52176542053125*^9, 3.52176542484375*^9}, {
   3.521785377328125*^9, 3.52178537815625*^9}, {3.52191031628125*^9, 
   3.52191034603125*^9}, {3.521953610078125*^9, 3.52195362115625*^9}, {
   3.533879988501708*^9, 3.5338799892817097`*^9}, {3.539461489280633*^9, 
   3.539461490232235*^9}, {3.5395513992984557`*^9, 3.539551399516856*^9}, {
   3.5395519776382713`*^9, 3.539552003893118*^9}, {3.539552268797183*^9, 
   3.539552272322789*^9}, {3.5395532365247307`*^9, 3.539553331809698*^9}, {
   3.5396154436038017`*^9, 3.5396154960042934`*^9}, {3.5402290068331127`*^9, 
   3.5402290102463083`*^9}, {3.5406985277983303`*^9, 
   3.5406985281883307`*^9}, {3.5760907158352337`*^9, 
   3.5760907185184383`*^9}, {3.576687280878089*^9, 3.57668728159569*^9}, {
   3.583790277252267*^9, 3.5837902779843087`*^9}, {3.6064384556351647`*^9, 
   3.6064384881380234`*^9}, {3.6064924309585853`*^9, 3.606492431618623*^9}, {
   3.606497508680014*^9, 3.6064975088930264`*^9}, {3.606513221090252*^9, 
   3.6065132216902857`*^9}, {3.6065760339903374`*^9, 3.606576034193349*^9}, {
   3.629478603100625*^9, 3.629478626380658*^9}, {3.6296663229592495`*^9, 
   3.629666326328855*^9}, {3.629696760563964*^9, 3.6296967675527763`*^9}, {
   3.6296976663093657`*^9, 3.6296976670425673`*^9}, {3.6297631265948153`*^9, 
   3.6297631388202496`*^9}, {3.6297635844679832`*^9, 3.629763585235385*^9}, {
   3.6299090675704484`*^9, 3.6299090680540495`*^9}, {3.6299342624573455`*^9, 
   3.629934268962557*^9}, {3.6299364112776365`*^9, 3.6299364121668377`*^9}, {
   3.6299366310350633`*^9, 3.6299366312116632`*^9}, {3.6302034053695235`*^9, 
   3.6302034062743254`*^9}, {3.669530992945468*^9, 3.6695309939064693`*^9}, {
   3.6695800175107813`*^9, 3.6695800184418344`*^9}, {3.6695940476889696`*^9, 
   3.6695940633728666`*^9}, {3.669838492931531*^9, 3.6698384945715337`*^9}, {
   3.671902272456382*^9, 3.6719022733059864`*^9}, {3.6719860723750825`*^9, 
   3.671986073131384*^9}, {3.6719949713687606`*^9, 3.6719949722788124`*^9}, {
   3.6719973595523567`*^9, 3.671997361245454*^9}, {3.671997550033252*^9, 
   3.671997550610285*^9}, {3.6720581366640635`*^9, 3.6720581374040747`*^9}, {
   3.6720599736112814`*^9, 3.6720599762688217`*^9}, 3.672157546020041*^9, {
   3.6721575964558153`*^9, 3.6721576156536107`*^9}, {3.672260840212137*^9, 
   3.6722608787223396`*^9}, 3.672260910619164*^9, {3.7181780642427597`*^9, 
   3.7181780784909678`*^9}, {3.718874200752311*^9, 3.7188742173283567`*^9}, {
   3.7277848911209745`*^9, 3.727784895767605*^9}, {3.7277921643882694`*^9, 
   3.72779216544811*^9}, {3.7810030413514233`*^9, 3.781003041579853*^9}, {
   3.79624487928796*^9, 3.7962448925002203`*^9}, {3.847243670754033*^9, 
   3.847243727826871*^9}, {3.847244443564865*^9, 3.8472444569099393`*^9}, {
   3.847249828209492*^9, 3.8472498312985916`*^9}, {3.847772671690015*^9, 
   3.8477726721887083`*^9}, {3.8478470585242147`*^9, 
   3.8478470639570103`*^9}, {3.848443340922896*^9, 3.8484433477978897`*^9}, {
   3.854160542414827*^9, 3.854160592264306*^9}, {3.859455378584504*^9, 
   3.8594553787935033`*^9}, {3.8594561661279883`*^9, 3.859456166281991*^9}, {
   3.859462504833667*^9, 3.859462504979822*^9}, {3.859510531307102*^9, 
   3.8595105314680033`*^9}, {3.8596008094352922`*^9, 3.85960080960419*^9}, {
   3.8601115113062525`*^9, 3.860111511431246*^9}, {3.8613321769586673`*^9, 
   3.861332177159543*^9}, {3.861769009402819*^9, 3.861769010402789*^9}, {
   3.8617690539297705`*^9, 3.8617690540860167`*^9}, {3.865120028476678*^9, 
   3.865120034070427*^9}, {3.8667159797900667`*^9, 3.866715979959731*^9}, {
   3.8667179820251565`*^9, 3.866717982228299*^9}, {3.86732818184883*^9, 
   3.8673281865408187`*^9}, {3.8691360186010585`*^9, 
   3.8691360186529503`*^9}, {3.872656577389273*^9, 3.8726565890320826`*^9}, {
   3.884215044808009*^9, 3.8842150449779067`*^9}, {3.8847705336736712`*^9, 
   3.8847705338115892`*^9}, {3.885376785871662*^9, 3.8853767860395594`*^9}, {
   3.8854233879288464`*^9, 3.885423388176694*^9}, {3.886570632623369*^9, 
   3.886570632801259*^9}, 3.886734689048409*^9, {3.886734810889494*^9, 
   3.8867348277858367`*^9}, {3.886738118345416*^9, 3.886738118499323*^9}, {
   3.8871125519368224`*^9, 3.887112555369953*^9}, {3.887116691341601*^9, 
   3.8871166915584683`*^9}, {3.887159828673361*^9, 3.887159828841333*^9}, {
   3.8901933781588116`*^9, 3.8901933787120004`*^9}, {3.8920080790424757`*^9, 
   3.8920080794532223`*^9}, {3.8920093644018335`*^9, 
   3.8920093648665447`*^9}, {3.8947758232574096`*^9, 
   3.8947758391568317`*^9}, {3.8947764224629583`*^9, 
   3.8947764225924454`*^9}, {3.8950717614051323`*^9, 3.8950717621394873`*^9}, 
   3.895073261803241*^9, {3.8950746894229045`*^9, 3.895074689626025*^9}, 
   3.8955429293076878`*^9, 3.8955490521520815`*^9, {3.8955540100484104`*^9, 
   3.8955540442742033`*^9}, {3.898754489212411*^9, 3.898754532448866*^9}, {
   3.899377413899913*^9, 3.8993774263712397`*^9}, 
   3.956199042660884*^9},ExpressionUUID->"58c44fd8-6e68-433c-af38-\
a80fd733c7fa"]
}, Closed]],

Cell[CellGroupData[{

Cell["End", "Section",
 CellChangeTimes->{{3.52030332671875*^9, 
  3.5203033341875*^9}},ExpressionUUID->"f22bca56-27ec-41a4-b3d0-6ec3bb235ca7"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"EndPackage", "[", "]"}], ";"}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.518287025359375*^9, 3.518287083796875*^9}, {
   3.518287204515625*^9, 3.518287246046875*^9}, {3.518288154015625*^9, 
   3.518288179625*^9}, {3.5196834121875*^9, 3.519683417953125*^9}, {
   3.519689356625*^9, 3.519689356921875*^9}, {3.51976580715625*^9, 
   3.519765810671875*^9}, {3.519963432453125*^9, 3.519963433953125*^9}, 
   3.520125837828125*^9, {3.5201289498125*^9, 3.5201289504375*^9}, 
   3.520219859578125*^9, 3.5202268538125*^9, {3.52027377246875*^9, 
   3.520273831296875*^9}, {3.5202738760625*^9, 3.52027388446875*^9}, {
   3.5202739371875*^9, 3.5202741019375*^9}, {3.52027416353125*^9, 
   3.520274167671875*^9}, 3.520274919453125*^9, {3.52027495775*^9, 
   3.52027500990625*^9}, {3.520275109328125*^9, 3.52027513640625*^9}, {
   3.520275352625*^9, 3.520275353015625*^9}, {3.52027552415625*^9, 
   3.5202755711875*^9}, 3.520275790296875*^9, {3.5202759311875*^9, 
   3.520275948625*^9}, {3.520276746125*^9, 3.5202767880625*^9}, {
   3.52027692378125*^9, 3.52027700428125*^9}, {3.520277061046875*^9, 
   3.520277097125*^9}, {3.520277138046875*^9, 3.520277203125*^9}, {
   3.52027851596875*^9, 3.520278524*^9}, {3.52027856384375*^9, 
   3.520278653328125*^9}, 3.5202787563125*^9, {3.520279456296875*^9, 
   3.5202794635625*^9}, {3.520279561640625*^9, 3.520279567359375*^9}, {
   3.52028006315625*^9, 3.520280068671875*^9}, {3.5202804206875*^9, 
   3.520280495234375*^9}, 3.520281272765625*^9, {3.52028149878125*^9, 
   3.5202815018125*^9}, {3.520281674421875*^9, 3.5202816786875*^9}, {
   3.520281727390625*^9, 3.520281730375*^9}, 3.52028190265625*^9, {
   3.52028213190625*^9, 3.520282169640625*^9}, {3.520282364859375*^9, 
   3.520282395859375*^9}, {3.520282483109375*^9, 3.520282499046875*^9}, {
   3.52028567246875*^9, 3.520285695984375*^9}, {3.5202857606875*^9, 
   3.520285762578125*^9}, {3.520285792890625*^9, 3.520285807109375*^9}, {
   3.5202858616875*^9, 3.52028586721875*^9}, {3.520286964859375*^9, 
   3.520286985015625*^9}, {3.52028713909375*^9, 3.520287168453125*^9}, {
   3.52030002590625*^9, 3.520300043171875*^9}, {3.520300760625*^9, 
   3.520300806765625*^9}, {3.52030106778125*^9, 3.520301101625*^9}, {
   3.520301143203125*^9, 3.520301143921875*^9}, {3.520301203140625*^9, 
   3.520301219734375*^9}, {3.520301382671875*^9, 3.520301408375*^9}, {
   3.5203015531875*^9, 3.520301561859375*^9}, {3.52030160309375*^9, 
   3.52030162021875*^9}, {3.520301674546875*^9, 3.520301675078125*^9}, 
   3.520301885265625*^9, {3.52030235646875*^9, 3.5203024485*^9}, {
   3.52030252584375*^9, 3.520302587984375*^9}, {3.520302792015625*^9, 
   3.520302959515625*^9}, {3.520303101875*^9, 3.520303107296875*^9}, {
   3.520303238609375*^9, 3.52030324271875*^9}, {3.520303299859375*^9, 
   3.520303323609375*^9}},ExpressionUUID->"50fbc756-37bb-453f-b324-\
c5e8338f1c6b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Update History", "Section",
 CellChangeTimes->{{3.5391952096336904`*^9, 3.539195218704503*^9}, {
  3.5396343987731066`*^9, 3.539634400089182*^9}, {3.5396612373985376`*^9, 
  3.5396612378197384`*^9}},ExpressionUUID->"a02fac61-8b82-4c6d-8ef1-\
5122ad80d48b"],

Cell[TextData[{
 StyleBox["Feb 2012: \n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": The function Metric is extended to allow the user to input a Tensor \
object of TensorType \[Rule] \[OpenCurlyDoubleQuote]Metric\
\[CloseCurlyDoubleQuote]. Metric returns the same object with \
TensorComponents \[LongDash] depending on the input indices \[LongDash] \
representing either the metric, inverse metric, or the identity. In other \
words, TensoriaCalc now allow raising and lowering of the indices of Tensor \
objects of TensorType \[Rule] \[OpenCurlyDoubleQuote]Metric\
\[CloseCurlyDoubleQuote].\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, the metric can only be entered as a List (i.e. a matrix). The \
function Metric is extended to allow the metric to be entered as an \
expression quadratic in the differentials of the coordinates. For example, \
{{1,0},{0,",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["r", "2"], TraditionalForm]],ExpressionUUID->
  "dbac4c17-310d-4391-a645-ee19708ca63d"],
 "}} or ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[DifferentialD]", 
     SuperscriptBox["r", "2"]}], "+", 
    RowBox[{
     SuperscriptBox["r", "2"], 
     RowBox[{"\[DifferentialD]", 
      SuperscriptBox["\[Phi]", "2"]}]}]}], TraditionalForm]],ExpressionUUID->
  "6fc1e950-549e-497a-bb68-21af29ee14f6"],
 ", with CoordinateSystem \[Rule] {",
 Cell[BoxData[
  FormBox["r", TraditionalForm]],ExpressionUUID->
  "d63e3ffe-05a2-4e71-a93f-8ba08dda0c4b"],
 ",\[Phi]}, are both valid ways to enter the metric of the Euclidean 2-space."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149698950706*^9}},ExpressionUUID->"7a2153af-e443-461d-adf3-\
be30f252d6d1"],

Cell[TextData[{
 StyleBox["March 2012\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Bug fix",
  FontSlant->"Italic"],
 ": RaiseLower, the function within TensoriaCalc that plays a key role in \
raising and lowering indices of Tensor objects, now takes into account both \
metrics and inverse metric when reading in a Tensor object of TensorType \
\[Rule] \"Metric\". Previously it had assumed all such objects had \
TensorComponents with lower indices, i.e., all were metrics and not inverse \
metrics."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149706753219*^9}},ExpressionUUID->"420ff4cf-d2c1-45e8-9544-\
523fe8e60a7e"],

Cell[TextData[{
 StyleBox["May 2012\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Added section \"Geometric Objects: Definitions\"."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149714980734*^9}},ExpressionUUID->"7c721e48-f508-4526-9b70-\
cf02b9d648a5"],

Cell[TextData[{
 StyleBox["April 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New TensoriaCalc function CovariantBox added. This is intended to be the \
wave operator acting on any Tensor object. Right now, however, only scalars \
are supported.\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New TensoriaCalc function CoordinateTransformation added. This computes \
the Jacobian of coordinate transformations."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.6721497334107656`*^9}, {3.8520083064137554`*^9, 
   3.8520083076681795`*^9}},ExpressionUUID->"bca1ac60-c7b5-4241-bf13-\
b3afd3fa07e2"],

Cell[TextData[{
 StyleBox["July 2013\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New TensoriaCalc function GradientSquared added. This computes ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"\[Del]", "f"}], ")"}], "2"], TraditionalForm]],ExpressionUUID->
  "30e4c2ed-4cec-4292-834b-de82de395e5d"],
 " for any scalar function ",
 Cell[BoxData[
  FormBox["f", TraditionalForm]],ExpressionUUID->
  "d2d99954-ab7a-4a15-b9f8-b9fa3fc652be"],
 "."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149750198295*^9}},ExpressionUUID->"ead71958-ac53-4658-8df1-\
ae41691260d0"],

Cell[TextData[{
 StyleBox["August 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Series now allows for expansion with respect to multiple parameters. \
Previously, only Series[Tensor[...],{\[Epsilon],\[Epsilon]start,n}] was \
supported.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Instead of the Union of the coordinate transformations CT and its \
associated Jacobian JC, CoordinateTransformation now outputs Flatten[{JC, \
CT}] instead."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.6721497554683037`*^9}, {3.852008306494322*^9, 
   3.852008307746319*^9}},ExpressionUUID->"0743ba2d-d02a-4a35-9a48-\
b26222ee90e6"],

Cell[TextData[{
 StyleBox["November 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Metric[..., M, ...], where M is the matrix representation of the given \
geometry, now checks explicitly whether the Head[M] === List.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CheckMetric, the function that checks whether a given expression is a \
quadratic form of coordinate differentials, now does so by checking that the \
expression scales homogeneously under \[DifferentialD]",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["x", "\[Mu]"], "\[Rule]", 
    RowBox[{"\[Epsilon]", " ", 
     RowBox[{"\[DifferentialD]", 
      FormBox[
       RowBox[{
        SuperscriptBox["x", "\[Mu]"], " "}],
       TraditionalForm]}]}]}], TraditionalForm]],ExpressionUUID->
  "9715ff6a-73e2-42df-b0a8-4568b44accea"],
 "."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149762173316*^9}},ExpressionUUID->"105d041f-d11d-472a-b7a6-\
55d5b0c7d4a4"],

Cell[TextData[{
 StyleBox["December 2013\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Metric now applies FullSimplify[Inverse[#]]& to the matrix representation \
of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c385d81a-6861-4e70-95cb-49b8da50fbba"],
 " to convert it to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "98941dd7-075f-4a97-8bd7-6e9ff2eef842"],
 ", and similarly vice versa. Previously, to convert from ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "c1f56a1f-3baa-4b33-bb60-21c23f272a46"],
 " to ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "1cceb043-14ee-4cbc-9052-47a497b56d95"],
 ", or vice versa, it would only apply Inverse[#]&."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149766183322*^9}},ExpressionUUID->"4225639f-c070-42ef-889d-\
a81e2dc4b44a"],

Cell[TextData[{
 "(",
 StyleBox["April and May) 2014\n",
  FontWeight->"Bold"],
 "\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Created subsections Tensor Code and Tensor Arguments. The former contains \
code related to Tensor; the latter is for documentation purposes \[LongDash] \
we need to keep track of the range of arguments that can occur within Tensor.\
\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function CovariantD[",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Mu]", "-"], TraditionalForm]],ExpressionUUID->
  "a41ccc2e-f1f3-4bc5-8125-57916bf0dd42"],
 " or ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Mu]", "-"], TraditionalForm]],ExpressionUUID->
  "3d263e2c-3063-4cd9-97ba-710cb9155158"],
 ", S, m_Tensor] applies ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Del]", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "f319e602-5ad4-416c-a9b3-4efa1f8e6367"],
 " (or ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Del]", "\[Mu]"], TraditionalForm]],ExpressionUUID->
  "61f25531-9869-40d9-a985-acd61341a0a9"],
 ") on S with respect to the metric Tensor m. We assume metric compatibility.\
\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function TensorsProduct[Times[tt__Tensor]] builds a single Tensor \
object from the sequence tt and sums over all repeated indices.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function SwapIndices takes in a Tensor object and swaps its indices \
and the appropriate portions of its TensorComponents.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Indices now also takes in a Tensor object and returns the RHS of its \
Indices\[Rule]RHS.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorComponents now also takes in a Tensor object and returns the RHS of \
its TensorComponents\[Rule]RHS."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.672149771265831*^9}, 
   3.895073261943859*^9, 
   3.895549052255018*^9},ExpressionUUID->"e6dffbbf-2f6d-4d0c-b056-\
bd861796db5e"],

Cell[TextData[{
 StyleBox["January 2015\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function Einstein[\[Mu],\[Nu],MetricTensor_Tensor,EinsteinOperator\
\[Rule]",
 StyleBox["op",
  FontSlant->"Italic"],
 "] computes the Einstein tensor of the metric MetricTensor and applies the \
operator ",
 StyleBox["op",
  FontSlant->"Italic"],
 " to it. EinsteinOperator is optional; the default is ",
 StyleBox["op",
  FontSlant->"Italic"],
 " = FullSimplify.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, when and only when all its indices are Integers or all of \
them are Coordinates, does Tensor returns the \tcorresponding component. We \
have now updated this to allow mixed Integer/Coordinate indices, i.e., as \
long as non of the indices are abstract ones, TensoriaCalc will return the \
corresponding component of the Tensor. Also: (1) Duplicate code was deleted. \
(2) The condition that the Integer be \[GreaterEqual] 0 was removed. \n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, when and only when all its indices are Integers or all of \
them are Coordinates, does Tensor returns the \tcorresponding component. Now, \
Tensor is updated such that, as long as one or more of its indices are not \
abstract ones, the TensorComponents would be reduced in rank accordingly, for \
e.g., ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", 
    RowBox[{
     RowBox[{"Underbar", "[", "0", "]"}], "\[Nu]"}]], TraditionalForm]],
  ExpressionUUID->"a93bc01c-cf64-4a41-bebc-be074e672702"],
 " (constructed from the Metric) is now a vector. We Apply UnderBar to the \
non-abstract index as a bookkeeping device, so that TensoriaCalc will treat \
it as a scalar.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) UpOrDown[\[Mu]_] was previously defined with \
TestIndices[\[Mu]] imposed. This constraint has now been dropped.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": When defining the appearance of non-Metric Tensors, we previously imposed \
the constraint that all indices must be Symbolic ones. This constraint has \
now been dropped.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Repeated indices occurring within a single Tensor are now automatically \
summed over. Underbar is then applied to these repeated indices for \
bookkeeping purposes, so that TensoriaCalc will treat them as a scalars.\n\t\n\
",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CovariantD now allows for the \[Del]-index and one of the input Tensor's \
index to be repeated.\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function \
Weyl[\[Alpha],\[Beta],\[Mu],\[Nu],MetricTensor_Tensor,WeylOperator\[Rule]",
 StyleBox["op",
  FontSlant->"Italic"],
 "] computes the Weyl tensor of the metric MetricTensor and applies the \
operator ",
 StyleBox["op",
  FontSlant->"Italic"],
 " to it. WeylOperator is optional; the default is ",
 StyleBox["op",
  FontSlant->"Italic"],
 " = FullSimplify.\n\t\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function TensorIsZero[stuff_Tensor] returns True if every component of \
the Tensor stuff is zero and False otherwise.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) NotAbstractIndex[\[Mu]] returns True if \[Mu] is not an \
abstract index (\[Congruent] ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"SuperMinus", " ", "or", " ", "SubMinus"}], ")"}], 
   TraditionalForm]],ExpressionUUID->"485dc74d-a967-4a87-bd6e-1659b9c3a006"],
 "[_Symbol or _Integer]) and False otherwise.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) TestScalarTensor[m_Tensor] returns True if the Tensor m is a \
scalar and False otherwise.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) RemoveUnderBarredIndices[\[Mu]T_List] removes from the list of \
indices \[Mu]T all indices with UnderBar applied to them.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) RemoveRepeatedUnderBarredIndices[\[Mu]T_List] removes from the \
list of indices \[Mu]T all repeated UnderBarred indices.\n\t\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) NestedDel[dd_Del] takes an expression of the form \
Del[...Del[stuff]] and peels off the Del's one by one until the Head of stuff \
is not Del. Returns {# of Del's, stuff}.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": \"Update History\" format changed slightly.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, TensorComponents distinguished between whether the input \
Tensor was a scalar or higher rank tensor. This is not necessary, and the \
code has been simplified.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": SwapIndices updated to account for the presence of UnderBarred indices.\n\
\n",
 StyleBox["Update",
  FontSlant->"Italic",
  FontColor->GrayLevel[0]],
 ": Until further notice we will not use TensorsProduct in internal \
TensoriaCalc code, because TensorsProduct is not properly developed. To this \
end, the CovariantD code has been modified.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Sgn code simplified.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function PartialD[\[Mu],stuff_,MetricM_Tensor] returns the partial \
derivative of stuff using the Metric Tensor MetricM.\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": Raising and lowering of the indices of the Ricci tensor has been \
de-bugged. Previously, the left index was raised/lowered instead of the right \
index, and vice versa. :-/\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function NonMetricTensor returns a user defined Tensor object.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " MoveIndices[tt_Tensor,idx_List,m_Tensor] raises/lower indices of tt, as \
specified by the idx, using the Metric Tensor m. Suppose tt has indices {",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]", "-"], TraditionalForm]],ExpressionUUID->
  "d112a1c3-4029-48d1-91c6-dcd28024f964"],
 ", ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Beta]", "-"], TraditionalForm]],ExpressionUUID->
  "c9383c18-d4d7-4a4b-bb00-840b62900c1f"],
 " ,",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Mu]", "-"], TraditionalForm]],ExpressionUUID->
  "4267b9bf-5146-44a8-8a6e-8a51dac0881d"],
 ", ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Nu]", "-"], TraditionalForm]],ExpressionUUID->
  "558dee5d-f074-4460-92d7-dc734b0098a6"],
 "} and \[Alpha] and \[Mu] needs to be raised and lowered respectively, then \
do MoveIndices[tt_Tensor,{",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["\[Alpha]", "-"], ",", 
    SubscriptBox["\[Mu]", "-"]}], TraditionalForm]],ExpressionUUID->
  "d236da68-e1a6-40ae-9655-4cd3b68a7274"],
 "},m].\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": All the default settings for RiemannOperator, WeylOperator, etc. have \
been changed from FullSimplify to Simplify to reduce computation time.\n\n",
 StyleBox["Update:",
  FontSlant->"Italic"],
 " All scalar, rank 1 and rank 2 tensors \[LongDash] including Metric Tensors \
\[LongDash] will now be displayed as their TensorNames with appropriate \
indices attached (e.g., ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["g", "\[Mu]\[Nu]"], TraditionalForm]],ExpressionUUID->
  "8f30d566-fa5e-4dca-a25c-0a92fa0913ab"],
 "). (Previously, the Metric Tensor, in particular, was displayed with a \
Tensor Head with the components of the Ricci tensor/scalar, Christoffel \
symbols, Riemann tensor, etc., as its arguments.) Hovering the mouse cursor \
over these scalar, vectors and tensors will display their TensorComponents \
and the coordinates used.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": When Metric Tensor has one up and one down index, the TensorName is \
changed to \[Delta]."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.672149782513352*^9}, 
   3.893289125024084*^9, {3.8950732621469765`*^9, 3.8950732623032265`*^9}, {
   3.8955490524931164`*^9, 3.8955490526549597`*^9}, 3.895554775581361*^9, 
   3.895555340266024*^9},ExpressionUUID->"219c5f04-52cf-4dae-967b-\
47f3912e2bec"],

Cell[TextData[{
 StyleBox["February 2015\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update:",
  FontSlant->"Italic"],
 " Previously TensorIsZero does not account for scalars. Now it does.\n\n",
 StyleBox["Update:",
  FontSlant->"Italic"],
 " Previously the description of Metric did not include the optional \
arguments ChristoffelOperator\[Rule]op, RiemannOperator\[Rule]op, \
RicciOperator\[Rule]op, RicciScalarOperator\[Rule]op. Now it does."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 
   3.672149786135858*^9}},ExpressionUUID->"dfdae96a-3060-44da-84f7-\
d41e581edf1b"],

Cell[TextData[{
 "(",
 StyleBox["April and May) 2016\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function LeviCivita implements the generally covariant Levi-Civita \
(pseudo-)tensor.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function CovariantHodgeDual implements the generall covariant Hodge \
dual (aka Hodge star) operation. It checks whether the tensor whose dual is \
being computed is fully antisymmetric.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function UniqueIndices takes in a Tensor and returns the same Tensor \
but with its indices replaced with Unique ones.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function RaiseAllIndices[t,m] takes in a tensor t and returns it with \
all indices raised using the Metric Tensor m.\n\n",
 StyleBox["Update!",
  FontSlant->"Italic"],
 " New function LowerAllIndices[t,m] takes in a tensor t and returns it with \
all indices lowered using the Metric Tensor m.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) TestMetricTensor[m_Tensor] returns True if m is of type \
\"Metric\" and False otherwise.\n\nUpdate: Previously, Coordinates only reads \
coordinates from a Metric Tensor. Now it reads in any Tensor.\n\nUpdate: The \
portion of code in CovariantD involving Christoffel symbols was re-written to \
exploit TensorProduct, TensorContract and Transpose.\n\n",
 StyleBox["Update!!",
  FontSlant->"Italic"],
 " New functions pre-pended with \"MHD\" implement the PDEs of ideal MHD in \
4D curved spacetimes. Currently, the main functions are:\n\t\tMHDSystem, \
MHDMaxwellCurrent, MHDEquations, MHDMetricTensor, MHDScalar, MHD3Form, \
MHDPlasmaCurrent, MHDMaxwell, \n\t\tMHDMaxwellCurrent, MHDRank2P, \
MHDEnergyMomentumShearStress, MHDMetric, MHDLagrangian, \
MHDPlasmaEnergyDensity\n\tNote: MHDSystem allows either sign conventions for \
the metric to be used.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorComponents now threads over Plus automatically.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Now, TensorComponents[(Non-Tensor stuff) x Tensor1 x Tensor2 ...] = \
(Non-Tensor stuff) TensorComponents[Tensor1 x Tensor2 ...].\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Tensor Code involving Einstein summation has been simplified to use \
TensorContract directly/solely. Previously, an additional contraction \
involving the identity matrix was employed.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": MoveIndices code re-written to employ TensorProduct, Transpose and \
TensorContract.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorsProduct is re-instated. It now perform a TensorProduct of sorts of \
Tensor objects, but \[LongDash] for now \[LongDash] only those Tensors with \
the same CoordinateSystem.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": (Internal) FormatTensorName will be applied to TensorName of a Tensor to \
format it in special cases, for e.g., when Tensor is a TensorProduct.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Now, CovariantD[\[Mu]_,(Non-Tensor stuff) x Tensor1 x Tensor2 ...,m_] = \
(Non-Tensor stuff) CovariantD[\[Mu], Tensor1 x Tensor2 ..., m]; CovariantD \
distributes over Plus; and CovariantD now acts on a product of Tensors ",
 StyleBox["m",
  FontSlant->"Italic"],
 " by first applying TensorsProduct to ",
 StyleBox["m",
  FontSlant->"Italic"],
 ", so that CovariantD can act on it as a single Tensor object. CovariantD \
now also obeys the product rule of differentiation.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorSymmetry[m_Tensor] now does TensorSymmetry[TensorComponents[m]].\n\n\
",
 StyleBox["Spring 2016\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Ideal Magneto-hydrodynamics (iMHD) functionality added. Updates to \
iMHD-related functions will appear in its subsection above.\n\n",
 StyleBox["October 2017\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": GeodesicSystem takes in as input a Metric Tensor, an affine parameter, \
and a non-affine parameter; and outputs a List: {Geodesic Lagrangian in \
affine parameter form, Geodesic Lagrangian in non-affine parameter form, \
Geodesic equations in affine parameter form, Geodesic equations in non-affine \
parameter form}.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": GeodesicLagrangians takes in as input a Metric Tensor, an affine \
parameter, and a non-affine parameter; and outputs a List: {Geodesic \
Lagrangian in affine parameter form, Geodesic Lagrangian in non-affine \
parameter form}. That is, it does what GeodesicSystem does, but does not \
output the geodesic equations themselves.\n\n",
 StyleBox["February 2018\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": ToTensor returns a Tensor.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": LieDerivative returns the Lie derivative of a metric.\n\n",
 StyleBox["May 2019\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " function Dimensions now may be applied to Tensor objects. It does \
Dimensions[TensorComponents[Tensor[stuff]]]; i.e., it returns the Dimensions \
of the TensorComponents.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": The Weyl tensor, being the traceless part of Riemann, is zero in two and \
three dimensions. TensoriaCalc now immediately outputs a zero tensor whenever \
the space(time) dimension is 2 or 3; previously, it computes Weyl when d=3 \
(which, of course, will always yield zero) and gives an error when d=2. The \
reason for the error in the latter is due to the generic formula for the Weyl \
tensor breaking down, as it contains factors of 1/(d-2); this in turn is \
related to the fact that the Einstein tensor is zero in 2D.\n\n",
 StyleBox["October 2019",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": NonMetricTensor now has an additional argument; i.e., \
it\[CloseCurlyQuote]s now \
NonMetricTensor[\[Mu]T_List,stuff_List,exp_,CoordinateSystem\[Rule]coords_\
List,opts:OptionsPattern[]], where the new argument exp refers to the \
TensorName \[Rule] exp. The name of the Tensor should not be Optional.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": The function ToTensor was deleted, because it overlaps with \
NonMetricTensor.\n\n",
 StyleBox["February 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CoordinateTransformation is now able to coordinate-transform Tensors of \
TensorType \[OpenCurlyDoubleQuote]Metric\[CloseCurlyDoubleQuote].\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Section \[OpenCurlyDoubleQuote]Geometry\[CloseCurlyDoubleQuote] is now \
renamed \[OpenCurlyDoubleQuote]Library of Functions\[CloseCurlyDoubleQuote].\n\
\n",
 StyleBox["April 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": New function GeodesicHamiltonianDynamics computes the Hamilton and the \
associated Hamilton\[CloseCurlyQuote]s equations for geodesic motion, given a \
metric, definitions of momenta, and the affine parameter variable.\n\n",
 StyleBox["May 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": NonMetricTensor\[CloseCurlyQuote]s usage has now been corrected to \
reflect NonMetricTensor[\[Mu]T_List,stuff_List,exp_,CoordinateSystem\[Rule]\
coords_List,opts:OptionsPattern[]], where the new argument exp refers to the \
TensorName \[Rule] exp. That is, the name of the Tensor is not Optional.\n\n",
 StyleBox["August 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": TensorsProduct is now applied to Tensors with the same Coordinates. For \
example, if t1 and t2 have the same Coordinates; and t3 and t4 have the same \
Coordinates (but different from those in t1 and t2) \[LongDash] then \
TensorsProduct[t1 t3 t2 t4] will return TensorsProduct[t1 t2] \
TensorsProduct[t3 t4]. Previously TensorsProduct[t1 t2 t3 t4] would have \
returned TensorsProduct[t1 t2 t3 t4].\n\n",
 StyleBox["October 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": NonMetricTensor can now create a Tensor object containing a scalar. \
Previously it only allowed creation of tensors with rank higher than zero.\n\n\
",
 StyleBox["Bux Fix",
  FontSlant->"Italic"],
 ": CovariantBox\[CloseCurlyQuote]s usage displayed the wrong formula. It \
used to read ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"|", 
       RowBox[{"det", " ", "g"}], "|"}], ")"}], 
     RowBox[{"1", "/", "2"}]], 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], 
     RowBox[{"(", "...", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "79793459-b54c-4a43-ba36-53936334b31a"],
 "; now it correctly reads  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"|", 
       RowBox[{"det", " ", "g"}], "|"}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]], 
    RowBox[{
     SubscriptBox["\[PartialD]", "\[Mu]"], 
     RowBox[{"(", "...", ")"}]}]}], TraditionalForm]],ExpressionUUID->
  "7d1b2f05-6710-4ecf-a9d3-aecac012bc2e"],
 ".\n\n",
 StyleBox["November 2020",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CoordinateTransformation[mt_Tensor,{....},{newcoords},...] no longer \
checks that the newcoords have the same Length as the old coordinates.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CoordinateTransformation[mt_Tensor,{....},{newcoords},...] now takes in a \
new Optional Rule StartIndex -> xx. If xx is not Integer, the StartIndex will \
be gotten from mt. Otherwise, it will be xx.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": Previously, the usage for PartialD failed to explain that it also acted \
on non-Tensor expressions. Now it does.\n\n",
 StyleBox["January 2021\n",
  FontWeight->"Bold"],
 "\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": CovariantHodgeDual now checks for the antisymmetry of the input tensor \
only when its rank is higher 1. Previously it tries to check for the \
antisymmetry of tensors of any rank.\n\n",
 StyleBox["March 2021",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": Usage description for CoordinateTransformation was fixed. In particular, \
in (II), the CoordinateTransformation[mt_Tensor,{x\[Rule]f1[p,q,r,...], y\
\[Rule]f2[p,q,r,...], z\[Rule]f3[p,q,r,...], ...}, {p,q,r, ...}, \
CoordinateTransformationOperator\[Rule]op, StartIndex\[Rule]si] was missing \
the mt_Tensor argument.\n\n",
 StyleBox["Update",
  FontSlant->"Italic"],
 ": In the Tensor code implementing Einstein summation, TensoriaCalc checks \
that the repeated indices are abstract. This check now uses the function \
NotAbstractIndex; previously there was a standalone code which was likely \
buggy.\n\n",
 StyleBox["April 2021",
  FontWeight->"Bold"],
 "\n\n",
 StyleBox["Bug Fix",
  FontSlant->"Italic"],
 ": Previously, NotAbstractIndex would return False if ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["#", "-"], TraditionalForm]],ExpressionUUID->
  "ddeb3936-1594-4cbf-91b8-0db60b9eb60b"],
 " or ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["#", "-"], TraditionalForm]],ExpressionUUID->
  "dfdd1f4e-48c7-4564-89fc-208318d3c224"],
 " contained a number # that lay out of range (e.g., 20 in a 3D coordinate \
system); now it returns True."
}], "Text",
 CellChangeTimes->{{3.5391952254569125`*^9, 3.539195640163097*^9}, {
   3.53955006359291*^9, 3.5395501346978345`*^9}, {3.5395501670990915`*^9, 
   3.539550390631884*^9}, {3.539551751874675*^9, 3.5395517613906918`*^9}, {
   3.539552377154973*^9, 3.539552451910304*^9}, {3.5396155207615376`*^9, 
   3.539615524739544*^9}, {3.5396155883252563`*^9, 3.5396156250342236`*^9}, {
   3.539634404087411*^9, 3.539634467948063*^9}, {3.539658702983876*^9, 
   3.53965871095549*^9}, {3.5396612431081476`*^9, 3.5396615769538345`*^9}, {
   3.5396616172225056`*^9, 3.539661649976963*^9}, {3.5398821994892073`*^9, 
   3.539882248779027*^9}, {3.5402291264969573`*^9, 3.5402291273160043`*^9}, {
   3.5468019316783457`*^9, 3.5468019713180156`*^9}, 3.5468020013948684`*^9, {
   3.576090752245698*^9, 3.5760908187330146`*^9}, {3.5760908545506773`*^9, 
   3.5760910170873632`*^9}, {3.5766872960881157`*^9, 3.576687366272639*^9}, {
   3.5837902958813324`*^9, 3.583790362004114*^9}, {3.585772227618986*^9, 
   3.5857723766460485`*^9}, {3.5857724160361176`*^9, 
   3.5857724217457275`*^9}, {3.585772487733843*^9, 3.585772597526836*^9}, {
   3.594234069677395*^9, 3.5942342865307264`*^9}, {3.594236245769825*^9, 
   3.594236403751252*^9}, {3.594236439967308*^9, 3.594236444402377*^9}, {
   3.5965848885218115`*^9, 3.5965851829879284`*^9}, {3.6064477129242563`*^9, 
   3.6064477170244904`*^9}, {3.6067643878025208`*^9, 
   3.6067645104187365`*^9}, {3.606764548030402*^9, 3.606764590602877*^9}, {
   3.609613720173603*^9, 3.6096137267880154`*^9}, {3.6096137886421237`*^9, 
   3.6096138439442205`*^9}, {3.6096139013367214`*^9, 3.609614191778032*^9}, {
   3.609614236846511*^9, 3.609614244334524*^9}, {3.609614445075677*^9, 
   3.6096144489912834`*^9}, {3.6294786490906897`*^9, 
   3.6294787833808775`*^9}, {3.62947881355092*^9, 3.629478818390927*^9}, {
   3.629479785061555*^9, 3.6294797863715563`*^9}, {3.629562542055464*^9, 
   3.6295625440532675`*^9}, {3.629563179524299*^9, 3.6295632164805703`*^9}, {
   3.6295634770856667`*^9, 3.6295634800078716`*^9}, {3.6295635962982955`*^9, 
   3.6295636268611546`*^9}, {3.6295636988918905`*^9, 
   3.6295637168753257`*^9}, {3.6295643246241803`*^9, 3.629564327174985*^9}, {
   3.6295643802052975`*^9, 3.6295643943321285`*^9}, 3.62956444018983*^9, {
   3.6295645910583153`*^9, 3.629564616309367*^9}, {3.629564793949936*^9, 
   3.6295648281644125`*^9}, {3.6295665105709906`*^9, 3.629566527426426*^9}, {
   3.6295667402196894`*^9, 3.6295667804318533`*^9}, {3.6295668168915315`*^9, 
   3.629566842207182*^9}, {3.629566877352854*^9, 3.6295668923634853`*^9}, {
   3.6295669401405888`*^9, 3.629566958360826*^9}, {3.6295676927117987`*^9, 
   3.6295677768997583`*^9}, {3.6295678947547846`*^9, 3.629567999329583*^9}, {
   3.6295822987213025`*^9, 3.6295823643752356`*^9}, {3.6295824139493294`*^9, 
   3.6295826420773797`*^9}, {3.629603441693468*^9, 3.6296037548778596`*^9}, {
   3.629607699840618*^9, 3.62960775507927*^9}, {3.629609623367103*^9, 
   3.6296096457134447`*^9}, {3.629611118868438*^9, 3.629611222099281*^9}, {
   3.6296966526365733`*^9, 3.629696692941445*^9}, {3.6297636071580486`*^9, 
   3.629763693559885*^9}, {3.629822036569414*^9, 3.6298220397694197`*^9}, {
   3.629822086093307*^9, 3.6298221023857403`*^9}, {3.6298221675296617`*^9, 
   3.6298221905345078`*^9}, {3.6298257059366274`*^9, 
   3.6298257837814646`*^9}, {3.6298259014543715`*^9, 3.629825999218544*^9}, {
   3.6298260411408176`*^9, 3.6298261482132063`*^9}, {3.6298266422494926`*^9, 
   3.6298266581016207`*^9}, {3.6298267861248455`*^9, 3.629826875894903*^9}, {
   3.62982690822066*^9, 3.6298271407473702`*^9}, {3.629827195279466*^9, 
   3.629827206545186*^9}, 3.6298272545121703`*^9, {3.6298273159494786`*^9, 
   3.629827323000691*^9}, {3.629827524644846*^9, 3.629827540043973*^9}, {
   3.629843695864236*^9, 3.629843768112363*^9}, {3.6298438969973907`*^9, 
   3.629843902972201*^9}, {3.6298448016472807`*^9, 3.629844837095543*^9}, {
   3.62985840203149*^9, 3.629858493510722*^9}, {3.6298657414582825`*^9, 
   3.6298657501879444`*^9}, {3.629909079007269*^9, 3.6299091181965375`*^9}, {
   3.6299263757686844`*^9, 3.6299264772814417`*^9}, {3.629929867859521*^9, 
   3.6299298729451303`*^9}, {3.6299342834705825`*^9, 
   3.6299343177282424`*^9}, {3.629938461994429*^9, 3.629938470512044*^9}, {
   3.62999370915497*^9, 3.629993709357771*^9}, 3.6299937861556067`*^9, 
   3.629993859254936*^9, {3.630203492255678*^9, 3.6302036679861917`*^9}, {
   3.630203700803055*^9, 3.6302037242280965`*^9}, {3.6303300486200323`*^9, 
   3.6303300997039537`*^9}, {3.630434289440716*^9, 3.6304344590808215`*^9}, {
   3.63063870239233*^9, 3.6306387057726374`*^9}, {3.6306914969265156`*^9, 
   3.630691522836998*^9}, {3.6306963776461215`*^9, 3.6306965559231014`*^9}, {
   3.630696629480076*^9, 3.630696650329111*^9}, {3.6306967646614947`*^9, 
   3.630696807987544*^9}, {3.6309870350982666`*^9, 3.630987055946305*^9}, {
   3.6326180036776175`*^9, 3.632618041000888*^9}, {3.633650773200718*^9, 
   3.633650875407123*^9}, {3.6695150914329014`*^9, 3.6695151469969916`*^9}, {
   3.6695340689888253`*^9, 3.669534103324486*^9}, {3.6695800385699854`*^9, 
   3.669580068158678*^9}, {3.6695801069818983`*^9, 3.6695801073199177`*^9}, {
   3.6697710716437035`*^9, 3.66977109395998*^9}, {3.669771129469011*^9, 
   3.669771147322032*^9}, {3.669771240047613*^9, 3.669771248967632*^9}, {
   3.6697712917597027`*^9, 3.669771304845722*^9}, {3.6698286373379354`*^9, 
   3.669828712054674*^9}, {3.6698397290864587`*^9, 3.6698397551453114`*^9}, {
   3.6698435572376857`*^9, 3.6698435867013707`*^9}, {3.671900284442581*^9, 
   3.6719003563897057`*^9}, {3.6719006947896194`*^9, 
   3.6719006963716235`*^9}, {3.671902989907487*^9, 3.671903150700734*^9}, {
   3.6719085682754197`*^9, 3.6719085691247215`*^9}, {3.67190902094978*^9, 
   3.671909022967884*^9}, {3.6719090611001635`*^9, 3.671909061869565*^9}, {
   3.6719095357905307`*^9, 3.6719095646735964`*^9}, {3.671909607961093*^9, 
   3.671909640559662*^9}, {3.6719096720568495`*^9, 3.6719096753777604`*^9}, {
   3.67190987991696*^9, 3.671909897029999*^9}, {3.671994989288786*^9, 
   3.671995084358223*^9}, {3.671995566580805*^9, 3.6719955978665943`*^9}, {
   3.672059857739501*^9, 3.6720598617095623`*^9}, {3.6720752906433525`*^9, 
   3.672075293958542*^9}, {3.6720753292375593`*^9, 3.6720753822145896`*^9}, {
   3.6720754410259533`*^9, 3.6720755069357233`*^9}, {3.6720827910149236`*^9, 
   3.6720828354681063`*^9}, {3.6721496951806993`*^9, 3.67214978745586*^9}, {
   3.672591105573307*^9, 3.6725912566740212`*^9}, {3.672936808465267*^9, 
   3.6729368315771112`*^9}, {3.673375150613358*^9, 3.6733751697738123`*^9}, {
   3.673482874654341*^9, 3.673482943414274*^9}, {3.7037308385464573`*^9, 
   3.703730868738502*^9}, {3.7037310150788503`*^9, 3.703731043713578*^9}, {
   3.7181781096702566`*^9, 3.7181783272362127`*^9}, {3.718874273144792*^9, 
   3.7188743211635275`*^9}, {3.727784922531112*^9, 3.727784970891547*^9}, {
   3.727792192363469*^9, 3.7277922232967973`*^9}, {3.766942314052198*^9, 
   3.7669423994489107`*^9}, {3.7669424318024282`*^9, 
   3.7669424361637697`*^9}, {3.7669424720101447`*^9, 
   3.7669425252977133`*^9}, {3.767003064291844*^9, 3.7670032701808124`*^9}, {
   3.7670039426402426`*^9, 3.7670040208339586`*^9}, {3.7810054481949325`*^9, 
   3.78100558506383*^9}, {3.7913775767884607`*^9, 3.791377674584175*^9}, {
   3.791603332344458*^9, 3.791603365243082*^9}, {3.7962449299087863`*^9, 
   3.7962450332599683`*^9}, {3.7991208217267137`*^9, 
   3.7991208947966423`*^9}, {3.806665185087378*^9, 3.8066652295731654`*^9}, {
   3.8066652706113157`*^9, 3.806665427808397*^9}, {3.806665637498681*^9, 
   3.80666565877029*^9}, {3.8067413672994328`*^9, 3.806741376537784*^9}, {
   3.8105266102894354`*^9, 3.8105266699404073`*^9}, {3.812324765355049*^9, 
   3.812324848483503*^9}, {3.8135318972255297`*^9, 3.813531978743048*^9}, {
   3.813532429709549*^9, 3.8135324878316646`*^9}, {3.815347188652671*^9, 
   3.81534723733668*^9}, {3.820996784408843*^9, 3.8209968536050873`*^9}, {
   3.8209987270093155`*^9, 3.820998776708673*^9}, {3.823815595942007*^9, 
   3.823815635170335*^9}, {3.825220099723398*^9, 3.8252202108887014`*^9}, {
   3.82563175045571*^9, 3.825631873785451*^9}, {3.8262347010480022`*^9, 
   3.826234705328848*^9}, {3.826234744066947*^9, 3.826234844433211*^9}, {
   3.89507326252197*^9, 3.8950732636313133`*^9}, {3.895549052899413*^9, 
   3.895549054088929*^9}, 
   3.8955551728498077`*^9},ExpressionUUID->"6a328d5f-73fb-4371-810d-\
e49da45a4eff"]
}, Closed]]
}, Open  ]]
},
AutoGeneratedPackage->Automatic,
WindowToolbars->"EditBar",
WindowSize->{1867.5, 978.75},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"VersionedStylesheet"->{"Default.nb"[8.] -> False}},
ShowSelection->True,
FrontEndVersion->"13.3 for Linux x86 (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"a685efb9-fa40-4dc0-9063-7c5abc2e202c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 157, 3, 98, "Title",ExpressionUUID->"709c6e72-b6d5-4da7-834f-6a8e8ec43703"],
Cell[CellGroupData[{
Cell[761, 29, 269, 4, 67, "Section",ExpressionUUID->"4c34ad68-c0ee-4c7e-b3bc-7e89d878397f"],
Cell[1033, 35, 12823, 271, 3554, "Text",ExpressionUUID->"f0341033-fda0-4009-9a1f-fc82d2af96d4"],
Cell[13859, 308, 305, 6, 29, "Input",ExpressionUUID->"ef005703-cd52-4222-a532-3659a531f1f5"]
}, Closed]],
Cell[CellGroupData[{
Cell[14201, 319, 219, 4, 53, "Section",ExpressionUUID->"72bd2be0-e491-4259-abdd-f5d0d6c720f4"],
Cell[14423, 325, 7476, 178, 651, "Input",ExpressionUUID->"4a86c268-2418-4e54-8890-ea254b3bdcf4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[21936, 508, 230, 4, 53, "Section",ExpressionUUID->"11b59f65-da1a-4f8a-811c-2386e77bf6d4"],
Cell[22169, 514, 1252, 19, 58, "Text",ExpressionUUID->"b5e6e792-1bbe-4285-ac5a-39d229eddab4"],
Cell[23424, 535, 1787, 39, 58, "Text",ExpressionUUID->"52f9b741-3e82-4d6f-a1d4-e25e37d937a2"],
Cell[25214, 576, 2161, 47, 58, "Text",ExpressionUUID->"d40af7e2-9a26-4ca2-9ae2-e53c5384a21b"],
Cell[27378, 625, 1207, 23, 35, "Text",ExpressionUUID->"3845de80-1110-454b-9540-2e8519c9c9ac"],
Cell[28588, 650, 1192, 23, 35, "Text",ExpressionUUID->"3c317f83-94d9-4d7a-886f-7a5d71c56178"],
Cell[29783, 675, 1280, 26, 35, "Text",ExpressionUUID->"aca41777-70a2-483b-a840-5989459e0b69"],
Cell[31066, 703, 4181, 109, 135, "Text",ExpressionUUID->"7946fbdc-2cbb-47bc-99b7-414d0ab90ab3"],
Cell[35250, 814, 3104, 78, 89, "Text",ExpressionUUID->"0031cf5e-9a66-49e2-9ae7-82aa2adb0af9"]
}, Closed]],
Cell[CellGroupData[{
Cell[38391, 897, 151, 3, 53, "Section",ExpressionUUID->"dbe7ad7a-92fe-41a0-9f5c-966a781ff5c3"],
Cell[CellGroupData[{
Cell[38567, 904, 157, 3, 54, "Subsection",ExpressionUUID->"7ed4bb07-bc17-40f3-a1d3-169195392a1b"],
Cell[38727, 909, 11507, 171, 86, "Input",ExpressionUUID->"0dedec9e-166b-4c5a-b98a-9db1ff6a4b12",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[50271, 1085, 158, 3, 38, "Subsection",ExpressionUUID->"92dff23d-d740-43fc-a3bc-d15106ea2098"],
Cell[50432, 1090, 53551, 1033, 6038, "Input",ExpressionUUID->"eb551ae7-49f0-46bf-a0d1-2e2fecbe6ae9",
 InitializationCell->True],
Cell[103986, 2125, 29973, 493, 2380, "Input",ExpressionUUID->"91b04c85-a1aa-4658-96dc-da31b43dd7ef",
 InitializationCell->True],
Cell[133962, 2620, 10477, 256, 1486, "Code",ExpressionUUID->"49edcfe2-6c69-44ee-a9ac-b7327209cab8"]
}, Closed]],
Cell[CellGroupData[{
Cell[144476, 2881, 237, 4, 38, "Subsection",ExpressionUUID->"ad34d706-e6c9-4ec1-a4a2-11f9f325835b"],
Cell[144716, 2887, 32539, 620, 1360, "Input",ExpressionUUID->"51d6a053-8ea8-4cc2-8ca7-ea9976cc4174",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[177304, 3513, 209, 4, 67, "Section",ExpressionUUID->"72db2963-df8b-47c5-afb6-fc5119094b1d"],
Cell[177516, 3519, 2921, 44, 45, "Input",ExpressionUUID->"918b4003-dc65-445a-bb4c-a29a22fcd1b5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[180474, 3568, 170, 3, 53, "Section",ExpressionUUID->"a50d09e8-2ca3-4c82-8198-485591f2ec8e"],
Cell[180647, 3573, 147584, 3536, 9763, "Input",ExpressionUUID->"488ddccd-bdb8-411d-9891-a43103f14aba",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[328268, 7114, 216, 4, 53, "Section",ExpressionUUID->"0394dae6-59c8-4959-bedf-167b042a8955"],
Cell[CellGroupData[{
Cell[328509, 7122, 369, 6, 54, "Subsection",ExpressionUUID->"f58072ca-30c6-4a05-b9e6-4325729d624a"],
Cell[CellGroupData[{
Cell[328903, 7132, 280, 5, 45, "Subsubsection",ExpressionUUID->"4b413813-1f35-4aa5-8079-459098f6c260"],
Cell[329186, 7139, 973, 16, 45, "Input",ExpressionUUID->"6dcd0d12-64f0-4d29-bc8d-3c3181c5f049",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[330196, 7160, 402, 6, 37, "Subsubsection",ExpressionUUID->"347f41c0-125f-4615-8eab-91074a82f150"],
Cell[330601, 7168, 2420, 52, 656, "Text",ExpressionUUID->"716b76f7-1c47-4ae9-82fd-d41c62af3adf",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[333058, 7225, 444, 6, 37, "Subsubsection",ExpressionUUID->"aae06da9-a5bf-477a-96de-902d8c8b5643"],
Cell[333505, 7233, 2871, 48, 495, "Text",ExpressionUUID->"fc9f0a89-a684-46e6-a8c0-f326a0c35007",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[336413, 7286, 157, 3, 37, "Subsubsection",ExpressionUUID->"40e9b7b5-f29e-4b42-a7e9-fa207ff66c33"],
Cell[336573, 7291, 56382, 1043, 2420, "Input",ExpressionUUID->"55cfa897-81b7-4dd3-958b-b5eff504d035",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[392992, 8339, 164, 3, 37, "Subsubsection",ExpressionUUID->"fd508f6f-e15c-4d3c-8ca6-88cad961051f"],
Cell[393159, 8344, 593, 15, 63, "Input",ExpressionUUID->"ed628348-f31e-4a9b-ba50-421e43ee81c2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[393789, 8364, 176, 3, 37, "Subsubsection",ExpressionUUID->"ee3581fd-c267-4aa2-b53e-618eedbcc19a"],
Cell[393968, 8369, 59902, 1383, 4294, "Input",ExpressionUUID->"f1b9dee0-dab0-4772-9362-1e686da3addd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[453907, 9757, 135, 3, 37, "Subsubsection",ExpressionUUID->"f5ba511d-dc39-4266-9a5d-b47036fe4c37"],
Cell[454045, 9762, 52846, 1009, 2750, "Input",ExpressionUUID->"52b440c1-9bbf-457b-af8b-55cb007f9e1c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[506928, 10776, 139, 3, 37, "Subsubsection",ExpressionUUID->"5199a88c-d4cf-4f1e-92d6-70c2399599c5"],
Cell[507070, 10781, 966, 24, 82, "Input",ExpressionUUID->"f39524e6-1023-42d5-91d4-26667a17a23e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[508073, 10810, 184, 3, 37, "Subsubsection",ExpressionUUID->"2eb70b72-66c1-4cca-92a3-faebd7ac4aa9"],
Cell[508260, 10815, 843, 20, 63, "Input",ExpressionUUID->"2e9cd62b-3af6-44da-a73d-4f398e9fd199",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[509140, 10840, 162, 3, 37, "Subsubsection",ExpressionUUID->"f7e3c5b7-2c51-41cc-b797-cdaf49449972"],
Cell[509305, 10845, 1394, 36, 140, "Input",ExpressionUUID->"944f0416-dd94-4d25-b197-86aa93bad688",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[510736, 10886, 176, 3, 37, "Subsubsection",ExpressionUUID->"453dc659-8cc9-4a14-b820-7a84bc7c10c1"],
Cell[510915, 10891, 47746, 867, 1587, "Input",ExpressionUUID->"136d1ccd-7984-4b1f-9f4e-8346551e4ac6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[558698, 11763, 280, 5, 37, "Subsubsection",ExpressionUUID->"4a651096-6fe7-480f-acb6-5fcf91995886"],
Cell[558981, 11770, 973, 16, 45, "Input",ExpressionUUID->"bd97d00f-a58d-48c7-92f8-341bc4133248",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[559991, 11791, 159, 3, 37, "Subsubsection",ExpressionUUID->"4c2e7990-bf65-48b1-8ec8-74cf66a257b3"],
Cell[560153, 11796, 2533, 63, 235, "Input",ExpressionUUID->"6e842148-ea8f-4433-b072-9e6630dcb93a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[562723, 11864, 163, 3, 37, "Subsubsection",ExpressionUUID->"cba288e5-988d-40bd-ae0e-5e166730c5fd"],
Cell[562889, 11869, 1973, 51, 197, "Input",ExpressionUUID->"5f34a97a-072a-4f9a-a613-82479f4825e7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[564899, 11925, 141, 3, 37, "Subsubsection",ExpressionUUID->"14afb864-641f-466b-b691-a1771dfe6365"],
Cell[565043, 11930, 17482, 400, 659, "Input",ExpressionUUID->"37147205-5cb8-4f7a-b766-decc14db435c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[582562, 12335, 243, 5, 37, "Subsubsection",ExpressionUUID->"21452b93-eb66-46fe-8421-ce6f17afd95c"],
Cell[582808, 12342, 38430, 656, 1421, "Input",ExpressionUUID->"338b0823-3ca3-4ff0-ae40-9910b605f2d3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[621275, 13003, 147, 3, 37, "Subsubsection",ExpressionUUID->"8fd9aec0-45a5-4318-82ee-88053c8585f4"],
Cell[621425, 13008, 37816, 628, 1244, "Input",ExpressionUUID->"36cf09fb-177d-4db5-95d5-946628070b0d",
 InitializationCell->True],
Cell[659244, 13638, 41851, 746, 1528, "Input",ExpressionUUID->"02652a5e-7479-46bb-822e-2576caf2530d"],
Cell[701098, 14386, 33486, 539, 771, "Input",ExpressionUUID->"5b8c30c6-bd5c-4b4a-9308-8005b11d9c0c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[734621, 14930, 133, 3, 37, "Subsubsection",ExpressionUUID->"e40595af-8b16-4e8a-bd7d-29d3504b2037"],
Cell[734757, 14935, 81154, 1674, 3761, "Input",ExpressionUUID->"a2d8608e-d483-43a5-abfa-b2ddb2badaa8",
 InitializationCell->True],
Cell[815914, 16611, 34648, 578, 611, "Input",ExpressionUUID->"2f19460f-6d3c-47f3-9581-2425bf3be082",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[850599, 17194, 225, 4, 37, "Subsubsection",ExpressionUUID->"95179f01-a721-49ed-ae8c-46fd0a7ef5a4"],
Cell[850827, 17200, 37653, 590, 559, "Input",ExpressionUUID->"0b387dd1-36ff-4323-8fb5-ce6799433dc8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[888517, 17795, 163, 3, 37, "Subsubsection",ExpressionUUID->"4f587374-e443-482e-8a24-a68a8ad56bd9"],
Cell[888683, 17800, 4509, 104, 206, "Input",ExpressionUUID->"79feeefb-52be-427f-9713-1a81e1d0c3a2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[893229, 17909, 169, 3, 37, "Subsubsection",ExpressionUUID->"144b4830-8fee-44b7-8263-a050478e3b14"],
Cell[893401, 17914, 2391, 62, 197, "Input",ExpressionUUID->"adf3d5e7-382b-45db-8489-dc31b7bb2318",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[895829, 17981, 395, 6, 37, "Subsubsection",ExpressionUUID->"703c590b-c2fa-432e-9327-0051b74354d4"],
Cell[896227, 17989, 3789, 101, 314, "Input",ExpressionUUID->"f0463e5c-46ae-45fb-9c45-47b88f73699a",
 InitializationCell->True],
Cell[900019, 18092, 25377, 547, 1846, "Input",ExpressionUUID->"462b9870-eaf5-4e85-8821-8f23f6226b83",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[925433, 18644, 236, 4, 37, "Subsubsection",ExpressionUUID->"afc02d37-1a20-42d1-8887-b5233f42effe"],
Cell[925672, 18650, 3448, 90, 274, "Input",ExpressionUUID->"835e3df6-d88f-4a15-96ec-a1877aacb2a8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[929157, 18745, 306, 5, 37, "Subsubsection",ExpressionUUID->"4066e9c4-6855-4c5e-b8c7-c1fa83be599e"],
Cell[929466, 18752, 5390, 136, 428, "Input",ExpressionUUID->"b3f00983-0f85-4982-a9d0-43b38e4a62f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[934893, 18893, 163, 3, 37, "Subsubsection",ExpressionUUID->"3c0f78f8-7661-40b4-b4b7-efc05743b3c1"],
Cell[935059, 18898, 2560, 70, 217, "Input",ExpressionUUID->"4565b3fa-2feb-49ba-8e39-bcadf8538a29",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[937656, 18973, 137, 3, 37, "Subsubsection",ExpressionUUID->"b1347b2c-9378-472d-8d1f-d2969626c983"],
Cell[937796, 18978, 6292, 176, 530, "Input",ExpressionUUID->"bb0ea90d-c494-44be-a406-c9e0494f9712",
 InitializationCell->True],
Cell[944091, 19156, 10981, 270, 885, "Input",ExpressionUUID->"bee3196f-15a2-4a02-be51-bbd1feefe179",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[955109, 19431, 161, 3, 37, "Subsubsection",ExpressionUUID->"1a17629d-a506-40d7-a32b-bf58a766190a"],
Cell[955273, 19436, 3134, 88, 255, "Input",ExpressionUUID->"651c226d-6609-4b62-84bd-4cd7cee36332",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[958444, 19529, 165, 3, 37, "Subsubsection",ExpressionUUID->"650aa254-73b5-4ec3-ba41-8826e283f1a4"],
Cell[958612, 19534, 3307, 90, 255, "Input",ExpressionUUID->"9e368f45-d1d0-410d-bd81-bfdc7ae926b7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[961956, 19629, 185, 3, 37, "Subsubsection",ExpressionUUID->"80b4b81a-4cbf-44a8-b5cb-d8713f3ffa99"],
Cell[962144, 19634, 5463, 143, 389, "Input",ExpressionUUID->"66275e49-0229-48bf-86d9-5f71bbb1bb90",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[967644, 19782, 214, 4, 37, "Subsubsection",ExpressionUUID->"d54d3da9-b877-45bd-9080-d8575f7b7de7"],
Cell[967861, 19788, 5014, 131, 427, "Input",ExpressionUUID->"41e88635-2b04-436f-9e5d-cb3af399831b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[972912, 19924, 245, 5, 37, "Subsubsection",ExpressionUUID->"c80e352f-b229-4543-817b-6f93f3646a9d"],
Cell[973160, 19931, 4780, 123, 390, "Input",ExpressionUUID->"ee6ef492-15bd-49cf-b99c-f24451caf889",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[977977, 20059, 306, 5, 37, "Subsubsection",ExpressionUUID->"f6ddef79-ceac-444b-9b8f-0cb002174997"],
Cell[978286, 20066, 3856, 90, 237, "Input",ExpressionUUID->"9c23682d-a789-407b-848f-e713449f4f9b",
 InitializationCell->True]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[982191, 20162, 185, 3, 54, "Subsection",ExpressionUUID->"f3f44c39-e189-4599-a024-fd5d7b9b5c7b"],
Cell[CellGroupData[{
Cell[982401, 20169, 164, 2, 45, "Subsubsection",ExpressionUUID->"23ecd828-5ed8-439a-8735-8f25774e6733"],
Cell[982568, 20173, 985, 27, 101, "Input",ExpressionUUID->"8df9954d-80ca-4556-9487-8ff41072a942",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[983590, 20205, 202, 3, 37, "Subsubsection",ExpressionUUID->"1aa6c251-39ee-4486-8824-260a86b5abeb"],
Cell[983795, 20210, 2427, 65, 273, "Input",ExpressionUUID->"0ddf66b2-2c4f-46d3-a8b5-2c4366356ce4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[986259, 20280, 193, 3, 37, "Subsubsection",ExpressionUUID->"7c82a65f-04a3-4068-a8d3-46c810bf713b"],
Cell[986455, 20285, 4265, 114, 408, "Input",ExpressionUUID->"f48a2b94-e898-4e99-8e01-5f1f5164877b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[990757, 20404, 199, 3, 37, "Subsubsection",ExpressionUUID->"8c83a780-d5bd-4f42-9a88-4a2610da6da9"],
Cell[990959, 20409, 19945, 488, 1627, "Input",ExpressionUUID->"2c93cd0b-eca5-4afe-839b-d6a84edb3bc6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1010941, 20902, 211, 3, 37, "Subsubsection",ExpressionUUID->"93e1a582-cf2e-4df0-8776-723340952030"],
Cell[1011155, 20907, 1266, 34, 120, "Input",ExpressionUUID->"68673e80-1522-444a-8f48-9a4fcb952557",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1012458, 20946, 207, 3, 37, "Subsubsection",ExpressionUUID->"93ad3344-221c-47ed-8021-9301d3e0e3f8"],
Cell[1012668, 20951, 2384, 64, 216, "Input",ExpressionUUID->"f4bf9519-da37-4584-8229-68da2fcbca6e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1015089, 21020, 202, 3, 37, "Subsubsection",ExpressionUUID->"10bafcd7-3513-408d-abb3-134089a6cebd"],
Cell[1015294, 21025, 1085, 31, 101, "Input",ExpressionUUID->"4e371737-231c-4a4c-b82d-436fd001d52c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1016416, 21061, 210, 3, 37, "Subsubsection",ExpressionUUID->"75ca5e59-f155-4b3b-a983-7ded1a3e689c"],
Cell[1016629, 21066, 1375, 38, 120, "Input",ExpressionUUID->"f7074981-1802-4521-80a0-1bdf63318722",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1018041, 21109, 226, 4, 33, "Subsubsection",ExpressionUUID->"21366297-de70-431e-bb9a-44742026c5d0"],
Cell[1018270, 21115, 6891, 174, 636, "Input",ExpressionUUID->"5ee271bf-6c2a-458e-8e57-9e23e8a922f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1025198, 21294, 207, 3, 33, "Subsubsection",ExpressionUUID->"bd0e82e6-1ea8-4e4f-a672-f441813d8795"],
Cell[1025408, 21299, 3031, 80, 311, "Input",ExpressionUUID->"a9ffbde1-9315-41e5-99ca-9ce6e4cdab7c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1028476, 21384, 198, 3, 33, "Subsubsection",ExpressionUUID->"5abeb7ce-6d51-43f6-a46b-d7054dbb4971"],
Cell[1028677, 21389, 12377, 279, 1263, "Input",ExpressionUUID->"1f65dda3-6561-49d3-b889-ec8afc65b582",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1041091, 21673, 299, 5, 33, "Subsubsection",ExpressionUUID->"a7f7f10d-763e-4c72-a7ca-7359b6939cd0"],
Cell[1041393, 21680, 12225, 269, 768, "Input",ExpressionUUID->"4ce8865e-e8e3-49bd-81b4-905700e9f61e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1053655, 21954, 153, 3, 33, "Subsubsection",ExpressionUUID->"0f0f2248-1ca5-4f9f-85f4-262176613ebb"],
Cell[1053811, 21959, 1720, 48, 180, "Input",ExpressionUUID->"216ec684-5d09-4555-9dbd-c9030a7b3685",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1055568, 22012, 266, 5, 33, "Subsubsection",ExpressionUUID->"7dfb31c1-6cd3-4f41-a858-7d9052b29eaa"],
Cell[1055837, 22019, 1762, 45, 240, "Input",ExpressionUUID->"390ef9bb-7716-4452-8d5b-ae7722bd9d7f",
 InitializationCell->True]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[1057648, 22070, 388, 6, 38, "Subsection",ExpressionUUID->"a6b6a354-d554-49ba-8092-63da772c0038"],
Cell[1058039, 22078, 11409, 267, 783, "Input",ExpressionUUID->"b8663cdd-4807-484a-941a-972af46a9cf8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1069485, 22350, 142, 3, 38, "Subsection",ExpressionUUID->"f950017d-de23-4b3a-bc36-deac1ceb23c6"],
Cell[1069630, 22355, 20795, 530, 1665, "Input",ExpressionUUID->"bea6ffd1-ee56-429a-9016-22680cfeaabc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1090462, 22890, 164, 3, 38, "Subsection",ExpressionUUID->"311d1f40-968d-4328-b149-24ed785a7f46"],
Cell[1090629, 22895, 4745, 127, 347, "Input",ExpressionUUID->"21e201e5-ef62-4f4d-b138-529dc05ee9fc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1095411, 23027, 293, 5, 38, "Subsection",ExpressionUUID->"b3b5ca54-2a98-41b1-b0bc-4a1ae48419be"],
Cell[1095707, 23034, 53160, 1165, 4324, "Input",ExpressionUUID->"4aba9fe4-8dc2-4999-9899-a395918895d5",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1148904, 24204, 240, 4, 38, "Subsection",ExpressionUUID->"c24b1520-13e6-4858-9683-fcd039868295"],
Cell[1149147, 24210, 18636, 433, 1514, "Input",ExpressionUUID->"e180f111-643b-4ad9-9190-34b76f2b913a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1167820, 24648, 152, 3, 38, "Subsection",ExpressionUUID->"3e851b52-9d26-44b4-88b1-d76b3c349201"],
Cell[1167975, 24653, 12514, 259, 959, "Input",ExpressionUUID->"88c465ea-0b26-453a-9f87-54d52741b1bd",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1180526, 24917, 178, 3, 38, "Subsection",ExpressionUUID->"a2143a5b-8e99-4039-af31-7b892d4f9ccb"],
Cell[1180707, 24922, 18404, 403, 1340, "Input",ExpressionUUID->"c9a30d29-04d5-45c8-bb1d-513ed83291b4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1199148, 25330, 148, 2, 38, "Subsection",ExpressionUUID->"c2def25f-1776-4a82-abe4-e31e6156b5ce"],
Cell[1199299, 25334, 11196, 248, 882, "Input",ExpressionUUID->"1d2b45cd-c3da-4db1-94aa-061cf78888fa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1210532, 25587, 157, 3, 38, "Subsection",ExpressionUUID->"c25be501-361d-4b91-9c14-1d4568313200"],
Cell[1210692, 25592, 2437, 58, 273, "Input",ExpressionUUID->"b3fdcfec-523d-4d23-bb28-efc266000646",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1213166, 25655, 229, 4, 38, "Subsection",ExpressionUUID->"39601059-4c8d-4012-9dea-8af07a0a4633"],
Cell[1213398, 25661, 13672, 281, 990, "Input",ExpressionUUID->"c9ec7425-5271-46ed-a20b-5b9376c901fe",
 InitializationCell->True],
Cell[1227073, 25944, 10016, 189, 654, "Input",ExpressionUUID->"21f8df74-d008-4560-b592-59d81d7698c8",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1237126, 26138, 206, 4, 38, "Subsection",ExpressionUUID->"7cbc090d-7a83-4153-ae68-cc167684801f"],
Cell[1237335, 26144, 9222, 191, 787, "Input",ExpressionUUID->"7f1ccae2-3c30-4371-8618-d91a4f17ca91",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1246594, 26340, 181, 3, 38, "Subsection",ExpressionUUID->"31e090b9-dd85-40b9-a7df-ce03fcde407b"],
Cell[1246778, 26345, 2438, 58, 235, "Input",ExpressionUUID->"0d49aaa7-8277-4d46-b9c9-435647c290fa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1249253, 26408, 243, 4, 38, "Subsection",ExpressionUUID->"55230c28-b185-4766-80cb-5916481cf9ef"],
Cell[1249499, 26414, 2217, 54, 146, "Input",ExpressionUUID->"a95930d0-217d-4427-a008-12e0a3b0dc8e",
 InitializationCell->True],
Cell[1251719, 26470, 10475, 256, 383, "Input",ExpressionUUID->"31fa951b-fa09-4c1b-8761-c958895c180d",
 InitializationCell->True],
Cell[1262197, 26728, 35103, 848, 2501, "Input",ExpressionUUID->"34349c22-e864-41cf-ad64-9e5af6463d2e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1297337, 27581, 671, 10, 38, "Subsection",ExpressionUUID->"1e02da7f-dadb-4d22-9e40-becc081cf057"],
Cell[1298011, 27593, 994, 26, 140, "Input",ExpressionUUID->"1deee915-48bf-442d-9992-412e1585ee56",
 InitializationCell->True],
Cell[1299008, 27621, 57534, 1252, 3975, "Input",ExpressionUUID->"5a630646-5eed-4f17-8285-6decb04988a6",
 InitializationCell->True],
Cell[1356545, 28875, 26597, 565, 1663, "Input",ExpressionUUID->"05c7a639-9ef9-4f32-ada2-34a29d99e7aa",
 InitializationCell->True],
Cell[1383145, 29442, 10545, 221, 768, "Input",ExpressionUUID->"5b86961e-1cf5-4a46-bc04-811c99736b22",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1393727, 29668, 357, 6, 38, "Subsection",ExpressionUUID->"05e9fa37-f55f-4e3e-90f1-83b8b508145e"],
Cell[1394087, 29676, 4602, 104, 368, "Input",ExpressionUUID->"8843326f-3452-4b7e-9d9f-ecdc3baed4a3",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1398726, 29785, 405, 6, 38, "Subsection",ExpressionUUID->"62186d2f-6045-4bdd-821b-6e563a764add"],
Cell[1399134, 29793, 71218, 1545, 3840, "Input",ExpressionUUID->"92a3c042-dbe0-47d4-9c1c-a11b13a56496",
 InitializationCell->True],
Cell[1470355, 31340, 33279, 672, 1627, "Input",ExpressionUUID->"267b9797-6b2b-430c-a9b6-975c0ade72be"]
}, Closed]],
Cell[CellGroupData[{
Cell[1503671, 32017, 463, 7, 38, "Subsection",ExpressionUUID->"3f734fc5-9c3f-4157-ab30-9d3e379fab20"],
Cell[1504137, 32026, 11155, 181, 311, "Input",ExpressionUUID->"0175fc62-84a9-4af5-bd42-c8f70b287fdb",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1515329, 32212, 461, 7, 38, "Subsection",ExpressionUUID->"7ae3a39d-25a1-4c31-ab81-6f0c1e5a8675"],
Cell[1515793, 32221, 11012, 179, 292, "Input",ExpressionUUID->"3d65c77e-074d-4df2-90b5-34a2dc446b2d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1526842, 32405, 567, 9, 38, "Subsection",ExpressionUUID->"3e71db93-4edc-48aa-a385-44c9fa8f6a67"],
Cell[1527412, 32416, 10404, 165, 160, "Input",ExpressionUUID->"5d3c4916-383f-4df9-8f0d-5bc252b8f0ac",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1537853, 32586, 567, 8, 38, "Subsection",ExpressionUUID->"2f9c189e-c61f-4528-b068-5ee78157f7a7"],
Cell[1538423, 32596, 23467, 463, 1225, "Input",ExpressionUUID->"681613ce-1289-4aac-a8e3-82a65ac70130",
 InitializationCell->True],
Cell[1561893, 33061, 17902, 336, 825, "Input",ExpressionUUID->"eb17d187-2648-4089-967a-01205d227499",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1579832, 33402, 547, 8, 38, "Subsection",ExpressionUUID->"0e319148-22dc-463b-b4f2-1996df21df7b"],
Cell[1580382, 33412, 32927, 598, 1187, "Input",ExpressionUUID->"f5045f13-e32e-4ccc-936b-6d56dd261ef9",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1613346, 34015, 388, 6, 38, "Subsection",ExpressionUUID->"50ec6023-e205-4e05-b069-65396b86e78d"],
Cell[1613737, 34023, 74442, 1618, 4283, "Input",ExpressionUUID->"60c56988-1c9a-4dd3-bdf9-66b8da5c2652",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1688216, 35646, 336, 5, 38, "Subsection",ExpressionUUID->"068f7a26-195b-4784-ab30-cc18cb7a08c8"],
Cell[1688555, 35653, 32863, 630, 1912, "Input",ExpressionUUID->"c62c2130-ec1c-4ac0-8992-b3ffe500d352",
 InitializationCell->True],
Cell[1721421, 36285, 48291, 974, 2773, "Input",ExpressionUUID->"7307a0e2-ee1d-4d18-b16b-642b8bd73765",
 InitializationCell->True],
Cell[1769715, 37261, 4497, 118, 368, "Input",ExpressionUUID->"a7e03333-566f-4964-af73-74f7ba21abcc",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1774249, 37384, 288, 5, 38, "Subsection",ExpressionUUID->"0e73ee14-ddc6-4094-897f-e020160790d0"],
Cell[1774540, 37391, 17876, 413, 1296, "Input",ExpressionUUID->"2530e695-ff6a-4bf8-a014-8709536a94b3",
 InitializationCell->True],
Cell[1792419, 37806, 81, 0, 28, "Input",ExpressionUUID->"74ccdc3f-0172-4103-b65e-b4fc62e0d23f"]
}, Closed]],
Cell[CellGroupData[{
Cell[1792537, 37811, 387, 6, 38, "Subsection",ExpressionUUID->"c6e974b4-db8f-43a6-b870-4241d0d1698a"],
Cell[1792927, 37819, 5122, 117, 444, "Input",ExpressionUUID->"c167f52d-6b5f-45f9-88cc-e47f81b96e71",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1798086, 37941, 167, 3, 38, "Subsection",ExpressionUUID->"64fc49b5-8c00-4eb5-9ab2-6332caaddfbb"],
Cell[1798256, 37946, 13353, 291, 1054, "Input",ExpressionUUID->"5a646ee0-bb50-4ec4-a619-8d4711fa672e",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1811646, 38242, 439, 7, 38, "Subsection",ExpressionUUID->"7503329c-2ee4-4851-b1a9-d38c3a66c1d1"],
Cell[1812088, 38251, 47740, 1005, 2024, "Input",ExpressionUUID->"4ea885f3-5b3b-40e6-892f-1255f61a94e7",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1859865, 39261, 161, 3, 38, "Subsection",ExpressionUUID->"ee5698d3-2006-4985-94f3-ce90c4ed802b"],
Cell[1860029, 39266, 25048, 579, 2010, "Input",ExpressionUUID->"227748a2-679c-45f6-b405-0147348e80ed",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1885114, 39850, 252, 4, 38, "Subsection",ExpressionUUID->"131904c6-bd11-4ab3-96db-cf9c959fa90e"],
Cell[1885369, 39856, 15138, 313, 1230, "Input",ExpressionUUID->"0ca44d64-f283-412b-b161-9661e40c02ea",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1900544, 40174, 258, 4, 38, "Subsection",ExpressionUUID->"b2354afd-9df5-4147-9021-cf009b24b203"],
Cell[1900805, 40180, 53515, 1162, 3027, "Input",ExpressionUUID->"77ee29de-9d0f-4973-bc71-a9732e80b77a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[1954357, 41347, 460, 7, 38, "Subsection",ExpressionUUID->"516e681d-1beb-42c7-806f-b844a71db486"],
Cell[1954820, 41356, 1134, 22, 58, "Text",ExpressionUUID->"393f2f94-1803-4e23-b0dd-9cd1deb87029"],
Cell[1955957, 41380, 64461, 1432, 4140, "Input",ExpressionUUID->"58101c3d-e202-45e2-8fee-0723b2d713ba",
 InitializationCell->True],
Cell[2020421, 42814, 6020, 135, 406, "Input",ExpressionUUID->"c81cd627-8f4c-4b5e-ae5b-e293cfdee714",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2026478, 42954, 134, 3, 38, "Subsection",ExpressionUUID->"5a6f0069-2e6b-4d53-b6f4-b774d3db0b81"],
Cell[2026615, 42959, 19031, 325, 561, "Input",ExpressionUUID->"d180cf2c-a79b-4f69-aea8-e633c963da59",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2045683, 43289, 150, 3, 38, "Subsection",ExpressionUUID->"6b8fdb4f-3e2d-4c25-9e87-ef1a7343b3cf"],
Cell[2045836, 43294, 9340, 230, 540, "Input",ExpressionUUID->"d82d687a-8264-4ab2-8e90-126ea1a0db20",
 InitializationCell->True],
Cell[2055179, 43526, 141569, 3224, 8755, "Input",ExpressionUUID->"b3e7bd08-1c18-4283-aced-4e7fd0095136",
 InitializationCell->True],
Cell[2196751, 46752, 135211, 3107, 9918, "Input",ExpressionUUID->"af284ae8-289c-4c91-bc16-2f323eb155c6",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2331999, 49864, 434, 7, 38, "Subsection",ExpressionUUID->"a00f9896-4f06-4a88-8e52-0ee43a61bd0b"],
Cell[2332436, 49873, 11534, 245, 941, "Input",ExpressionUUID->"2f5af4b6-2f92-465b-ae16-6ac60fd229f1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2344007, 50123, 464, 7, 38, "Subsection",ExpressionUUID->"bbfd1ab0-1e50-42bd-8f51-869014502f0a"],
Cell[2344474, 50132, 23227, 464, 1041, "Input",ExpressionUUID->"6bd51a80-bab0-48e3-b098-59a9caf39d3f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2367738, 50601, 164, 3, 38, "Subsection",ExpressionUUID->"8a45d202-28be-4482-b50b-e26fefc3992b"],
Cell[2367905, 50606, 12319, 287, 829, "Input",ExpressionUUID->"c48cf425-f1a2-4462-9c2a-870af9587f71",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2380261, 50898, 418, 8, 38, "Subsection",ExpressionUUID->"3dc93e88-18fc-4b08-a0f2-3b0ced8ffdbc"],
Cell[2380682, 50908, 746, 15, 166, "Text",ExpressionUUID->"e2214c72-9e0d-4f3b-a15d-6117c612dd78"],
Cell[2381431, 50925, 15439, 312, 787, "Input",ExpressionUUID->"774edf3d-4b55-4145-849b-051d46c6a79d",
 InitializationCell->True],
Cell[2396873, 51239, 795, 16, 144, "Text",ExpressionUUID->"1b74c357-bac8-4f82-b251-cefd17cf0c45"],
Cell[2397671, 51257, 14700, 294, 750, "Input",ExpressionUUID->"5d23b930-244c-4440-9bb2-85e665a9cfe2",
 InitializationCell->True],
Cell[2412374, 51553, 1020, 17, 122, "Text",ExpressionUUID->"a487075c-68f8-446d-88be-4ec5655f4d49"],
Cell[2413397, 51572, 15586, 313, 604, "Input",ExpressionUUID->"2326bf4b-94b0-4d6a-94dc-818f699c4d72",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2429020, 51890, 199, 3, 38, "Subsection",ExpressionUUID->"7281337e-90c7-4b6f-8c1b-99b585cc5ebe"],
Cell[2429222, 51895, 12727, 291, 874, "Input",ExpressionUUID->"9f06ca08-8f2d-4be0-a5fd-c759237e39e4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2441986, 52191, 173, 3, 38, "Subsection",ExpressionUUID->"4375b8ad-6ca0-4d8e-a4f4-b57cc6e2c0cf"],
Cell[2442162, 52196, 65311, 1516, 4725, "Input",ExpressionUUID->"50c6e264-7529-47c9-b7ad-c8dfe917b77a",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2507510, 53717, 159, 3, 38, "Subsection",ExpressionUUID->"a55d1c18-3c45-4e1f-9386-d993b2e4baea"],
Cell[2507672, 53722, 3847, 94, 397, "Input",ExpressionUUID->"e76f6b7f-8058-4fc4-8e18-32647377a312",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2511556, 53821, 342, 5, 38, "Subsection",ExpressionUUID->"9aeb1f18-2f1d-4f6e-b2d8-2c04ed42fe68"],
Cell[CellGroupData[{
Cell[2511923, 53830, 243, 4, 43, "Subsubsection",ExpressionUUID->"5db8945c-3ed2-4319-93e6-ef131d7ea38b"],
Cell[2512169, 53836, 932, 17, 78, "Text",ExpressionUUID->"550153cc-829c-4cab-b436-a3dffadefa9f"],
Cell[2513104, 53855, 1593, 35, 100, "Text",ExpressionUUID->"06625af5-e892-4986-a9e0-3fcb55cd4351"],
Cell[2514700, 53892, 906, 21, 55, "Text",ExpressionUUID->"4fe5a98c-8d34-40fb-a0f9-d95ece083cf3"],
Cell[2515609, 53915, 2404, 66, 80, "Text",ExpressionUUID->"484f6c56-4b94-4e41-89a3-11bbf52411f1"],
Cell[2518016, 53983, 2441, 64, 101, "Text",ExpressionUUID->"9a4d30a7-e9b1-49e7-ad9a-e04e4ad3649c"],
Cell[2520460, 54049, 3816, 104, 152, "Text",ExpressionUUID->"737bb917-bcee-448c-8c61-0e630eff150f"],
Cell[2524279, 54155, 2413, 52, 144, "Text",ExpressionUUID->"cda8c66d-f29b-4fb2-8ec7-df06179942fe"],
Cell[2526695, 54209, 3600, 94, 170, "Text",ExpressionUUID->"7365e31d-053a-4341-847b-9d20c90a79a6"],
Cell[2530298, 54305, 2482, 58, 123, "Text",ExpressionUUID->"2910b6b4-dd90-4a69-8a52-32d0f911eefa"],
Cell[2532783, 54365, 782, 16, 100, "Text",ExpressionUUID->"0b80b6e4-d06c-4784-8abe-4917f26d885e"]
}, Closed]],
Cell[CellGroupData[{
Cell[2533602, 54386, 162, 3, 33, "Subsubsection",ExpressionUUID->"865bec23-b795-4f79-abb2-692dba52b506"],
Cell[2533767, 54391, 55341, 1174, 4070, "Input",ExpressionUUID->"be69bc0c-f23e-42f8-b5d2-e67fb1a31db0",
 InitializationCell->True],
Cell[2589111, 55567, 18034, 302, 605, "Input",ExpressionUUID->"e7aa6d7e-597e-4268-9cea-38b386020295",
 InitializationCell->True],
Cell[2607148, 55871, 15174, 255, 587, "Input",ExpressionUUID->"8d79a8a5-7ec4-4e96-b4c8-b15d70013b23",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2622359, 56131, 316, 5, 33, "Subsubsection",ExpressionUUID->"6b883a84-a833-4032-b90f-01b764466ccc"],
Cell[2622678, 56138, 5991, 157, 406, "Input",ExpressionUUID->"bd12b7be-8b0d-43d8-912f-7a4b2aecd725",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2628706, 56300, 160, 3, 33, "Subsubsection",ExpressionUUID->"e87a704e-ca4f-4e56-bc1a-70782c9b0a2c"],
Cell[2628869, 56305, 1968, 46, 120, "Input",ExpressionUUID->"2cea03de-e41a-4d25-89fa-b6ed5552e8a1",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2630874, 56356, 166, 3, 33, "Subsubsection",ExpressionUUID->"0b6fed30-3634-43ee-80c8-2ecafdd0e265"],
Cell[2631043, 56361, 1626, 39, 101, "Input",ExpressionUUID->"27725eec-53c5-41b7-850c-df20b3c08fa2",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2632706, 56405, 211, 4, 33, "Subsubsection",ExpressionUUID->"293f512d-0167-44ba-99c9-f7fe9e66e44b"],
Cell[2632920, 56411, 1766, 43, 101, "Input",ExpressionUUID->"1a414918-ee66-4e6f-ad5a-be0b8c63c99c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2634723, 56459, 271, 4, 33, "Subsubsection",ExpressionUUID->"b9a4af75-3a33-450a-9c0f-4ce1c0791806"],
Cell[2634997, 56465, 1680, 40, 101, "Input",ExpressionUUID->"f80df394-c6f8-48b0-bd29-6b0999066c15",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2636714, 56510, 312, 5, 33, "Subsubsection",ExpressionUUID->"b0b8d692-4957-467d-ae1e-aa214d3370e1"],
Cell[2637029, 56517, 1840, 44, 82, "Input",ExpressionUUID->"cca260ae-8eb8-43cf-b070-73050e196e5f",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2638906, 56566, 261, 4, 33, "Subsubsection",ExpressionUUID->"1de083d4-2870-4c02-8d71-5d6c7c6e7e6d"],
Cell[2639170, 56572, 1505, 37, 120, "Input",ExpressionUUID->"d5943ebb-12da-48aa-ba02-3d505a60df87",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2640712, 56614, 461, 7, 33, "Subsubsection",ExpressionUUID->"34826003-b078-4f6c-9e5e-6c618ecc57de"],
Cell[2641176, 56623, 4928, 118, 368, "Input",ExpressionUUID->"ca54feb2-d00e-4f7e-b100-a65454a219b4",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2646141, 56746, 504, 7, 33, "Subsubsection",ExpressionUUID->"9fe1b10e-8538-43de-b21f-03b7c5eb1687"],
Cell[2646648, 56755, 1103, 27, 101, "Input",ExpressionUUID->"df59a9b6-049f-49d0-9094-da66833be24c",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2647788, 56787, 311, 5, 33, "Subsubsection",ExpressionUUID->"86ba7e76-0b9d-41d2-a82b-b1c6c7226501"],
Cell[2648102, 56794, 1283, 33, 101, "Input",ExpressionUUID->"dba3ad66-c194-4162-bbe2-88aa9be0e86d",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2649422, 56832, 447, 7, 33, "Subsubsection",ExpressionUUID->"d7ea3f83-6f7c-4a43-b6a3-c9bdd5b55d7b"],
Cell[2649872, 56841, 1003, 26, 82, "Input",ExpressionUUID->"bcb84637-decb-49f1-b131-ecc12403ffa5",
 InitializationCell->True]
}, Closed]],
Cell[2650890, 56870, 289, 4, 33, "Subsubsection",ExpressionUUID->"fa2a8b50-6d07-47f6-b1be-2e88a8613a2e"]
}, Closed]]
}, If[{97} === Open, Closed, Open]]],
Cell[CellGroupData[{
Cell[2651253, 56880, 147, 2, 67, "Section",ExpressionUUID->"d17ead81-6517-42ab-898c-9f79ba651411"],
Cell[2651403, 56884, 9824, 144, 591, "Input",ExpressionUUID->"58c44fd8-6e68-433c-af38-a80fd733c7fa",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2661264, 57033, 143, 2, 53, "Section",ExpressionUUID->"f22bca56-27ec-41a4-b3d0-6ec3bb235ca7"],
Cell[2661410, 57037, 2961, 46, 62, "Input",ExpressionUUID->"50fbc756-37bb-453f-b324-c5e8338f1c6b",
 InitializationCell->True]
}, Closed]],
Cell[CellGroupData[{
Cell[2664408, 57088, 262, 4, 53, "Section",ExpressionUUID->"a02fac61-8b82-4c6d-8ef1-5122ad80d48b"],
Cell[2664673, 57094, 8118, 129, 298, "Text",ExpressionUUID->"7a2153af-e443-461d-adf3-be30f252d6d1"],
Cell[2672794, 57225, 7021, 101, 166, "Text",ExpressionUUID->"420ff4cf-d2c1-45e8-9544-523fe8e60a7e"],
Cell[2679818, 57328, 6689, 96, 78, "Text",ExpressionUUID->"7c721e48-f508-4526-9b70-cf02b9d648a5"],
Cell[2686510, 57426, 7039, 103, 188, "Text",ExpressionUUID->"bca1ac60-c7b5-4241-bf13-b3afd3fa07e2"],
Cell[2693552, 57531, 7030, 107, 100, "Text",ExpressionUUID->"ead71958-ac53-4658-8df1-ae41691260d0"],
Cell[2700585, 57640, 7064, 104, 166, "Text",ExpressionUUID->"0743ba2d-d02a-4a35-9a48-b26222ee90e6"],
Cell[2707652, 57746, 7382, 114, 188, "Text",ExpressionUUID->"105d041f-d11d-472a-b7a6-55d5b0c7d4a4"],
Cell[2715037, 57862, 7435, 117, 124, "Text",ExpressionUUID->"4225639f-c070-42ef-889d-a81e2dc4b44a"],
Cell[2722475, 57981, 8381, 141, 453, "Text",ExpressionUUID->"e6dffbbf-2f6d-4d0c-b056-bd861796db5e"],
Cell[2730859, 58124, 14480, 284, 2152, "Text",ExpressionUUID->"219c5f04-52cf-4dae-967b-47f3912e2bec"],
Cell[2745342, 58410, 6966, 101, 166, "Text",ExpressionUUID->"dfdae96a-3060-44da-84f7-d41e581edf1b"],
Cell[2752311, 58513, 20004, 402, 3915, "Text",ExpressionUUID->"6a328d5f-73fb-4371-810d-e49da45a4eff"]
}, Closed]]
}, Open  ]]
}
]
*)

